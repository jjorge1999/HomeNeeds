var p4=Object.defineProperty,g4=Object.defineProperties;var m4=Object.getOwnPropertyDescriptors;var d1=Object.getOwnPropertySymbols;var y4=Object.prototype.hasOwnProperty,v4=Object.prototype.propertyIsEnumerable;var h1=(n,e,t)=>e in n?p4(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,H=(n,e)=>{for(var t in e||={})y4.call(e,t)&&h1(n,t,e[t]);if(d1)for(var t of d1(e))v4.call(e,t)&&h1(n,t,e[t]);return n},ce=(n,e)=>g4(n,m4(e));var Dn=null,kg=!1,lw=1,_4=null,Fn=Symbol("SIGNAL");function de(n){let e=Dn;return Dn=n,e}function Mg(){return Dn}var Ml={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function hh(n){if(kg)throw new Error("");if(Dn===null)return;Dn.consumerOnSignalRead(n);let e=Dn.producersTail;if(e!==void 0&&e.producer===n)return;let t,r=Dn.recomputing;if(r&&(t=e!==void 0?e.nextProducer:Dn.producers,t!==void 0&&t.producer===n)){Dn.producersTail=t,t.lastReadVersion=n.version;return}let i=n.consumersTail;if(i!==void 0&&i.consumer===Dn&&(!r||I4(i,Dn)))return;let s=Ol(Dn),o={producer:n,consumer:Dn,nextProducer:t,prevConsumer:i,lastReadVersion:n.version,nextConsumer:void 0};Dn.producersTail=o,e!==void 0?e.nextProducer=o:Dn.producers=o,s&&m1(n,o)}function f1(){lw++}function uw(n){if(!(Ol(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===lw)){if(!n.producerMustRecompute(n)&&!ph(n)){cw(n);return}n.producerRecomputeValue(n),cw(n)}}function dw(n){if(n.consumers===void 0)return;let e=kg;kg=!0;try{for(let t=n.consumers;t!==void 0;t=t.nextConsumer){let r=t.consumer;r.dirty||w4(r)}}finally{kg=e}}function hw(){return Dn?.consumerAllowSignalWrites!==!1}function w4(n){n.dirty=!0,dw(n),n.consumerMarkedDirty?.(n)}function cw(n){n.dirty=!1,n.lastCleanEpoch=lw}function Pl(n){return n&&p1(n),de(n)}function p1(n){n.producersTail=void 0,n.recomputing=!0}function fh(n,e){de(e),n&&g1(n)}function g1(n){n.recomputing=!1;let e=n.producersTail,t=e!==void 0?e.nextProducer:n.producers;if(t!==void 0){if(Ol(n))do t=fw(t);while(t!==void 0);e!==void 0?e.nextProducer=void 0:n.producers=void 0}}function ph(n){for(let e=n.producers;e!==void 0;e=e.nextProducer){let t=e.producer,r=e.lastReadVersion;if(r!==t.version||(uw(t),r!==t.version))return!0}return!1}function Ua(n){if(Ol(n)){let e=n.producers;for(;e!==void 0;)e=fw(e)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function m1(n,e){let t=n.consumersTail,r=Ol(n);if(t!==void 0?(e.nextConsumer=t.nextConsumer,t.nextConsumer=e):(e.nextConsumer=void 0,n.consumers=e),e.prevConsumer=t,n.consumersTail=e,!r)for(let i=n.producers;i!==void 0;i=i.nextProducer)m1(i.producer,i)}function fw(n){let e=n.producer,t=n.nextProducer,r=n.nextConsumer,i=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,r!==void 0?r.prevConsumer=i:e.consumersTail=i,i!==void 0)i.nextConsumer=r;else if(e.consumers=r,!Ol(e)){let s=e.producers;for(;s!==void 0;)s=fw(s)}return t}function Ol(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function pw(n){_4?.(n)}function I4(n,e){let t=e.producersTail;if(t!==void 0){let r=e.producers;do{if(r===n)return!0;if(r===t)break;r=r.nextProducer}while(r!==void 0)}return!1}function gw(n,e){return Object.is(n,e)}function Pg(n,e){let t=Object.create(E4);t.computation=n,e!==void 0&&(t.equal=e);let r=()=>{if(uw(t),hh(t),t.value===Ng)throw t.error;return t.value};return r[Fn]=t,pw(t),r}var ow=Symbol("UNSET"),aw=Symbol("COMPUTING"),Ng=Symbol("ERRORED"),E4=ce(H({},Ml),{value:ow,dirty:!0,error:null,equal:gw,kind:"computed",producerMustRecompute(n){return n.value===ow||n.value===aw},producerRecomputeValue(n){if(n.value===aw)throw new Error("");let e=n.value;n.value=aw;let t=Pl(n),r,i=!1;try{r=n.computation(),de(null),i=e!==ow&&e!==Ng&&r!==Ng&&n.equal(e,r)}catch(s){r=Ng,n.error=s}finally{fh(n,t)}if(i){n.value=e;return}n.value=r,n.version++}});function b4(){throw new Error}var y1=b4;function v1(n){y1(n)}function mw(n){y1=n}var C4=null;function yw(n,e){let t=Object.create(Og);t.value=n,e!==void 0&&(t.equal=e);let r=()=>_1(t);return r[Fn]=t,pw(t),[r,o=>gh(t,o),o=>w1(t,o)]}function _1(n){return hh(n),n.value}function gh(n,e){hw()||v1(n),n.equal(n.value,e)||(n.value=e,T4(n))}function w1(n,e){hw()||v1(n),gh(n,e(n.value))}var Og=ce(H({},Ml),{equal:gw,value:void 0,kind:"signal"});function T4(n){n.version++,f1(),dw(n),C4?.(n)}function vw(n){let e=de(null);try{return n()}finally{de(e)}}var _w=ce(H({},Ml),{consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,kind:"effect"});function ww(n){if(n.dirty=!1,n.version>0&&!ph(n))return;n.version++;let e=Pl(n);try{n.cleanup(),n.fn()}finally{fh(n,e)}}function Te(n){return typeof n=="function"}function Fl(n){let t=n(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Fg=Fl(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function ja(n,e){if(n){let t=n.indexOf(e);0<=t&&n.splice(t,1)}}var Zt=class n{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let s of t)s.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Te(r))try{r()}catch(s){e=s instanceof Fg?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{I1(s)}catch(o){e=e??[],o instanceof Fg?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Fg(e)}}add(e){var t;if(e&&e!==this)if(this.closed)I1(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}}_hasParent(e){let{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){let{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&ja(t,e)}remove(e){let{_finalizers:t}=this;t&&ja(t,e),e instanceof n&&e._removeParent(this)}};Zt.EMPTY=(()=>{let n=new Zt;return n.closed=!0,n})();var Iw=Zt.EMPTY;function Vg(n){return n instanceof Zt||n&&"closed"in n&&Te(n.remove)&&Te(n.add)&&Te(n.unsubscribe)}function I1(n){Te(n)?n():n.unsubscribe()}var jr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Vl={setTimeout(n,e,...t){let{delegate:r}=Vl;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){let{delegate:e}=Vl;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function Lg(n){Vl.setTimeout(()=>{let{onUnhandledError:e}=jr;if(e)e(n);else throw n})}function mh(){}var E1=Ew("C",void 0,void 0);function b1(n){return Ew("E",void 0,n)}function C1(n){return Ew("N",n,void 0)}function Ew(n,e,t){return{kind:n,value:e,error:t}}var Ba=null;function Ll(n){if(jr.useDeprecatedSynchronousErrorHandling){let e=!Ba;if(e&&(Ba={errorThrown:!1,error:null}),n(),e){let{errorThrown:t,error:r}=Ba;if(Ba=null,t)throw r}}else n()}function T1(n){jr.useDeprecatedSynchronousErrorHandling&&Ba&&(Ba.errorThrown=!0,Ba.error=n)}var $a=class extends Zt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Vg(e)&&e.add(this)):this.destination=A4}static create(e,t,r){return new Ul(e,t,r)}next(e){this.isStopped?Cw(C1(e),this):this._next(e)}error(e){this.isStopped?Cw(b1(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Cw(E1,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},S4=Function.prototype.bind;function bw(n,e){return S4.call(n,e)}var Tw=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){Ug(r)}}error(e){let{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){Ug(r)}else Ug(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){Ug(t)}}},Ul=class extends $a{constructor(e,t,r){super();let i;if(Te(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&jr.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&bw(e.next,s),error:e.error&&bw(e.error,s),complete:e.complete&&bw(e.complete,s)}):i=e}this.destination=new Tw(i)}};function Ug(n){jr.useDeprecatedSynchronousErrorHandling?T1(n):Lg(n)}function D4(n){throw n}function Cw(n,e){let{onStoppedNotification:t}=jr;t&&Vl.setTimeout(()=>t(n,e))}var A4={closed:!0,next:mh,error:D4,complete:mh};var jl=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Br(n){return n}function Sw(...n){return Dw(n)}function Dw(n){return n.length===0?Br:n.length===1?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}var Me=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){let s=R4(t)?t:new Ul(t,r,i);return Ll(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=S1(r),new r((i,s)=>{let o=new Ul({next:a=>{try{t(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[jl](){return this}pipe(...t){return Dw(t)(this)}toPromise(t){return t=S1(t),new t((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function S1(n){var e;return(e=n??jr.Promise)!==null&&e!==void 0?e:Promise}function x4(n){return n&&Te(n.next)&&Te(n.error)&&Te(n.complete)}function R4(n){return n&&n instanceof $a||x4(n)&&Vg(n)}function k4(n){return Te(n?.lift)}function Xe(n){return e=>{if(k4(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ze(n,e,t,r,i){return new Aw(n,e,t,r,i)}var Aw=class extends $a{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};var D1=Fl(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var en=(()=>{class n extends Me{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new jg(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new D1}next(t){Ll(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Ll(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Ll(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Iw:(this.currentObservers=null,s.push(t),new Zt(()=>{this.currentObservers=null,ja(s,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){let t=new Me;return t.source=this,t}}return n.create=(e,t)=>new jg(e,t),n})(),jg=class extends en{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,e)}error(e){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,e)}complete(){var e,t;(t=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||t===void 0||t.call(e)}_subscribe(e){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(e))!==null&&r!==void 0?r:Iw}};var wn=class extends en{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){let{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var xw={now(){return(xw.delegate||Date).now()},delegate:void 0};var Bg=class extends Zt{constructor(e,t){super()}schedule(e,t=0){return this}};var yh={setInterval(n,e,...t){let{delegate:r}=yh;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){let{delegate:e}=yh;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};var Bl=class extends Bg{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return yh.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return t;t!=null&&yh.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,t);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,ja(r,this),e!=null&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}};var $l=class n{constructor(e,t=n.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}};$l.now=xw.now;var Hl=class extends $l{constructor(e,t=$l.now){super(e,t),this.actions=[],this._active=!1}flush(e){let{actions:t}=this;if(this._active){t.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}};var Rw=new Hl(Bl);var $g=class extends Bl{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}};var Hg=class extends Hl{};var kw=new Hg($g);var Wn=new Me(n=>n.complete());function A1(n){return n&&Te(n.schedule)}function x1(n){return n[n.length-1]}function qg(n){return Te(x1(n))?n.pop():void 0}function yo(n){return A1(x1(n))?n.pop():void 0}function Nw(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function k1(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(h){try{d(r.next(h))}catch(p){o(p)}}function c(h){try{d(r.throw(h))}catch(p){o(p)}}function d(h){h.done?s(h.value):i(h.value).then(a,c)}d((r=r.apply(n,e||[])).next())})}function R1(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ha(n){return this instanceof Ha?(this.v=n,this):new Ha(n)}function N1(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(E){return function(k){return Promise.resolve(k).then(E,p)}}function a(E,k){r[E]&&(i[E]=function(P){return new Promise(function(M,$){s.push([E,P,M,$])>1||c(E,P)})},k&&(i[E]=k(i[E])))}function c(E,k){try{d(r[E](k))}catch(P){y(s[0][3],P)}}function d(E){E.value instanceof Ha?Promise.resolve(E.value.v).then(h,p):y(s[0][2],E)}function h(E){c("next",E)}function p(E){c("throw",E)}function y(E,k){E(k),s.shift(),s.length&&c(s[0][0],s[0][1])}}function M1(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof R1=="function"?R1(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(s){t[s]=n[s]&&function(o){return new Promise(function(a,c){o=n[s](o),i(a,c,o.done,o.value)})}}function i(s,o,a,c){Promise.resolve(c).then(function(d){s({value:d,done:a})},o)}}var zg=n=>n&&typeof n.length=="number"&&typeof n!="function";function Gg(n){return Te(n?.then)}function Wg(n){return Te(n[jl])}function Kg(n){return Symbol.asyncIterator&&Te(n?.[Symbol.asyncIterator])}function Qg(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function N4(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Yg=N4();function Jg(n){return Te(n?.[Yg])}function Xg(n){return N1(this,arguments,function*(){let t=n.getReader();try{for(;;){let{value:r,done:i}=yield Ha(t.read());if(i)return yield Ha(void 0);yield yield Ha(r)}}finally{t.releaseLock()}})}function Zg(n){return Te(n?.getReader)}function Mt(n){if(n instanceof Me)return n;if(n!=null){if(Wg(n))return M4(n);if(zg(n))return P4(n);if(Gg(n))return O4(n);if(Kg(n))return P1(n);if(Jg(n))return F4(n);if(Zg(n))return V4(n)}throw Qg(n)}function M4(n){return new Me(e=>{let t=n[jl]();if(Te(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function P4(n){return new Me(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function O4(n){return new Me(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,Lg)})}function F4(n){return new Me(e=>{for(let t of n)if(e.next(t),e.closed)return;e.complete()})}function P1(n){return new Me(e=>{L4(n,e).catch(t=>e.error(t))})}function V4(n){return P1(Xg(n))}function L4(n,e){var t,r,i,s;return k1(this,void 0,void 0,function*(){try{for(t=M1(n);r=yield t.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})}function Kn(n,e,t,r=0,i=!1){let s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function vo(n,e=0){return Xe((t,r)=>{t.subscribe(Ze(r,i=>Kn(r,n,()=>r.next(i),e),()=>Kn(r,n,()=>r.complete(),e),i=>Kn(r,n,()=>r.error(i),e)))})}function _o(n,e=0){return Xe((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function O1(n,e){return Mt(n).pipe(_o(e),vo(e))}function F1(n,e){return Mt(n).pipe(_o(e),vo(e))}function V1(n,e){return new Me(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}function L1(n,e){return new Me(t=>{let r;return Kn(t,e,()=>{r=n[Yg](),Kn(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){t.error(o);return}s?t.complete():t.next(i)},0,!0)}),()=>Te(r?.return)&&r.return()})}function em(n,e){if(!n)throw new Error("Iterable cannot be null");return new Me(t=>{Kn(t,e,()=>{let r=n[Symbol.asyncIterator]();Kn(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function U1(n,e){return em(Xg(n),e)}function j1(n,e){if(n!=null){if(Wg(n))return O1(n,e);if(zg(n))return V1(n,e);if(Gg(n))return F1(n,e);if(Kg(n))return em(n,e);if(Jg(n))return L1(n,e);if(Zg(n))return U1(n,e)}throw Qg(n)}function Pt(n,e){return e?j1(n,e):Mt(n)}function je(...n){let e=yo(n);return Pt(n,e)}function Mw(n,e){let t=Te(n)?n:()=>n,r=i=>i.error(t());return new Me(e?i=>e.schedule(r,0,i):r)}function tm(n){return!!n&&(n instanceof Me||Te(n.lift)&&Te(n.subscribe))}var qa=Fl(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function ut(n,e){return Xe((t,r)=>{let i=0;t.subscribe(Ze(r,s=>{r.next(n.call(e,s,i++))}))})}var{isArray:U4}=Array;function j4(n,e){return U4(e)?n(...e):n(e)}function nm(n){return ut(e=>j4(n,e))}var{isArray:B4}=Array,{getPrototypeOf:$4,prototype:H4,keys:q4}=Object;function rm(n){if(n.length===1){let e=n[0];if(B4(e))return{args:e,keys:null};if(z4(e)){let t=q4(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}function z4(n){return n&&typeof n=="object"&&$4(n)===H4}function im(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function Pw(...n){let e=yo(n),t=qg(n),{args:r,keys:i}=rm(n);if(r.length===0)return Pt([],e);let s=new Me(G4(r,e,i?o=>im(i,o):Br));return t?s.pipe(nm(t)):s}function G4(n,e,t=Br){return r=>{B1(e,()=>{let{length:i}=n,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)B1(e,()=>{let d=Pt(n[c],e),h=!1;d.subscribe(Ze(r,p=>{s[c]=p,h||(h=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function B1(n,e,t){n?Kn(t,n,e):e()}function $1(n,e,t,r,i,s,o,a){let c=[],d=0,h=0,p=!1,y=()=>{p&&!c.length&&!d&&e.complete()},E=P=>d<r?k(P):c.push(P),k=P=>{s&&e.next(P),d++;let M=!1;Mt(t(P,h++)).subscribe(Ze(e,$=>{i?.($),s?E($):e.next($)},()=>{M=!0},void 0,()=>{if(M)try{for(d--;c.length&&d<r;){let $=c.shift();o?Kn(e,o,()=>k($)):k($)}y()}catch($){e.error($)}}))};return n.subscribe(Ze(e,E,()=>{p=!0,y()})),()=>{a?.()}}function Vn(n,e,t=1/0){return Te(e)?Vn((r,i)=>ut((s,o)=>e(r,s,i,o))(Mt(n(r,i))),t):(typeof e=="number"&&(t=e),Xe((r,i)=>$1(r,i,n,t)))}function H1(n=1/0){return Vn(Br,n)}function q1(){return H1(1)}function ql(...n){return q1()(Pt(n,yo(n)))}function vh(n){return new Me(e=>{Mt(n()).subscribe(e)})}function Ow(...n){let e=qg(n),{args:t,keys:r}=rm(n),i=new Me(s=>{let{length:o}=t;if(!o){s.complete();return}let a=new Array(o),c=o,d=o;for(let h=0;h<o;h++){let p=!1;Mt(t[h]).subscribe(Ze(s,y=>{p||(p=!0,d--),a[h]=y},()=>c--,void 0,()=>{(!c||!p)&&(d||s.next(r?im(r,a):a),s.complete())}))}});return e?i.pipe(nm(e)):i}function fi(n,e){return Xe((t,r)=>{let i=0;t.subscribe(Ze(r,s=>n.call(e,s,i++)&&r.next(s)))})}function _h(n){return Xe((e,t)=>{let r=null,i=!1,s;r=e.subscribe(Ze(t,void 0,void 0,o=>{s=Mt(n(o,_h(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function sm(n,e){return Te(e)?Vn(n,e,1):Vn(n,1)}function Fw(n){return Xe((e,t)=>{let r=!1;e.subscribe(Ze(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function rs(n){return n<=0?()=>Wn:Xe((e,t)=>{let r=0;e.subscribe(Ze(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function z1(n=W4){return Xe((e,t)=>{let r=!1;e.subscribe(Ze(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function W4(){return new qa}function Vw(n){return Xe((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}function is(n,e){let t=arguments.length>=2;return r=>r.pipe(n?fi((i,s)=>n(i,s,r)):Br,rs(1),t?Fw(e):z1(()=>new qa))}function om(n){return n<=0?()=>Wn:Xe((e,t)=>{let r=[];e.subscribe(Ze(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Lw(...n){let e=yo(n);return Xe((t,r)=>{(e?ql(n,t,e):ql(n,t)).subscribe(r)})}function pi(n,e){return Xe((t,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();t.subscribe(Ze(r,c=>{i?.unsubscribe();let d=0,h=s++;Mt(n(c,h)).subscribe(i=Ze(r,p=>r.next(e?e(c,p,h,d++):p),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function wh(n){return Xe((e,t)=>{Mt(n).subscribe(Ze(t,()=>t.complete(),mh)),!t.closed&&e.subscribe(t)})}function Ln(n,e,t){let r=Te(n)||e||t?{next:n,error:e,complete:t}:n;return r?Xe((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Ze(s,c=>{var d;(d=r.next)===null||d===void 0||d.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var d;a=!1,(d=r.error)===null||d===void 0||d.call(r,c),s.error(c)},()=>{var c,d;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(d=r.finalize)===null||d===void 0||d.call(r)}))}):Br}var Uw;function am(){return Uw}function gi(n){let e=Uw;return Uw=n,e}var G1=Symbol("NotFound");function zl(n){return n===G1||n?.name==="\u0275NotFound"}var Ga=class{full;major;minor;patch;constructor(e){this.full=e;let t=e.split(".");this.major=t[0],this.minor=t[1],this.patch=t.slice(2).join(".")}},Zw=new Ga("21.0.5");var pm="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",oe=class extends Error{code;constructor(e,t){super(Wl(e,t)),this.code=e}};function K4(n){return`NG0${Math.abs(n)}`}function Wl(n,e){return`${K4(n)}${e?": "+e:""}`}var cs=globalThis;function et(n){for(let e in n)if(n[e]===et)return e;throw Error("")}function J1(n,e){for(let t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function os(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(os).join(", ")}]`;if(n==null)return""+n;let e=n.overriddenName||n.name;if(e)return`${e}`;let t=n.toString();if(t==null)return""+t;let r=t.indexOf(`
`);return r>=0?t.slice(0,r):t}function gm(n,e){return n?e?`${n} ${e}`:n:e||""}var Q4=et({__forward_ref__:et});function ls(n){return n.__forward_ref__=ls,n.toString=function(){return os(this())},n}function In(n){return eI(n)?n():n}function eI(n){return typeof n=="function"&&n.hasOwnProperty(Q4)&&n.__forward_ref__===ls}function se(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function yi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Dh(n){return Y4(n,mm)}function tI(n){return Dh(n)!==null}function Y4(n,e){return n.hasOwnProperty(e)&&n[e]||null}function J4(n){let e=n?.[mm]??null;return e||null}function Bw(n){return n&&n.hasOwnProperty(lm)?n[lm]:null}var mm=et({\u0275prov:et}),lm=et({\u0275inj:et}),ae=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(e,t){this._desc=e,this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=se({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function nI(n){return n&&!!n.\u0275providers}var rI=et({\u0275cmp:et}),iI=et({\u0275dir:et}),sI=et({\u0275pipe:et}),oI=et({\u0275mod:et}),Eh=et({\u0275fac:et}),Ya=et({__NG_ELEMENT_ID__:et}),W1=et({__NG_ENV_ID__:et});function aI(n){return n[oI]||null}function bo(n){return n[rI]||null}function cI(n){return n[iI]||null}function X1(n){return n[sI]||null}function Ja(n){return typeof n=="string"?n:n==null?"":String(n)}function Z1(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ja(n)}var eR=et({ngErrorCode:et}),X4=et({ngErrorMessage:et}),Z4=et({ngTokenPath:et});function lI(n,e){return tR("",-200,e)}function ym(n,e){throw new oe(-201,!1)}function tR(n,e,t){let r=new oe(e,n);return r[eR]=e,r[X4]=n,t&&(r[Z4]=t),r}function eB(n){return n[eR]}var $w;function nR(){return $w}function Un(n){let e=$w;return $w=n,e}function uI(n,e,t){let r=Dh(n);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&8)return null;if(e!==void 0)return e;ym(n,"Injector")}var tB={},za=tB,Hw="__NG_DI_FLAG__",qw=class{injector;constructor(e){this.injector=e}retrieve(e,t){let r=Wa(t)||0;try{return this.injector.get(e,r&8?null:za,r)}catch(i){if(zl(i))return i;throw i}}};function nB(n,e=0){let t=am();if(t===void 0)throw new oe(-203,!1);if(t===null)return uI(n,void 0,e);{let r=rB(e),i=t.retrieve(n,r);if(zl(i)){if(r.optional)return null;throw i}return i}}function xe(n,e=0){return(nR()||nB)(In(n),e)}function j(n,e){return xe(n,Wa(e))}function Wa(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function rB(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function zw(n){let e=[];for(let t=0;t<n.length;t++){let r=In(n[t]);if(Array.isArray(r)){if(r.length===0)throw new oe(900,!1);let i,s=0;for(let o=0;o<r.length;o++){let a=r[o],c=iB(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(xe(i,s))}else e.push(xe(r))}return e}function rR(n,e){return n[Hw]=e,n.prototype[Hw]=e,n}function iB(n){return n[Hw]}function wo(n,e){let t=n.hasOwnProperty(Eh);return t?n[Eh]:null}function vm(n,e){n.forEach(t=>Array.isArray(t)?vm(t,e):e(t))}function dI(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Ah(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function iR(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(i===1)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;){let s=i-2;n[i]=n[s],i--}n[e]=t,n[e+1]=r}}function _m(n,e,t){let r=Kl(n,e);return r>=0?n[r|1]=t:(r=~r,iR(n,r,e,t)),r}function wm(n,e){let t=Kl(n,e);if(t>=0)return n[t|1]}function Kl(n,e){return sB(n,e,1)}function sB(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){let s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}var Co={},jn=[],Xa=new ae(""),hI=new ae("",-1),fI=new ae(""),bh=class{get(e,t=za){if(t===za){let i=tR("",-201);throw i.name="\u0275NotFound",i}return t}};function nr(n){return{\u0275providers:n}}function sR(n){return nr([{provide:Xa,multi:!0,useValue:n}])}function oR(...n){return{\u0275providers:pI(!0,n),\u0275fromNgModule:!0}}function pI(n,...e){let t=[],r=new Set,i,s=o=>{t.push(o)};return vm(e,o=>{let a=o;um(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&aR(i,s),t}function aR(n,e){for(let t=0;t<n.length;t++){let{ngModule:r,providers:i}=n[t];gI(i,s=>{e(s,r)})}}function um(n,e,t,r){if(n=In(n),!n)return!1;let i=null,s=Bw(n),o=!s&&bo(n);if(!s&&!o){let c=n.ngModule;if(s=Bw(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=n}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let d of c)um(d,e,t,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let d;try{vm(s.imports,h=>{um(h,e,t,r)&&(d||=[],d.push(h))})}finally{}d!==void 0&&aR(d,e)}if(!a){let d=wo(i)||(()=>new i);e({provide:i,useFactory:d,deps:jn},i),e({provide:fI,useValue:i,multi:!0},i),e({provide:Xa,useValue:()=>xe(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let d=n;gI(c,h=>{e(h,d)})}}else return!1;return i!==n&&n.providers!==void 0}function gI(n,e){for(let t of n)nI(t)&&(t=t.\u0275providers),Array.isArray(t)?gI(t,e):e(t)}var oB=et({provide:String,useValue:et});function cR(n){return n!==null&&typeof n=="object"&&oB in n}function aB(n){return!!(n&&n.useExisting)}function cB(n){return!!(n&&n.useFactory)}function Ka(n){return typeof n=="function"}function lR(n){return!!n.useClass}var xh=new ae(""),cm={},K1={},jw;function Rh(){return jw===void 0&&(jw=new bh),jw}var Ot=class{},Qa=class extends Ot{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,Ww(e,o=>this.processProvider(o)),this.records.set(hI,Gl(void 0,this)),i.has("environment")&&this.records.set(Ot,Gl(void 0,this));let s=this.records.get(xh);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(fI,jn,{self:!0}))}retrieve(e,t){let r=Wa(t)||0;try{return this.get(e,za,r)}catch(i){if(zl(i))return i;throw i}}destroy(){Ih(this),this._destroyed=!0;let e=de(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),de(e)}}onDestroy(e){return Ih(this),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){Ih(this);let t=gi(this),r=Un(void 0),i;try{return e()}finally{gi(t),Un(r)}}get(e,t=za,r){if(Ih(this),e.hasOwnProperty(W1))return e[W1](this);let i=Wa(r),s,o=gi(this),a=Un(void 0);try{if(!(i&4)){let d=this.records.get(e);if(d===void 0){let h=fB(e)&&Dh(e);h&&this.injectableDefInScope(h)?d=Gl(Gw(e),cm):d=null,this.records.set(e,d)}if(d!=null)return this.hydrate(e,d,i)}let c=i&2?Rh():this.parent;return t=i&8&&t===za?null:t,c.get(e,t)}catch(c){let d=eB(c);throw d===-200||d===-201?new oe(d,null):c}finally{Un(a),gi(o)}}resolveInjectorInitializers(){let e=de(null),t=gi(this),r=Un(void 0),i;try{let s=this.get(Xa,jn,{self:!0});for(let o of s)o()}finally{gi(t),Un(r),de(e)}}toString(){let e=[],t=this.records;for(let r of t.keys())e.push(os(r));return`R3Injector[${e.join(", ")}]`}processProvider(e){e=In(e);let t=Ka(e)?e:In(e&&e.provide),r=uB(e);if(!Ka(e)&&e.multi===!0){let i=this.records.get(t);i||(i=Gl(void 0,cm,!0),i.factory=()=>zw(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t,r){let i=de(null);try{if(t.value===K1)throw lI(os(e));return t.value===cm&&(t.value=K1,t.value=t.factory(void 0,r)),typeof t.value=="object"&&t.value&&hB(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{de(i)}}injectableDefInScope(e){if(!e.providedIn)return!1;let t=In(e.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){let t=this._onDestroyHooks.indexOf(e);t!==-1&&this._onDestroyHooks.splice(t,1)}};function Gw(n){let e=Dh(n),t=e!==null?e.factory:wo(n);if(t!==null)return t;if(n instanceof ae)throw new oe(204,!1);if(n instanceof Function)return lB(n);throw new oe(204,!1)}function lB(n){if(n.length>0)throw new oe(204,!1);let t=J4(n);return t!==null?()=>t.factory(n):()=>new n}function uB(n){if(cR(n))return Gl(void 0,n.useValue);{let e=mI(n);return Gl(e,cm)}}function mI(n,e,t){let r;if(Ka(n)){let i=In(n);return wo(i)||Gw(i)}else if(cR(n))r=()=>In(n.useValue);else if(cB(n))r=()=>n.useFactory(...zw(n.deps||[]));else if(aB(n))r=(i,s)=>xe(In(n.useExisting),s!==void 0&&s&8?8:void 0);else{let i=In(n&&(n.useClass||n.provide));if(dB(n))r=()=>new i(...zw(n.deps));else return wo(i)||Gw(i)}return r}function Ih(n){if(n.destroyed)throw new oe(205,!1)}function Gl(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function dB(n){return!!n.deps}function hB(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function fB(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function Ww(n,e){for(let t of n)Array.isArray(t)?Ww(t,e):t&&nI(t)?Ww(t.\u0275providers,e):e(t)}function tn(n,e){let t;n instanceof Qa?(Ih(n),t=n):t=new qw(n);let r,i=gi(t),s=Un(void 0);try{return e()}finally{gi(i),Un(s)}}function uR(){return nR()!==void 0||am()!=null}var $r=0,me=1,we=2,ln=3,yr=4,vr=5,Ql=6,Yl=7,xt=8,us=9,vi=10,ht=11,Jl=12,yI=13,Za=14,rr=15,ec=16,tc=17,nc=18,kh=19,vI=20,ss=21,Im=22,Io=23,ir=24,rc=25,ic=26,Ft=27,dR=1,_I=6,To=7,Nh=8,Mh=9,Rt=10;function _i(n){return Array.isArray(n)&&typeof n[dR]=="object"}function Hr(n){return Array.isArray(n)&&n[dR]===!0}function wI(n){return(n.flags&4)!==0}function So(n){return n.componentOffset>-1}function Em(n){return(n.flags&1)===1}function wi(n){return!!n.template}function Xl(n){return(n[we]&512)!==0}function sc(n){return(n[we]&256)===256}var hR="svg",fR="math";function _r(n){for(;Array.isArray(n);)n=n[$r];return n}function II(n,e){return _r(e[n])}function qr(n,e){return _r(e[n.index])}function Ph(n,e){return n.data[e]}function EI(n,e){return n[e]}function bI(n,e,t,r){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=r}function wr(n,e){let t=e[n];return _i(t)?t:t[$r]}function bm(n){return(n[we]&128)===128}function pR(n){return Hr(n[ln])}function Ii(n,e){return e==null?null:n[e]}function CI(n){n[tc]=0}function TI(n){n[we]&1024||(n[we]|=1024,bm(n)&&oc(n))}function gR(n,e){for(;n>0;)e=e[Za],n--;return e}function Oh(n){return!!(n[we]&9216||n[ir]?.dirty)}function Cm(n){n[vi].changeDetectionScheduler?.notify(8),n[we]&64&&(n[we]|=1024),Oh(n)&&oc(n)}function oc(n){n[vi].changeDetectionScheduler?.notify(0);let e=Eo(n);for(;e!==null&&!(e[we]&8192||(e[we]|=8192,!bm(e)));)e=Eo(e)}function SI(n,e){if(sc(n))throw new oe(911,!1);n[ss]===null&&(n[ss]=[]),n[ss].push(e)}function mR(n,e){if(n[ss]===null)return;let t=n[ss].indexOf(e);t!==-1&&n[ss].splice(t,1)}function Eo(n){let e=n[ln];return Hr(e)?e[ln]:e}function yR(n){return n[Yl]??=[]}function vR(n){return n.cleanup??=[]}var ke={lFrame:PR(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Kw=!1;function _R(){return ke.lFrame.elementDepthCount}function wR(){ke.lFrame.elementDepthCount++}function DI(){ke.lFrame.elementDepthCount--}function IR(){return ke.bindingsEnabled}function ER(){return ke.skipHydrationRootTNode!==null}function AI(n){return ke.skipHydrationRootTNode===n}function xI(){ke.skipHydrationRootTNode=null}function Pe(){return ke.lFrame.lView}function un(){return ke.lFrame.tView}function X(n){return ke.lFrame.contextLView=n,n[xt]}function Z(n){return ke.lFrame.contextLView=null,n}function An(){let n=RI();for(;n!==null&&n.type===64;)n=n.parent;return n}function RI(){return ke.lFrame.currentTNode}function bR(){let n=ke.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}function Zl(n,e){let t=ke.lFrame;t.currentTNode=n,t.isParent=e}function kI(){return ke.lFrame.isParent}function CR(){ke.lFrame.isParent=!1}function TR(){return ke.lFrame.contextLView}function NI(){return Kw}function Ch(n){let e=Kw;return Kw=n,e}function SR(){let n=ke.lFrame,e=n.bindingRootIndex;return e===-1&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function DR(){return ke.lFrame.bindingIndex}function AR(n){return ke.lFrame.bindingIndex=n}function ac(){return ke.lFrame.bindingIndex++}function Tm(n){let e=ke.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function xR(){return ke.lFrame.inI18n}function RR(n,e){let t=ke.lFrame;t.bindingIndex=t.bindingRootIndex=n,Sm(e)}function kR(){return ke.lFrame.currentDirectiveIndex}function Sm(n){ke.lFrame.currentDirectiveIndex=n}function NR(n){let e=ke.lFrame.currentDirectiveIndex;return e===-1?null:n[e]}function MI(n){ke.lFrame.currentQueryIndex=n}function pB(n){let e=n[me];return e.type===2?e.declTNode:e.type===1?n[vr]:null}function PI(n,e,t){if(t&4){let i=e,s=n;for(;i=i.parent,i===null&&!(t&1);)if(i=pB(s),i===null||(s=s[Za],i.type&10))break;if(i===null)return!1;e=i,n=s}let r=ke.lFrame=MR();return r.currentTNode=e,r.lView=n,!0}function Dm(n){let e=MR(),t=n[me];ke.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function MR(){let n=ke.lFrame,e=n===null?null:n.child;return e===null?PR(n):e}function PR(n){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=e),e}function OR(){let n=ke.lFrame;return ke.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var OI=OR;function Am(){let n=OR();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function FR(n){return(ke.lFrame.contextLView=gR(n,ke.lFrame.contextLView))[xt]}function Ei(){return ke.lFrame.selectedIndex}function Do(n){ke.lFrame.selectedIndex=n}function xm(){let n=ke.lFrame;return Ph(n.tView,n.selectedIndex)}function VR(){return ke.lFrame.currentNamespace}var LR=!0;function Rm(){return LR}function km(n){LR=n}function Qw(n,e=null,t=null,r){let i=FI(n,e,t,r);return i.resolveInjectorInitializers(),i}function FI(n,e=null,t=null,r,i=new Set){let s=[t||jn,oR(n)];return r=r||(typeof n=="object"?void 0:os(n)),new Qa(s,e||Rh(),r||null,i)}var At=class n{static THROW_IF_NOT_FOUND=za;static NULL=new bh;static create(e,t){if(Array.isArray(e))return Qw({name:""},t,e,"");{let r=e.name??"";return Qw({name:r},e.parent,e.providers,r)}}static \u0275prov=se({token:n,providedIn:"any",factory:()=>xe(hI)});static __NG_ELEMENT_ID__=-1},nn=new ae(""),Ir=(()=>{class n{static __NG_ELEMENT_ID__=gB;static __NG_ENV_ID__=t=>t}return n})(),dm=class extends Ir{_lView;constructor(e){super(),this._lView=e}get destroyed(){return sc(this._lView)}onDestroy(e){let t=this._lView;return SI(t,e),()=>mR(t,e)}};function gB(){return new dm(Pe())}var UR=!1,ds=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new wn(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Me(t=>{t.next(!1),t.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}has(t){return this.pendingTasks.has(t)}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=se({token:n,providedIn:"root",factory:()=>new n})}return n})(),Yw=class extends en{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(e=!1){super(),this.__isAsync=e,uR()&&(this.destroyRef=j(Ir,{optional:!0})??void 0,this.pendingTasks=j(ds,{optional:!0})??void 0)}emit(e){let t=de(null);try{super.next(e)}finally{de(t)}}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=this.wrapInTimeout(s),i&&(i=this.wrapInTimeout(i)),o&&(o=this.wrapInTimeout(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Zt&&e.add(a),a}wrapInTimeout(e){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{try{e(t)}finally{r!==void 0&&this.pendingTasks?.remove(r)}})}}},Dt=Yw;function hm(...n){}function VI(n){let e,t;function r(){n=hm;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),e!==void 0&&clearTimeout(e)}catch{}}return e=setTimeout(()=>{n(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{n(),r()})),()=>r()}function LI(n){return queueMicrotask(()=>n()),()=>{n=hm}}var UI="isAngularZone",Th=UI+"_ID",mB=0,gt=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Dt(!1);onMicrotaskEmpty=new Dt(!1);onStable=new Dt(!1);onError=new Dt(!1);constructor(e){let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:s=UR}=e;if(typeof Zone>"u")throw new oe(908,!1);Zone.assertZonePatched();let o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!i&&r,o.shouldCoalesceRunChangeDetection=i,o.callbackScheduled=!1,o.scheduleInRootZone=s,_B(o)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(UI)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new oe(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new oe(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,yB,hm,hm);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}},yB={};function jI(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function vB(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function e(){VI(()=>{n.callbackScheduled=!1,Jw(n),n.isCheckStableRunning=!0,jI(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{e()}):n._outer.run(()=>{e()}),Jw(n)}function _B(n){let e=()=>{vB(n)},t=mB++;n._inner=n._inner.fork({name:"angular",properties:{[UI]:!0,[Th]:t,[Th+t]:!0},onInvokeTask:(r,i,s,o,a,c)=>{if(wB(c))return r.invokeTask(s,o,a,c);try{return Q1(n),r.invokeTask(s,o,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&o.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&e(),Y1(n)}},onInvoke:(r,i,s,o,a,c,d)=>{try{return Q1(n),r.invoke(s,o,a,c,d)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!IB(c)&&e(),Y1(n)}},onHasTask:(r,i,s,o)=>{r.hasTask(s,o),i===s&&(o.change=="microTask"?(n._hasPendingMicrotasks=o.microTask,Jw(n),jI(n)):o.change=="macroTask"&&(n.hasPendingMacrotasks=o.macroTask))},onHandleError:(r,i,s,o)=>(r.handleError(s,o),n.runOutsideAngular(()=>n.onError.emit(o)),!1)})}function Jw(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function Q1(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Y1(n){n._nesting--,jI(n)}var Sh=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Dt;onMicrotaskEmpty=new Dt;onStable=new Dt;onError=new Dt;run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}};function wB(n){return jR(n,"__ignore_ng_zone__")}function IB(n){return jR(n,"__scheduler_tick__")}function jR(n,e){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[e]===!0}var mi=class{_console=console;handleError(e){this._console.error("ERROR",e)}},sr=new ae("",{factory:()=>{let n=j(gt),e=j(Ot),t;return r=>{n.runOutsideAngular(()=>{e.destroyed&&!t?setTimeout(()=>{throw r}):(t??=e.get(mi),t.handleError(r))})}}}),BR={provide:Xa,useValue:()=>{let n=j(mi,{optional:!0})},multi:!0},EB=new ae("",{factory:()=>{let n=j(nn).defaultView;if(!n)return;let e=j(sr),t=s=>{e(s.reason),s.preventDefault()},r=s=>{s.error?e(s.error):e(new Error(s.message,{cause:s})),s.preventDefault()},i=()=>{n.addEventListener("unhandledrejection",t),n.addEventListener("error",r)};typeof Zone<"u"?Zone.root.run(i):i(),j(Ir).onDestroy(()=>{n.removeEventListener("error",r),n.removeEventListener("unhandledrejection",t)})}});function BI(){return nr([sR(()=>void j(EB))])}function Se(n,e){let[t,r,i]=yw(n,e?.equal),s=t,o=s[Fn];return s.set=r,s.update=i,s.asReadonly=$R.bind(s),s}function $R(){let n=this[Fn];if(n.readonlyFn===void 0){let e=()=>this();e[Fn]=n,n.readonlyFn=e}return n.readonlyFn}var Fh=(()=>{class n{view;node;constructor(t,r){this.view=t,this.node=r}static __NG_ELEMENT_ID__=bB}return n})();function bB(){return new Fh(Pe(),An())}var as=class{},Vh=new ae("",{factory:()=>!0});var $I=new ae(""),eu=(()=>{class n{internalPendingTasks=j(ds);scheduler=j(as);errorHandler=j(sr);add(){let t=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(t)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(t))}}run(t){let r=this.add();t().catch(this.errorHandler).finally(r)}static \u0275prov=se({token:n,providedIn:"root",factory:()=>new n})}return n})(),Nm=(()=>{class n{static \u0275prov=se({token:n,providedIn:"root",factory:()=>new Xw})}return n})(),Xw=class{dirtyEffectCount=0;queues=new Map;add(e){this.enqueue(e),this.schedule(e)}schedule(e){e.dirty&&this.dirtyEffectCount++}remove(e){let t=e.zone,r=this.queues.get(t);r.has(e)&&(r.delete(e),e.dirty&&this.dirtyEffectCount--)}enqueue(e){let t=e.zone;this.queues.has(t)||this.queues.set(t,new Set);let r=this.queues.get(t);r.has(e)||r.add(e)}flush(){for(;this.dirtyEffectCount>0;){let e=!1;for(let[t,r]of this.queues)t===null?e||=this.flushQueue(r):e||=t.run(()=>this.flushQueue(r));e||(this.dirtyEffectCount=0)}}flushQueue(e){let t=!1;for(let r of e)r.dirty&&(this.dirtyEffectCount--,t=!0,r.run());return t}},fm=class{[Fn];constructor(e){this[Fn]=e}destroy(){this[Fn].destroy()}};function Ao(n,e){let t=e?.injector??j(At),r=e?.manualCleanup!==!0?t.get(Ir):null,i,s=t.get(Fh,null,{optional:!0}),o=t.get(as);return s!==null?(i=SB(s.view,o,n),r instanceof dm&&r._lView===s.view&&(r=null)):i=DB(n,t.get(Nm),o),i.injector=t,r!==null&&(i.onDestroyFns=[r.onDestroy(()=>i.destroy())]),new fm(i)}var HR=ce(H({},_w),{cleanupFns:void 0,zone:null,onDestroyFns:null,run(){let n=Ch(!1);try{ww(this)}finally{Ch(n)}},cleanup(){if(!this.cleanupFns?.length)return;let n=de(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],de(n)}}}),CB=ce(H({},HR),{consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){if(Ua(this),this.onDestroyFns!==null)for(let n of this.onDestroyFns)n();this.cleanup(),this.scheduler.remove(this)}}),TB=ce(H({},HR),{consumerMarkedDirty(){this.view[we]|=8192,oc(this.view),this.notifier.notify(13)},destroy(){if(Ua(this),this.onDestroyFns!==null)for(let n of this.onDestroyFns)n();this.cleanup(),this.view[Io]?.delete(this)}});function SB(n,e,t){let r=Object.create(TB);return r.view=n,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=e,r.fn=qR(r,t),n[Io]??=new Set,n[Io].add(r),r.consumerMarkedDirty(r),r}function DB(n,e,t){let r=Object.create(CB);return r.fn=qR(r,n),r.scheduler=e,r.notifier=t,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}function qR(n,e){return()=>{e(t=>(n.cleanupFns??=[]).push(t))}}function rn(n){return vw(n)}function au(n){return{toString:n}.toString()}var Mm="__parameters__";function OB(n){return function(...t){if(n){let r=n(...t);for(let i in r)this[i]=r[i]}}}function FB(n,e,t){return au(()=>{let r=OB(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,d,h){let p=c.hasOwnProperty(Mm)?c[Mm]:Object.defineProperty(c,Mm,{value:[]})[Mm];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(o),c}}return i.prototype.ngMetadataName=n,i.annotationCls=i,i})}var or=rR(FB("Optional"),8);function VB(n){return typeof n=="function"}function _k(n,e,t,r){e!==null?e.applyValueToInputSignal(e,r):n[t]=r}var jm=class{previousValue;currentValue;firstChange;constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}},xo=(()=>{let n=()=>wk;return n.ngInherit=!0,n})();function wk(n){return n.type.prototype.ngOnChanges&&(n.setInput=UB),LB}function LB(){let n=Ek(this),e=n?.current;if(e){let t=n.previous;if(t===Co)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function UB(n,e,t,r,i){let s=this.declaredInputs[r],o=Ek(n)||jB(n,{previous:Co,current:null}),a=o.current||(o.current={}),c=o.previous,d=c[s];a[s]=new jm(d&&d.currentValue,t,c===Co),_k(n,e,i,t)}var Ik="__ngSimpleChanges__";function Ek(n){return n[Ik]||null}function jB(n,e){return n[Ik]=e}var zR=[];var tt=function(n,e=null,t){for(let r=0;r<zR.length;r++){let i=zR[r];i(n,e,t)}},ze=(function(n){return n[n.TemplateCreateStart=0]="TemplateCreateStart",n[n.TemplateCreateEnd=1]="TemplateCreateEnd",n[n.TemplateUpdateStart=2]="TemplateUpdateStart",n[n.TemplateUpdateEnd=3]="TemplateUpdateEnd",n[n.LifecycleHookStart=4]="LifecycleHookStart",n[n.LifecycleHookEnd=5]="LifecycleHookEnd",n[n.OutputStart=6]="OutputStart",n[n.OutputEnd=7]="OutputEnd",n[n.BootstrapApplicationStart=8]="BootstrapApplicationStart",n[n.BootstrapApplicationEnd=9]="BootstrapApplicationEnd",n[n.BootstrapComponentStart=10]="BootstrapComponentStart",n[n.BootstrapComponentEnd=11]="BootstrapComponentEnd",n[n.ChangeDetectionStart=12]="ChangeDetectionStart",n[n.ChangeDetectionEnd=13]="ChangeDetectionEnd",n[n.ChangeDetectionSyncStart=14]="ChangeDetectionSyncStart",n[n.ChangeDetectionSyncEnd=15]="ChangeDetectionSyncEnd",n[n.AfterRenderHooksStart=16]="AfterRenderHooksStart",n[n.AfterRenderHooksEnd=17]="AfterRenderHooksEnd",n[n.ComponentStart=18]="ComponentStart",n[n.ComponentEnd=19]="ComponentEnd",n[n.DeferBlockStateStart=20]="DeferBlockStateStart",n[n.DeferBlockStateEnd=21]="DeferBlockStateEnd",n[n.DynamicComponentStart=22]="DynamicComponentStart",n[n.DynamicComponentEnd=23]="DynamicComponentEnd",n[n.HostBindingsUpdateStart=24]="HostBindingsUpdateStart",n[n.HostBindingsUpdateEnd=25]="HostBindingsUpdateEnd",n})(ze||{});function BB(n,e,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=wk(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}function $B(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){let s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:d,ngOnDestroy:h}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),c&&(n.viewHooks??=[]).push(-t,c),d&&((n.viewHooks??=[]).push(t,d),(n.viewCheckHooks??=[]).push(t,d)),h!=null&&(n.destroyHooks??=[]).push(t,h)}}function Fm(n,e,t){bk(n,e,3,t)}function Vm(n,e,t,r){(n[we]&3)===t&&bk(n,e,t,r)}function HI(n,e){let t=n[we];(t&3)===e&&(t&=16383,t+=1,n[we]=t)}function bk(n,e,t,r){let i=r!==void 0?n[tc]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(n[tc]+=65536),(a<s||s==-1)&&(HB(n,t,e,c),n[tc]=(n[tc]&4294901760)+c+2),c++}function GR(n,e){tt(ze.LifecycleHookStart,n,e);let t=de(null);try{e.call(n)}finally{de(t),tt(ze.LifecycleHookEnd,n,e)}}function HB(n,e,t,r){let i=t[r]<0,s=t[r+1],o=i?-t[r]:t[r],a=n[o];i?n[we]>>14<n[tc]>>16&&(n[we]&3)===e&&(n[we]+=16384,GR(a,s)):GR(a,s)}var nu=-1,lc=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(e,t,r,i){this.factory=e,this.name=i,this.canSeeViewProviders=t,this.injectImpl=r}};function qB(n){return(n.flags&8)!==0}function zB(n){return(n.flags&16)!==0}function GB(n,e,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{let s=i,o=t[++r];WB(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function Ck(n){return n===3||n===4||n===6}function WB(n){return n.charCodeAt(0)===64}function ru(n,e){if(!(e===null||e.length===0))if(n===null||n.length===0)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?WR(n,t,i,null,e[++r]):WR(n,t,i,null,null))}}return n}function WR(n,e,t,r,i){let s=0,o=n.length;if(e===-1)o=-1;else for(;s<n.length;){let a=n[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<n.length;){let a=n[s];if(typeof a=="number")break;if(a===t){i!==null&&(n[s+1]=i);return}s++,i!==null&&s++}o!==-1&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),i!==null&&n.splice(s++,0,i)}function Tk(n){return n!==nu}function Bm(n){return n&32767}function KB(n){return n>>16}function $m(n,e){let t=KB(n),r=e;for(;t>0;)r=r[Za],t--;return r}var eE=!0;function Hm(n){let e=eE;return eE=n,e}var QB=256,Sk=QB-1,Dk=5,YB=0,bi={};function JB(n,e,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(Ya)&&(r=t[Ya]),r==null&&(r=t[Ya]=YB++);let i=r&Sk,s=1<<i;e.data[n+(i>>Dk)]|=s}function qm(n,e){let t=Ak(n,e);if(t!==-1)return t;let r=e[me];r.firstCreatePass&&(n.injectorIndex=e.length,qI(r.data,n),qI(e,null),qI(r.blueprint,null));let i=EE(n,e),s=n.injectorIndex;if(Tk(i)){let o=Bm(i),a=$m(i,e),c=a[me].data;for(let d=0;d<8;d++)e[s+d]=a[o+d]|c[o+d]}return e[s+8]=i,s}function qI(n,e){n.push(0,0,0,0,0,0,0,0,e)}function Ak(n,e){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||e[n.injectorIndex+8]===null?-1:n.injectorIndex}function EE(n,e){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;i!==null;){if(r=Mk(i),r===null)return nu;if(t++,i=i[Za],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return nu}function tE(n,e,t){JB(n,e,t)}function XB(n,e){if(e==="class")return n.classes;if(e==="style")return n.styles;let t=n.attrs;if(t){let r=t.length,i=0;for(;i<r;){let s=t[i];if(Ck(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(s===e)return t[i+1];i=i+2}}}return null}function xk(n,e,t){if(t&8||n!==void 0)return n;ym(e,"NodeInjector")}function Rk(n,e,t,r){if(t&8&&r===void 0&&(r=null),(t&3)===0){let i=n[us],s=Un(void 0);try{return i?i.get(e,r,t&8):uI(e,r,t&8)}finally{Un(s)}}return xk(r,e,t)}function kk(n,e,t,r=0,i){if(n!==null){if(e[we]&2048&&!(r&2)){let o=r3(n,e,t,r,bi);if(o!==bi)return o}let s=Nk(n,e,t,r,bi);if(s!==bi)return s}return Rk(e,t,r,i)}function Nk(n,e,t,r,i){let s=t3(t);if(typeof s=="function"){if(!PI(e,n,r))return r&1?xk(i,t,r):Rk(e,t,r,i);try{let o;if(o=s(r),o==null&&!(r&8))ym(t);else return o}finally{OI()}}else if(typeof s=="number"){let o=null,a=Ak(n,e),c=nu,d=r&1?e[rr][vr]:null;for((a===-1||r&4)&&(c=a===-1?EE(n,e):e[a+8],c===nu||!QR(r,!1)?a=-1:(o=e[me],a=Bm(c),e=$m(c,e)));a!==-1;){let h=e[me];if(KR(s,a,h.data)){let p=ZB(a,e,t,o,r,d);if(p!==bi)return p}c=e[a+8],c!==nu&&QR(r,e[me].data[a+8]===d)&&KR(s,a,e)?(o=h,a=Bm(c),e=$m(c,e)):a=-1}}return i}function ZB(n,e,t,r,i,s){let o=e[me],a=o.data[n+8],c=r==null?So(a)&&eE:r!=o&&(a.type&3)!==0,d=i&1&&s===a,h=e3(a,o,t,c,d);return h!==null?zm(e,o,h,a,i):bi}function e3(n,e,t,r,i){let s=n.providerIndexes,o=e.data,a=s&1048575,c=n.directiveStart,d=n.directiveEnd,h=s>>20,p=r?a:a+h,y=i?a+h:d;for(let E=p;E<y;E++){let k=o[E];if(E<c&&t===k||E>=c&&k.type===t)return E}if(i){let E=o[c];if(E&&wi(E)&&E.type===t)return c}return null}function zm(n,e,t,r,i){let s=n[t],o=e.data;if(s instanceof lc){let a=s;if(a.resolving){let E=Z1(o[t]);throw lI(E)}let c=Hm(a.canSeeViewProviders);a.resolving=!0;let d=o[t].type||o[t],h,p=a.injectImpl?Un(a.injectImpl):null,y=PI(n,r,0);try{s=n[t]=a.factory(void 0,i,o,n,r),e.firstCreatePass&&t>=r.directiveStart&&BB(t,o[t],e)}finally{p!==null&&Un(p),Hm(c),a.resolving=!1,OI()}}return s}function t3(n){if(typeof n=="string")return n.charCodeAt(0)||0;let e=n.hasOwnProperty(Ya)?n[Ya]:void 0;return typeof e=="number"?e>=0?e&Sk:n3:e}function KR(n,e,t){let r=1<<n;return!!(t[e+(n>>Dk)]&r)}function QR(n,e){return!(n&2)&&!(n&1&&e)}var cc=class{_tNode;_lView;constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return kk(this._tNode,this._lView,e,Wa(r),t)}};function n3(){return new cc(An(),Pe())}function hs(n){return au(()=>{let e=n.prototype.constructor,t=e[Eh]||nE(e),r=Object.prototype,i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){let s=i[Eh]||nE(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function nE(n){return eI(n)?()=>{let e=nE(In(n));return e&&e()}:wo(n)}function r3(n,e,t,r,i){let s=n,o=e;for(;s!==null&&o!==null&&o[we]&2048&&!Xl(o);){let a=Nk(s,o,t,r|2,bi);if(a!==bi)return a;let c=s.parent;if(!c){let d=o[vI];if(d){let h=d.get(t,bi,r);if(h!==bi)return h}c=Mk(o),o=o[Za]}s=c}return i}function Mk(n){let e=n[me],t=e.type;return t===2?e.declTNode:t===1?n[vr]:null}function Gh(n){return XB(An(),n)}function i3(){return bE(An(),Pe())}function bE(n,e){return new Si(qr(n,e))}var Si=(()=>{class n{nativeElement;constructor(t){this.nativeElement=t}static __NG_ELEMENT_ID__=i3}return n})();function Pk(n){return(n.flags&128)===128}var CE=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(CE||{}),Ok=new Map,s3=0;function o3(){return s3++}function a3(n){Ok.set(n[kh],n)}function rE(n){Ok.delete(n[kh])}var YR="__ngContext__";function iu(n,e){_i(e)?(n[YR]=e[kh],a3(e)):n[YR]=e}function Fk(n){return Lk(n[Jl])}function Vk(n){return Lk(n[yr])}function Lk(n){for(;n!==null&&!Hr(n);)n=n[yr];return n}var c3;function TE(n){c3=n}var sy=new ae("",{factory:()=>l3}),l3="ng";var oy=new ae(""),gc=new ae("",{providedIn:"platform",factory:()=>"unknown"});var ay=new ae("",{factory:()=>j(nn).body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Uk="r";var jk="di";var Bk=!1,$k=new ae("",{factory:()=>Bk});var u3=(n,e,t,r)=>{};function d3(n,e,t,r){u3(n,e,t,r)}function SE(n){return(n.flags&32)===32}var h3=()=>null;function Hk(n,e,t=!1){return h3(n,e,t)}function qk(n,e){let t=n.contentQueries;if(t!==null){let r=de(null);try{for(let i=0;i<t.length;i+=2){let s=t[i],o=t[i+1];if(o!==-1){let a=n.data[o];MI(s),a.contentQueries(2,e[o],o)}}}finally{de(r)}}}function iE(n,e,t){MI(0);let r=de(null);try{e(n,t)}finally{de(r)}}function zk(n,e,t){if(wI(e)){let r=de(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=n.data[o];if(a.contentQueries){let c=t[o];a.contentQueries(1,c,o)}}}finally{de(r)}}}var Wr=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n[n.ExperimentalIsolatedShadowDom=4]="ExperimentalIsolatedShadowDom",n})(Wr||{});var Pm;function f3(){if(Pm===void 0&&(Pm=null,cs.trustedTypes))try{Pm=cs.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Pm}function JR(n){return f3()?.createScriptURL(n)||n}var Gm=class{changingThisBreaksApplicationSecurity;constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${pm})`}};function Wh(n){return n instanceof Gm?n.changingThisBreaksApplicationSecurity:n}function DE(n,e){let t=Gk(n);if(t!=null&&t!==e){if(t==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${pm})`)}return t===e}function Gk(n){return n instanceof Gm&&n.getTypeName()||null}var p3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Wk(n){return n=String(n),n.match(p3)?n:"unsafe:"+n}function g3(n,e){return n.createText(e)}function m3(n,e,t){n.setValue(e,t)}function Kk(n,e,t){return n.createElement(e,t)}function Wm(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Qk(n,e,t){n.appendChild(e,t)}function XR(n,e,t,r,i){r!==null?Wm(n,e,t,r,i):Qk(n,e,t)}function Yk(n,e,t,r){n.removeChild(null,e,t,r)}function y3(n,e,t){n.setAttribute(e,"style",t)}function v3(n,e,t){t===""?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Jk(n,e,t){let{mergedAttrs:r,classes:i,styles:s}=t;r!==null&&GB(n,e,r),i!==null&&v3(n,e,i),s!==null&&y3(n,e,s)}var cy=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})(cy||{});function Qn(n){let e=Zk();return e?e.sanitize(cy.URL,n)||"":DE(n,"URL")?Wh(n):Wk(Ja(n))}function Xk(n){let e=Zk();if(e)return JR(e.sanitize(cy.RESOURCE_URL,n)||"");if(DE(n,"ResourceURL"))return JR(Wh(n));throw new oe(904,!1)}function _3(n,e){return e==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||e==="href"&&(n==="base"||n==="link")?Xk:Qn}function AE(n,e,t){return _3(e,t)(n)}function Zk(){let n=Pe();return n&&n[vi].sanitizer}function eN(n){return n instanceof Function?n():n}function w3(n,e,t){let r=n.length;for(;;){let i=n.indexOf(e,t);if(i===-1)return i;if(i===0||n.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}var tN="ng-template";function I3(n,e,t,r){let i=0;if(r){for(;i<e.length&&typeof e[i]=="string";i+=2)if(e[i]==="class"&&w3(e[i+1].toLowerCase(),t,0)!==-1)return!0}else if(xE(n))return!1;if(i=e.indexOf(1,i),i>-1){let s;for(;++i<e.length&&typeof(s=e[i])=="string";)if(s.toLowerCase()===t)return!0}return!1}function xE(n){return n.type===4&&n.value!==tN}function E3(n,e,t){let r=n.type===4&&!t?tN:n.value;return e===r}function b3(n,e,t){let r=4,i=n.attrs,s=i!==null?S3(i):0,o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!zr(r)&&!zr(c))return!1;if(o&&zr(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!E3(n,c,t)||c===""&&e.length===1){if(zr(r))return!1;o=!0}}else if(r&8){if(i===null||!I3(n,i,c,t)){if(zr(r))return!1;o=!0}}else{let d=e[++a],h=C3(c,i,xE(n),t);if(h===-1){if(zr(r))return!1;o=!0;continue}if(d!==""){let p;if(h>s?p="":p=i[h+1].toLowerCase(),r&2&&d!==p){if(zr(r))return!1;o=!0}}}}return zr(r)||o}function zr(n){return(n&1)===0}function C3(n,e,t,r){if(e===null)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){let o=e[i];if(o===n)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return D3(e,n)}function T3(n,e,t=!1){for(let r=0;r<e.length;r++)if(b3(n,e[r],t))return!0;return!1}function S3(n){for(let e=0;e<n.length;e++){let t=n[e];if(Ck(t))return e}return n.length}function D3(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){let r=n[t];if(typeof r=="number")return-1;if(r===e)return t;t++}return-1}function ZR(n,e){return n?":not("+e.trim()+")":e}function A3(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if(typeof o=="string")if(r&2){let a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!zr(o)&&(e+=ZR(s,i),i=""),r=o,s=s||!zr(r);t++}return i!==""&&(e+=ZR(s,i)),e}function x3(n){return n.map(A3).join(",")}function R3(n){let e=[],t=[],r=1,i=2;for(;r<n.length;){let s=n[r];if(typeof s=="string")i===2?s!==""&&e.push(s,n[++r]):i===8&&t.push(s);else{if(!zr(i))break;i=s}r++}return t.length&&e.push(1,...t),e}var Yn={};function RE(n,e,t,r,i,s,o,a,c,d,h){let p=Ft+r,y=p+i,E=k3(p,y),k=typeof d=="function"?d():d;return E[me]={type:n,blueprint:E,template:t,queries:null,viewQuery:a,declTNode:e,data:E.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:k,incompleteFirstPass:!1,ssrId:h}}function k3(n,e){let t=[];for(let r=0;r<e;r++)t.push(r<n?null:Yn);return t}function N3(n){let e=n.tView;return e===null||e.incompleteFirstPass?n.tView=RE(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function kE(n,e,t,r,i,s,o,a,c,d,h){let p=e.blueprint.slice();return p[$r]=i,p[we]=r|4|128|8|64|1024,(d!==null||n&&n[we]&2048)&&(p[we]|=2048),CI(p),p[ln]=p[Za]=n,p[xt]=t,p[vi]=o||n&&n[vi],p[ht]=a||n&&n[ht],p[us]=c||n&&n[us]||null,p[vr]=s,p[kh]=o3(),p[Ql]=h,p[vI]=d,p[rr]=e.type==2?n[rr]:p,p}function M3(n,e,t){let r=qr(e,n),i=N3(t),s=n[vi].rendererFactory,o=NE(n,kE(n,i,null,nN(t),r,e,null,s.createRenderer(r,t),null,null,null));return n[e.index]=o}function nN(n){let e=16;return n.signals?e=4096:n.onPush&&(e=64),e}function rN(n,e,t,r){if(t===0)return-1;let i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function NE(n,e){return n[Jl]?n[yI][yr]=e:n[Jl]=e,n[yI]=e,e}function V(n=1){iN(un(),Pe(),Ei()+n,!1)}function iN(n,e,t,r){if(!r)if((e[we]&3)===3){let s=n.preOrderCheckHooks;s!==null&&Fm(e,s,t)}else{let s=n.preOrderHooks;s!==null&&Vm(e,s,0,t)}Do(t)}var ly=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(ly||{});function sE(n,e,t,r){let i=de(null);try{let[s,o,a]=n.inputs[t],c=null;(o&ly.SignalBased)!==0&&(c=e[s][Fn]),c!==null&&c.transformFn!==void 0?r=c.transformFn(r):a!==null&&(r=a.call(e,r)),n.setInput!==null?n.setInput(e,c,r,t,s):_k(e,c,s,r)}finally{de(i)}}var Ci=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Ci||{}),P3;function ME(n,e){return P3(n,e)}var uc=new Set,uy=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(uy||{}),mc=new ae(""),ek=new Set;function Ro(n){ek.has(n)||(ek.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var PE=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=se({token:n,providedIn:"root",factory:()=>new n})}return n})(),sN=[0,1,2,3],oN=(()=>{class n{ngZone=j(gt);scheduler=j(as);errorHandler=j(mi,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){j(mc,{optional:!0})}execute(){let t=this.sequences.size>0;t&&tt(ze.AfterRenderHooksStart),this.executing=!0;for(let r of sN)for(let i of this.sequences)if(!(i.erroredOrDestroyed||!i.hooks[r]))try{i.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let s=i.hooks[r];return s(i.pipelinedValue)},i.snapshot))}catch(s){i.erroredOrDestroyed=!0,this.errorHandler?.handleError(s)}this.executing=!1;for(let r of this.sequences)r.afterRun(),r.once&&(this.sequences.delete(r),r.destroy());for(let r of this.deferredRegistrations)this.sequences.add(r);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),t&&tt(ze.AfterRenderHooksEnd)}register(t){let{view:r}=t;r!==void 0?((r[rc]??=[]).push(t),oc(r),r[we]|=8192):this.executing?this.deferredRegistrations.add(t):this.addSequence(t)}addSequence(t){this.sequences.add(t),this.scheduler.notify(7)}unregister(t){this.executing&&this.sequences.has(t)?(t.erroredOrDestroyed=!0,t.pipelinedValue=void 0,t.once=!0):(this.sequences.delete(t),this.deferredRegistrations.delete(t))}maybeTrace(t,r){return r?r.run(uy.AFTER_NEXT_RENDER,t):t()}static \u0275prov=se({token:n,providedIn:"root",factory:()=>new n})}return n})(),Km=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(e,t,r,i,s,o=null){this.impl=e,this.hooks=t,this.view=r,this.once=i,this.snapshot=o,this.unregisterOnDestroy=s?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let e=this.view?.[rc];e&&(this.view[rc]=e.filter(t=>t!==this))}};function dy(n,e){let t=e?.injector??j(At);return Ro("NgAfterNextRender"),F3(n,t,e,!0)}function O3(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function F3(n,e,t,r){let i=e.get(PE);i.impl??=e.get(oN);let s=e.get(mc,null,{optional:!0}),o=t?.manualCleanup!==!0?e.get(Ir):null,a=e.get(Fh,null,{optional:!0}),c=new Km(i.impl,O3(n),a?.view,r,o,s?.snapshot(null));return i.impl.register(c),c}var aN=new ae("",{factory:()=>({queue:new Set,isScheduled:!1,scheduler:null,injector:j(Ot)})});function cN(n,e,t){let r=n.get(aN);if(Array.isArray(e))for(let i of e)r.queue.add(i),t?.detachedLeaveAnimationFns?.push(i);else r.queue.add(e),t?.detachedLeaveAnimationFns?.push(e);r.scheduler&&r.scheduler(n)}function V3(n,e){let t=n.get(aN);if(e.detachedLeaveAnimationFns){for(let r of e.detachedLeaveAnimationFns)t.queue.delete(r);e.detachedLeaveAnimationFns=void 0}}function L3(n,e){for(let[t,r]of e)cN(n,r.animateFns)}function tk(n,e,t,r){let i=n?.[ic]?.enter;e!==null&&i&&i.has(t.index)&&L3(r,i)}function tu(n,e,t,r,i,s,o,a){if(i!=null){let c,d=!1;Hr(i)?c=i:_i(i)&&(d=!0,i=i[$r]);let h=_r(i);n===0&&r!==null?(tk(a,r,s,t),o==null?Qk(e,r,h):Wm(e,r,h,o||null,!0)):n===1&&r!==null?(tk(a,r,s,t),Wm(e,r,h,o||null,!0)):n===2?nk(a,s,t,p=>{Yk(e,h,d,p)}):n===3&&nk(a,s,t,()=>{e.destroyNode(h)}),c!=null&&J3(e,n,t,c,s,r,o)}}function U3(n,e){lN(n,e),e[$r]=null,e[vr]=null}function j3(n,e,t,r,i,s){r[$r]=i,r[vr]=e,fy(n,r,t,1,i,s)}function lN(n,e){e[vi].changeDetectionScheduler?.notify(9),fy(n,e,e[ht],2,null,null)}function B3(n){let e=n[Jl];if(!e)return zI(n[me],n);for(;e;){let t=null;if(_i(e))t=e[Jl];else{let r=e[Rt];r&&(t=r)}if(!t){for(;e&&!e[yr]&&e!==n;)_i(e)&&zI(e[me],e),e=e[ln];e===null&&(e=n),_i(e)&&zI(e[me],e),t=e&&e[yr]}e=t}}function OE(n,e){let t=n[Mh],r=t.indexOf(e);t.splice(r,1)}function hy(n,e){if(sc(e))return;let t=e[ht];t.destroyNode&&fy(n,e,t,3,null,null),B3(e)}function zI(n,e){if(sc(e))return;let t=de(null);try{e[we]&=-129,e[we]|=256,e[ir]&&Ua(e[ir]),q3(n,e),H3(n,e),e[me].type===1&&e[ht].destroy();let r=e[ec];if(r!==null&&Hr(e[ln])){r!==e[ln]&&OE(r,e);let i=e[nc];i!==null&&i.detachView(n)}rE(e)}finally{de(t)}}function nk(n,e,t,r){let i=n?.[ic];if(i==null||i.leave==null||!i.leave.has(e.index))return r(!1);n&&uc.add(n),cN(t,()=>{if(i.leave&&i.leave.has(e.index)){let o=i.leave.get(e.index),a=[];if(o){for(let c=0;c<o.animateFns.length;c++){let d=o.animateFns[c],{promise:h}=d();a.push(h)}i.detachedLeaveAnimationFns=void 0}i.running=Promise.allSettled(a),$3(n,r)}else n&&uc.delete(n),r(!1)},i)}function $3(n,e){let t=n[ic]?.running;if(t){t.then(()=>{n[ic].running=void 0,uc.delete(n),e(!0)});return}e(!1)}function H3(n,e){let t=n.cleanup,r=e[Yl];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let a=t[o+3];a>=0?r[a]():r[-a].unsubscribe(),o+=2}else{let a=r[t[o+1]];t[o].call(a)}r!==null&&(e[Yl]=null);let i=e[ss];if(i!==null){e[ss]=null;for(let o=0;o<i.length;o++){let a=i[o];a()}}let s=e[Io];if(s!==null){e[Io]=null;for(let o of s)o.destroy()}}function q3(n,e){let t;if(n!=null&&(t=n.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=e[t[r]];if(!(i instanceof lc)){let s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];tt(ze.LifecycleHookStart,a,c);try{c.call(a)}finally{tt(ze.LifecycleHookEnd,a,c)}}else{tt(ze.LifecycleHookStart,i,s);try{s.call(i)}finally{tt(ze.LifecycleHookEnd,i,s)}}}}}function z3(n,e,t){return G3(n,e.parent,t)}function G3(n,e,t){let r=e;for(;r!==null&&r.type&168;)e=r,r=e.parent;if(r===null)return t[$r];if(So(r)){let{encapsulation:i}=n.data[r.directiveStart+r.componentOffset];if(i===Wr.None||i===Wr.Emulated)return null}return qr(r,t)}function W3(n,e,t){return Q3(n,e,t)}function K3(n,e,t){return n.type&40?qr(n,t):null}var Q3=K3,rk;function FE(n,e,t,r){let i=z3(n,r,e),s=e[ht],o=r.parent||e[vr],a=W3(o,r,e);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)XR(s,i,t[c],a,!1);else XR(s,i,t,a,!1);rk!==void 0&&rk(s,r,e,t,i)}function Uh(n,e){if(e!==null){let t=e.type;if(t&3)return qr(e,n);if(t&4)return oE(-1,n[e.index]);if(t&8){let r=e.child;if(r!==null)return Uh(n,r);{let i=n[e.index];return Hr(i)?oE(-1,i):_r(i)}}else{if(t&128)return Uh(n,e.next);if(t&32)return ME(e,n)()||_r(n[e.index]);{let r=uN(n,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Eo(n[rr]);return Uh(i,r)}else return Uh(n,e.next)}}}return null}function uN(n,e){if(e!==null){let r=n[rr][vr],i=e.projection;return r.projection[i]}return null}function oE(n,e){let t=Rt+n+1;if(t<e.length){let r=e[t],i=r[me].firstChild;if(i!==null)return Uh(r,i)}return e[To]}function VE(n,e,t,r,i,s,o){for(;t!=null;){let a=r[us];if(t.type===128){t=t.next;continue}let c=r[t.index],d=t.type;if(o&&e===0&&(c&&iu(_r(c),r),t.flags|=2),!SE(t))if(d&8)VE(n,e,t.child,r,i,s,!1),tu(e,n,a,i,c,t,s,r);else if(d&32){let h=ME(t,r),p;for(;p=h();)tu(e,n,a,i,p,t,s,r);tu(e,n,a,i,c,t,s,r)}else d&16?Y3(n,e,r,t,i,s):tu(e,n,a,i,c,t,s,r);t=o?t.projectionNext:t.next}}function fy(n,e,t,r,i,s){VE(t,r,n.firstChild,e,i,s,!1)}function Y3(n,e,t,r,i,s){let o=t[rr],c=o[vr].projection[r.projection];if(Array.isArray(c))for(let d=0;d<c.length;d++){let h=c[d];tu(e,n,t[us],i,h,r,s,t)}else{let d=c,h=o[ln];Pk(r)&&(d.flags|=128),VE(n,e,d,h,i,s,!0)}}function J3(n,e,t,r,i,s,o){let a=r[To],c=_r(r);a!==c&&tu(e,n,t,s,a,i,o);for(let d=Rt;d<r.length;d++){let h=r[d];fy(h[me],h,n,e,s,a)}}function X3(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=r.indexOf("-")===-1?void 0:Ci.DashCase;i==null?n.removeStyle(t,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Ci.Important),n.setStyle(t,r,i,s))}}function dN(n,e,t,r,i){let s=Ei(),o=r&2;try{Do(-1),o&&e.length>Ft&&iN(n,e,Ft,!1);let a=o?ze.TemplateUpdateStart:ze.TemplateCreateStart;tt(a,i,t),t(r,i)}finally{Do(s);let a=o?ze.TemplateUpdateEnd:ze.TemplateCreateEnd;tt(a,i,t)}}function hN(n,e,t){s6(n,e,t),(t.flags&64)===64&&o6(n,e,t)}function LE(n,e,t=qr){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?t(e,n):n[o];n[i++]=a}}}function Z3(n,e,t,r){let s=r.get($k,Bk)||t===Wr.ShadowDom||t===Wr.ExperimentalIsolatedShadowDom,o=n.selectRootElement(e,s);return e6(o),o}function e6(n){t6(n)}var t6=()=>null;function n6(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function fN(n,e,t,r,i,s){let o=e[me];if(UE(n,o,e,t,r)){So(n)&&i6(e,n.index);return}n.type&3&&(t=n6(t)),r6(n,e,t,r,i,s)}function r6(n,e,t,r,i,s){if(n.type&3){let o=qr(n,e);r=s!=null?s(r,n.value||"",t):r,i.setProperty(o,t,r)}else n.type&12}function i6(n,e){let t=wr(e,n);t[we]&16||(t[we]|=64)}function s6(n,e,t){let r=t.directiveStart,i=t.directiveEnd;So(t)&&M3(e,t,n.data[r+t.componentOffset]),n.firstCreatePass||qm(t,e);let s=t.initialInputs;for(let o=r;o<i;o++){let a=n.data[o],c=zm(e,n,o,t);if(iu(c,e),s!==null&&d6(e,o-r,c,a,t,s),wi(a)){let d=wr(t.index,e);d[xt]=zm(e,n,o,t)}}}function o6(n,e,t){let r=t.directiveStart,i=t.directiveEnd,s=t.index,o=kR();try{Do(s);for(let a=r;a<i;a++){let c=n.data[a],d=e[a];Sm(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&a6(c,d)}}finally{Do(-1),Sm(o)}}function a6(n,e){n.hostBindings!==null&&n.hostBindings(1,e)}function c6(n,e){let t=n.directiveRegistry,r=null;if(t)for(let i=0;i<t.length;i++){let s=t[i];T3(e,s.selectors,!1)&&(r??=[],wi(s)?r.unshift(s):r.push(s))}return r}function l6(n,e,t,r,i,s){let o=qr(n,e);u6(e[ht],o,s,n.value,t,r,i)}function u6(n,e,t,r,i,s,o){if(s==null)n.removeAttribute(e,i,t);else{let a=o==null?Ja(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}function d6(n,e,t,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;a+=2){let c=o[a],d=o[a+1];sE(r,t,c,d)}}function pN(n,e,t,r,i){let s=Ft+t,o=e[me],a=i(o,e,n,r,t);e[s]=a,Zl(n,!0);let c=n.type===2;return c?(Jk(e[ht],a,n),(_R()===0||Em(n))&&iu(a,e),wR()):iu(a,e),Rm()&&(!c||!SE(n))&&FE(o,e,a,n),n}function gN(n){let e=n;return kI()?CR():(e=e.parent,Zl(e,!1)),e}function h6(n,e){let t=n[us];if(!t)return;let r;try{r=t.get(sr,null)}catch{r=null}r?.(e)}function UE(n,e,t,r,i){let s=n.inputs?.[r],o=n.hostDirectiveInputs?.[r],a=!1;if(o)for(let c=0;c<o.length;c+=2){let d=o[c],h=o[c+1],p=e.data[d];sE(p,t[d],h,i),a=!0}if(s)for(let c of s){let d=t[c],h=e.data[c];sE(h,d,r,i),a=!0}return a}function f6(n,e){let t=wr(e,n),r=t[me];p6(r,t);let i=t[$r];i!==null&&t[Ql]===null&&(t[Ql]=Hk(i,t[us])),tt(ze.ComponentStart);try{jE(r,t,t[xt])}finally{tt(ze.ComponentEnd,t[xt])}}function p6(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}function jE(n,e,t){Dm(e);try{let r=n.viewQuery;r!==null&&iE(1,r,t);let i=n.template;i!==null&&dN(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),e[nc]?.finishViewCreation(n),n.staticContentQueries&&qk(n,e),n.staticViewQueries&&iE(2,n.viewQuery,t);let s=n.components;s!==null&&g6(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[we]&=-5,Am()}}function g6(n,e){for(let t=0;t<e.length;t++)f6(n,e[t])}function BE(n,e,t,r){let i=de(null);try{let s=e.tView,a=n[we]&4096?4096:16,c=kE(n,s,t,a,null,e,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),d=n[e.index];c[ec]=d;let h=n[nc];return h!==null&&(c[nc]=h.createEmbeddedView(s)),jE(s,c,t),c}finally{de(i)}}function Bh(n,e){return!e||e.firstChild===null||Pk(n)}function $h(n,e,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let s=e[t.index];s!==null&&r.push(_r(s)),Hr(s)&&mN(s,r);let o=t.type;if(o&8)$h(n,e,t.child,r);else if(o&32){let a=ME(t,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=uN(e,t);if(Array.isArray(a))r.push(...a);else{let c=Eo(e[rr]);$h(c[me],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function mN(n,e){for(let t=Rt;t<n.length;t++){let r=n[t],i=r[me].firstChild;i!==null&&$h(r[me],r,i,e)}n[To]!==n[$r]&&e.push(n[To])}function yN(n){if(n[rc]!==null){for(let e of n[rc])e.impl.addSequence(e);n[rc].length=0}}var vN=[];function m6(n){return n[ir]??y6(n)}function y6(n){let e=vN.pop()??Object.create(_6);return e.lView=n,e}function v6(n){n.lView[ir]!==n&&(n.lView=null,vN.push(n))}var _6=ce(H({},Ml),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{oc(n.lView)},consumerOnSignalRead(){this.lView[ir]=this}});function w6(n){let e=n[ir]??Object.create(I6);return e.lView=n,e}var I6=ce(H({},Ml),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let e=Eo(n.lView);for(;e&&!_N(e[me]);)e=Eo(e);e&&TI(e)},consumerOnSignalRead(){this.lView[ir]=this}});function _N(n){return n.type!==2}function wN(n){if(n[Io]===null)return;let e=!0;for(;e;){let t=!1;for(let r of n[Io])r.dirty&&(t=!0,r.zone===null||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));e=t&&!!(n[we]&8192)}}var E6=100;function IN(n,e=0){let r=n[vi].rendererFactory,i=!1;i||r.begin?.();try{b6(n,e)}finally{i||r.end?.()}}function b6(n,e){let t=NI();try{Ch(!0),aE(n,e);let r=0;for(;Oh(n);){if(r===E6)throw new oe(103,!1);r++,aE(n,1)}}finally{Ch(t)}}function C6(n,e,t,r){if(sc(e))return;let i=e[we],s=!1,o=!1;Dm(e);let a=!0,c=null,d=null;s||(_N(n)?(d=m6(e),c=Pl(d)):Mg()===null?(a=!1,d=w6(e),c=Pl(d)):e[ir]&&(Ua(e[ir]),e[ir]=null));try{CI(e),AR(n.bindingStartIndex),t!==null&&dN(n,e,t,2,r);let h=(i&3)===3;if(!s)if(h){let E=n.preOrderCheckHooks;E!==null&&Fm(e,E,null)}else{let E=n.preOrderHooks;E!==null&&Vm(e,E,0,null),HI(e,0)}if(o||T6(e),wN(e),EN(e,0),n.contentQueries!==null&&qk(n,e),!s)if(h){let E=n.contentCheckHooks;E!==null&&Fm(e,E)}else{let E=n.contentHooks;E!==null&&Vm(e,E,1),HI(e,1)}D6(n,e);let p=n.components;p!==null&&CN(e,p,0);let y=n.viewQuery;if(y!==null&&iE(2,y,r),!s)if(h){let E=n.viewCheckHooks;E!==null&&Fm(e,E)}else{let E=n.viewHooks;E!==null&&Vm(e,E,2),HI(e,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),e[Im]){for(let E of e[Im])E();e[Im]=null}s||(yN(e),e[we]&=-73)}catch(h){throw s||oc(e),h}finally{d!==null&&(fh(d,c),a&&v6(d)),Am()}}function EN(n,e){for(let t=Fk(n);t!==null;t=Vk(t))for(let r=Rt;r<t.length;r++){let i=t[r];bN(i,e)}}function T6(n){for(let e=Fk(n);e!==null;e=Vk(e)){if(!(e[we]&2))continue;let t=e[Mh];for(let r=0;r<t.length;r++){let i=t[r];TI(i)}}}function S6(n,e,t){tt(ze.ComponentStart);let r=wr(e,n);try{bN(r,t)}finally{tt(ze.ComponentEnd,r[xt])}}function bN(n,e){bm(n)&&aE(n,e)}function aE(n,e){let r=n[me],i=n[we],s=n[ir],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&ph(s)),o||=!1,s&&(s.dirty=!1),n[we]&=-9217,o)C6(r,n,r.template,n[xt]);else if(i&8192){let a=de(null);try{wN(n),EN(n,1);let c=r.components;c!==null&&CN(n,c,1),yN(n)}finally{de(a)}}}function CN(n,e,t){for(let r=0;r<e.length;r++)S6(n,e[r],t)}function D6(n,e){let t=n.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)Do(~i);else{let s=i,o=t[++r],a=t[++r];RR(o,s);let c=e[s];tt(ze.HostBindingsUpdateStart,c);try{a(2,c)}finally{tt(ze.HostBindingsUpdateEnd,c)}}}}finally{Do(-1)}}function $E(n,e){let t=NI()?64:1088;for(n[vi].changeDetectionScheduler?.notify(e);n;){n[we]|=t;let r=Eo(n);if(Xl(n)&&!r)return n;n=r}return null}function TN(n,e,t,r){return[n,!0,0,e,null,r,null,t,null,null]}function SN(n,e){let t=Rt+e;if(t<n.length)return n[t]}function py(n,e,t,r=!0){let i=e[me];if(A6(i,e,n,t),r){let o=oE(t,n),a=e[ht],c=a.parentNode(n[To]);c!==null&&j3(i,n[vr],a,e,c,o)}let s=e[Ql];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function DN(n,e){let t=Hh(n,e);return t!==void 0&&hy(t[me],t),t}function Hh(n,e){if(n.length<=Rt)return;let t=Rt+e,r=n[t];if(r){let i=r[ec];i!==null&&i!==n&&OE(i,r),e>0&&(n[t-1][yr]=r[yr]);let s=Ah(n,Rt+e);U3(r[me],r);let o=s[nc];o!==null&&o.detachView(s[me]),r[ln]=null,r[yr]=null,r[we]&=-129}return r}function A6(n,e,t,r){let i=Rt+r,s=t.length;r>0&&(t[i-1][yr]=e),r<s-Rt?(e[yr]=t[i],dI(t,Rt+r,e)):(t.push(e),e[yr]=null),e[ln]=t;let o=e[ec];o!==null&&t!==o&&AN(o,e);let a=e[nc];a!==null&&a.insertView(n),Cm(e),e[we]|=128}function AN(n,e){let t=n[Mh],r=e[ln];if(_i(r))n[we]|=2;else{let i=r[ln][rr];e[rr]!==i&&(n[we]|=2)}t===null?n[Mh]=[e]:t.push(e)}var dc=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let e=this._lView,t=e[me];return $h(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t}get context(){return this._lView[xt]}set context(e){this._lView[xt]=e}get destroyed(){return sc(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[ln];if(Hr(e)){let t=e[Nh],r=t?t.indexOf(this):-1;r>-1&&(Hh(e,r),Ah(t,r))}this._attachedToViewContainer=!1}hy(this._lView[me],this._lView)}onDestroy(e){SI(this._lView,e)}markForCheck(){$E(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[we]&=-129}reattach(){Cm(this._lView),this._lView[we]|=128}detectChanges(){this._lView[we]|=1024,IN(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new oe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let e=Xl(this._lView),t=this._lView[ec];t!==null&&!e&&OE(t,this._lView),lN(this._lView[me],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new oe(902,!1);this._appRef=e;let t=Xl(this._lView),r=this._lView[ec];r!==null&&!t&&AN(r,this._lView),Cm(this._lView)}};function gy(n,e,t,r,i){let s=n.data[e];if(s===null)s=x6(n,e,t,r,i),xR()&&(s.flags|=32);else if(s.type&64){s.type=t,s.value=r,s.attrs=i;let o=bR();s.injectorIndex=o===null?-1:o.injectorIndex}return Zl(s,!0),s}function x6(n,e,t,r,i){let s=RI(),o=kI(),a=o?s:s&&s.parent,c=n.data[e]=k6(n,a,t,e,r,i);return R6(n,c,s,o),c}function R6(n,e,t,r){n.firstChild===null&&(n.firstChild=e),t!==null&&(r?t.child==null&&e.parent!==null&&(t.child=e):t.next===null&&(t.next=e,e.prev=t))}function k6(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return ER()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,fieldIndex:-1,customControlIndex:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function N6(n){let e=n[_I]??[],r=n[ln][ht],i=[];for(let s of e)s.data[jk]!==void 0?i.push(s):M6(s,r);n[_I]=i}function M6(n,e){let t=0,r=n.firstChild;if(r){let i=n.data[Uk];for(;t<i;){let s=r.nextSibling;Yk(e,r,!1),r=s,t++}}}var P6=()=>null,O6=()=>null;function cE(n,e){return P6(n,e)}function xN(n,e,t){return O6(n,e,t)}var RN=class{},my=class{},lE=class{resolveComponentFactory(e){throw new oe(917,!1)}},Kh=class{static NULL=new lE},hc=class{},fs=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>F6()}return n})();function F6(){let n=Pe(),e=An(),t=wr(e.index,n);return(_i(t)?t:n)[ht]}var kN=(()=>{class n{static \u0275prov=se({token:n,providedIn:"root",factory:()=>null})}return n})();var Lm={},uE=class{injector;parentInjector;constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){let i=this.injector.get(e,Lm,r);return i!==Lm||t===Lm?i:this.parentInjector.get(e,t,r)}};function Qm(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=gm(i,a);else if(s==2){let c=a,d=e[++o];r=gm(r,c+": "+d+";")}}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function Be(n,e=0){let t=Pe();if(t===null)return xe(n,e);let r=An();return kk(r,t,In(n),e)}function V6(n,e,t,r,i){let s=r===null?null:{"":-1},o=i(n,t);if(o!==null){let a=o,c=null,d=null;for(let h of o)if(h.resolveHostDirectives!==null){[a,c,d]=h.resolveHostDirectives(o);break}j6(n,e,t,a,s,c,d)}s!==null&&r!==null&&L6(t,r,s)}function L6(n,e,t){let r=n.localNames=[];for(let i=0;i<e.length;i+=2){let s=t[e[i+1]];if(s==null)throw new oe(-301,!1);r.push(e[i],s)}}function U6(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function j6(n,e,t,r,i,s,o){let a=r.length,c=null;for(let y=0;y<a;y++){let E=r[y];c===null&&wi(E)&&(c=E,U6(n,t,y)),tE(qm(t,e),n,E.type)}G6(t,n.data.length,a),c?.viewProvidersResolver&&c.viewProvidersResolver(c);for(let y=0;y<a;y++){let E=r[y];E.providersResolver&&E.providersResolver(E)}let d=!1,h=!1,p=rN(n,e,a,null);a>0&&(t.directiveToIndex=new Map);for(let y=0;y<a;y++){let E=r[y];if(t.mergedAttrs=ru(t.mergedAttrs,E.hostAttrs),$6(n,t,e,p,E),z6(p,E,i),o!==null&&o.has(E)){let[P,M]=o.get(E);t.directiveToIndex.set(E.type,[p,P+t.directiveStart,M+t.directiveStart])}else(s===null||!s.has(E))&&t.directiveToIndex.set(E.type,p);E.contentQueries!==null&&(t.flags|=4),(E.hostBindings!==null||E.hostAttrs!==null||E.hostVars!==0)&&(t.flags|=64);let k=E.type.prototype;!d&&(k.ngOnChanges||k.ngOnInit||k.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),d=!0),!h&&(k.ngOnChanges||k.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),h=!0),p++}B6(n,t,s)}function B6(n,e,t){for(let r=e.directiveStart;r<e.directiveEnd;r++){let i=n.data[r];if(t===null||!t.has(i))ik(0,e,i,r),ik(1,e,i,r),ok(e,r,!1);else{let s=t.get(i);sk(0,e,s,r),sk(1,e,s,r),ok(e,r,!0)}}}function ik(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o;n===0?o=e.inputs??={}:o=e.outputs??={},o[s]??=[],o[s].push(r),NN(e,s)}}function sk(n,e,t,r){let i=n===0?t.inputs:t.outputs;for(let s in i)if(i.hasOwnProperty(s)){let o=i[s],a;n===0?a=e.hostDirectiveInputs??={}:a=e.hostDirectiveOutputs??={},a[o]??=[],a[o].push(r,s),NN(e,o)}}function NN(n,e){e==="class"?n.flags|=8:e==="style"&&(n.flags|=16)}function ok(n,e,t){let{attrs:r,inputs:i,hostDirectiveInputs:s}=n;if(r===null||!t&&i===null||t&&s===null||xE(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let o=null,a=0;for(;a<r.length;){let c=r[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!t&&i.hasOwnProperty(c)){let d=i[c];for(let h of d)if(h===e){o??=[],o.push(c,r[a+1]);break}}else if(t&&s.hasOwnProperty(c)){let d=s[c];for(let h=0;h<d.length;h+=2)if(d[h]===e){o??=[],o.push(d[h+1],r[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(o)}function $6(n,e,t,r,i){n.data[r]=i;let s=i.factory||(i.factory=wo(i.type,!0)),o=new lc(s,wi(i),Be,null);n.blueprint[r]=o,t[r]=o,H6(n,e,r,rN(n,t,i.hostVars,Yn),i)}function H6(n,e,t,r,i){let s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;o===null&&(o=n.hostBindingOpCodes=[]);let a=~e.index;q6(o)!=a&&o.push(a),o.push(t,r,s)}}function q6(n){let e=n.length;for(;e>0;){let t=n[--e];if(typeof t=="number"&&t<0)return t}return 0}function z6(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;wi(e)&&(t[""]=n)}}function G6(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}function MN(n,e,t,r,i,s,o,a){let c=e[me],d=c.consts,h=Ii(d,o),p=gy(c,n,t,r,h);return s&&V6(c,e,p,Ii(d,a),i),p.mergedAttrs=ru(p.mergedAttrs,p.attrs),p.attrs!==null&&Qm(p,p.attrs,!1),p.mergedAttrs!==null&&Qm(p,p.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,p),p}function PN(n,e){$B(n,e),wI(e)&&n.queries.elementEnd(e)}function W6(n,e,t,r,i,s){let o=e.consts,a=Ii(o,i),c=gy(e,n,t,r,a);if(c.mergedAttrs=ru(c.mergedAttrs,c.attrs),s!=null){let d=Ii(o,s);c.localNames=[];for(let h=0;h<d.length;h+=2)c.localNames.push(d[h],-1)}return c.attrs!==null&&Qm(c,c.attrs,!1),c.mergedAttrs!==null&&Qm(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function K6(n,e,t){return n[e]=t}function Ti(n,e,t){if(t===Yn)return!1;let r=n[e];return Object.is(r,t)?!1:(n[e]=t,!0)}function ON(n,e,t,r){let i=Ti(n,e,t);return Ti(n,e+1,r)||i}function Um(n,e,t){return function r(i){let s=So(n)?wr(n.index,e):e;$E(s,5);let o=e[xt],a=ak(e,o,t,i),c=r.__ngNextListenerFn__;for(;c;)a=ak(e,o,c,i)&&a,c=c.__ngNextListenerFn__;return a}}function ak(n,e,t,r){let i=de(null);try{return tt(ze.OutputStart,e,t),t(r)!==!1}catch(s){return h6(n,s),!1}finally{tt(ze.OutputEnd,e,t),de(i)}}function FN(n,e,t,r,i,s,o,a){let c=Em(n),d=!1,h=null;if(!r&&c&&(h=Y6(e,t,s,n.index)),h!==null){let p=h.__ngLastListenerFn__||h;p.__ngNextListenerFn__=o,h.__ngLastListenerFn__=o,d=!0}else{let p=qr(n,t),y=r?r(p):p;d3(t,y,s,a);let E=i.listen(y,s,a);if(!Q6(s)){let k=r?P=>r(_r(P[n.index])):n.index;VN(k,e,t,s,a,E,!1)}}return d}function Q6(n){return n.startsWith("animation")||n.startsWith("transition")}function Y6(n,e,t,r){let i=n.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===t&&i[s+1]===r){let a=e[Yl],c=i[s+2];return a&&a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function VN(n,e,t,r,i,s,o){let a=e.firstCreatePass?vR(e):null,c=yR(t),d=c.length;c.push(i,s),a&&a.push(r,n,d,(d+1)*(o?-1:1))}function ck(n,e,t,r,i,s){let o=e[t],a=e[me],d=a.data[t].outputs[r],p=o[d].subscribe(s);VN(n.index,a,e,i,s,p,!0)}var dE=Symbol("BINDING");var Ym=class extends Kh{ngModule;constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let t=bo(e);return new su(t,this.ngModule)}};function J6(n){return Object.keys(n).map(e=>{let[t,r,i]=n[e],s={propName:t,templateName:e,isSignal:(r&ly.SignalBased)!==0};return i&&(s.transform=i),s})}function X6(n){return Object.keys(n).map(e=>({propName:n[e],templateName:e}))}function Z6(n,e,t){let r=e instanceof Ot?e:e?.injector;return r&&n.getStandaloneInjector!==null&&(r=n.getStandaloneInjector(r)||r),r?new uE(t,r):t}function e5(n){let e=n.get(hc,null);if(e===null)throw new oe(407,!1);let t=n.get(kN,null),r=n.get(as,null);return{rendererFactory:e,sanitizer:t,changeDetectionScheduler:r,ngReflect:!1}}function t5(n,e){let t=LN(n);return Kk(e,t,t==="svg"?hR:t==="math"?fR:null)}function LN(n){return(n.selectors[0][0]||"div").toLowerCase()}var su=class extends my{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=J6(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=X6(this.componentDef.outputs),this.cachedOutputs}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=x3(e.selectors),this.ngContentSelectors=e.ngContentSelectors??[],this.isBoundToModule=!!t}create(e,t,r,i,s,o){tt(ze.DynamicComponentStart);let a=de(null);try{let c=this.componentDef,d=n5(r,c,o,s),h=Z6(c,i||this.ngModule,e),p=e5(h),y=p.rendererFactory.createRenderer(null,c),E=r?Z3(y,r,c.encapsulation,h):t5(c,y),k=o?.some(lk)||s?.some($=>typeof $!="function"&&$.bindings.some(lk)),P=kE(null,d,null,512|nN(c),null,null,p,y,h,null,Hk(E,h,!0));P[Ft]=E,Dm(P);let M=null;try{let $=MN(Ft,P,2,"#host",()=>d.directiveRegistry,!0,0);Jk(y,E,$),iu(E,P),hN(d,P,$),zk(d,$,P),PN(d,$),t!==void 0&&i5($,this.ngContentSelectors,t),M=wr($.index,P),P[xt]=M[xt],jE(d,P,null)}catch($){throw M!==null&&rE(M),rE(P),$}finally{tt(ze.DynamicComponentEnd),Am()}return new Jm(this.componentType,P,!!k)}finally{de(a)}}};function n5(n,e,t,r){let i=n?["ng-version","21.0.5"]:R3(e.selectors[0]),s=null,o=null,a=0;if(t)for(let h of t)a+=h[dE].requiredVars,h.create&&(h.targetIdx=0,(s??=[]).push(h)),h.update&&(h.targetIdx=0,(o??=[]).push(h));if(r)for(let h=0;h<r.length;h++){let p=r[h];if(typeof p!="function")for(let y of p.bindings){a+=y[dE].requiredVars;let E=h+1;y.create&&(y.targetIdx=E,(s??=[]).push(y)),y.update&&(y.targetIdx=E,(o??=[]).push(y))}}let c=[e];if(r)for(let h of r){let p=typeof h=="function"?h:h.type,y=cI(p);c.push(y)}return RE(0,null,r5(s,o),1,a,c,null,null,null,[i],null)}function r5(n,e){return!n&&!e?null:t=>{if(t&1&&n)for(let r of n)r.create();if(t&2&&e)for(let r of e)r.update()}}function lk(n){let e=n[dE].kind;return e==="input"||e==="twoWay"}var Jm=class extends RN{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(e,t,r){super(),this._rootLView=t,this._hasInputBindings=r,this._tNode=Ph(t[me],Ft),this.location=bE(this._tNode,t),this.instance=wr(this._tNode.index,t)[xt],this.hostView=this.changeDetectorRef=new dc(t,void 0),this.componentType=e}setInput(e,t){this._hasInputBindings;let r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;let i=this._rootLView,s=UE(r,i[me],i,e,t);this.previousInputValues.set(e,t);let o=wr(r.index,i);$E(o,1)}get injector(){return new cc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function i5(n,e,t){let r=n.projection=[];for(let i=0;i<e.length;i++){let s=t[i];r.push(s!=null&&s.length?Array.from(s):null)}}var Qh=(()=>{class n{static __NG_ELEMENT_ID__=s5}return n})();function s5(){let n=An();return a5(n,Pe())}var o5=Qh,UN=class extends o5{_lContainer;_hostTNode;_hostLView;constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return bE(this._hostTNode,this._hostLView)}get injector(){return new cc(this._hostTNode,this._hostLView)}get parentInjector(){let e=EE(this._hostTNode,this._hostLView);if(Tk(e)){let t=$m(e,this._hostLView),r=Bm(e),i=t[me].data[r+8];return new cc(i,t)}else return new cc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let t=uk(this._lContainer);return t!==null&&t[e]||null}get length(){return this._lContainer.length-Rt}createEmbeddedView(e,t,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=cE(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(t||{},s,o);return this.insertImpl(a,i,Bh(this._hostTNode,o)),a}createComponent(e,t,r,i,s,o,a){let c=e&&!VB(e),d;if(c)d=t;else{let M=t||{};d=M.index,r=M.injector,i=M.projectableNodes,s=M.environmentInjector||M.ngModuleRef,o=M.directives,a=M.bindings}let h=c?e:new su(bo(e)),p=r||this.parentInjector;if(!s&&h.ngModule==null){let $=(c?p:this.parentInjector).get(Ot,null);$&&(s=$)}let y=bo(h.componentType??{}),E=cE(this._lContainer,y?.id??null),k=E?.firstChild??null,P=h.create(p,i,k,s,o,a);return this.insertImpl(P.hostView,d,Bh(this._hostTNode,E)),P}insert(e,t){return this.insertImpl(e,t,!0)}insertImpl(e,t,r){let i=e._lView;if(pR(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[ln],d=new UN(c,c[vr],c[ln]);d.detach(d.indexOf(e))}}let s=this._adjustIndex(t),o=this._lContainer;return py(o,i,s,r),e.attachToViewContainerRef(),dI(GI(o),s,e),e}move(e,t){return this.insert(e,t)}indexOf(e){let t=uk(this._lContainer);return t!==null?t.indexOf(e):-1}remove(e){let t=this._adjustIndex(e,-1),r=Hh(this._lContainer,t);r&&(Ah(GI(this._lContainer),t),hy(r[me],r))}detach(e){let t=this._adjustIndex(e,-1),r=Hh(this._lContainer,t);return r&&Ah(GI(this._lContainer),t)!=null?new dc(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function uk(n){return n[Nh]}function GI(n){return n[Nh]||(n[Nh]=[])}function a5(n,e){let t,r=e[n.index];return Hr(r)?t=r:(t=TN(r,e,null,n),e[n.index]=t,NE(e,t)),l5(t,e,n,r),new UN(t,n,e)}function c5(n,e){let t=n[ht],r=t.createComment(""),i=qr(e,n),s=t.parentNode(i);return Wm(t,s,r,t.nextSibling(i),!1),r}var l5=h5,u5=()=>!1;function d5(n,e,t){return u5(n,e,t)}function h5(n,e,t,r){if(n[To])return;let i;t.type&8?i=_r(r):i=c5(e,t),n[To]=i}var fc=class{},yy=class{};var Xm=class extends fc{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Ym(this);constructor(e,t,r,i=!0){super(),this.ngModuleType=e,this._parent=t;let s=aI(e);this._bootstrapComponents=eN(s.bootstrap),this._r3Injector=FI(e,t,[{provide:fc,useValue:this},{provide:Kh,useValue:this.componentFactoryResolver},...r],os(e),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Zm=class extends yy{moduleType;constructor(e){super(),this.moduleType=e}create(e){return new Xm(this.moduleType,e,[])}};var qh=class extends fc{injector;componentFactoryResolver=new Ym(this);instance=null;constructor(e){super();let t=new Qa([...e.providers,{provide:fc,useValue:this},{provide:Kh,useValue:this.componentFactoryResolver}],e.parent||Rh(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Yh(n,e,t=null){return new qh({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}var f5=(()=>{class n{_injector;cachedInjectors=new Map;constructor(t){this._injector=t}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=pI(!1,t.type),i=r.length>0?Yh([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=se({token:n,providedIn:"environment",factory:()=>new n(xe(Ot))})}return n})();function Bn(n){return au(()=>{let e=jN(n),t=ce(H({},e),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===CE.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:e.standalone?i=>i.get(f5).getOrCreateStandaloneInjector(t):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Wr.Emulated,styles:n.styles||jn,_:null,schemas:n.schemas||null,tView:null,id:""});e.standalone&&Ro("NgStandalone"),BN(t);let r=n.dependencies;return t.directiveDefs=dk(r,p5),t.pipeDefs=dk(r,X1),t.id=y5(t),t})}function p5(n){return bo(n)||cI(n)}function ps(n){return au(()=>({type:n.type,bootstrap:n.bootstrap||jn,declarations:n.declarations||jn,imports:n.imports||jn,exports:n.exports||jn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function g5(n,e){if(n==null)return Co;let t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r],s,o,a,c;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s,c=i[3]||null):(s=i,o=i,a=ly.None,c=null),t[s]=[r,a,c],e[s]=o}return t}function m5(n){if(n==null)return Co;let e={};for(let t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function xn(n){return au(()=>{let e=jN(n);return BN(e),e})}function HE(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function jN(n){let e={};return{type:n.type,providersResolver:null,viewProvidersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputConfig:n.inputs||Co,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||jn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:g5(n.inputs,e),outputs:m5(n.outputs),debugInfo:null}}function BN(n){n.features?.forEach(e=>e(n))}function dk(n,e){return n?()=>{let t=typeof n=="function"?n():n,r=[];for(let i of t){let s=e(i);s!==null&&r.push(s)}return r}:null}function y5(n){let e=0,t=typeof n.consts=="function"?"":n.consts,r=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,t,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let s of r.join("|"))e=Math.imul(31,e)+s.charCodeAt(0)<<0;return e+=2147483648,"c"+e}function v5(n){return Object.getPrototypeOf(n.prototype).constructor}function gs(n){let e=v5(n.type),t=!0,r=[n];for(;e;){let i;if(wi(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new oe(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);let o=n;o.inputs=WI(n.inputs),o.declaredInputs=WI(n.declaredInputs),o.outputs=WI(n.outputs);let a=i.hostBindings;a&&b5(n,a);let c=i.viewQuery,d=i.contentQueries;if(c&&I5(n,c),d&&E5(n,d),_5(n,i),J1(n.outputs,i.outputs),wi(i)&&i.data.animation){let h=n.data;h.animation=(h.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(n),a===gs&&(t=!1)}}e=Object.getPrototypeOf(e)}w5(r)}function _5(n,e){for(let t in e.inputs){if(!e.inputs.hasOwnProperty(t)||n.inputs.hasOwnProperty(t))continue;let r=e.inputs[t];r!==void 0&&(n.inputs[t]=r,n.declaredInputs[t]=e.declaredInputs[t])}}function w5(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){let i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=ru(i.hostAttrs,t=ru(t,i.hostAttrs))}}function WI(n){return n===Co?{}:n===jn?[]:n}function I5(n,e){let t=n.viewQuery;t?n.viewQuery=(r,i)=>{e(r,i),t(r,i)}:n.viewQuery=e}function E5(n,e){let t=n.contentQueries;t?n.contentQueries=(r,i,s)=>{e(r,i,s),t(r,i,s)}:n.contentQueries=e}function b5(n,e){let t=n.hostBindings;t?n.hostBindings=(r,i)=>{e(r,i),t(r,i)}:n.hostBindings=e}function C5(n,e,t,r,i,s,o,a){if(t.firstCreatePass){n.mergedAttrs=ru(n.mergedAttrs,n.attrs);let h=n.tView=RE(2,n,i,s,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,t.consts,null);t.queries!==null&&(t.queries.template(t,n),h.queries=t.queries.embeddedTView(n))}a&&(n.flags|=a),Zl(n,!1);let c=T5(t,e,n,r);Rm()&&FE(t,e,c,n),iu(c,e);let d=TN(c,e,c,n);e[r+Ft]=d,NE(e,d),d5(d,n,e)}function ey(n,e,t,r,i,s,o,a,c,d,h){let p=t+Ft,y;if(e.firstCreatePass){if(y=gy(e,p,4,o||null,a||null),d!=null){let E=Ii(e.consts,d);y.localNames=[];for(let k=0;k<E.length;k+=2)y.localNames.push(E[k],-1)}}else y=e.data[p];return C5(y,n,e,t,r,i,s,c),d!=null&&LE(n,y,h),y}var T5=S5;function S5(n,e,t,r){return km(!0),e[ht].createComment("")}var qE=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();function $N(n){return typeof n=="function"&&n[Fn]!==void 0}function zE(n){return $N(n)&&typeof n.set=="function"}var GE=new ae("");function ko(n){return!!n&&typeof n.then=="function"}function WE(n){return!!n&&typeof n.subscribe=="function"}var HN=new ae("");var KE=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r});appInits=j(HN,{optional:!0})??[];injector=j(At);constructor(){}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let s=tn(this.injector,i);if(ko(s))t.push(s);else if(WE(s)){let o=new Promise((a,c)=>{s.subscribe({complete:a,error:c})});t.push(o)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),vy=new ae("");function qN(){mw(()=>{let n="";throw new oe(600,n)})}function zN(n){return n.isBoundToModule}var D5=10;var No=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=j(sr);afterRenderManager=j(PE);zonelessEnabled=j(Vh);rootEffectScheduler=j(Nm);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new en;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=j(ds);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(ut(t=>!t))}constructor(){j(mc,{optional:!0})}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}_injector=j(Ot);_rendererFactory=null;get injector(){return this._injector}bootstrap(t,r){return this.bootstrapImpl(t,r)}bootstrapImpl(t,r,i=At.NULL){return this._injector.get(gt).run(()=>{tt(ze.BootstrapComponentStart);let o=t instanceof my;if(!this._injector.get(KE).done){let k="";throw new oe(405,k)}let c;o?c=t:c=this._injector.get(Kh).resolveComponentFactory(t),this.componentTypes.push(c.componentType);let d=zN(c)?void 0:this._injector.get(fc),h=r||c.selector,p=c.create(i,[],h,d),y=p.location.nativeElement,E=p.injector.get(GE,null);return E?.registerApplication(y),p.onDestroy(()=>{this.detachView(p.hostView),jh(this.components,p),E?.unregisterApplication(y)}),this._loadComponent(p),tt(ze.BootstrapComponentEnd,p),p})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){tt(ze.ChangeDetectionStart),this.tracingSnapshot!==null?this.tracingSnapshot.run(uy.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw tt(ze.ChangeDetectionEnd),new oe(101,!1);let t=de(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,de(t),this.afterTick.next(),tt(ze.ChangeDetectionEnd)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(hc,null,{optional:!0}));let t=0;for(;this.dirtyFlags!==0&&t++<D5;){tt(ze.ChangeDetectionSyncStart);try{this.synchronizeOnce()}finally{tt(ze.ChangeDetectionSyncEnd)}}}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let t=!1;if(this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i}of this.allViews){if(!r&&!Oh(i))continue;let s=r&&!this.zonelessEnabled?0:1;IN(i,s),t=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}t||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Oh(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;jh(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView);try{this.tick()}catch(i){this.internalErrorHandler(i)}this.components.push(t),this._injector.get(vy,[]).forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>jh(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new oe(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function jh(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Jh(n,e,t,r){let i=Pe(),s=ac();if(Ti(i,s,e)){let o=un(),a=xm();l6(a,i,n,e,t,r)}return Jh}var _ae=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var hE=class{destroy(e){}updateValue(e,t){}swap(e,t){let r=Math.min(e,t),i=Math.max(e,t),s=this.detach(i);if(i-r>1){let o=this.detach(r);this.attach(r,s),this.attach(i,o)}else this.attach(r,s)}move(e,t){this.attach(t,this.detach(e))}};function KI(n,e,t,r,i){return n===t&&Object.is(e,r)?1:Object.is(i(n,e),i(t,r))?-1:0}function A5(n,e,t,r){let i,s,o=0,a=n.length-1,c=void 0;if(Array.isArray(e)){de(r);let d=e.length-1;for(de(null);o<=a&&o<=d;){let h=n.at(o),p=e[o],y=KI(o,h,o,p,t);if(y!==0){y<0&&n.updateValue(o,p),o++;continue}let E=n.at(a),k=e[d],P=KI(a,E,d,k,t);if(P!==0){P<0&&n.updateValue(a,k),a--,d--;continue}let M=t(o,h),$=t(a,E),Y=t(o,p);if(Object.is(Y,$)){let ee=t(d,k);Object.is(ee,M)?(n.swap(o,a),n.updateValue(a,k),d--,a--):n.move(a,o),n.updateValue(o,p),o++;continue}if(i??=new ty,s??=fk(n,o,a,t),fE(n,i,o,Y))n.updateValue(o,p),o++,a++;else if(s.has(Y))i.set(M,n.detach(o)),a--;else{let ee=n.create(o,e[o]);n.attach(o,ee),o++,a++}}for(;o<=d;)hk(n,i,t,o,e[o]),o++}else if(e!=null){de(r);let d=e[Symbol.iterator]();de(null);let h=d.next();for(;!h.done&&o<=a;){let p=n.at(o),y=h.value,E=KI(o,p,o,y,t);if(E!==0)E<0&&n.updateValue(o,y),o++,h=d.next();else{i??=new ty,s??=fk(n,o,a,t);let k=t(o,y);if(fE(n,i,o,k))n.updateValue(o,y),o++,a++,h=d.next();else if(!s.has(k))n.attach(o,n.create(o,y)),o++,a++,h=d.next();else{let P=t(o,p);i.set(P,n.detach(o)),a--}}}for(;!h.done;)hk(n,i,t,n.length,h.value),h=d.next()}for(;o<=a;)n.destroy(n.detach(a--));i?.forEach(d=>{n.destroy(d)})}function fE(n,e,t,r){return e!==void 0&&e.has(r)?(n.attach(t,e.get(r)),e.delete(r),!0):!1}function hk(n,e,t,r,i){if(fE(n,e,r,t(r,i)))n.updateValue(r,i);else{let s=n.create(r,i);n.attach(r,s)}}function fk(n,e,t,r){let i=new Set;for(let s=e;s<=t;s++)i.add(r(s,n.at(s)));return i}var ty=class{kvMap=new Map;_vMap=void 0;has(e){return this.kvMap.has(e)}delete(e){if(!this.has(e))return!1;let t=this.kvMap.get(e);return this._vMap!==void 0&&this._vMap.has(t)?(this.kvMap.set(e,this._vMap.get(t)),this._vMap.delete(t)):this.kvMap.delete(e),!0}get(e){return this.kvMap.get(e)}set(e,t){if(this.kvMap.has(e)){let r=this.kvMap.get(e);this._vMap===void 0&&(this._vMap=new Map);let i=this._vMap;for(;i.has(r);)r=i.get(r);i.set(r,t)}else this.kvMap.set(e,t)}forEach(e){for(let[t,r]of this.kvMap)if(e(r,t),this._vMap!==void 0){let i=this._vMap;for(;i.has(r);)r=i.get(r),e(r,t)}}};function ye(n,e,t,r,i,s,o,a){Ro("NgControlFlow");let c=Pe(),d=un(),h=Ii(d.consts,s);return ey(c,d,n,e,t,r,i,h,256,o,a),QE}function QE(n,e,t,r,i,s,o,a){Ro("NgControlFlow");let c=Pe(),d=un(),h=Ii(d.consts,s);return ey(c,d,n,e,t,r,i,h,512,o,a),QE}function ve(n,e){Ro("NgControlFlow");let t=Pe(),r=ac(),i=t[r]!==Yn?t[r]:-1,s=i!==-1?ny(t,Ft+i):void 0,o=0;if(Ti(t,r,n)){let a=de(null);try{if(s!==void 0&&DN(s,o),n!==-1){let c=Ft+n,d=ny(t,c),h=yE(t[me],c),p=xN(d,h,t),y=BE(t,h,e,{dehydratedView:p});py(d,y,o,Bh(h,p))}}finally{de(a)}}else if(s!==void 0){let a=SN(s,o);a!==void 0&&(a[xt]=e)}}var pE=class{lContainer;$implicit;$index;constructor(e,t,r){this.lContainer=e,this.$implicit=t,this.$index=r}get $count(){return this.lContainer.length-Rt}};function cu(n,e){return e}var gE=class{hasEmptyBlock;trackByFn;liveCollection;constructor(e,t,r){this.hasEmptyBlock=e,this.trackByFn=t,this.liveCollection=r}};function wt(n,e,t,r,i,s,o,a,c,d,h,p,y){Ro("NgControlFlow");let E=Pe(),k=un(),P=c!==void 0,M=Pe(),$=a?o.bind(M[rr][xt]):o,Y=new gE(P,$);M[Ft+n]=Y,ey(E,k,n+1,e,t,r,i,Ii(k.consts,s),256),P&&ey(E,k,n+2,c,d,h,p,Ii(k.consts,y),512)}var mE=class extends hE{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(e,t,r){super(),this.lContainer=e,this.hostLView=t,this.templateTNode=r}get length(){return this.lContainer.length-Rt}at(e){return this.getLView(e)[xt].$implicit}attach(e,t){let r=t[Ql];this.needsIndexUpdate||=e!==this.length,py(this.lContainer,t,e,Bh(this.templateTNode,r)),x5(this.lContainer,e)}detach(e){return this.needsIndexUpdate||=e!==this.length-1,R5(this.lContainer,e),k5(this.lContainer,e)}create(e,t){let r=cE(this.lContainer,this.templateTNode.tView.ssrId);return BE(this.hostLView,this.templateTNode,new pE(this.lContainer,t,e),{dehydratedView:r})}destroy(e){hy(e[me],e)}updateValue(e,t){this.getLView(e)[xt].$implicit=t}reset(){this.needsIndexUpdate=!1}updateIndexes(){if(this.needsIndexUpdate)for(let e=0;e<this.length;e++)this.getLView(e)[xt].$index=e}getLView(e){return N5(this.lContainer,e)}};function It(n){let e=de(null),t=Ei();try{let r=Pe(),i=r[me],s=r[t],o=t+1,a=ny(r,o);if(s.liveCollection===void 0){let d=yE(i,o);s.liveCollection=new mE(a,r,d)}else s.liveCollection.reset();let c=s.liveCollection;if(A5(c,n,s.trackByFn,e),c.updateIndexes(),s.hasEmptyBlock){let d=ac(),h=c.length===0;if(Ti(r,d,h)){let p=t+2,y=ny(r,p);if(h){let E=yE(i,p),k=xN(y,E,r),P=BE(r,E,void 0,{dehydratedView:k});py(y,P,0,Bh(E,k))}else i.firstUpdatePass&&N6(y),DN(y,0)}}}finally{de(e)}}function ny(n,e){return n[e]}function x5(n,e){if(n.length<=Rt)return;let t=Rt+e,r=n[t],i=r?r[ic]:void 0;if(r&&i&&i.detachedLeaveAnimationFns&&i.detachedLeaveAnimationFns.length>0){let s=r[us];V3(s,i),uc.delete(r),i.detachedLeaveAnimationFns=void 0}}function R5(n,e){if(n.length<=Rt)return;let t=Rt+e,r=n[t],i=r?r[ic]:void 0;i&&i.leave&&i.leave.size>0&&(i.detachedLeaveAnimationFns=[])}function k5(n,e){return Hh(n,e)}function N5(n,e){return SN(n,e)}function yE(n,e){return Ph(n,e)}function Ge(n,e,t){let r=Pe(),i=ac();if(Ti(r,i,e)){let s=un(),o=xm();fN(o,r,n,e,r[ht],t)}return Ge}function vE(n,e,t,r,i){UE(e,n,t,i?"class":"style",r)}function x(n,e,t,r){let i=Pe(),s=i[me],o=n+Ft,a=s.firstCreatePass?MN(o,i,2,e,c6,IR(),t,r):s.data[o];if(pN(a,i,n,e,GN),Em(a)){let c=i[me];hN(c,i,a),zk(c,a,i)}return r!=null&&LE(i,a),x}function R(){let n=un(),e=An(),t=gN(e);return n.firstCreatePass&&PN(n,t),AI(t)&&xI(),DI(),t.classesWithoutHost!=null&&qB(t)&&vE(n,t,Pe(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&zB(t)&&vE(n,t,Pe(),t.stylesWithoutHost,!1),R}function kt(n,e,t,r){return x(n,e,t,r),R(),kt}function Di(n,e,t,r){let i=Pe(),s=i[me],o=n+Ft,a=s.firstCreatePass?W6(o,s,2,e,t,r):s.data[o];return pN(a,i,n,e,GN),r!=null&&LE(i,a),Di}function Mo(){let n=An(),e=gN(n);return AI(e)&&xI(),DI(),Mo}var GN=(n,e,t,r,i)=>(km(!0),Kk(e[ht],r,VR()));function Oe(){return Pe()}var Lh=void 0;function M5(n){let e=Math.floor(Math.abs(n)),t=n.toString().replace(/^[^.]*\.?/,"").length;return e===1&&t===0?1:5}var P5=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Lh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Lh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm\u202Fa","h:mm:ss\u202Fa","h:mm:ss\u202Fa z","h:mm:ss\u202Fa zzzz"],["{1}, {0}",Lh,Lh,Lh],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",M5],QI={};function ar(n){let e=O5(n),t=pk(e);if(t)return t;let r=e.split("-")[0];if(t=pk(r),t)return t;if(r==="en")return P5;throw new oe(701,!1)}function pk(n){return n in QI||(QI[n]=cs.ng&&cs.ng.common&&cs.ng.common.locales&&cs.ng.common.locales[n]),QI[n]}var Nt=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(Nt||{});function O5(n){return n.toLowerCase().replace(/_/g,"-")}var Xh="en-US";var F5=Xh;function WN(n){typeof n=="string"&&(F5=n.toLowerCase().replace(/_/g,"-"))}function Q(n,e,t){let r=Pe(),i=un(),s=An();return KN(i,r,r[ht],s,n,e,t),Q}function lu(n,e,t){let r=Pe(),i=un(),s=An();return(s.type&3||t)&&FN(s,i,r,t,r[ht],n,e,Um(s,r,e)),lu}function KN(n,e,t,r,i,s,o){let a=!0,c=null;if((r.type&3||o)&&(c??=Um(r,e,s),FN(r,n,e,o,t,i,s,c)&&(a=!1)),a){let d=r.outputs?.[i],h=r.hostDirectiveOutputs?.[i];if(h&&h.length)for(let p=0;p<h.length;p+=2){let y=h[p],E=h[p+1];c??=Um(r,e,s),ck(r,e,y,E,i,c)}if(d&&d.length)for(let p of d)c??=Um(r,e,s),ck(r,e,p,i,i,c)}}function B(n=1){return FR(n)}function YE(n){let e=TR();return EI(e,Ft+n)}function Om(n,e){return n<<17|e<<2}function pc(n){return n>>17&32767}function V5(n){return(n&2)==2}function L5(n,e){return n&131071|e<<17}function _E(n){return n|2}function ou(n){return(n&131068)>>2}function YI(n,e){return n&-131069|e<<2}function U5(n){return(n&1)===1}function wE(n){return n|1}function j5(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=pc(o),c=ou(o);n[r]=t;let d=!1,h;if(Array.isArray(t)){let p=t;h=p[1],(h===null||Kl(p,h)>0)&&(d=!0)}else h=t;if(i)if(c!==0){let y=pc(n[a+1]);n[r+1]=Om(y,a),y!==0&&(n[y+1]=YI(n[y+1],r)),n[a+1]=L5(n[a+1],r)}else n[r+1]=Om(a,0),a!==0&&(n[a+1]=YI(n[a+1],r)),a=r;else n[r+1]=Om(c,0),a===0?a=r:n[c+1]=YI(n[c+1],r),c=r;d&&(n[r+1]=_E(n[r+1])),gk(n,h,r,!0),gk(n,h,r,!1),B5(e,h,n,r,s),o=Om(a,c),s?e.classBindings=o:e.styleBindings=o}function B5(n,e,t,r,i){let s=i?n.residualClasses:n.residualStyles;s!=null&&typeof e=="string"&&Kl(s,e)>=0&&(t[r+1]=wE(t[r+1]))}function gk(n,e,t,r){let i=n[t+1],s=e===null,o=r?pc(i):ou(i),a=!1;for(;o!==0&&(a===!1||s);){let c=n[o],d=n[o+1];$5(c,e)&&(a=!0,n[o+1]=r?wE(d):_E(d)),o=r?pc(d):ou(d)}a&&(n[t+1]=r?_E(i):wE(i))}function $5(n,e){return n===null||e==null||(Array.isArray(n)?n[1]:n)===e?!0:Array.isArray(n)&&typeof e=="string"?Kl(n,e)>=0:!1}var Gr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function H5(n){return n.substring(Gr.key,Gr.keyEnd)}function q5(n){return z5(n),QN(n,YN(n,0,Gr.textEnd))}function QN(n,e){let t=Gr.textEnd;return t===e?-1:(e=Gr.keyEnd=G5(n,Gr.key=e,t),YN(n,e,t))}function z5(n){Gr.key=0,Gr.keyEnd=0,Gr.value=0,Gr.valueEnd=0,Gr.textEnd=n.length}function YN(n,e,t){for(;e<t&&n.charCodeAt(e)<=32;)e++;return e}function G5(n,e,t){for(;e<t&&n.charCodeAt(e)>32;)e++;return e}function _y(n,e,t){return JN(n,e,t,!1),_y}function Rn(n,e){return JN(n,e,null,!0),Rn}function ft(n){K5(e9,W5,n,!0)}function W5(n,e){for(let t=q5(e);t>=0;t=QN(e,t))_m(n,H5(e),!0)}function JN(n,e,t,r){let i=Pe(),s=un(),o=Tm(2);if(s.firstUpdatePass&&ZN(s,n,o,r),e!==Yn&&Ti(i,o,e)){let a=s.data[Ei()];eM(s,a,i,i[ht],n,i[o+1]=n9(e,t),r,o)}}function K5(n,e,t,r){let i=un(),s=Tm(2);i.firstUpdatePass&&ZN(i,null,s,r);let o=Pe();if(t!==Yn&&Ti(o,s,t)){let a=i.data[Ei()];if(tM(a,r)&&!XN(i,s)){let c=r?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(t=gm(c,t||"")),vE(i,a,o,t,r)}else t9(i,a,o,o[ht],o[s+1],o[s+1]=Z5(n,e,t),r,s)}}function XN(n,e){return e>=n.expandoStartIndex}function ZN(n,e,t,r){let i=n.data;if(i[t+1]===null){let s=i[Ei()],o=XN(n,t);tM(s,r)&&e===null&&!o&&(e=!1),e=Q5(i,s,e,r),j5(i,s,e,t,o,r)}}function Q5(n,e,t,r){let i=NR(n),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(t=JI(null,n,e,t,r),t=zh(t,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||n[o]!==i)if(t=JI(i,n,e,t,r),s===null){let c=Y5(n,e,r);c!==void 0&&Array.isArray(c)&&(c=JI(null,n,e,c[1],r),c=zh(c,e.attrs,r),J5(n,e,r,c))}else s=X5(n,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),t}function Y5(n,e,t){let r=t?e.classBindings:e.styleBindings;if(ou(r)!==0)return n[pc(r)]}function J5(n,e,t,r){let i=t?e.classBindings:e.styleBindings;n[pc(i)]=r}function X5(n,e,t){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=n[s].hostAttrs;r=zh(r,o,t)}return zh(r,e.attrs,t)}function JI(n,e,t,r,i){let s=null,o=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<o&&(s=e[a],r=zh(r,s.hostAttrs,i),s!==n);)a++;return n!==null&&(t.directiveStylingLast=a),r}function zh(n,e,t){let r=t?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),_m(n,o,t?!0:e[++s]))}return n===void 0?null:n}function Z5(n,e,t){if(t==null||t==="")return jn;let r=[],i=Wh(t);if(Array.isArray(i))for(let s=0;s<i.length;s++)n(r,i[s],!0);else if(typeof i=="object")for(let s in i)i.hasOwnProperty(s)&&n(r,s,i[s]);else typeof i=="string"&&e(r,i);return r}function e9(n,e,t){let r=String(e);r!==""&&!r.includes(" ")&&_m(n,r,t)}function t9(n,e,t,r,i,s,o,a){i===Yn&&(i=jn);let c=0,d=0,h=0<i.length?i[0]:null,p=0<s.length?s[0]:null;for(;h!==null||p!==null;){let y=c<i.length?i[c+1]:void 0,E=d<s.length?s[d+1]:void 0,k=null,P;h===p?(c+=2,d+=2,y!==E&&(k=p,P=E)):p===null||h!==null&&h<p?(c+=2,k=h):(d+=2,k=p,P=E),k!==null&&eM(n,e,t,r,k,P,o,a),h=c<i.length?i[c]:null,p=d<s.length?s[d]:null}}function eM(n,e,t,r,i,s,o,a){if(!(e.type&3))return;let c=n.data,d=c[a+1],h=U5(d)?mk(c,e,t,i,ou(d),o):void 0;if(!ry(h)){ry(s)||V5(d)&&(s=mk(c,null,t,i,a,o));let p=II(Ei(),t);X3(r,o,p,i,s)}}function mk(n,e,t,r,i,s){let o=e===null,a;for(;i>0;){let c=n[i],d=Array.isArray(c),h=d?c[1]:c,p=h===null,y=t[i+1];y===Yn&&(y=p?jn:void 0);let E=p?wm(y,r):h===r?y:void 0;if(d&&!ry(E)&&(E=wm(c,r)),ry(E)&&(a=E,o))return a;let k=n[i+1];i=o?pc(k):ou(k)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=wm(c,r))}return a}function ry(n){return n!==void 0}function n9(n,e){return n==null||n===""||(typeof e=="string"?n=n+e:typeof n=="object"&&(n=os(Wh(n)))),n}function tM(n,e){return(n.flags&(e?8:16))!==0}function N(n,e=""){let t=Pe(),r=un(),i=n+Ft,s=r.firstCreatePass?gy(r,i,1,e,null):r.data[i],o=r9(r,t,s,e,n);t[i]=o,Rm()&&FE(r,t,o,s),Zl(s,!1)}var r9=(n,e,t,r,i)=>(km(!0),g3(e[ht],r));function i9(n,e,t,r=""){return Ti(n,ac(),t)?e+Ja(t)+r:Yn}function s9(n,e,t,r,i,s=""){let o=DR(),a=ON(n,o,t,i);return Tm(2),a?e+Ja(t)+r+Ja(i)+s:Yn}function Re(n){return lt("",n),Re}function lt(n,e,t){let r=Pe(),i=i9(r,n,e,t);return i!==Yn&&nM(r,Ei(),i),lt}function wy(n,e,t,r,i){let s=Pe(),o=s9(s,n,e,t,r,i);return o!==Yn&&nM(s,Ei(),o),wy}function nM(n,e,t){let r=II(e,n);m3(n[ht],r,t)}function sn(n,e,t){zE(e)&&(e=e());let r=Pe(),i=ac();if(Ti(r,i,e)){let s=un(),o=xm();fN(o,r,n,e,r[ht],t)}return sn}function dn(n,e){let t=zE(n);return t&&n.set(e),t}function on(n,e){let t=Pe(),r=un(),i=An();return KN(r,t,t[ht],i,n,e),on}function yk(n,e,t){let r=un();r.firstCreatePass&&rM(e,r.data,r.blueprint,wi(n),t)}function rM(n,e,t,r,i){if(n=In(n),Array.isArray(n))for(let s=0;s<n.length;s++)rM(n[s],e,t,r,i);else{let s=un(),o=Pe(),a=An(),c=Ka(n)?n:In(n.provide),d=mI(n),h=a.providerIndexes&1048575,p=a.directiveStart,y=a.providerIndexes>>20;if(Ka(n)||!n.multi){let E=new lc(d,i,Be,null),k=ZI(c,e,i?h:h+y,p);k===-1?(tE(qm(a,o),s,c),XI(s,n,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(E),o.push(E)):(t[k]=E,o[k]=E)}else{let E=ZI(c,e,h+y,p),k=ZI(c,e,h,h+y),P=E>=0&&t[E],M=k>=0&&t[k];if(i&&!M||!i&&!P){tE(qm(a,o),s,c);let $=c9(i?a9:o9,t.length,i,r,d,n);!i&&M&&(t[k].providerFactory=$),XI(s,n,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push($),o.push($)}else{let $=iM(t[i?k:E],d,!i&&r);XI(s,n,E>-1?E:k,$)}!i&&r&&M&&t[k].componentProviders++}}}function XI(n,e,t,r){let i=Ka(e),s=lR(e);if(i||s){let c=(s?In(e.useClass):e).prototype.ngOnDestroy;if(c){let d=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){let h=d.indexOf(t);h===-1?d.push(t,[r,c]):d[h+1].push(r,c)}else d.push(t,c)}}}function iM(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function ZI(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function o9(n,e,t,r,i){return IE(this.multi,[])}function a9(n,e,t,r,i){let s=this.multi,o;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=zm(r,r[me],this.providerFactory.index,i);o=c.slice(0,a),IE(s,o);for(let d=a;d<c.length;d++)o.push(c[d])}else o=[],IE(s,o);return o}function IE(n,e){for(let t=0;t<n.length;t++){let r=n[t];e.push(r())}return e}function c9(n,e,t,r,i,s){let o=new lc(n,t,Be,null);return o.multi=[],o.index=e,o.componentProviders=0,iM(o,i,r&&!t),o}function uu(n,e){return t=>{t.providersResolver=(r,i)=>yk(r,i?i(n):n,!1),e&&(t.viewProvidersResolver=(r,i)=>yk(r,i?i(e):e,!0))}}function l9(n,e){let t=n[e];return t===Yn?void 0:t}function u9(n,e,t,r,i,s,o){let a=e+t;return ON(n,a,i,s)?K6(n,a+2,o?r.call(o,i,s):r(i,s)):l9(n,a+2)}function Zh(n,e){let t=un(),r,i=n+Ft;t.firstCreatePass?(r=d9(e,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let s=r.factory||(r.factory=wo(r.type,!0)),o,a=Un(Be);try{let c=Hm(!1),d=s();return Hm(c),bI(t,Pe(),i,d),d}finally{Un(a)}}function d9(n,e){if(e)for(let t=e.length-1;t>=0;t--){let r=e[t];if(n===r.name)return r}}function ef(n,e,t,r){let i=n+Ft,s=Pe(),o=EI(s,i);return h9(s,i)?u9(s,SR(),e,o.transform,t,r,o):o.transform(t,r)}function h9(n,e){return n[me].data[e].pure}var iy=class{ngModuleFactory;componentFactories;constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}},JE=(()=>{class n{compileModuleSync(t){return new Zm(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=aI(t),s=eN(i.declarations).reduce((o,a)=>{let c=bo(a);return c&&o.push(new su(c)),o},[]);return new iy(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var sM=(()=>{class n{applicationErrorHandler=j(sr);appRef=j(No);taskService=j(ds);ngZone=j(gt);zonelessEnabled=j(Vh);tracing=j(mc,{optional:!0});zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new Zt;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Th):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(j($I,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()}))}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2;break}case 12:{this.appRef.dirtyFlags|=16;break}case 13:{this.appRef.dirtyFlags|=2;break}case 11:break;case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?LI:VI;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Th+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(t),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,LI(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function oM(){return[{provide:as,useExisting:sM},{provide:gt,useClass:Sh},{provide:Vh,useValue:!0}]}function f9(){return typeof $localize<"u"&&$localize.locale||Xh}var tf=new ae("",{factory:()=>j(tf,{optional:!0,skipSelf:!0})||f9()});function nt(n,e){return Pg(n,e?.equal)}var cM=Symbol("InputSignalNode#UNSET"),R9=ce(H({},Og),{transformFn:void 0,applyValueToInputSignal(n,e){gh(n,e)}});function lM(n,e){let t=Object.create(R9);t.value=n,t.transformFn=e?.transform;function r(){if(hh(t),t.value===cM){let i=null;throw new oe(-950,i)}return t.value}return r[Fn]=t,r}var Ey=class{attributeName;constructor(e){this.attributeName=e}__NG_ELEMENT_ID__=()=>Gh(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}};function aM(n,e){return lM(n,e)}function k9(n){return lM(cM,n)}var uM=(aM.required=k9,aM);var XE=new ae(""),N9=new ae("");function nf(n){return!n.moduleRef}function M9(n){let e=nf(n)?n.r3Injector:n.moduleRef.injector,t=e.get(gt);return t.run(()=>{nf(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let r=e.get(sr),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:r})}),nf(n)){let s=()=>e.destroy(),o=n.platformInjector.get(XE);o.add(s),e.onDestroy(()=>{i.unsubscribe(),o.delete(s)})}else{let s=()=>n.moduleRef.destroy(),o=n.platformInjector.get(XE);o.add(s),n.moduleRef.onDestroy(()=>{jh(n.allPlatformModules,n.moduleRef),i.unsubscribe(),o.delete(s)})}return O9(r,t,()=>{let s=e.get(ds),o=s.add(),a=e.get(KE);return a.runInitializers(),a.donePromise.then(()=>{let c=e.get(tf,Xh);if(WN(c||Xh),!e.get(N9,!0))return nf(n)?e.get(No):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(nf(n)){let h=e.get(No);return n.rootComponent!==void 0&&h.bootstrap(n.rootComponent),h}else return P9?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void s.remove(o))})})}var P9;function O9(n,e,t){try{let r=t();return ko(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n(r)),r}}var Iy=null;function F9(n=[],e){return At.create({name:e,providers:[{provide:xh,useValue:"platform"},{provide:XE,useValue:new Set([()=>Iy=null])},...n]})}function V9(n=[]){if(Iy)return Iy;let e=F9(n);return Iy=e,qN(),L9(e),e}function L9(n){let e=n.get(oy,null);tn(n,()=>{e?.forEach(t=>t())})}function ZE(){return!1}var yc=(()=>{class n{static __NG_ELEMENT_ID__=U9}return n})();function U9(n){return j9(An(),Pe(),(n&16)===16)}function j9(n,e,t){if(So(n)&&!t){let r=wr(n.index,e);return new dc(r,r)}else if(n.type&175){let r=e[rr];return new dc(r,e)}return null}function dM(n){let{rootComponent:e,appProviders:t,platformProviders:r,platformRef:i}=n;tt(ze.BootstrapApplicationStart);try{let s=i?.injector??V9(r),o=[oM(),BR,...t||[]],a=new qh({providers:o,parent:s,debugName:"",runEnvironmentInitializers:!1});return M9({r3Injector:a.injector,platformInjector:s,rootComponent:e})}catch(s){return Promise.reject(s)}finally{tt(ze.BootstrapApplicationEnd)}}function hu(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}var hM=null;function Er(){return hM}function eb(n){hM??=n}var rf=class{},by=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>j(fM),providedIn:"platform"})}return n})();var fM=(()=>{class n extends by{_location;_history;_doc=j(nn);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Er().getBaseHref(this._doc)}onPopState(t){let r=Er().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Er().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function mM(n,e){return n?e?n.endsWith("/")?e.startsWith("/")?n+e.slice(1):n+e:e.startsWith("/")?n+e:`${n}/${e}`:n:e}function pM(n){let e=n.search(/#|\?|$/);return n[e-1]==="/"?n.slice(0,e-1)+n.slice(e):n}function Po(n){return n&&n[0]!=="?"?`?${n}`:n}var fu=(()=>{class n{historyGo(t){throw new Error("")}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>j($9),providedIn:"root"})}return n})(),B9=new ae(""),$9=(()=>{class n extends fu{_platformLocation;_baseHref;_removeListenerFns=[];constructor(t,r){super(),this._platformLocation=t,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??j(nn).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return mM(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Po(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Po(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Po(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static \u0275fac=function(r){return new(r||n)(xe(by),xe(B9,8))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pu=(()=>{class n{_subject=new en;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(t){this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=z9(pM(gM(r))),this._locationStrategy.onPopState(i=>{this._subject.next({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Po(r))}normalize(t){return n.stripTrailingSlash(q9(this._basePath,gM(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Po(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Po(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r??void 0,complete:i??void 0})}static normalizeQueryParams=Po;static joinWithSlash=mM;static stripTrailingSlash=pM;static \u0275fac=function(r){return new(r||n)(xe(fu))};static \u0275prov=se({token:n,factory:()=>H9(),providedIn:"root"})}return n})();function H9(){return new pu(xe(fu))}function q9(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function gM(n){return n.replace(/\/index.html$/,"")}function z9(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}var kn=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(kn||{}),at=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(at||{}),Jn=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(Jn||{}),ys={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function vM(n){return ar(n)[Nt.LocaleId]}function _M(n,e,t){let r=ar(n),i=[r[Nt.DayPeriodsFormat],r[Nt.DayPeriodsStandalone]],s=br(i,e);return br(s,t)}function wM(n,e,t){let r=ar(n),i=[r[Nt.DaysFormat],r[Nt.DaysStandalone]],s=br(i,e);return br(s,t)}function IM(n,e,t){let r=ar(n),i=[r[Nt.MonthsFormat],r[Nt.MonthsStandalone]],s=br(i,e);return br(s,t)}function EM(n,e){let r=ar(n)[Nt.Eras];return br(r,e)}function sf(n,e){let t=ar(n);return br(t[Nt.DateFormat],e)}function of(n,e){let t=ar(n);return br(t[Nt.TimeFormat],e)}function af(n,e){let r=ar(n)[Nt.DateTimeFormat];return br(r,e)}function cf(n,e){let t=ar(n),r=t[Nt.NumberSymbols][e];if(typeof r>"u"){if(e===ys.CurrencyDecimal)return t[Nt.NumberSymbols][ys.Decimal];if(e===ys.CurrencyGroup)return t[Nt.NumberSymbols][ys.Group]}return r}function bM(n){if(!n[Nt.ExtraData])throw new oe(2303,!1)}function CM(n){let e=ar(n);return bM(e),(e[Nt.ExtraData][2]||[]).map(r=>typeof r=="string"?tb(r):[tb(r[0]),tb(r[1])])}function TM(n,e,t){let r=ar(n);bM(r);let i=[r[Nt.ExtraData][0],r[Nt.ExtraData][1]],s=br(i,e)||[];return br(s,t)||[]}function br(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new oe(2304,!1)}function tb(n){let[e,t]=n.split(":");return{hours:+e,minutes:+t}}var G9=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Cy={},W9=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function SM(n,e,t,r){let i=n$(n);e=ms(t,e)||e;let o=[],a;for(;e;)if(a=W9.exec(e),a){o=o.concat(a.slice(1));let h=o.pop();if(!h)break;e=h}else{o.push(e);break}let c=i.getTimezoneOffset();r&&(c=AM(r,c),i=t$(i,r));let d="";return o.forEach(h=>{let p=Z9(h);d+=p?p(i,t,c):h==="''"?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function xy(n,e,t){let r=new Date(0);return r.setFullYear(n,e,t),r.setHours(0,0,0),r}function ms(n,e){let t=vM(n);if(Cy[t]??={},Cy[t][e])return Cy[t][e];let r="";switch(e){case"shortDate":r=sf(n,Jn.Short);break;case"mediumDate":r=sf(n,Jn.Medium);break;case"longDate":r=sf(n,Jn.Long);break;case"fullDate":r=sf(n,Jn.Full);break;case"shortTime":r=of(n,Jn.Short);break;case"mediumTime":r=of(n,Jn.Medium);break;case"longTime":r=of(n,Jn.Long);break;case"fullTime":r=of(n,Jn.Full);break;case"short":let i=ms(n,"shortTime"),s=ms(n,"shortDate");r=Ty(af(n,Jn.Short),[i,s]);break;case"medium":let o=ms(n,"mediumTime"),a=ms(n,"mediumDate");r=Ty(af(n,Jn.Medium),[o,a]);break;case"long":let c=ms(n,"longTime"),d=ms(n,"longDate");r=Ty(af(n,Jn.Long),[c,d]);break;case"full":let h=ms(n,"fullTime"),p=ms(n,"fullDate");r=Ty(af(n,Jn.Full),[h,p]);break}return r&&(Cy[t][e]=r),r}function Ty(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,r){return e!=null&&r in e?e[r]:t})),n}function Kr(n,e,t="-",r,i){let s="";(n<0||i&&n<=0)&&(i?n=-n+1:(n=-n,s=t));let o=String(n);for(;o.length<e;)o="0"+o;return r&&(o=o.slice(o.length-e)),s+o}function K9(n,e){return Kr(n,3).substring(0,e)}function Vt(n,e,t=0,r=!1,i=!1){return function(s,o){let a=Q9(n,s);if((t>0||a>-t)&&(a+=t),n===3)a===0&&t===-12&&(a=12);else if(n===6)return K9(a,e);let c=cf(o,ys.MinusSign);return Kr(a,e,c,r,i)}}function Q9(n,e){switch(n){case 0:return e.getFullYear();case 1:return e.getMonth();case 2:return e.getDate();case 3:return e.getHours();case 4:return e.getMinutes();case 5:return e.getSeconds();case 6:return e.getMilliseconds();case 7:return e.getDay();default:throw new oe(2301,!1)}}function dt(n,e,t=kn.Format,r=!1){return function(i,s){return Y9(i,s,n,e,t,r)}}function Y9(n,e,t,r,i,s){switch(t){case 2:return IM(e,i,r)[n.getMonth()];case 1:return wM(e,i,r)[n.getDay()];case 0:let o=n.getHours(),a=n.getMinutes();if(s){let d=CM(e),h=TM(e,i,r),p=d.findIndex(y=>{if(Array.isArray(y)){let[E,k]=y,P=o>=E.hours&&a>=E.minutes,M=o<k.hours||o===k.hours&&a<k.minutes;if(E.hours<k.hours){if(P&&M)return!0}else if(P||M)return!0}else if(y.hours===o&&y.minutes===a)return!0;return!1});if(p!==-1)return h[p]}return _M(e,i,r)[o<12?0:1];case 3:return EM(e,r)[n.getFullYear()<=0?0:1];default:let c=t;throw new oe(2302,!1)}}function Sy(n){return function(e,t,r){let i=-1*r,s=cf(t,ys.MinusSign),o=i>0?Math.floor(i/60):Math.ceil(i/60);switch(n){case 0:return(i>=0?"+":"")+Kr(o,2,s)+Kr(Math.abs(i%60),2,s);case 1:return"GMT"+(i>=0?"+":"")+Kr(o,1,s);case 2:return"GMT"+(i>=0?"+":"")+Kr(o,2,s)+":"+Kr(Math.abs(i%60),2,s);case 3:return r===0?"Z":(i>=0?"+":"")+Kr(o,2,s)+":"+Kr(Math.abs(i%60),2,s);default:throw new oe(2310,!1)}}}var J9=0,Ay=4;function X9(n){let e=xy(n,J9,1).getDay();return xy(n,0,1+(e<=Ay?Ay:Ay+7)-e)}function DM(n){let e=n.getDay(),t=e===0?-3:Ay-e;return xy(n.getFullYear(),n.getMonth(),n.getDate()+t)}function nb(n,e=!1){return function(t,r){let i;if(e){let s=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,o=t.getDate();i=1+Math.floor((o+s)/7)}else{let s=DM(t),o=X9(s.getFullYear()),a=s.getTime()-o.getTime();i=1+Math.round(a/6048e5)}return Kr(i,n,cf(r,ys.MinusSign))}}function Dy(n,e=!1){return function(t,r){let s=DM(t).getFullYear();return Kr(s,n,cf(r,ys.MinusSign),e)}}var rb={};function Z9(n){if(rb[n])return rb[n];let e;switch(n){case"G":case"GG":case"GGG":e=dt(3,at.Abbreviated);break;case"GGGG":e=dt(3,at.Wide);break;case"GGGGG":e=dt(3,at.Narrow);break;case"y":e=Vt(0,1,0,!1,!0);break;case"yy":e=Vt(0,2,0,!0,!0);break;case"yyy":e=Vt(0,3,0,!1,!0);break;case"yyyy":e=Vt(0,4,0,!1,!0);break;case"Y":e=Dy(1);break;case"YY":e=Dy(2,!0);break;case"YYY":e=Dy(3);break;case"YYYY":e=Dy(4);break;case"M":case"L":e=Vt(1,1,1);break;case"MM":case"LL":e=Vt(1,2,1);break;case"MMM":e=dt(2,at.Abbreviated);break;case"MMMM":e=dt(2,at.Wide);break;case"MMMMM":e=dt(2,at.Narrow);break;case"LLL":e=dt(2,at.Abbreviated,kn.Standalone);break;case"LLLL":e=dt(2,at.Wide,kn.Standalone);break;case"LLLLL":e=dt(2,at.Narrow,kn.Standalone);break;case"w":e=nb(1);break;case"ww":e=nb(2);break;case"W":e=nb(1,!0);break;case"d":e=Vt(2,1);break;case"dd":e=Vt(2,2);break;case"c":case"cc":e=Vt(7,1);break;case"ccc":e=dt(1,at.Abbreviated,kn.Standalone);break;case"cccc":e=dt(1,at.Wide,kn.Standalone);break;case"ccccc":e=dt(1,at.Narrow,kn.Standalone);break;case"cccccc":e=dt(1,at.Short,kn.Standalone);break;case"E":case"EE":case"EEE":e=dt(1,at.Abbreviated);break;case"EEEE":e=dt(1,at.Wide);break;case"EEEEE":e=dt(1,at.Narrow);break;case"EEEEEE":e=dt(1,at.Short);break;case"a":case"aa":case"aaa":e=dt(0,at.Abbreviated);break;case"aaaa":e=dt(0,at.Wide);break;case"aaaaa":e=dt(0,at.Narrow);break;case"b":case"bb":case"bbb":e=dt(0,at.Abbreviated,kn.Standalone,!0);break;case"bbbb":e=dt(0,at.Wide,kn.Standalone,!0);break;case"bbbbb":e=dt(0,at.Narrow,kn.Standalone,!0);break;case"B":case"BB":case"BBB":e=dt(0,at.Abbreviated,kn.Format,!0);break;case"BBBB":e=dt(0,at.Wide,kn.Format,!0);break;case"BBBBB":e=dt(0,at.Narrow,kn.Format,!0);break;case"h":e=Vt(3,1,-12);break;case"hh":e=Vt(3,2,-12);break;case"H":e=Vt(3,1);break;case"HH":e=Vt(3,2);break;case"m":e=Vt(4,1);break;case"mm":e=Vt(4,2);break;case"s":e=Vt(5,1);break;case"ss":e=Vt(5,2);break;case"S":e=Vt(6,1);break;case"SS":e=Vt(6,2);break;case"SSS":e=Vt(6,3);break;case"Z":case"ZZ":case"ZZZ":e=Sy(0);break;case"ZZZZZ":e=Sy(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=Sy(1);break;case"OOOO":case"ZZZZ":case"zzzz":e=Sy(2);break;default:return null}return rb[n]=e,e}function AM(n,e){n=n.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function e$(n,e){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+e),n}function t$(n,e,t){let i=n.getTimezoneOffset(),s=AM(e,i);return e$(n,-1*(s-i))}function n$(n){if(yM(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[i,s=1,o=1]=n.split("-").map(a=>+a);return xy(i,s-1,o)}let t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let r;if(r=n.match(G9))return r$(r)}let e=new Date(n);if(!yM(e))throw new oe(2311,!1);return e}function r$(n){let e=new Date(0),t=0,r=0,i=n[8]?e.setUTCFullYear:e.setFullYear,s=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),r=Number(n[9]+n[11])),i.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));let o=Number(n[4]||0)-t,a=Number(n[5]||0)-r,c=Number(n[6]||0),d=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return s.call(e,o,a,c,d),e}function yM(n){return n instanceof Date&&!isNaN(n.valueOf())}function i$(n,e){return new oe(2100,!1)}var s$="mediumDate",xM=new ae(""),RM=new ae(""),lf=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,s){if(t==null||t===""||t!==t)return null;try{let o=r??this.defaultOptions?.dateFormat??s$,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return SM(t,o,s||this.locale,a)}catch(o){throw i$(n,o.message)}}static \u0275fac=function(r){return new(r||n)(Be(tf,16),Be(xM,24),Be(RM,24))};static \u0275pipe=HE({name:"date",type:n,pure:!0})}return n})();var Cr=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ps({type:n});static \u0275inj=yi({})}return n})();function ib(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var uf=class{};var kM="browser";var df=class{_doc;constructor(e){this._doc=e}manager},Ry=(()=>{class n extends df{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i,s){return t.addEventListener(r,i,s),()=>this.removeEventListener(t,r,i,s)}removeEventListener(t,r,i,s){return t.removeEventListener(r,i,s)}static \u0275fac=function(r){return new(r||n)(xe(nn))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),My=new ae(""),lb=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(t,r){this._zone=r,t.forEach(o=>{o.manager=this});let i=t.filter(o=>!(o instanceof Ry));this._plugins=i.slice().reverse();let s=t.find(o=>o instanceof Ry);s&&this._plugins.push(s)}addEventListener(t,r,i,s){return this._findPluginFor(r).addEventListener(t,r,i,s)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new oe(5101,!1);return this._eventNameToPlugin.set(t,r),r}static \u0275fac=function(r){return new(r||n)(xe(My),xe(gt))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),ob="ng-app-id";function NM(n){for(let e of n)e.remove()}function MM(n,e){let t=e.createElement("style");return t.textContent=n,t}function a$(n,e,t,r){let i=n.head?.querySelectorAll(`style[${ob}="${e}"],link[${ob}="${e}"]`);if(i)for(let s of i)s.removeAttribute(ob),s instanceof HTMLLinkElement?r.set(s.href.slice(s.href.lastIndexOf("/")+1),{usage:0,elements:[s]}):s.textContent&&t.set(s.textContent,{usage:0,elements:[s]})}function cb(n,e){let t=e.createElement("link");return t.setAttribute("rel","stylesheet"),t.setAttribute("href",n),t}var ub=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,a$(t,r,this.inline,this.external),this.hosts.add(t.head)}addStyles(t,r){for(let i of t)this.addUsage(i,this.inline,MM);r?.forEach(i=>this.addUsage(i,this.external,cb))}removeStyles(t,r){for(let i of t)this.removeUsage(i,this.inline);r?.forEach(i=>this.removeUsage(i,this.external))}addUsage(t,r,i){let s=r.get(t);s?s.usage++:r.set(t,{usage:1,elements:[...this.hosts].map(o=>this.addElement(o,i(t,this.doc)))})}removeUsage(t,r){let i=r.get(t);i&&(i.usage--,i.usage<=0&&(NM(i.elements),r.delete(t)))}ngOnDestroy(){for(let[,{elements:t}]of[...this.inline,...this.external])NM(t);this.hosts.clear()}addHost(t){this.hosts.add(t);for(let[r,{elements:i}]of this.inline)i.push(this.addElement(t,MM(r,this.doc)));for(let[r,{elements:i}]of this.external)i.push(this.addElement(t,cb(r,this.doc)))}removeHost(t){this.hosts.delete(t)}addElement(t,r){return this.nonce&&r.setAttribute("nonce",this.nonce),t.appendChild(r)}static \u0275fac=function(r){return new(r||n)(xe(nn),xe(sy),xe(ay,8),xe(gc))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),ab={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},db=/%COMP%/g;var OM="%COMP%",c$=`_nghost-${OM}`,l$=`_ngcontent-${OM}`,u$=!0,d$=new ae("",{factory:()=>u$});function h$(n){return l$.replace(db,n)}function f$(n){return c$.replace(db,n)}function FM(n,e){return e.map(t=>t.replace(db,n))}var hb=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(t,r,i,s,o,a,c=null,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.ngZone=a,this.nonce=c,this.tracingService=d,this.platformIsServer=!1,this.defaultRenderer=new hf(t,o,a,this.platformIsServer,this.tracingService)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;let i=this.getOrCreateRenderer(t,r);return i instanceof Ny?i.applyToHost(t):i instanceof ff&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let o=this.doc,a=this.ngZone,c=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer,y=this.tracingService;switch(r.encapsulation){case Wr.Emulated:s=new Ny(c,d,r,this.appId,h,o,a,p,y);break;case Wr.ShadowDom:return new ky(c,t,r,o,a,this.nonce,p,y,d);case Wr.ExperimentalIsolatedShadowDom:return new ky(c,t,r,o,a,this.nonce,p,y);default:s=new ff(c,d,r,h,o,a,p,y);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(t){this.rendererByCompId.delete(t)}static \u0275fac=function(r){return new(r||n)(xe(lb),xe(ub),xe(sy),xe(d$),xe(nn),xe(gt),xe(ay),xe(mc,8))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),hf=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(e,t,r,i,s){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.tracingService=s}destroy(){}destroyNode=null;createElement(e,t){return t?this.doc.createElementNS(ab[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(PM(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(PM(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new oe(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=ab[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=ab[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Ci.DashCase|Ci.Important)?e.style.setProperty(t,r,i&Ci.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Ci.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r,i){if(typeof e=="string"&&(e=Er().getGlobalEventTarget(this.doc,e),!e))throw new oe(5102,!1);let s=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(s=this.tracingService.wrapEventListener(e,t,s)),this.eventManager.addEventListener(e,t,s,i)}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;e(t)===!1&&t.preventDefault()}}};function PM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var ky=class extends hf{hostEl;sharedStylesHost;shadowRoot;constructor(e,t,r,i,s,o,a,c,d){super(e,i,s,a,c),this.hostEl=t,this.sharedStylesHost=d,this.shadowRoot=t.attachShadow({mode:"open"}),this.sharedStylesHost&&this.sharedStylesHost.addHost(this.shadowRoot);let h=r.styles;h=FM(r.id,h);for(let y of h){let E=document.createElement("style");o&&E.setAttribute("nonce",o),E.textContent=y,this.shadowRoot.appendChild(E)}let p=r.getExternalStyles?.();if(p)for(let y of p){let E=cb(y,i);o&&E.setAttribute("nonce",o),this.shadowRoot.appendChild(E)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost&&this.sharedStylesHost.removeHost(this.shadowRoot)}},ff=class extends hf{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(e,t,r,i,s,o,a,c,d){super(e,s,o,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i;let h=r.styles;this.styles=d?FM(d,h):h,this.styleUrls=r.getExternalStyles?.(d)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&uc.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Ny=class extends ff{contentAttr;hostAttr;constructor(e,t,r,i,s,o,a,c,d){let h=i+"-"+r.id;super(e,t,r,s,o,a,c,d,h),this.contentAttr=h$(h),this.hostAttr=f$(h)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}};var Py=class n extends rf{supportsDOMEvents=!0;static makeCurrent(){eb(new n)}onAndCancel(e,t,r,i){return e.addEventListener(t,r,i),()=>{e.removeEventListener(t,r,i)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=p$();return t==null?null:g$(t)}resetBaseElement(){pf=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return ib(document.cookie,e)}},pf=null;function p$(){return pf=pf||document.head.querySelector("base"),pf?pf.getAttribute("href"):null}function g$(n){return new URL(n,document.baseURI).pathname}var m$=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})(),VM=["alt","control","meta","shift"],y$={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},v$={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},LM=(()=>{class n extends df{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i,s){let o=n.parseEventName(r),a=n.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Er().onAndCancel(t,o.domEventName,a,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),VM.forEach(d=>{let h=r.indexOf(d);h>-1&&(r.splice(h,1),o+=d+".")}),o+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=o,c}static matchEventFullKeyCode(t,r){let i=y$[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),VM.forEach(o=>{if(o!==i){let a=v$[o];a(t)&&(s+=o+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static \u0275fac=function(r){return new(r||n)(xe(nn))};static \u0275prov=se({token:n,factory:n.\u0275fac})}return n})();function fb(n,e,t){let r=H({rootComponent:n,platformRef:t?.platformRef},_$(e));return dM(r)}function _$(n){return{appProviders:[...C$,...n?.providers??[]],platformProviders:b$}}function w$(){Py.makeCurrent()}function I$(){return new mi}function E$(){return TE(document),document}var b$=[{provide:gc,useValue:kM},{provide:oy,useValue:w$,multi:!0},{provide:nn,useFactory:E$}];var C$=[{provide:xh,useValue:"root"},{provide:mi,useFactory:I$},{provide:My,useClass:Ry,multi:!0},{provide:My,useClass:LM,multi:!0},hb,ub,lb,{provide:hc,useExisting:hb},{provide:uf,useClass:m$},[]];var UM=(()=>{class n{_doc;constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static \u0275fac=function(r){return new(r||n)(xe(nn))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Ie="primary",Df=Symbol("RouteTitle"),vb=class{params;constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Ic(n){return new vb(n)}function KM(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=n[s];if(o[0]===":")i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function jy(n){return new Promise((e,t)=>{n.pipe(is()).subscribe({next:r=>e(r),error:r=>t(r)})})}function S$(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Ai(n[t],e[t]))return!1;return!0}function Ai(n,e){let t=n?_b(n):void 0,r=e?_b(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!QM(n[i],e[i]))return!1;return!0}function _b(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function QM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function YM(n){return n.length>0?n[n.length-1]:null}function bc(n){return tm(n)?n:ko(n)?Pt(Promise.resolve(n)):je(n)}function JM(n){return tm(n)?jy(n):Promise.resolve(n)}var D$={exact:ZM,subset:eP},XM={exact:A$,subset:x$,ignored:()=>!0};function jM(n,e,t){return D$[t.paths](n.root,e.root,t.matrixParams)&&XM[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function A$(n,e){return Ai(n,e)}function ZM(n,e,t){if(!_c(n.segments,e.segments)||!Vy(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!ZM(n.children[r],e.children[r],t))return!1;return!0}function x$(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>QM(n[t],e[t]))}function eP(n,e,t){return tP(n,e,e.segments,t)}function tP(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!_c(i,t)||e.hasChildren()||!Vy(i,t,r))}else if(n.segments.length===t.length){if(!_c(n.segments,t)||!Vy(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!eP(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!_c(n.segments,i)||!Vy(n.segments,i,r)||!n.children[Ie]?!1:tP(n.children[Ie],e,s,r)}}function Vy(n,e,t){return e.every((r,i)=>XM[t](n[i].parameters,r.parameters))}var Yr=class{root;queryParams;fragment;_queryParamMap;constructor(e=new Ye([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Ic(this.queryParams),this._queryParamMap}toString(){return N$.serialize(this)}},Ye=class{segments;children;parent=null;constructor(e,t){this.segments=e,this.children=t,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ly(this)}},Oo=class{path;parameters;_parameterMap;constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Ic(this.parameters),this._parameterMap}toString(){return rP(this)}};function R$(n,e){return _c(n,e)&&n.every((t,r)=>Ai(t.parameters,e[r].parameters))}function _c(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function k$(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Ie&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Ie&&(t=t.concat(e(i,r)))}),t}var Af=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>new Fo,providedIn:"root"})}return n})(),Fo=class{parse(e){let t=new Ib(e);return new Yr(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${gf(e.root,!0)}`,r=O$(e.queryParams),i=typeof e.fragment=="string"?`#${M$(e.fragment)}`:"";return`${t}${r}${i}`}},N$=new Fo;function Ly(n){return n.segments.map(e=>rP(e)).join("/")}function gf(n,e){if(!n.hasChildren())return Ly(n);if(e){let t=n.children[Ie]?gf(n.children[Ie],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==Ie&&r.push(`${i}:${gf(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=k$(n,(r,i)=>i===Ie?[gf(n.children[Ie],!1)]:[`${i}:${gf(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Ie]!=null?`${Ly(n)}/${t[0]}`:`${Ly(n)}/(${t.join("//")})`}}function nP(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Oy(n){return nP(n).replace(/%3B/gi,";")}function M$(n){return encodeURI(n)}function wb(n){return nP(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Uy(n){return decodeURIComponent(n)}function BM(n){return Uy(n.replace(/\+/g,"%20"))}function rP(n){return`${wb(n.path)}${P$(n.parameters)}`}function P$(n){return Object.entries(n).map(([e,t])=>`;${wb(e)}=${wb(t)}`).join("")}function O$(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${Oy(t)}=${Oy(i)}`).join("&"):`${Oy(t)}=${Oy(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var F$=/^[^\/()?;#]+/;function pb(n){let e=n.match(F$);return e?e[0]:""}var V$=/^[^\/()?;=#]+/;function L$(n){let e=n.match(V$);return e?e[0]:""}var U$=/^[^=?&#]+/;function j$(n){let e=n.match(U$);return e?e[0]:""}var B$=/^[^&#]+/;function $$(n){let e=n.match(B$);return e?e[0]:""}var Ib=class{url;remaining;constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ye([],{}):new Ye([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Ie]=new Ye(e,t)),r}parseSegment(){let e=pb(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new oe(4009,!1);return this.capture(e),new Oo(Uy(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=L$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=pb(this.remaining);i&&(r=i,this.capture(r))}e[Uy(t)]=Uy(r)}parseQueryParam(e){let t=j$(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let o=$$(this.remaining);o&&(r=o,this.capture(r))}let i=BM(t),s=BM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=pb(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new oe(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ie);let o=this.parseChildren();t[s??Ie]=Object.keys(o).length===1&&o[Ie]?o[Ie]:new Ye([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new oe(4011,!1)}};function iP(n){return n.segments.length>0?new Ye([],{[Ie]:n}):n}function sP(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=sP(i);if(r===Ie&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new Ye(n.segments,e);return H$(t)}function H$(n){if(n.numberOfChildren===1&&n.children[Ie]){let e=n.children[Ie];return new Ye(n.segments.concat(e.segments),e.children)}return n}function Vo(n){return n instanceof Yr}function oP(n,e,t=null,r=null,i=new Fo){let s=aP(n);return cP(s,e,t,r,i)}function aP(n){let e;function t(s){let o={};for(let c of s.children){let d=t(c);o[c.outlet]=d}let a=new Ye(s.url,o);return s===n&&(e=a),a}let r=t(n.root),i=iP(r);return e??i}function cP(n,e,t,r,i){let s=n;for(;s.parent;)s=s.parent;if(e.length===0)return gb(s,s,s,t,r,i);let o=q$(e);if(o.toRoot())return gb(s,s,new Ye([],{}),t,r,i);let a=z$(o,s,n),c=a.processChildren?yf(a.segmentGroup,a.index,o.commands):uP(a.segmentGroup,a.index,o.commands);return gb(s,a.segmentGroup,c,t,r,i)}function By(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function wf(n){return typeof n=="object"&&n!=null&&n.outlets}function $M(n,e,t){n||="\u0275";let r=new Yr;return r.queryParams={[n]:e},t.parse(t.serialize(r)).queryParams[n]}function gb(n,e,t,r,i,s){let o={};for(let[d,h]of Object.entries(r??{}))o[d]=Array.isArray(h)?h.map(p=>$M(d,p,s)):$M(d,h,s);let a;n===e?a=t:a=lP(n,e,t);let c=iP(sP(a));return new Yr(c,o,i)}function lP(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=lP(s,e,t)}),new Ye(n.segments,r)}var $y=class{isAbsolute;numberOfDoubleDots;commands;constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&By(r[0]))throw new oe(4003,!1);let i=r.find(wf);if(i&&i!==YM(r))throw new oe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function q$(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new $y(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,d])=>{a[c]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new $y(t,e,r)}var mu=class{segmentGroup;processChildren;index;constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function z$(n,e,t){if(n.isAbsolute)return new mu(e,!0,0);if(!t)return new mu(e,!1,NaN);if(t.parent===null)return new mu(t,!0,0);let r=By(n.commands[0])?0:1,i=t.segments.length-1+r;return G$(t,i,n.numberOfDoubleDots)}function G$(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new oe(4005,!1);i=r.segments.length}return new mu(r,!1,i-s)}function W$(n){return wf(n[0])?n[0].outlets:{[Ie]:n}}function uP(n,e,t){if(n??=new Ye([],{}),n.segments.length===0&&n.hasChildren())return yf(n,e,t);let r=K$(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new Ye(n.segments.slice(0,r.pathIndex),{});return s.children[Ie]=new Ye(n.segments.slice(r.pathIndex),n.children),yf(s,0,i)}else return r.match&&i.length===0?new Ye(n.segments,{}):r.match&&!n.hasChildren()?Eb(n,e,t):r.match?yf(n,0,i):Eb(n,e,t)}function yf(n,e,t){if(t.length===0)return new Ye(n.segments,{});{let r=W$(t),i={};if(Object.keys(r).some(s=>s!==Ie)&&n.children[Ie]&&n.numberOfChildren===1&&n.children[Ie].segments.length===0){let s=yf(n.children[Ie],e,t);return new Ye(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=uP(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ye(n.segments,i)}}function K$(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let o=n.segments[i],a=t[r];if(wf(a))break;let c=`${a}`,d=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&d&&typeof d=="object"&&d.outlets===void 0){if(!qM(c,d,o))return s;r+=2}else{if(!qM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Eb(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(wf(s)){let c=Q$(s.outlets);return new Ye(r,c)}if(i===0&&By(t[0])){let c=n.segments[e];r.push(new Oo(c.path,HM(t[0]))),i++;continue}let o=wf(s)?s.outlets[Ie]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&By(a)?(r.push(new Oo(o,HM(a))),i+=2):(r.push(new Oo(o,{})),i++)}return new Ye(r,{})}function Q$(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Eb(new Ye([],{}),0,r))}),e}function HM(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function qM(n,e,t){return n==t.path&&Ai(e,t.parameters)}var vf="imperative",hn=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(hn||{}),lr=class{id;url;constructor(e,t){this.id=e,this.url=t}},Ec=class extends lr{type=hn.NavigationStart;navigationTrigger;restoredState;constructor(e,t,r="imperative",i=null){super(e,t),this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ri=class extends lr{urlAfterRedirects;type=hn.NavigationEnd;constructor(e,t,r){super(e,t),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},$n=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})($n||{}),If=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(If||{}),xi=class extends lr{reason;code;type=hn.NavigationCancel;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},vs=class extends lr{reason;code;type=hn.NavigationSkipped;constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i}},vu=class extends lr{error;target;type=hn.NavigationError;constructor(e,t,r,i){super(e,t),this.error=r,this.target=i}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Ef=class extends lr{urlAfterRedirects;state;type=hn.RoutesRecognized;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hy=class extends lr{urlAfterRedirects;state;type=hn.GuardsCheckStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qy=class extends lr{urlAfterRedirects;state;shouldActivate;type=hn.GuardsCheckEnd;constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},zy=class extends lr{urlAfterRedirects;state;type=hn.ResolveStart;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Gy=class extends lr{urlAfterRedirects;state;type=hn.ResolveEnd;constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wy=class{route;type=hn.RouteConfigLoadStart;constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ky=class{route;type=hn.RouteConfigLoadEnd;constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Qy=class{snapshot;type=hn.ChildActivationStart;constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yy=class{snapshot;type=hn.ChildActivationEnd;constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Jy=class{snapshot;type=hn.ActivationStart;constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Xy=class{snapshot;type=hn.ActivationEnd;constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var bf=class{},_u=class{url;navigationBehaviorOptions;constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function Y$(n){return!(n instanceof bf)&&!(n instanceof _u)}function J$(n,e){return n.providers&&!n._injector&&(n._injector=Yh(n.providers,e,`Route: ${n.path}`)),n._injector??e}function Qr(n){return n.outlet||Ie}function X$(n,e){let t=n.filter(r=>Qr(r)===e);return t.push(...n.filter(r=>Qr(r)!==e)),t}function Eu(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var Zy=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Eu(this.route?.snapshot)??this.rootInjector}constructor(e){this.rootInjector=e,this.children=new bu(this.rootInjector)}},bu=(()=>{class n{rootInjector;contexts=new Map;constructor(t){this.rootInjector=t}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Zy(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static \u0275fac=function(r){return new(r||n)(xe(Ot))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ev=class{_root;constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=bb(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=bb(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Cb(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Cb(e,this._root).map(t=>t.value)}};function bb(n,e){if(n===e.value)return e;for(let t of e.children){let r=bb(n,t);if(r)return r}return null}function Cb(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Cb(n,t);if(r.length)return r.unshift(e),r}return[]}var cr=class{value;children;constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function gu(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Cf=class extends ev{snapshot;constructor(e,t){super(e),this.snapshot=t,Rb(this,e)}toString(){return this.snapshot.toString()}};function dP(n){let e=Z$(n),t=new wn([new Oo("",{})]),r=new wn({}),i=new wn({}),s=new wn({}),o=new wn(""),a=new _s(t,r,s,o,i,Ie,n,e.root);return a.snapshot=e.root,new Cf(new cr(a,[]),e)}function Z$(n){let e={},t={},r={},s=new wc([],e,r,"",t,Ie,n,null,{});return new Tf("",new cr(s,[]))}var _s=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(e,t,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ut(d=>d[Df]))??je(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ut(e=>Ic(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ut(e=>Ic(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function tv(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:H(H({},e.params),n.params),data:H(H({},e.data),n.data),resolve:H(H(H(H({},n.data),e.data),i?.data),n._resolvedData)}:r={params:H({},n.params),data:H({},n.data),resolve:H(H({},n.data),n._resolvedData??{})},i&&fP(i)&&(r.resolve[Df]=i.title),r}var wc=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Df]}constructor(e,t,r,i,s,o,a,c,d){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Ic(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Ic(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Tf=class extends ev{url;constructor(e,t){super(t),this.url=e,Rb(this,t)}toString(){return hP(this._root)}};function Rb(n,e){e.value._routerState=n,e.children.forEach(t=>Rb(n,t))}function hP(n){let e=n.children.length>0?` { ${n.children.map(hP).join(", ")} } `:"";return`${n.value}${e}`}function mb(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Ai(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Ai(e.params,t.params)||n.paramsSubject.next(t.params),S$(e.url,t.url)||n.urlSubject.next(t.url),Ai(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Tb(n,e){let t=Ai(n.params,e.params)&&R$(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Tb(n.parent,e.parent))}function fP(n){return typeof n.title=="string"||n.title===null}var pP=new ae(""),xf=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=Ie;activateEvents=new Dt;deactivateEvents=new Dt;attachEvents=new Dt;detachEvents=new Dt;routerOutletData=uM();parentContexts=j(bu);location=j(Qh);changeDetector=j(yc);inputBinder=j(sv,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new oe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new oe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new oe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new oe(4013,!1);this._activatedRoute=t;let i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Sb(t,a,i.injector,this.routerOutletData);this.activated=i.createComponent(o,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||n)};static \u0275dir=xn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[xo]})}return n})(),Sb=class{route;childContexts;parent;outletData;constructor(e,t,r,i){this.route=e,this.childContexts=t,this.parent=r,this.outletData=i}get(e,t){return e===_s?this.route:e===bu?this.childContexts:e===pP?this.outletData:this.parent.get(e,t)}},sv=new ae("");var kb=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275cmp=Bn({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,i){r&1&&kt(0,"router-outlet")},dependencies:[xf],encapsulation:2})}return n})();function Nb(n){let e=n.children&&n.children.map(Nb),t=e?ce(H({},n),{children:e}):H({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Ie&&(t.component=kb),t}function eH(n,e,t){let r=Sf(n,e._root,t?t._root:void 0);return new Cf(r,e)}function Sf(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=tH(n,e,t);return new cr(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Sf(n,a)),o}}let r=nH(e.value),i=e.children.map(s=>Sf(n,s));return new cr(r,i)}}function tH(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Sf(n,r,i);return Sf(n,r)})}function nH(n){return new _s(new wn(n.url),new wn(n.params),new wn(n.queryParams),new wn(n.fragment),new wn(n.data),n.outlet,n.component,n)}var wu=class{redirectTo;navigationBehaviorOptions;constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},gP="ngNavigationCancelingError";function nv(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Vo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=mP(!1,$n.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function mP(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[gP]=!0,t.cancellationCode=e,t}function rH(n){return yP(n)&&Vo(n.url)}function yP(n){return!!n&&n[gP]}var iH=(n,e,t,r)=>ut(i=>(new Db(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Db=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),mb(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=gu(t);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=gu(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=gu(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=gu(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Xy(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Yy(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(mb(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),mb(a.route.value),this.activateChildRoutes(e,null,o.children)}else o.attachRef=null,o.route=i,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}else this.activateChildRoutes(e,null,r)}},rv=class{path;route;constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},yu=class{component;route;constructor(e,t){this.component=e,this.route=t}};function sH(n,e,t){let r=n._root,i=e?e._root:null;return mf(r,i,t,[r.value])}function oH(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Cu(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!tI(n)?n:e.get(n):r}function mf(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=gu(e);return n.children.forEach(o=>{aH(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>_f(a,t.getContext(o),i)),i}function aH(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=cH(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new rv(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?mf(n,e,a?a.children:null,r,i):mf(n,e,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new yu(a.outlet.component,o))}else o&&_f(e,a,i),i.canActivateChecks.push(new rv(r)),s.component?mf(n,null,a?a.children:null,r,i):mf(n,null,t,r,i);return i}function cH(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!_c(n.url,e.url);case"pathParamsOrQueryParamsChange":return!_c(n.url,e.url)||!Ai(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Tb(n,e)||!Ai(n.queryParams,e.queryParams);case"paramsChange":default:return!Tb(n,e)}}function _f(n,e,t){let r=gu(n),i=n.value;Object.entries(r).forEach(([s,o])=>{i.component?e?_f(o,e.children.getContext(s),t):_f(o,null,t):_f(o,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new yu(e.outlet.component,i)):t.canDeactivateChecks.push(new yu(null,i)):t.canDeactivateChecks.push(new yu(null,i))}function Rf(n){return typeof n=="function"}function lH(n){return typeof n=="boolean"}function uH(n){return n&&Rf(n.canLoad)}function dH(n){return n&&Rf(n.canActivate)}function hH(n){return n&&Rf(n.canActivateChild)}function fH(n){return n&&Rf(n.canDeactivate)}function pH(n){return n&&Rf(n.canMatch)}function vP(n){return n instanceof qa||n?.name==="EmptyError"}var Fy=Symbol("INITIAL_VALUE");function Iu(){return pi(n=>Pw(n.map(e=>e.pipe(rs(1),Lw(Fy)))).pipe(ut(e=>{for(let t of e)if(t!==!0){if(t===Fy)return Fy;if(t===!1||gH(t))return t}return!0}),fi(e=>e!==Fy),rs(1)))}function gH(n){return Vo(n)||n instanceof wu}function _P(n){return n.aborted?je(void 0).pipe(rs(1)):new Me(e=>{let t=()=>{e.next(),e.complete()};return n.addEventListener("abort",t),()=>n.removeEventListener("abort",t)})}function wP(n){return wh(_P(n))}function mH(n,e){return Vn(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return o.length===0&&s.length===0?je(ce(H({},t),{guardsResult:!0})):yH(o,r,i,n).pipe(Vn(a=>a&&lH(a)?vH(r,s,n,e):je(a)),ut(a=>ce(H({},t),{guardsResult:a})))})}function yH(n,e,t,r){return Pt(n).pipe(Vn(i=>bH(i.component,i.route,t,e,r)),is(i=>i!==!0,!0))}function vH(n,e,t,r){return Pt(e).pipe(sm(i=>ql(wH(i.route.parent,r),_H(i.route,r),EH(n,i.path,t),IH(n,i.route,t))),is(i=>i!==!0,!0))}function _H(n,e){return n!==null&&e&&e(new Jy(n)),je(!0)}function wH(n,e){return n!==null&&e&&e(new Qy(n)),je(!0)}function IH(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return je(!0);let i=r.map(s=>vh(()=>{let o=Eu(e)??t,a=Cu(s,o),c=dH(a)?a.canActivate(e,n):tn(o,()=>a(e,n));return bc(c).pipe(is())}));return je(i).pipe(Iu())}function EH(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>oH(o)).filter(o=>o!==null).map(o=>vh(()=>{let a=o.guards.map(c=>{let d=Eu(o.node)??t,h=Cu(c,d),p=hH(h)?h.canActivateChild(r,n):tn(d,()=>h(r,n));return bc(p).pipe(is())});return je(a).pipe(Iu())}));return je(s).pipe(Iu())}function bH(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return je(!0);let o=s.map(a=>{let c=Eu(e)??i,d=Cu(a,c),h=fH(d)?d.canDeactivate(n,e,t,r):tn(c,()=>d(n,e,t,r));return bc(h).pipe(is())});return je(o).pipe(Iu())}function CH(n,e,t,r,i){let s=e.canLoad;if(s===void 0||s.length===0)return je(!0);let o=s.map(a=>{let c=Cu(a,n),d=uH(c)?c.canLoad(e,t):tn(n,()=>c(e,t)),h=bc(d);return i?h.pipe(wP(i)):h});return je(o).pipe(Iu(),IP(r))}function IP(n){return Sw(Ln(e=>{if(typeof e!="boolean")throw nv(n,e)}),ut(e=>e===!0))}function TH(n,e,t,r,i){let s=e.canMatch;if(!s||s.length===0)return je(!0);let o=s.map(a=>{let c=Cu(a,n),d=pH(c)?c.canMatch(e,t):tn(n,()=>c(e,t)),h=bc(d);return i?h.pipe(wP(i)):h});return je(o).pipe(Iu(),IP(r))}var vc=class EP extends Error{segmentGroup;constructor(e){super(),this.segmentGroup=e||null,Object.setPrototypeOf(this,EP.prototype)}},Ab=class bP extends Error{urlTree;constructor(e){super(),this.urlTree=e,Object.setPrototypeOf(this,bP.prototype)}};function SH(n){throw new oe(4e3,!1)}function DH(n){throw mP(!1,$n.GuardRejected)}var AH=class{urlSerializer;urlTree;constructor(e,t){this.urlSerializer=e,this.urlTree=t}async lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return r;if(i.numberOfChildren>1||!i.children[Ie])throw SH(`${e.redirectTo}`);i=i.children[Ie]}}async applyRedirectCommands(e,t,r,i,s){let o=await xH(t,i,s);if(o instanceof Yr)throw new Ab(o);let a=this.applyRedirectCreateUrlTree(o,this.urlSerializer.parse(o),e,r);if(o[0]==="/")throw new Ab(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Yr(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),o={};return Object.entries(t.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ye(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new oe(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}};function xH(n,e,t){if(typeof n=="string")return Promise.resolve(n);let r=n,{queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,params:d,data:h,title:p}=e;return jy(bc(tn(t,()=>r({params:d,data:h,queryParams:i,fragment:s,routeConfig:o,url:a,outlet:c,title:p}))))}var xb={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function RH(n,e,t,r,i,s){let o=CP(n,e,t);return o.matched?(r=J$(e,r),TH(r,e,t,i,s).pipe(ut(a=>a===!0?o:H({},xb)))):je(o)}function CP(n,e,t){if(e.path==="**")return kH(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?H({},xb):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||KM)(t,n,e);if(!i)return H({},xb);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?H(H({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function kH(n){return{matched:!0,parameters:n.length>0?YM(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function zM(n,e,t,r){return t.length>0&&PH(n,t,r)?{segmentGroup:new Ye(e,MH(r,new Ye(t,n.children))),slicedSegments:[]}:t.length===0&&OH(n,t,r)?{segmentGroup:new Ye(n.segments,NH(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new Ye(n.segments,n.children),slicedSegments:t}}function NH(n,e,t,r){let i={};for(let s of t)if(ov(n,e,s)&&!r[Qr(s)]){let o=new Ye([],{});i[Qr(s)]=o}return H(H({},r),i)}function MH(n,e){let t={};t[Ie]=e;for(let r of n)if(r.path===""&&Qr(r)!==Ie){let i=new Ye([],{});t[Qr(r)]=i}return t}function PH(n,e,t){return t.some(r=>ov(n,e,r)&&Qr(r)!==Ie)}function OH(n,e,t){return t.some(r=>ov(n,e,r))}function ov(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function FH(n,e,t){return e.length===0&&!n.children[t]}var VH=class{};async function LH(n,e,t,r,i,s,o="emptyOnly",a){return new jH(n,e,t,r,i,o,s,a).recognize()}var UH=31,jH=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;abortSignal;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(e,t,r,i,s,o,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.abortSignal=c,this.applyRedirects=new AH(this.urlSerializer,this.urlTree)}noMatchError(e){return new oe(4002,`'${e.segmentGroup}'`)}async recognize(){let e=zM(this.urlTree.root,[],[],this.config).segmentGroup,{children:t,rootSnapshot:r}=await this.match(e),i=new cr(r,t),s=new Tf("",i),o=oP(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),{state:s,tree:o}}async match(e){let t=new wc([],Object.freeze({}),Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Ie,this.rootComponentType,null,{});try{return{children:await this.processSegmentGroup(this.injector,this.config,e,Ie,t),rootSnapshot:t}}catch(r){if(r instanceof Ab)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof vc?this.noMatchError(r):r}}async processSegmentGroup(e,t,r,i,s){if(r.segments.length===0&&r.hasChildren())return this.processChildren(e,t,r,s);let o=await this.processSegment(e,t,r,r.segments,i,!0,s);return o instanceof cr?[o]:[]}async processChildren(e,t,r,i){let s=[];for(let c of Object.keys(r.children))c==="primary"?s.unshift(c):s.push(c);let o=[];for(let c of s){let d=r.children[c],h=X$(t,c),p=await this.processSegmentGroup(e,h,d,c,i);o.push(...p)}let a=TP(o);return BH(a),a}async processSegment(e,t,r,i,s,o,a){for(let c of t)try{return await this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,o,a)}catch(d){if(d instanceof vc||vP(d))continue;throw d}if(FH(r,i,s))return new VH;throw new vc(r)}async processSegmentAgainstRoute(e,t,r,i,s,o,a,c){if(Qr(r)!==o&&(o===Ie||!ov(i,s,r)))throw new vc(i);if(r.redirectTo===void 0)return this.matchSegmentAgainstRoute(e,i,r,s,o,c);if(this.allowRedirects&&a)return this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o,c);throw new vc(i)}async expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o,a){let{matched:c,parameters:d,consumedSegments:h,positionalParamSegments:p,remainingSegments:y}=CP(t,i,s);if(!c)throw new vc(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>UH&&(this.allowRedirects=!1));let E=new wc(s,d,Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,GM(i),Qr(i),i.component??i._loadedComponent??null,i,WM(i)),k=tv(E,a,this.paramsInheritanceStrategy);if(E.params=Object.freeze(k.params),E.data=Object.freeze(k.data),this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let P=await this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,E,e),M=await this.applyRedirects.lineralizeSegments(i,P);return this.processSegment(e,r,t,M.concat(y),o,!1,a)}async matchSegmentAgainstRoute(e,t,r,i,s,o){if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);let a=await jy(RH(t,r,i,e,this.urlSerializer,this.abortSignal));if(r.path==="**"&&(t.children={}),!a?.matched)throw new vc(t);e=r._injector??e;let{routes:c}=await this.getChildConfig(e,r,i),d=r._loadedInjector??e,{parameters:h,consumedSegments:p,remainingSegments:y}=a,E=new wc(p,h,Object.freeze(H({},this.urlTree.queryParams)),this.urlTree.fragment,GM(r),Qr(r),r.component??r._loadedComponent??null,r,WM(r)),k=tv(E,o,this.paramsInheritanceStrategy);E.params=Object.freeze(k.params),E.data=Object.freeze(k.data);let{segmentGroup:P,slicedSegments:M}=zM(t,p,y,c);if(M.length===0&&P.hasChildren()){let ee=await this.processChildren(d,c,P,E);return new cr(E,ee)}if(c.length===0&&M.length===0)return new cr(E,[]);let $=Qr(r)===s,Y=await this.processSegment(d,c,P,M,$?Ie:s,!0,E);return new cr(E,Y instanceof cr?[Y]:[])}async getChildConfig(e,t,r){if(t.children)return{routes:t.children,injector:e};if(t.loadChildren){if(t._loadedRoutes!==void 0)return{routes:t._loadedRoutes,injector:t._loadedInjector};if(this.abortSignal.aborted)throw new Error(this.abortSignal.reason);if(await jy(CH(e,t,r,this.urlSerializer,this.abortSignal))){let s=await this.configLoader.loadChildren(e,t);return t._loadedRoutes=s.routes,t._loadedInjector=s.injector,s}throw DH(t)}return{routes:[],injector:e}}};function BH(n){n.sort((e,t)=>e.value.outlet===Ie?-1:t.value.outlet===Ie?1:e.value.outlet.localeCompare(t.value.outlet))}function $H(n){let e=n.value.routeConfig;return e&&e.path===""}function TP(n){let e=[],t=new Set;for(let r of n){if(!$H(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=TP(r.children);e.push(new cr(r.value,i))}return e.filter(r=>!t.has(r))}function GM(n){return n.data||{}}function WM(n){return n.resolve||{}}var HH=new ae("",{factory:()=>LH});function qH(n,e,t,r,i,s,o){let a=n.get(HH);return Vn(c=>je(c).pipe(pi(d=>a(n,e,t,r,d.extractedUrl,i,s,o)),ut(({state:d,tree:h})=>ce(H({},c),{targetSnapshot:d,urlAfterRedirects:h}))))}function zH(n,e){return Vn(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return je(t);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let d of SP(c))o.add(d);let a=0;return Pt(o).pipe(sm(c=>s.has(c)?GH(c,r,n,e):(c.data=tv(c,c.parent,n).resolve,je(void 0))),Ln(()=>a++),om(1),Vn(c=>a===o.size?je(t):Wn))})}function SP(n){let e=n.children.map(t=>SP(t)).flat();return[n,...e]}function GH(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!fP(i)&&(s[Df]=i.title),vh(()=>(n.data=tv(n,n.parent,t).resolve,WH(s,n,e,r).pipe(ut(o=>(n._resolvedData=o,n.data=H(H({},n.data),o),null)))))}function WH(n,e,t,r){let i=_b(n);if(i.length===0)return je({});let s={};return Pt(i).pipe(Vn(o=>KH(n[o],e,t,r).pipe(is(),Ln(a=>{if(a instanceof wu)throw nv(new Fo,a);s[o]=a}))),om(1),ut(()=>s),_h(o=>vP(o)?Wn:Mw(o)))}function KH(n,e,t,r){let i=Eu(e)??r,s=Cu(n,i),o=s.resolve?s.resolve(e,t):tn(i,()=>s(e,t));return bc(o)}function yb(n){return pi(e=>{let t=n(e);return t?Pt(t).pipe(ut(()=>e)):je(e)})}var Mb=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===Ie);return r}getResolvedTitleForRoute(t){return t.data[Df]}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>j(DP),providedIn:"root"})}return n})(),DP=(()=>{class n extends Mb{title;constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||n)(xe(UM))};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Tu=new ae("",{factory:()=>({})}),kf=new ae(""),AP=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=j(JE);async loadComponent(t,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return Promise.resolve(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await JM(tn(t,()=>r.loadComponent())),o=await kP(RP(s));return this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o,o}finally{this.componentLoaders.delete(r)}})();return this.componentLoaders.set(r,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Promise.resolve({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let i=(async()=>{try{let s=await xP(r,this.compiler,t,this.onLoadEndListener);return r._loadedRoutes=s.routes,r._loadedInjector=s.injector,s}finally{this.childrenLoaders.delete(r)}})();return this.childrenLoaders.set(r,i),i}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();async function xP(n,e,t,r){let i=await JM(tn(t,()=>n.loadChildren())),s=await kP(RP(i)),o;s instanceof yy||Array.isArray(s)?o=s:o=await e.compileModuleAsync(s),r&&r(n);let a,c,d=!1;return Array.isArray(o)?(c=o,d=!0):(a=o.create(t).injector,c=a.get(kf,[],{optional:!0,self:!0}).flat()),{routes:c.map(Nb),injector:a}}function QH(n){return n&&typeof n=="object"&&"default"in n}function RP(n){return QH(n)?n.default:n}async function kP(n){return n}var av=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>j(YH),providedIn:"root"})}return n})(),YH=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),NP=new ae("");var JH=()=>{},MP=new ae(""),PP=(()=>{class n{currentNavigation=Se(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=Se(null);events=new en;transitionAbortWithErrorSubject=new en;configLoader=j(AP);environmentInjector=j(Ot);destroyRef=j(Ir);urlSerializer=j(Af);rootContexts=j(bu);location=j(pu);inputBindingEnabled=j(sv,{optional:!0})!==null;titleStrategy=j(Mb);options=j(Tu,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=j(av);createViewTransition=j(NP,{optional:!0});navigationErrorHandler=j(MP,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>je(void 0);rootComponentType=null;destroyed=!1;constructor(){let t=i=>this.events.next(new Wy(i)),r=i=>this.events.next(new Ky(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;rn(()=>{this.transitions?.next(ce(H({},t),{extractedUrl:this.urlHandlingStrategy.extract(t.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:r}))})}setupNavigations(t){return this.transitions=new wn(null),this.transitions.pipe(fi(r=>r!==null),pi(r=>{let i=!1,s=new AbortController;return je(r).pipe(pi(o=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",$n.SupersededByNewNavigation),Wn;this.currentTransition=r;let a=this.lastSuccessfulNavigation();this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:a?ce(H({},a),{previousNavigation:null}):null,abort:()=>s.abort()});let c=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=o.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!c&&d!=="reload")return this.events.next(new vs(o.id,this.urlSerializer.serialize(o.rawUrl),"",If.IgnoredSameUrlNavigation)),o.resolve(!1),Wn;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return je(o).pipe(pi(h=>(this.events.next(new Ec(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),h.id!==this.navigationId?Wn:Promise.resolve(h))),qH(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy,s.signal),Ln(h=>{r.targetSnapshot=h.targetSnapshot,r.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation.update(y=>(y.finalUrl=h.urlAfterRedirects,y));let p=new Ef(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(p)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:h,extractedUrl:p,source:y,restoredState:E,extras:k}=o,P=new Ec(h,this.urlSerializer.serialize(p),y,E);this.events.next(P);let M=dP(this.rootComponentType).snapshot;return this.currentTransition=r=ce(H({},o),{targetSnapshot:M,urlAfterRedirects:p,extras:ce(H({},k),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update($=>($.finalUrl=p,$)),je(r)}else return this.events.next(new vs(o.id,this.urlSerializer.serialize(o.extractedUrl),"",If.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Wn}),Ln(o=>{let a=new Hy(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),ut(o=>(this.currentTransition=r=ce(H({},o),{guards:sH(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),r)),mH(this.environmentInjector,o=>this.events.next(o)),Ln(o=>{if(r.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw nv(this.urlSerializer,o.guardsResult);let a=new qy(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),fi(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",$n.GuardRejected),!1)),yb(o=>{if(o.guards.canActivateChecks.length!==0)return je(o).pipe(Ln(a=>{let c=new zy(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}),pi(a=>{let c=!1;return je(a).pipe(zH(this.paramsInheritanceStrategy,this.environmentInjector),Ln({next:()=>c=!0,complete:()=>{c||this.cancelNavigationTransition(a,"",$n.NoDataFromResolver)}}))}),Ln(a=>{let c=new Gy(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(c)}))}),yb(o=>{let a=d=>{let h=[];if(d.routeConfig?._loadedComponent)d.component=d.routeConfig?._loadedComponent;else if(d.routeConfig?.loadComponent){let p=Eu(d)??this.environmentInjector;h.push(this.configLoader.loadComponent(p,d.routeConfig).then(y=>{d.component=y}))}for(let p of d.children)h.push(...a(p));return h},c=a(o.targetSnapshot.root);return c.length===0?je(o):Pt(Promise.all(c).then(()=>o))}),yb(()=>this.afterPreactivation()),pi(()=>{let{currentSnapshot:o,targetSnapshot:a}=r,c=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return c?Pt(c).pipe(ut(()=>r)):je(r)}),ut(o=>{let a=eH(t.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=r=ce(H({},o),{targetRouterState:a}),this.currentNavigation.update(c=>(c.targetRouterState=a,c)),r}),Ln(()=>{this.events.next(new bf)}),iH(this.rootContexts,t.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),rs(1),wh(_P(s.signal).pipe(fi(()=>!i&&!r.targetRouterState),Ln(()=>{this.cancelNavigationTransition(r,s.signal.reason+"",$n.Aborted)}))),Ln({next:o=>{i=!0,this.currentNavigation.update(a=>(a.abort=JH,a)),this.lastSuccessfulNavigation.set(rn(this.currentNavigation)),this.events.next(new Ri(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{i=!0}}),wh(this.transitionAbortWithErrorSubject.pipe(Ln(o=>{throw o}))),Vw(()=>{s.abort(),i||this.cancelNavigationTransition(r,"",$n.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),_h(o=>{if(this.destroyed)return r.resolve(!1),Wn;if(i=!0,yP(o))this.events.next(new xi(r.id,this.urlSerializer.serialize(r.extractedUrl),o.message,o.cancellationCode)),rH(o)?this.events.next(new _u(o.url,o.navigationBehaviorOptions)):r.resolve(!1);else{let a=new vu(r.id,this.urlSerializer.serialize(r.extractedUrl),o,r.targetSnapshot??void 0);try{let c=tn(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(c instanceof wu){let{message:d,cancellationCode:h}=nv(this.urlSerializer,c);this.events.next(new xi(r.id,this.urlSerializer.serialize(r.extractedUrl),d,h)),this.events.next(new _u(c.redirectTo,c.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(c){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(c)}}return Wn}))}))}cancelNavigationTransition(t,r,i){let s=new xi(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=rn(this.currentNavigation),i=r?.targetBrowserUrl??r?.extractedUrl;return t.toString()!==i?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function XH(n){return n!==vf}var OP=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>j(ZH),providedIn:"root"})}return n})(),iv=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},ZH=(()=>{class n extends iv{static \u0275fac=(()=>{let t;return function(i){return(t||(t=hs(n)))(i||n)}})();static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Pb=(()=>{class n{urlSerializer=j(Af);options=j(Tu,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=j(pu);urlHandlingStrategy=j(av);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Yr;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:t,initialUrl:r,targetBrowserUrl:i}){let s=t!==void 0?this.urlHandlingStrategy.merge(t,r):r,o=i??s;return o instanceof Yr?this.urlSerializer.serialize(o):o}commitTransition({targetRouterState:t,finalUrl:r,initialUrl:i}){r&&t?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,i),this.routerState=t):this.rawUrlTree=i}routerState=dP(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:t}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t??this.rawUrlTree)}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:()=>j(FP),providedIn:"root"})}return n})(),FP=(()=>{class n extends Pb{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&setTimeout(()=>{t(r.url,r.state,"popstate")})})}handleRouterEvent(t,r){t instanceof Ec?this.updateStateMemento():t instanceof vs?this.commitTransition(r):t instanceof Ef?this.urlUpdateStrategy==="eager"&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof bf?(this.commitTransition(r),this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):t instanceof xi&&t.code!==$n.SupersededByNewNavigation&&t.code!==$n.Redirect?this.restoreHistory(r):t instanceof vu?this.restoreHistory(r,!0):t instanceof Ri&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,{extras:r,id:i}){let{replaceUrl:s,state:o}=r;if(this.location.isCurrentPathEqualTo(t)||s){let a=this.browserPageId,c=H(H({},o),this.generateNgRouterState(i,a));this.location.replaceState(t,"",c)}else{let a=H(H({},o),this.generateNgRouterState(i,this.browserPageId+1));this.location.go(t,"",a)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.getCurrentUrlTree()===t.finalUrl&&s===0&&(this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetInternalState(t),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static \u0275fac=(()=>{let t;return function(i){return(t||(t=hs(n)))(i||n)}})();static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ob(n,e){n.events.pipe(fi(t=>t instanceof Ri||t instanceof xi||t instanceof vu||t instanceof vs),ut(t=>t instanceof Ri||t instanceof vs?0:(t instanceof xi?t.code===$n.Redirect||t.code===$n.SupersededByNewNavigation:!1)?2:1),fi(t=>t!==2),rs(1)).subscribe(()=>{e()})}var e8={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},t8={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Nf=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=j(qE);stateManager=j(Pb);options=j(Tu,{optional:!0})||{};pendingTasks=j(ds);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=j(PP);urlSerializer=j(Af);location=j(pu);urlHandlingStrategy=j(av);injector=j(Ot);_events=new en;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=j(OP);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=j(kf,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!j(sv,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}eventsSubscription=new Zt;subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=rn(this.navigationTransitions.currentNavigation);if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof xi&&r.code!==$n.Redirect&&r.code!==$n.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Ri)this.navigated=!0;else if(r instanceof _u){let o=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=H({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||XH(i.source)},o);this.scheduleNavigation(a,vf,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}Y$(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortWithErrorSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),vf,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r,i)=>{this.navigateToSyncWithBrowser(t,i,r)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){let c=H({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s).catch(c=>{this.disposed||this.injector.get(sr)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return rn(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Nb),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:c}=r,d=c?this.currentUrlTree.fragment:o,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=H(H({},this.currentUrlTree.queryParams),s);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=s||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let y=i?i.snapshot:this.routerState.snapshot.root;p=aP(y)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return cP(p,t,h,d??null,this.urlSerializer)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Vo(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,vf,null,r)}navigate(t,r={skipLocationChange:!1}){return n8(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.console.warn(Wl(4018,!1)),this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=H({},e8):r===!1?i=H({},t8):i=r,Vo(t))return jM(this.currentUrlTree,t,i);let s=this.parseUrl(t);return jM(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,c,d;o?(a=o.resolve,c=o.reject,d=o.promise):d=new Promise((p,y)=>{a=p,c=y});let h=this.pendingTasks.add();return Ob(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:a,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function n8(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new oe(4008,!1)}var cv=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=Se(null);get href(){return rn(this.reactiveHref)}set href(t){this.reactiveHref.set(t)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new en;applicationErrorHandler=j(sr);options=j(Tu,{optional:!0});constructor(t,r,i,s,o,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.reactiveHref.set(j(new Ey("href"),{optional:!0}));let c=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let t=this.preserveFragment,r=i=>i==="merge"||i==="preserve";t||=r(this.queryParamsHandling),t||=!this.queryParamsHandling&&!r(this.options?.defaultQueryParamsHandling),t&&(this.subscription=this.router.events.subscribe(i=>{i instanceof Ri&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Vo(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,s,o){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||s||o||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c)?.catch(d=>{this.applicationErrorHandler(d)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.reactiveHref.set(t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t))??"":null)}applyAttributeValue(t,r){let i=this.renderer,s=this.el.nativeElement;r!==null?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return this.routerLinkInput===null?null:Vo(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(r){return new(r||n)(Be(Nf),Be(_s),Gh("tabindex"),Be(fs),Be(Si),Be(fu))};static \u0275dir=xn({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(r,i){r&1&&Q("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),r&2&&Jh("href",i.reactiveHref(),AE)("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",hu],skipLocationChange:[2,"skipLocationChange","skipLocationChange",hu],replaceUrl:[2,"replaceUrl","replaceUrl",hu],routerLink:"routerLink"},features:[xo]})}return n})();var i8=new ae("");function Fb(n,...e){return nr([{provide:kf,multi:!0,useValue:n},[],{provide:_s,useFactory:s8},{provide:vy,multi:!0,useFactory:o8},e.map(t=>t.\u0275providers)])}function s8(){return j(Nf).routerState.root}function o8(){let n=j(At);return e=>{let t=n.get(No);if(e!==t.components[0])return;let r=n.get(Nf),i=n.get(a8);n.get(c8)===1&&r.initialNavigation(),n.get(l8,null,{optional:!0})?.setUpPreloading(),n.get(i8,null,{optional:!0})?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var a8=new ae("",{factory:()=>new en}),c8=new ae("",{factory:()=>1});var l8=new ae("");var VP=()=>{};var jP=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},u8=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},lv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,h=s>>2,p=(s&3)<<4|a>>4,y=(a&15)<<2|d>>6,E=d&63;c||(E=64,o||(y=64)),r.push(t[h],t[p],t[y],t[E])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jP(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):u8(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||d==null||p==null)throw new Lb;let y=s<<2|a>>4;if(r.push(y),d!==64){let E=a<<4&240|d>>2;if(r.push(E),p!==64){let k=d<<6&192|p;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Lb=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},d8=function(n){let e=jP(n);return lv.encodeByteArray(e,!0)},Pf=function(n){return d8(n).replace(/\./g,"")},uv=function(n){try{return lv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function jb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var h8=()=>jb().__FIREBASE_DEFAULTS__,f8=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},p8=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&uv(n[1]);return e&&JSON.parse(e)},dv=()=>{try{return VP()||h8()||f8()||p8()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Bb=n=>{var e,t;return(t=(e=dv())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},BP=n=>{let e=Bb(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},$b=()=>{var n;return(n=dv())===null||n===void 0?void 0:n.config},Hb=n=>{var e;return(e=dv())===null||e===void 0?void 0:e[`_${n}`]};var Cc=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Lo(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function hv(n){return(await fetch(n,{credentials:"include"})).ok}function $P(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Pf(JSON.stringify(t)),Pf(JSON.stringify(o)),""].join(".")}var Mf={};function g8(){let n={prod:[],emulator:[]};for(let e of Object.keys(Mf))Mf[e]?n.emulator.push(e):n.prod.push(e);return n}function m8(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var LP=!1;function fv(n,e){if(typeof window>"u"||typeof document>"u"||!Lo(window.location.host)||Mf[n]===e||Mf[n]||LP)return;Mf[n]=e;function t(y){return`__firebase__banner__${y}`}let r="__firebase__banner",s=g8().prod.length>0;function o(){let y=document.getElementById(r);y&&y.remove()}function a(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function c(y,E){y.setAttribute("width","24"),y.setAttribute("id",E),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){let y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{LP=!0,o()},y}function h(y,E){y.setAttribute("id",E),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){let y=m8(r),E=t("text"),k=document.getElementById(E)||document.createElement("span"),P=t("learnmore"),M=document.getElementById(P)||document.createElement("a"),$=t("preprendIcon"),Y=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){let ee=y.element;a(ee),h(M,P);let Ce=d();c(Y,$),ee.append(Y,k,M,Ce),document.body.appendChild(ee)}s?(k.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function fn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HP(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fn())}function y8(){var n;let e=(n=dv())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function qP(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function zP(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function GP(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WP(){let n=fn();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function KP(){return!y8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Of(){try{return typeof indexedDB=="object"}catch{return!1}}function QP(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var v8="FirebaseError",ur=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=v8,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Jr.prototype.create)}},Jr=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?_8(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new ur(i,a,r)}};function _8(n,e){return n.replace(w8,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var w8=/\{\$([^}]+)}/g;function YP(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ki(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(UP(s)&&UP(o)){if(!ki(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function UP(n){return n!==null&&typeof n=="object"}function Ff(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function JP(n,e){let t=new Ub(n,e);return t.subscribe.bind(t)}var Ub=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");I8(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Vb),i.error===void 0&&(i.error=Vb),i.complete===void 0&&(i.complete=Vb);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function I8(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Vb(){}var Fme=14400*1e3;function an(n){return n&&n._delegate?n._delegate:n}var Hn=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Tc="[DEFAULT]";var qb=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Cc;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(b8(e))try{this.getOrInitializeService({instanceIdentifier:Tc})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Tc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Tc){return this.instances.has(e)}getOptions(e=Tc){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:E8(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Tc){return this.component?this.component.multipleInstances?e:Tc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function E8(n){return n===Tc?void 0:n}function b8(n){return n.instantiationMode==="EAGER"}var pv=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new qb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var C8=[],Fe=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})(Fe||{}),T8={debug:Fe.DEBUG,verbose:Fe.VERBOSE,info:Fe.INFO,warn:Fe.WARN,error:Fe.ERROR,silent:Fe.SILENT},S8=Fe.INFO,D8={[Fe.DEBUG]:"log",[Fe.VERBOSE]:"log",[Fe.INFO]:"info",[Fe.WARN]:"warn",[Fe.ERROR]:"error"},A8=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=D8[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ni=class{constructor(e){this.name=e,this._logLevel=S8,this._logHandler=A8,this._userLogHandler=null,C8.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Fe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?T8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Fe.DEBUG,...e),this._logHandler(this,Fe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Fe.VERBOSE,...e),this._logHandler(this,Fe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Fe.INFO,...e),this._logHandler(this,Fe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Fe.WARN,...e),this._logHandler(this,Fe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Fe.ERROR,...e),this._logHandler(this,Fe.ERROR,...e)}};var x8=(n,e)=>e.some(t=>n instanceof t),XP,ZP;function R8(){return XP||(XP=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function k8(){return ZP||(ZP=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var eO=new WeakMap,Gb=new WeakMap,tO=new WeakMap,zb=new WeakMap,Kb=new WeakMap;function N8(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Mi(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&eO.set(t,n)}).catch(()=>{}),Kb.set(e,n),e}function M8(n){if(Gb.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Gb.set(n,e)}var Wb={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Gb.get(n);if(e==="objectStoreNames")return n.objectStoreNames||tO.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Mi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nO(n){Wb=n(Wb)}function P8(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(gv(this),e,...t);return tO.set(r,e.sort?e.sort():[e]),Mi(r)}:k8().includes(n)?function(...e){return n.apply(gv(this),e),Mi(eO.get(this))}:function(...e){return Mi(n.apply(gv(this),e))}}function O8(n){return typeof n=="function"?P8(n):(n instanceof IDBTransaction&&M8(n),x8(n,R8())?new Proxy(n,Wb):n)}function Mi(n){if(n instanceof IDBRequest)return N8(n);if(zb.has(n))return zb.get(n);let e=O8(n);return e!==n&&(zb.set(n,e),Kb.set(e,n)),e}var gv=n=>Kb.get(n);function mv(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=Mi(o);return r&&o.addEventListener("upgradeneeded",c=>{r(Mi(o.result),c.oldVersion,c.newVersion,Mi(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),a}var F8=["get","getKey","getAll","getAllKeys","count"],V8=["put","add","delete","clear"],Qb=new Map;function rO(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Qb.get(e))return Qb.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=V8.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||F8.includes(t)))return;let s=async function(o,...a){let c=this.transaction(o,i?"readwrite":"readonly"),d=c.store;return r&&(d=d.index(a.shift())),(await Promise.all([d[t](...a),i&&c.done]))[0]};return Qb.set(e,s),s}nO(n=>ce(H({},n),{get:(e,t,r)=>rO(e,t)||n.get(e,t,r),has:(e,t)=>!!rO(e,t)||n.has(e,t)}));var Jb=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(L8(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function L8(n){let e=n.getComponent();return e?.type==="VERSION"}var Xb="@firebase/app",iO="0.13.2";var ws=new Ni("@firebase/app"),U8="@firebase/app-compat",j8="@firebase/analytics-compat",B8="@firebase/analytics",$8="@firebase/app-check-compat",H8="@firebase/app-check",q8="@firebase/auth",z8="@firebase/auth-compat",G8="@firebase/database",W8="@firebase/data-connect",K8="@firebase/database-compat",Q8="@firebase/functions",Y8="@firebase/functions-compat",J8="@firebase/installations",X8="@firebase/installations-compat",Z8="@firebase/messaging",eq="@firebase/messaging-compat",tq="@firebase/performance",nq="@firebase/performance-compat",rq="@firebase/remote-config",iq="@firebase/remote-config-compat",sq="@firebase/storage",oq="@firebase/storage-compat",aq="@firebase/firestore",cq="@firebase/ai",lq="@firebase/firestore-compat",uq="firebase",dq="11.10.0";var Zb="[DEFAULT]",hq={[Xb]:"fire-core",[U8]:"fire-core-compat",[B8]:"fire-analytics",[j8]:"fire-analytics-compat",[H8]:"fire-app-check",[$8]:"fire-app-check-compat",[q8]:"fire-auth",[z8]:"fire-auth-compat",[G8]:"fire-rtdb",[W8]:"fire-data-connect",[K8]:"fire-rtdb-compat",[Q8]:"fire-fn",[Y8]:"fire-fn-compat",[J8]:"fire-iid",[X8]:"fire-iid-compat",[Z8]:"fire-fcm",[eq]:"fire-fcm-compat",[tq]:"fire-perf",[nq]:"fire-perf-compat",[rq]:"fire-rc",[iq]:"fire-rc-compat",[sq]:"fire-gcs",[oq]:"fire-gcs-compat",[aq]:"fire-fst",[lq]:"fire-fst-compat",[cq]:"fire-vertex","fire-js":"fire-js",[uq]:"fire-js-all"};var Vf=new Map,fq=new Map,eC=new Map;function sO(n,e){try{n.container.addComponent(e)}catch(t){ws.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Xr(n){let e=n.name;if(eC.has(e))return ws.debug(`There were multiple attempts to register component ${e}.`),!1;eC.set(e,n);for(let t of Vf.values())sO(t,n);for(let t of fq.values())sO(t,n);return!0}function Su(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Tr(n){return n==null?!1:n.settings!==void 0}var pq={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Uo=new Jr("app","Firebase",pq);var tC=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Hn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Uo.create("app-deleted",{appName:this._name})}};var jo=dq;function iC(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Zb,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Uo.create("bad-app-name",{appName:String(i)});if(t||(t=$b()),!t)throw Uo.create("no-options");let s=Vf.get(i);if(s){if(ki(t,s.options)&&ki(r,s.config))return s;throw Uo.create("duplicate-app",{appName:i})}let o=new pv(i);for(let c of eC.values())o.addComponent(c);let a=new tC(t,r,o);return Vf.set(i,a),a}function Sc(n=Zb){let e=Vf.get(n);if(!e&&n===Zb&&$b())return iC();if(!e)throw Uo.create("no-app",{appName:n});return e}function yv(){return Array.from(Vf.values())}function bt(n,e,t){var r;let i=(r=hq[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ws.warn(a.join(" "));return}Xr(new Hn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var gq="firebase-heartbeat-database",mq=1,Lf="firebase-heartbeat-store",Yb=null;function lO(){return Yb||(Yb=mv(gq,mq,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Lf)}catch(t){console.warn(t)}}}}).catch(n=>{throw Uo.create("idb-open",{originalErrorMessage:n.message})})),Yb}async function yq(n){try{let t=(await lO()).transaction(Lf),r=await t.objectStore(Lf).get(uO(n));return await t.done,r}catch(e){if(e instanceof ur)ws.warn(e.message);else{let t=Uo.create("idb-get",{originalErrorMessage:e?.message});ws.warn(t.message)}}}async function oO(n,e){try{let r=(await lO()).transaction(Lf,"readwrite");await r.objectStore(Lf).put(e,uO(n)),await r.done}catch(t){if(t instanceof ur)ws.warn(t.message);else{let r=Uo.create("idb-set",{originalErrorMessage:t?.message});ws.warn(r.message)}}}function uO(n){return`${n.name}!${n.options.appId}`}var vq=1024,_q=30,nC=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new rC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=aO();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>_q){let o=Iq(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ws.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=aO(),{heartbeatsToSend:r,unsentEntries:i}=wq(this._heartbeatsCache.heartbeats),s=Pf(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ws.warn(t),""}}};function aO(){return new Date().toISOString().substring(0,10)}function wq(n,e=vq){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),cO(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),cO(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var rC=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Of()?QP().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await yq(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return oO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return oO(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function cO(n){return Pf(JSON.stringify({version:2,heartbeats:n})).length}function Iq(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function Eq(n){Xr(new Hn("platform-logger",e=>new Jb(e),"PRIVATE")),Xr(new Hn("heartbeat",e=>new nC(e),"PRIVATE")),bt(Xb,iO,n),bt(Xb,iO,"esm2017"),bt("fire-js","")}Eq("");var bq="firebase",Cq="11.10.0";bt(bq,Cq,"app");function dO(n){n===void 0&&(n=j(At));let e=n.get(eu);return t=>new Me(r=>{let i=e.add(),s=!1;function o(){s||(i(),s=!0)}let a=t.subscribe({next:c=>{r.next(c),o()},complete:()=>{r.complete(),o()},error:c=>{r.error(c),o()}});return a.add(()=>{r.unsubscribe(),o()}),a})}var Bo=new Ga("ANGULARFIRE2_VERSION");function Uf(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(o=>o.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var Au=(n,e)=>{let t=e?[e]:yv(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Du=(function(n){return n[n.SILENT=0]="SILENT",n[n.WARN=1]="WARN",n[n.VERBOSE=2]="VERBOSE",n})(Du||{}),hO=ZE()&&typeof Zone<"u"?Du.WARN:Du.SILENT;var vv=class{zone;delegate;constructor(e,t=kw){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(o){i?i.runGuarded(()=>{e.apply(this,[o])}):e.apply(this,[o])};return this.delegate.schedule(s,t,r)}},$o=(()=>{class n{outsideAngular;insideAngular;constructor(){let t=j(gt);this.outsideAngular=t.runOutsideAngular(()=>new vv(typeof Zone>"u"?void 0:Zone.current)),this.insideAngular=t.run(()=>new vv(typeof Zone>"u"?void 0:Zone.current,Rw))}static \u0275fac=function(r){return new(r||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),fO=!1;function Tq(n,e){!fO&&(hO>Du.SILENT||ZE())&&(fO=!0,console.warn("Calling Firebase APIs outside of an Injection context may destabilize your application leading to subtle change-detection and hydration bugs. Find more at https://github.com/angular/angularfire/blob/main/docs/zones.md")),hO>=e&&console.warn(`Firebase API called outside injection context: ${n.name}`)}function Sq(n){let e=j(gt,{optional:!0});return e?e.runOutsideAngular(()=>n()):n()}function Dc(n){let e=j(gt,{optional:!0});return e?e.run(()=>n()):n()}var Dq=(n,e,t)=>(...r)=>(e&&setTimeout(e,0),tn(t,()=>Dc(()=>n.apply(void 0,r)))),En=(n,e,t)=>(t||=e?Du.WARN:Du.VERBOSE,function(){let r,i=arguments,s,o,a;try{s=j($o),o=j(eu),a=j(Ot)}catch{return Tq(n,t),n.apply(this,i)}for(let d=0;d<arguments.length;d++)typeof i[d]=="function"&&(e&&(r||=Dc(()=>o.add())),i[d]=Dq(i[d],r,a));let c=Sq(()=>n.apply(this,i));return e?c instanceof Me?c.pipe(_o(s.outsideAngular),vo(s.insideAngular),dO(a)):c instanceof Promise?Dc(()=>{let d=o.add();return new Promise((h,p)=>{c.then(y=>tn(a,()=>Dc(()=>h(y))),y=>tn(a,()=>Dc(()=>p(y)))).finally(d)})}):typeof c=="function"&&r?function(){return setTimeout(r,0),c.apply(this,arguments)}:Dc(()=>c):c instanceof Me?c.pipe(_o(s.outsideAngular),vo(s.insideAngular)):Dc(()=>c)});var Is=class{constructor(e){return e}},Ac=class{constructor(){return yv()}};function Aq(n){return n&&n.length===1?n[0]:new Is(Sc())}var sC=new ae("angularfire2._apps"),xq={provide:Is,useFactory:Aq,deps:[[new or,sC]]},Rq={provide:Ac,deps:[[new or,sC]]};function kq(n){return(e,t)=>{let r=t.get(gc);bt("angularfire",Bo.full,"core"),bt("angularfire",Bo.full,"app"),bt("angular",Zw.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Is(i)}}function pO(n,...e){return nr([xq,Rq,{provide:sC,useFactory:kq(n),multi:!0,deps:[gt,At,$o,...e]}])}var gO=En(iC,!0);var Nq=new Map,Mq={activated:!1,tokenObservers:[]},Pq={initialized:!1,enabled:!1};function Zr(n){return Nq.get(n)||Object.assign({},Mq)}function _O(){return Pq}var Oq="https://content-firebaseappcheck.googleapis.com/v1";var Fq="exchangeDebugToken",mO={OFFSET_DURATION:300*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:960*1e3},Fye=1440*60*1e3;var cC=class{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new Cc,this.pending.promise.catch(t=>{}),await Vq(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new Cc,this.pending.promise.catch(t=>{}),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(t){this.retryPolicy(t)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}};function Vq(n){return new Promise(e=>{setTimeout(e,n)})}var Lq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.","initial-throttle":"{$httpStatus} error. Attempts allowed again after {$time}",throttled:"Requests throttled due to previous {$httpStatus} error. Attempts allowed again after {$time}"},Ho=new Jr("appCheck","AppCheck",Lq);function wO(n){if(!Zr(n).activated)throw Ho.create("use-before-activation",{appName:n.name})}async function IO({url:n,body:e},t){let r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){let p=await i.getHeartbeatsHeader();p&&(r["X-Firebase-Client"]=p)}let s={method:"POST",body:JSON.stringify(e),headers:r},o;try{o=await fetch(n,s)}catch(p){throw Ho.create("fetch-network-error",{originalErrorMessage:p?.message})}if(o.status!==200)throw Ho.create("fetch-status-error",{httpStatus:o.status});let a;try{a=await o.json()}catch(p){throw Ho.create("fetch-parse-error",{originalErrorMessage:p?.message})}let c=a.ttl.match(/^([\d.]+)(s)$/);if(!c||!c[2]||isNaN(Number(c[1])))throw Ho.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});let d=Number(c[1])*1e3,h=Date.now();return{token:a.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}}function EO(n,e){let{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${Oq}/projects/${t}/apps/${r}:${Fq}?key=${i}`,body:{debug_token:e}}}var Uq="firebase-app-check-database",jq=1,lC="firebase-app-check-store";var _v=null;function Bq(){return _v||(_v=new Promise((n,e)=>{try{let t=indexedDB.open(Uq,jq);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(Ho.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},t.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(lC,{keyPath:"compositeKey"})}}}catch(t){e(Ho.create("storage-open",{originalErrorMessage:t?.message}))}}),_v)}function $q(n,e){return Hq(qq(n),e)}async function Hq(n,e){let r=(await Bq()).transaction(lC,"readwrite"),s=r.objectStore(lC).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var d;a(Ho.create("storage-set",{originalErrorMessage:(d=c.target.error)===null||d===void 0?void 0:d.message}))}})}function qq(n){return`${n.options.appId}-${n.name}`}var jf=new Ni("@firebase/app-check");function oC(n,e){return Of()?$q(n,e).catch(t=>{jf.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function bO(){return _O().enabled}async function CO(){let n=_O();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}var zq={error:"UNKNOWN_ERROR"};function Gq(n){return lv.encodeString(JSON.stringify(n),!1)}async function uC(n,e=!1,t=!1){let r=n.app;wO(r);let i=Zr(r),s=i.token,o;if(s&&!Bf(s)&&(i.token=void 0,s=void 0),!s){let d=await i.cachedTokenPromise;d&&(Bf(d)?s=d:await oC(r,void 0))}if(!e&&s&&Bf(s))return{token:s.token};let a=!1;if(bO())try{i.exchangeTokenPromise||(i.exchangeTokenPromise=IO(EO(r,await CO()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),a=!0);let d=await i.exchangeTokenPromise;return await oC(r,d),i.token=d,{token:d.token}}catch(d){return d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?jf.warn(d.message):t&&jf.error(d),aC(d)}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),a=!0),s=await Zr(r).exchangeTokenPromise}catch(d){d.code==="appCheck/throttled"||d.code==="appCheck/initial-throttle"?jf.warn(d.message):t&&jf.error(d),o=d}let c;return s?o?Bf(s)?c={token:s.token,internalError:o}:c=aC(o):(c={token:s.token},i.token=s,await oC(r,s)):c=aC(o),a&&Yq(r,c),c}async function Wq(n){let e=n.app;wO(e);let{provider:t}=Zr(e);if(bO()){let r=await CO(),{token:i}=await IO(EO(e,r),n.heartbeatServiceProvider);return{token:i}}else{let{token:r}=await t.getToken();return{token:r}}}function Kq(n,e,t,r){let{app:i}=n,s=Zr(i),o={next:t,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Bf(s.token)){let a=s.token;Promise.resolve().then(()=>{t({token:a.token}),yO(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>yO(n))}function TO(n,e){let t=Zr(n),r=t.tokenObservers.filter(i=>i.next!==e);r.length===0&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function yO(n){let{app:e}=n,t=Zr(e),r=t.tokenRefresher;r||(r=Qq(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function Qq(n){let{app:e}=n;return new cC(async()=>{let t=Zr(e),r;if(t.token?r=await uC(n,!0):r=await uC(n),r.error)throw r.error;if(r.internalError)throw r.internalError},()=>!0,()=>{let t=Zr(e);if(t.token){let r=t.token.issuedAtTimeMillis+(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)*.5+3e5,i=t.token.expireTimeMillis-300*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},mO.RETRIAL_MIN_WAIT,mO.RETRIAL_MAX_WAIT)}function Yq(n,e){let t=Zr(n).tokenObservers;for(let r of t)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function Bf(n){return n.expireTimeMillis-Date.now()>0}function aC(n){return{token:Gq(zq),error:n}}var dC=class{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){let{tokenObservers:e}=Zr(this.app);for(let t of e)TO(this.app,t.next);return Promise.resolve()}};function Jq(n,e){return new dC(n,e)}function Xq(n){return{getToken:e=>uC(n,e),getLimitedUseToken:()=>Wq(n),addTokenListener:e=>Kq(n,"INTERNAL",e),removeTokenListener:e=>TO(n.app,e)}}var Zq="@firebase/app-check",ez="0.10.1";var tz="app-check",vO="app-check-internal";function nz(){Xr(new Hn(tz,n=>{let e=n.getProvider("app").getImmediate(),t=n.getProvider("heartbeat");return Jq(e,t)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(vO).initialize()})),Xr(new Hn(vO,n=>{let e=n.getProvider("app-check").getImmediate();return Xq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),bt(Zq,ez)}nz();var rz="app-check";var xu=class{constructor(){return Au(rz)}};var iz=["localhost","0.0.0.0","127.0.0.1"],Kye=typeof window<"u"&&iz.includes(window.location.hostname);var SO=()=>{};var xO=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},sz=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},RO={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,h=s>>2,p=(s&3)<<4|a>>4,y=(a&15)<<2|d>>6,E=d&63;c||(E=64,o||(y=64)),r.push(t[h],t[p],t[y],t[E])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(xO(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):sz(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let p=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||d==null||p==null)throw new hC;let y=s<<2|a>>4;if(r.push(y),d!==64){let E=a<<4&240|d>>2;if(r.push(E),p!==64){let k=d<<6&192|p;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},hC=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},oz=function(n){let e=xO(n);return RO.encodeByteArray(e,!0)},Hf=function(n){return oz(n).replace(/\./g,"")},kO=function(n){try{return RO.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function NO(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var az=()=>NO().__FIREBASE_DEFAULTS__,cz=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},lz=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&kO(n[1]);return e&&JSON.parse(e)},fC=()=>{try{return SO()||az()||cz()||lz()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},uz=n=>fC()?.emulatorHosts?.[n],MO=n=>{let e=uz(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},pC=()=>fC()?.config;var wv=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Iv(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function PO(n){return(await fetch(n,{credentials:"include"})).ok}function OO(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=H({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Hf(JSON.stringify(t)),Hf(JSON.stringify(o)),""].join(".")}var $f={};function dz(){let n={prod:[],emulator:[]};for(let e of Object.keys($f))$f[e]?n.emulator.push(e):n.prod.push(e);return n}function hz(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var DO=!1;function FO(n,e){if(typeof window>"u"||typeof document>"u"||!Iv(window.location.host)||$f[n]===e||$f[n]||DO)return;$f[n]=e;function t(y){return`__firebase__banner__${y}`}let r="__firebase__banner",s=dz().prod.length>0;function o(){let y=document.getElementById(r);y&&y.remove()}function a(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function c(y,E){y.setAttribute("width","24"),y.setAttribute("id",E),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function d(){let y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{DO=!0,o()},y}function h(y,E){y.setAttribute("id",E),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function p(){let y=hz(r),E=t("text"),k=document.getElementById(E)||document.createElement("span"),P=t("learnmore"),M=document.getElementById(P)||document.createElement("a"),$=t("preprendIcon"),Y=document.getElementById($)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){let ee=y.element;a(ee),h(M,P);let Ce=d();c(Y,$),ee.append(Y,k,M,Ce),document.body.appendChild(ee)}s?(k.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}function VO(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fz(){let n=fC()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function LO(){return!fz()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function gC(){try{return typeof indexedDB=="object"}catch{return!1}}function UO(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var pz="FirebaseError",Es=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=pz,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qf.prototype.create)}},qf=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?gz(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Es(i,a,r)}};function gz(n,e){return n.replace(mz,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var mz=/\{\$([^}]+)}/g;function Ru(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(AO(s)&&AO(o)){if(!Ru(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function AO(n){return n!==null&&typeof n=="object"}var Zye=14400*1e3;function ei(n){return n&&n._delegate?n._delegate:n}var bs=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var xc="[DEFAULT]";var mC=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new wv;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vz(e))try{this.getOrInitializeService({instanceIdentifier:xc})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=xc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=xc){return this.instances.has(e)}getOptions(e=xc){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yz(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=xc){return this.component?this.component.multipleInstances?e:xc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function yz(n){return n===xc?void 0:n}function vz(n){return n.instantiationMode==="EAGER"}var Ev=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new mC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var _z=[],$e=(function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n})($e||{}),wz={debug:$e.DEBUG,verbose:$e.VERBOSE,info:$e.INFO,warn:$e.WARN,error:$e.ERROR,silent:$e.SILENT},Iz=$e.INFO,Ez={[$e.DEBUG]:"log",[$e.VERBOSE]:"log",[$e.INFO]:"info",[$e.WARN]:"warn",[$e.ERROR]:"error"},bz=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=Ez[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ku=class{constructor(e){this.name=e,this._logLevel=Iz,this._logHandler=bz,this._userLogHandler=null,_z.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $e))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?wz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$e.DEBUG,...e),this._logHandler(this,$e.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$e.VERBOSE,...e),this._logHandler(this,$e.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$e.INFO,...e),this._logHandler(this,$e.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$e.WARN,...e),this._logHandler(this,$e.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$e.ERROR,...e),this._logHandler(this,$e.ERROR,...e)}};var vC=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Cz(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function Cz(n){return n.getComponent()?.type==="VERSION"}var _C="@firebase/app",jO="0.14.6";var Cs=new ku("@firebase/app"),Tz="@firebase/app-compat",Sz="@firebase/analytics-compat",Dz="@firebase/analytics",Az="@firebase/app-check-compat",xz="@firebase/app-check",Rz="@firebase/auth",kz="@firebase/auth-compat",Nz="@firebase/database",Mz="@firebase/data-connect",Pz="@firebase/database-compat",Oz="@firebase/functions",Fz="@firebase/functions-compat",Vz="@firebase/installations",Lz="@firebase/installations-compat",Uz="@firebase/messaging",jz="@firebase/messaging-compat",Bz="@firebase/performance",$z="@firebase/performance-compat",Hz="@firebase/remote-config",qz="@firebase/remote-config-compat",zz="@firebase/storage",Gz="@firebase/storage-compat",Wz="@firebase/firestore",Kz="@firebase/ai",Qz="@firebase/firestore-compat",Yz="firebase",Jz="12.6.0";var wC="[DEFAULT]",Xz={[_C]:"fire-core",[Tz]:"fire-core-compat",[Dz]:"fire-analytics",[Sz]:"fire-analytics-compat",[xz]:"fire-app-check",[Az]:"fire-app-check-compat",[Rz]:"fire-auth",[kz]:"fire-auth-compat",[Nz]:"fire-rtdb",[Mz]:"fire-data-connect",[Pz]:"fire-rtdb-compat",[Oz]:"fire-fn",[Fz]:"fire-fn-compat",[Vz]:"fire-iid",[Lz]:"fire-iid-compat",[Uz]:"fire-fcm",[jz]:"fire-fcm-compat",[Bz]:"fire-perf",[$z]:"fire-perf-compat",[Hz]:"fire-rc",[qz]:"fire-rc-compat",[zz]:"fire-gcs",[Gz]:"fire-gcs-compat",[Wz]:"fire-fst",[Qz]:"fire-fst-compat",[Kz]:"fire-vertex","fire-js":"fire-js",[Yz]:"fire-js-all"};var bv=new Map,Zz=new Map,IC=new Map;function BO(n,e){try{n.container.addComponent(e)}catch(t){Cs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function zf(n){let e=n.name;if(IC.has(e))return Cs.debug(`There were multiple attempts to register component ${e}.`),!1;IC.set(e,n);for(let t of bv.values())BO(t,n);for(let t of Zz.values())BO(t,n);return!0}function zO(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function GO(n){return n==null?!1:n.settings!==void 0}var eG={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qo=new qf("app","Firebase",eG);var EC=class{constructor(e,t,r){this._isDeleted=!1,this._options=H({},e),this._config=H({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new bs("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qo.create("app-deleted",{appName:this._name})}};var WO=Jz;function Wf(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=H({name:wC,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw qo.create("bad-app-name",{appName:String(i)});if(t||(t=pC()),!t)throw qo.create("no-options");let s=bv.get(i);if(s){if(Ru(t,s.options)&&Ru(r,s.config))return s;throw qo.create("duplicate-app",{appName:i})}let o=new Ev(i);for(let c of IC.values())o.addComponent(c);let a=new EC(t,r,o);return bv.set(i,a),a}function KO(n=wC){let e=bv.get(n);if(!e&&n===wC&&pC())return Wf();if(!e)throw qo.create("no-app",{appName:n});return e}function zo(n,e,t){let r=Xz[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cs.warn(o.join(" "));return}zf(new bs(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var tG="firebase-heartbeat-database",nG=1,Gf="firebase-heartbeat-store",yC=null;function QO(){return yC||(yC=mv(tG,nG,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Gf)}catch(t){console.warn(t)}}}}).catch(n=>{throw qo.create("idb-open",{originalErrorMessage:n.message})})),yC}async function rG(n){try{let t=(await QO()).transaction(Gf),r=await t.objectStore(Gf).get(YO(n));return await t.done,r}catch(e){if(e instanceof Es)Cs.warn(e.message);else{let t=qo.create("idb-get",{originalErrorMessage:e?.message});Cs.warn(t.message)}}}async function $O(n,e){try{let r=(await QO()).transaction(Gf,"readwrite");await r.objectStore(Gf).put(e,YO(n)),await r.done}catch(t){if(t instanceof Es)Cs.warn(t.message);else{let r=qo.create("idb-set",{originalErrorMessage:t?.message});Cs.warn(r.message)}}}function YO(n){return`${n.name}!${n.options.appId}`}var iG=1024,sG=30,bC=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new CC(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=HO();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>sG){let i=aG(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Cs.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=HO(),{heartbeatsToSend:t,unsentEntries:r}=oG(this._heartbeatsCache.heartbeats),i=Hf(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return Cs.warn(e),""}}};function HO(){return new Date().toISOString().substring(0,10)}function oG(n,e=iG){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),qO(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),qO(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var CC=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return gC()?UO().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await rG(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return $O(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return $O(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function qO(n){return Hf(JSON.stringify({version:2,heartbeats:n})).length}function aG(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function cG(n){zf(new bs("platform-logger",e=>new vC(e),"PRIVATE")),zf(new bs("heartbeat",e=>new bC(e),"PRIVATE")),zo(_C,jO,n),zo(_C,jO,"esm2020"),zo("fire-js","")}cG("");function d2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var h2=d2,f2=new Jr("auth","Firebase",d2());var xv=new Ni("@firebase/auth");function lG(n,...e){xv.logLevel<=Fe.WARN&&xv.warn(`Auth (${jo}): ${n}`,...e)}function Tv(n,...e){xv.logLevel<=Fe.ERROR&&xv.error(`Auth (${jo}): ${n}`,...e)}function Ko(n,...e){throw qC(n,...e)}function kc(n,...e){return qC(n,...e)}function p2(n,e,t){let r=Object.assign(Object.assign({},h2()),{[e]:t});return new Jr("auth","Firebase",r).create(e,{appName:n.name})}function Rc(n){return p2(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function qC(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return f2.create(n,...e)}function _e(n,e,...t){if(!n)throw qC(e,...t)}function Ts(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Tv(e),new Error(e)}function Qo(n,e){n||Ts(e)}function AC(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function uG(){return JO()==="http:"||JO()==="https:"}function JO(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function dG(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(uG()||zP()||"connection"in navigator)?navigator.onLine:!0}function hG(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Nc=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Qo(t>e,"Short delay should be less than long delay!"),this.isMobile=HP()||GP()}get(){return dG()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function zC(n,e){Qo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Rv=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ts("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ts("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ts("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var fG={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var pG=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],gG=new Nc(3e4,6e4);function GC(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Nu(n,e,t,r,i={}){return g2(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let a=Ff(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);let d=Object.assign({method:e,headers:c},s);return qP()||(d.referrerPolicy="no-referrer"),n.emulatorConfig&&Lo(n.emulatorConfig.host)&&(d.credentials="include"),Rv.fetch()(await m2(n,n.config.apiHost,t,a),d)})}async function g2(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},fG),e);try{let i=new xC(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw Cv(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,d]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Cv(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Cv(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw Cv(n,"user-disabled",o);let h=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw p2(n,h,d);Ko(n,h)}}catch(i){if(i instanceof ur)throw i;Ko(n,"network-request-failed",{message:String(i)})}}async function mG(n,e,t,r,i={}){let s=await Nu(n,e,t,r,i);return"mfaPendingCredential"in s&&Ko(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function m2(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?zC(n.config,i):`${n.config.apiScheme}://${i}`;return pG.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}var xC=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(kc(this.auth,"network-request-failed")),gG.get())})}};function Cv(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=kc(n,e,r);return i.customData._tokenResponse=t,i}async function yG(n,e){return Nu(n,"POST","/v1/accounts:delete",e)}async function kv(n,e){return Nu(n,"POST","/v1/accounts:lookup",e)}function Kf(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function WC(n,e=!1){let t=an(n),r=await t.getIdToken(e),i=KC(r);_e(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Kf(TC(i.auth_time)),issuedAtTime:Kf(TC(i.iat)),expirationTime:Kf(TC(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function TC(n){return Number(n)*1e3}function KC(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Tv("JWT malformed, contained fewer than 3 sections"),null;try{let i=uv(t);return i?JSON.parse(i):(Tv("Failed to decode base64 JWT payload"),null)}catch(i){return Tv("Caught error parsing JWT payload as JSON",i?.toString()),null}}function XO(n){let e=KC(n);return _e(e,"internal-error"),_e(typeof e.exp<"u","internal-error"),_e(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Yf(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ur&&vG(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function vG({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var RC=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var Jf=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kf(this.lastLoginAt),this.creationTime=Kf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Nv(n){var e;let t=n.auth,r=await n.getIdToken(),i=await Yf(n,kv(t,{idToken:r}));_e(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?y2(s.providerUserInfo):[],a=_G(n.providerData,o),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!a?.length,h=c?d:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Jf(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,p)}async function QC(n){let e=an(n);await Nv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function _G(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function y2(n){return n.map(e=>{var{providerId:t}=e,r=Nw(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function wG(n,e){let t=await g2(n,{},async()=>{let r=Ff({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await m2(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";let c={method:"POST",headers:a,body:r};return n.emulatorConfig&&Lo(n.emulatorConfig.host)&&(c.credentials="include"),Rv.fetch()(o,c)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function IG(n,e){return Nu(n,"POST","/v2/accounts:revokeToken",GC(n,e))}var Qf=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_e(e.idToken,"internal-error"),_e(typeof e.idToken<"u","internal-error"),_e(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):XO(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){_e(e.length!==0,"internal-error");let t=XO(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(_e(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await wG(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(_e(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(_e(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(_e(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return Ts("not implemented")}};function Go(n,e){_e(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Wo=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Nw(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new RC(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Jf(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let t=await Yf(this,this.stsTokenManager.getToken(this.auth,e));return _e(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return WC(this,e)}reload(){return QC(this)}_assign(e){this!==e&&(_e(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){_e(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Nv(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Tr(this.auth.app))return Promise.reject(Rc(this.auth));let e=await this.getIdToken();return await Yf(this,yG(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,d,h;let p=(r=t.displayName)!==null&&r!==void 0?r:void 0,y=(i=t.email)!==null&&i!==void 0?i:void 0,E=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,k=(o=t.photoURL)!==null&&o!==void 0?o:void 0,P=(a=t.tenantId)!==null&&a!==void 0?a:void 0,M=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,$=(d=t.createdAt)!==null&&d!==void 0?d:void 0,Y=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:ee,emailVerified:Ce,isAnonymous:Je,providerData:pe,stsTokenManager:T}=t;_e(ee&&T,e,"internal-error");let _=Qf.fromJSON(this.name,T);_e(typeof ee=="string",e,"internal-error"),Go(p,e.name),Go(y,e.name),_e(typeof Ce=="boolean",e,"internal-error"),_e(typeof Je=="boolean",e,"internal-error"),Go(E,e.name),Go(k,e.name),Go(P,e.name),Go(M,e.name),Go($,e.name),Go(Y,e.name);let I=new n({uid:ee,auth:e,email:y,emailVerified:Ce,displayName:p,isAnonymous:Je,photoURL:k,phoneNumber:E,tenantId:P,stsTokenManager:_,createdAt:$,lastLoginAt:Y});return pe&&Array.isArray(pe)&&(I.providerData=pe.map(C=>Object.assign({},C))),M&&(I._redirectEventId=M),I}static async _fromIdTokenResponse(e,t,r=!1){let i=new Qf;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Nv(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];_e(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?y2(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,a=new Qf;a.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Jf(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,d),c}};var ZO=new Map;function Ss(n){Qo(n instanceof Function,"Expected a class definition");let e=ZO.get(n);return e?(Qo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ZO.set(n,e),e)}var EG=(()=>{class n{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,r){this.storage[t]=r}async _get(t){let r=this.storage[t];return r===void 0?null:r}async _remove(t){delete this.storage[t]}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),kC=EG;function Sv(n,e,t){return`firebase:${n}:${e}:${t}`}var Mv=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Sv(this.userKey,i.apiKey,s),this.fullPersistenceKey=Sv("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await kv(this.auth,{idToken:e}).catch(()=>{});return t?Wo._fromGetAccountInfoResponse(this.auth,t,e):null}return Wo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(Ss(kC),e,r);let i=(await Promise.all(t.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d),s=i[0]||Ss(kC),o=Sv(r,e.config.apiKey,e.name),a=null;for(let d of t)try{let h=await d._get(o);if(h){let p;if(typeof h=="string"){let y=await kv(e,{idToken:h}).catch(()=>{});if(!y)break;p=await Wo._fromGetAccountInfoResponse(e,y,h)}else p=Wo._fromJSON(e,h);d!==s&&(a=p),s=d;break}}catch{}let c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async d=>{if(d!==s)try{await d._remove(o)}catch{}})),new n(s,e,r))}};function e2(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(I2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(v2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(b2(e))return"Blackberry";if(C2(e))return"Webos";if(_2(e))return"Safari";if((e.includes("chrome/")||w2(e))&&!e.includes("edge/"))return"Chrome";if(E2(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function v2(n=fn()){return/firefox\//i.test(n)}function _2(n=fn()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function w2(n=fn()){return/crios\//i.test(n)}function I2(n=fn()){return/iemobile/i.test(n)}function E2(n=fn()){return/android/i.test(n)}function b2(n=fn()){return/blackberry/i.test(n)}function C2(n=fn()){return/webos/i.test(n)}function YC(n=fn()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function bG(n=fn()){var e;return YC(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function CG(){return WP()&&document.documentMode===10}function T2(n=fn()){return YC(n)||E2(n)||C2(n)||b2(n)||/windows phone/i.test(n)||I2(n)}function S2(n,e=[]){let t;switch(n){case"Browser":t=e2(fn());break;case"Worker":t=`${e2(fn())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${jo}/${r}`}var NC=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function TG(n,e={}){return Nu(n,"GET","/v2/passwordPolicy",GC(n,e))}var SG=6,MC=class{constructor(e){var t,r,i,s;let o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:SG,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,a;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var PC=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Pv(this),this.idTokenSubscription=new Pv(this),this.beforeStateQueue=new NC(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ss(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await Mv.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await kv(this,{idToken:e}),r=await Wo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Tr(this.app)){let o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return _e(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Nv(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=hG()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Tr(this.app))return Promise.reject(Rc(this));let t=e?an(e):null;return t&&_e(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&_e(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Tr(this.app)?Promise.reject(Rc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Tr(this.app)?Promise.reject(Rc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ss(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await TG(this),t=new MC(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Jr("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await IG(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Ss(e)||this._popupRedirectResolver;_e(t,this,"argument-error"),this.redirectPersistenceManager=await Mv.create(this,[Ss(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,a=this._isInitialized?Promise.resolve():this._initializationPromise;if(_e(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{o=!0,c()}}else{let c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _e(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=S2(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(Tr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&lG(`Error while retrieving App Check token: ${t.error}`),t?.token}};function JC(n){return an(n)}var Pv=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=JP(t=>this.observer=t)}get next(){return _e(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var XC={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function DG(n){XC=n}function AG(n){return XC.loadJS(n)}function xG(){return XC.gapiScript}function D2(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function ZC(n,e){let t=Su(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(ki(s,e??{}))return i;Ko(i,"already-initialized")}return t.initialize({options:e})}function RG(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ss);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function eT(n,e,t){let r=JC(n);_e(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=A2(e),{host:o,port:a}=kG(e),c=a===null?"":`:${a}`,d={url:`${s}//${o}${c}/`},h=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){_e(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),_e(ki(d,r.config.emulator)&&ki(h,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=d,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,Lo(o)?(hv(`${s}//${o}${c}`),fv("Auth",!0)):i||NG()}function A2(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function kG(n){let e=A2(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:t2(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:t2(o)}}}function t2(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function NG(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var Ov=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Ts("not implemented")}_getIdTokenResponse(e){return Ts("not implemented")}_linkToIdToken(e,t){return Ts("not implemented")}_getReauthenticationResolver(e){return Ts("not implemented")}};async function SC(n,e){return mG(n,"POST","/v1/accounts:signInWithIdp",GC(n,e))}var Fv=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var OC=class extends Fv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var Xf=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await Wo._fromIdTokenResponse(e,r,i),o=n2(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=n2(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function n2(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var FC=class n extends ur{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function x2(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?FC._fromErrorAndOperation(n,s,e,r):s})}async function MG(n,e,t=!1){let r=await Yf(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Xf._forOperation(n,"link",r)}async function PG(n,e,t=!1){let{auth:r}=n;if(Tr(r.app))return Promise.reject(Rc(r));let i="reauthenticate";try{let s=await Yf(n,x2(r,i,e,n),t);_e(s.idToken,r,"internal-error");let o=KC(s.idToken);_e(o,r,"internal-error");let{sub:a}=o;return _e(n.uid===a,r,"user-mismatch"),Xf._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ko(r,"user-mismatch"),s}}async function OG(n,e,t=!1){if(Tr(n.app))return Promise.reject(Rc(n));let r="signIn",i=await x2(n,r,e),s=await Xf._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}function tT(n,e,t,r){return an(n).onIdTokenChanged(e,t,r)}function nT(n,e,t){return an(n).beforeAuthStateChanged(e,t)}var Vv="__sak";var Lv=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Vv,"1"),this.storage.removeItem(Vv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var FG=1e3,VG=10,LG=(()=>{class n extends Lv{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,r)=>this.onStorageEvent(t,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=T2(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(let r of Object.keys(this.listeners)){let i=this.storage.getItem(r),s=this.localCache[r];i!==s&&t(r,s,i)}}onStorageEvent(t,r=!1){if(!t.key){this.forAllChangedKeys((a,c,d)=>{this.notifyListeners(a,d)});return}let i=t.key;r?this.detachListener():this.stopPolling();let s=()=>{let a=this.storage.getItem(i);!r&&this.localCache[i]===a||this.notifyListeners(i,a)},o=this.storage.getItem(i);CG()&&o!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,VG):s()}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,r,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:r,newValue:i}),!0)})},FG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,r){await super._set(t,r),this.localCache[t]=JSON.stringify(r)}async _get(t){let r=await super._get(t);return this.localCache[t]=JSON.stringify(r),r}async _remove(t){await super._remove(t),delete this.localCache[t]}}return n.type="LOCAL",n})(),R2=LG;var UG=(()=>{class n extends Lv{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,r){}_removeListener(t,r){}}return n.type="SESSION",n})(),rT=UG;function jG(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var BG=(()=>{class n{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){let r=this.receivers.find(s=>s.isListeningto(t));if(r)return r;let i=new n(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){let r=t,{eventId:i,eventType:s,data:o}=r.data,a=this.handlersMap[s];if(!a?.size)return;r.ports[0].postMessage({status:"ack",eventId:i,eventType:s});let c=Array.from(a).map(async h=>h(r.origin,o)),d=await jG(c);r.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:d})}_subscribe(t,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(r)}_unsubscribe(t,r){this.handlersMap[t]&&r&&this.handlersMap[t].delete(r),(!r||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}n.receivers=[];return n})();function k2(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var VC=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let d=k2("",20);i.port1.start();let h=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(p){let y=p;if(y.data.eventId===d)switch(y.data.status){case"ack":clearTimeout(h),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(y.data.response);break;default:clearTimeout(h),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function Pi(){return window}function $G(n){Pi().location.href=n}function N2(){return typeof Pi().WorkerGlobalScope<"u"&&typeof Pi().importScripts=="function"}async function HG(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qG(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function zG(){return N2()?self:null}var M2="firebaseLocalStorageDb",GG=1,Uv="firebaseLocalStorage",P2="fbase_key",Mc=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Bv(n,e){return n.transaction([Uv],e?"readwrite":"readonly").objectStore(Uv)}function WG(){let n=indexedDB.deleteDatabase(M2);return new Mc(n).toPromise()}function LC(){let n=indexedDB.open(M2,GG);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Uv,{keyPath:P2})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Uv)?e(r):(r.close(),await WG(),e(await LC()))})})}async function r2(n,e,t){let r=Bv(n,!0).put({[P2]:e,value:t});return new Mc(r).toPromise()}async function KG(n,e){let t=Bv(n,!1).get(e),r=await new Mc(t).toPromise();return r===void 0?null:r.value}function i2(n,e){let t=Bv(n,!0).delete(e);return new Mc(t).toPromise()}var QG=800,YG=3,JG=(()=>{class n{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await LC(),this.db)}async _withRetries(t){let r=0;for(;;)try{let i=await this._openDb();return await t(i)}catch(i){if(r++>YG)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return N2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=BG._getInstance(zG()),this.receiver._subscribe("keyChanged",async(t,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(t,r)=>["keyChanged"])}async initializeSender(){var t,r;if(this.activeServiceWorker=await HG(),!this.activeServiceWorker)return;this.sender=new VC(this.activeServiceWorker);let i=await this.sender._send("ping",{},800);i&&!((t=i[0])===null||t===void 0)&&t.fulfilled&&!((r=i[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||qG()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let t=await LC();return await r2(t,Vv,"1"),await i2(t,Vv),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,r){return this._withPendingWrite(async()=>(await this._withRetries(i=>r2(i,t,r)),this.localCache[t]=r,this.notifyServiceWorker(t)))}async _get(t){let r=await this._withRetries(i=>KG(i,t));return this.localCache[t]=r,r}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(r=>i2(r,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){let t=await this._withRetries(s=>{let o=Bv(s,!1).getAll();return new Mc(o).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];let r=[],i=new Set;if(t.length!==0)for(let{fbase_key:s,value:o}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),r.push(s));for(let s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),r.push(s));return r}notifyListeners(t,r){this.localCache[t]=r;let i=this.listeners[t];if(i)for(let s of Array.from(i))s(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(r)}_removeListener(t,r){this.listeners[t]&&(this.listeners[t].delete(r),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}return n.type="LOCAL",n})(),O2=JG;var bve=D2("rcb"),Cve=new Nc(3e4,6e4);function XG(n,e){return e?Ss(e):(_e(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Zf=class extends Ov{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return SC(e,this._buildIdpRequest())}_linkToIdToken(e,t){return SC(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return SC(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function ZG(n){return OG(n.auth,new Zf(n),n.bypassAuthState)}function e7(n){let{auth:e,user:t}=n;return _e(t,e,"internal-error"),PG(t,new Zf(n),n.bypassAuthState)}async function t7(n){let{auth:e,user:t}=n;return _e(t,e,"internal-error"),MG(t,new Zf(n),n.bypassAuthState)}var UC=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ZG;case"linkViaPopup":case"linkViaRedirect":return t7;case"reauthViaPopup":case"reauthViaRedirect":return e7;default:Ko(this.auth,"internal-error")}}resolve(e){Qo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Qo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var Tve=new Nc(2e3,1e4);var n7="pendingRedirect",Dv=new Map,jC=class extends UC{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Dv.get(this.auth._key());if(!e){try{let r=await r7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Dv.set(this.auth._key(),e)}return this.bypassAuthState||Dv.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function r7(n,e){let t=o7(e),r=s7(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function i7(n,e){Dv.set(n._key(),e)}function s7(n){return Ss(n._redirectPersistence)}function o7(n){return Sv(n7,n.config.apiKey,n.name)}async function a7(n,e,t=!1){if(Tr(n.app))return Promise.reject(Rc(n));let r=JC(n),i=XG(r,e),o=await new jC(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}var c7=600*1e3,BC=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!l7(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!F2(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(kc(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=c7&&this.cachedEventUids.clear(),this.cachedEventUids.has(s2(e))}saveEventToCache(e){this.cachedEventUids.add(s2(e)),this.lastProcessedEventTime=Date.now()}};function s2(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function F2({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function l7(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return F2(n);default:return!1}}async function u7(n,e={}){return Nu(n,"GET","/v1/projects",e)}var d7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,h7=/^https?/;async function f7(n){if(n.config.emulator)return;let{authorizedDomains:e}=await u7(n);for(let t of e)try{if(p7(t))return}catch{}Ko(n,"unauthorized-domain")}function p7(n){let e=AC(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!h7.test(t))return!1;if(d7.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var g7=new Nc(3e4,6e4);function o2(){let n=Pi().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function m7(n){return new Promise((e,t)=>{var r,i,s;function o(){o2(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{o2(),t(kc(n,"network-request-failed"))},timeout:g7.get()})}if(!((i=(r=Pi().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Pi().gapi)===null||s===void 0)&&s.load)o();else{let a=D2("iframefcb");return Pi()[a]=()=>{gapi.load?o():t(kc(n,"network-request-failed"))},AG(`${xG()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Av=null,e})}var Av=null;function y7(n){return Av=Av||m7(n),Av}var v7=new Nc(5e3,15e3),_7="__/auth/iframe",w7="emulator/auth/iframe",I7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},E7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function b7(n){let e=n.config;_e(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?zC(e,w7):`https://${n.config.authDomain}/${_7}`,r={apiKey:e.apiKey,appName:n.name,v:jo},i=E7.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Ff(r).slice(1)}`}async function C7(n){let e=await y7(n),t=Pi().gapi;return _e(t,n,"internal-error"),e.open({where:document.body,url:b7(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:I7,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=kc(n,"network-request-failed"),a=Pi().setTimeout(()=>{s(o)},v7.get());function c(){Pi().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}var T7={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},S7=500,D7=600,A7="_blank",x7="http://localhost",jv=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function R7(n,e,t,r=S7,i=D7){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},T7),{width:r.toString(),height:i.toString(),top:s,left:o}),d=fn().toLowerCase();t&&(a=w2(d)?A7:t),v2(d)&&(e=e||x7,c.scrollbars="yes");let h=Object.entries(c).reduce((y,[E,k])=>`${y}${E}=${k},`,"");if(bG(d)&&a!=="_self")return k7(e||"",a),new jv(null);let p=window.open(e||"",a,h);_e(p,n,"popup-blocked");try{p.focus()}catch{}return new jv(p)}function k7(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var N7="__/auth/handler",M7="emulator/auth/handler",P7=encodeURIComponent("fac");async function a2(n,e,t,r,i,s){_e(n.config.authDomain,n,"auth-domain-config-required"),_e(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:jo,eventId:i};if(e instanceof Fv){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",YP(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[h,p]of Object.entries(s||{}))o[h]=p}if(e instanceof OC){let h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let h of Object.keys(a))a[h]===void 0&&delete a[h];let c=await n._getAppCheckToken(),d=c?`#${P7}=${encodeURIComponent(c)}`:"";return`${O7(n)}?${Ff(a).slice(1)}${d}`}function O7({config:n}){return n.emulator?zC(n,M7):`https://${n.authDomain}/${N7}`}var DC="webStorageSupport",$C=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rT,this._completeRedirectFn=a7,this._overrideRedirectResult=i7}async _openPopup(e,t,r,i){var s;Qo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=await a2(e,t,r,AC(),i);return R7(e,o,k2())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await a2(e,t,r,AC(),i);return $G(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Qo(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await C7(e),r=new BC(e);return t.register("authEvent",i=>(_e(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(DC,{type:DC},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[DC];o!==void 0&&t(!!o),Ko(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=f7(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return T2()||_2()||YC()}},V2=$C;var c2="@firebase/auth",l2="1.10.8";var HC=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){_e(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function F7(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function V7(n){Xr(new Hn("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;_e(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:S2(n)},d=new PC(r,i,s,c);return RG(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Xr(new Hn("auth-internal",e=>{let t=JC(e.getProvider("auth").getImmediate());return(r=>new HC(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),bt(c2,l2,F7(n)),bt(c2,l2,"esm2017")}var L7=300,U7=Hb("authIdTokenMaxAge")||L7,u2=null,j7=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>U7)return;let i=t?.token;u2!==i&&(u2=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function iT(n=Sc()){let e=Su(n,"auth");if(e.isInitialized())return e.getImmediate();let t=ZC(n,{popupRedirectResolver:V2,persistence:[O2,R2,rT]}),r=Hb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=j7(s.toString());nT(t,o,()=>o(t.currentUser)),tT(t,a=>o(a))}}let i=Bb("auth");return i&&eT(t,`http://${i}`),t}function B7(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}DG({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=kc("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",B7().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});V7("Browser");var L2="auth",ep=class{constructor(e){return e}},tp=class{constructor(){return Au(L2)}};var sT=new ae("angularfire2.auth-instances");function PW(n,e){let t=Uf(L2,n,e);return t&&new ep(t)}function OW(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new ep(r)}}var FW={provide:tp,deps:[[new or,sT]]},VW={provide:ep,useFactory:PW,deps:[[new or,sT],Is]};function U2(n,...e){return bt("angularfire",Bo.full,"auth"),nr([VW,FW,{provide:sT,useFactory:OW(n),multi:!0,deps:[gt,At,$o,Ac,[new or,xu],...e]}])}var j2=En(iT,!0);var B2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},$2={};var Ds,oT;(function(){var n;function e(T,_){function I(){}I.prototype=_.prototype,T.F=_.prototype,T.prototype=new I,T.prototype.constructor=T,T.D=function(C,b,A){for(var w=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)w[pt-2]=arguments[pt];return _.prototype[b].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,_,I){I||(I=0);let C=Array(16);if(typeof _=="string")for(var b=0;b<16;++b)C[b]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(b=0;b<16;++b)C[b]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=T.g[0],I=T.g[1],b=T.g[2];let A=T.g[3],w;w=_+(A^I&(b^A))+C[0]+3614090360&4294967295,_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[1]+3905402710&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[2]+606105819&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[3]+3250441966&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(A^I&(b^A))+C[4]+4118548399&4294967295,_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[5]+1200080426&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[6]+2821735955&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[7]+4249261313&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(A^I&(b^A))+C[8]+1770035416&4294967295,_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[9]+2336552879&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[10]+4294925233&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[11]+2304563134&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(A^I&(b^A))+C[12]+1804603682&4294967295,_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[13]+4254626195&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[14]+2792965006&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[15]+1236535329&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(b^A&(I^b))+C[1]+4129170786&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[6]+3225465664&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[11]+643717713&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[0]+3921069994&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(b^A&(I^b))+C[5]+3593408605&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[10]+38016083&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[15]+3634488961&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[4]+3889429448&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(b^A&(I^b))+C[9]+568446438&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[14]+3275163606&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[3]+4107603335&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[8]+1163531501&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(b^A&(I^b))+C[13]+2850285829&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[2]+4243563512&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[7]+1735328473&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[12]+2368359562&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(I^b^A)+C[5]+4294588738&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[8]+2272392833&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[11]+1839030562&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[14]+4259657740&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(I^b^A)+C[1]+2763975236&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[4]+1272893353&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[7]+4139469664&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[10]+3200236656&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(I^b^A)+C[13]+681279174&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[0]+3936430074&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[3]+3572445317&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[6]+76029189&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(I^b^A)+C[9]+3654602809&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[12]+3873151461&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[15]+530742520&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[2]+3299628645&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(b^(I|~A))+C[0]+4096336452&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[7]+1126891415&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[14]+2878612391&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[5]+4237533241&4294967295,I=b+(w<<21&4294967295|w>>>11),w=_+(b^(I|~A))+C[12]+1700485571&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[3]+2399980690&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[10]+4293915773&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[1]+2240044497&4294967295,I=b+(w<<21&4294967295|w>>>11),w=_+(b^(I|~A))+C[8]+1873313359&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[15]+4264355552&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[6]+2734768916&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[13]+1309151649&4294967295,I=b+(w<<21&4294967295|w>>>11),w=_+(b^(I|~A))+C[4]+4149444226&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[11]+3174756917&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[2]+718787259&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(b+(w<<21&4294967295|w>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.v=function(T,_){_===void 0&&(_=T.length);let I=_-this.blockSize,C=this.C,b=this.h,A=0;for(;A<_;){if(b==0)for(;A<=I;)i(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<_;)if(C[b++]=T.charCodeAt(A++),b==this.blockSize){i(this,C),b=0;break}}else for(;A<_;)if(C[b++]=T[A++],b==this.blockSize){i(this,C),b=0;break}}this.h=b,this.o+=_},r.prototype.A=function(){var T=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;_=this.o*8;for(var I=T.length-8;I<T.length;++I)T[I]=_&255,_/=256;for(this.v(T),T=Array(16),_=0,I=0;I<4;++I)for(let C=0;C<32;C+=8)T[_++]=this.g[I]>>>C&255;return T};function s(T,_){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=_(T)}function o(T,_){this.h=_;let I=[],C=!0;for(let b=T.length-1;b>=0;b--){let A=T[b]|0;C&&A==_||(I[b]=A,C=!1)}this.g=I}var a={};function c(T){return-128<=T&&T<128?s(T,function(_){return new o([_|0],_<0?-1:0)}):new o([T|0],T<0?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return p;if(T<0)return M(d(-T));let _=[],I=1;for(let C=0;T>=I;C++)_[C]=T/I|0,I*=4294967296;return new o(_,0)}function h(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,_<2||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return M(h(T.substring(1),_));if(T.indexOf("-")>=0)throw Error('number format error: interior "-" character');let I=d(Math.pow(_,8)),C=p;for(let A=0;A<T.length;A+=8){var b=Math.min(8,T.length-A);let w=parseInt(T.substring(A,A+b),_);b<8?(b=d(Math.pow(_,b)),C=C.j(b).add(d(w))):(C=C.j(I),C=C.add(d(w)))}return C}var p=c(0),y=c(1),E=c(16777216);n=o.prototype,n.m=function(){if(P(this))return-M(this).m();let T=0,_=1;for(let I=0;I<this.g.length;I++){let C=this.i(I);T+=(C>=0?C:4294967296+C)*_,_*=4294967296}return T},n.toString=function(T){if(T=T||10,T<2||36<T)throw Error("radix out of range: "+T);if(k(this))return"0";if(P(this))return"-"+M(this).toString(T);let _=d(Math.pow(T,6));var I=this;let C="";for(;;){let b=Ce(I,_).g;I=$(I,b.j(_));let A=((I.g.length>0?I.g[0]:I.h)>>>0).toString(T);if(I=b,k(I))return A+C;for(;A.length<6;)A="0"+A;C=A+C}},n.i=function(T){return T<0?0:T<this.g.length?this.g[T]:this.h};function k(T){if(T.h!=0)return!1;for(let _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function P(T){return T.h==-1}n.l=function(T){return T=$(this,T),P(T)?-1:k(T)?0:1};function M(T){let _=T.g.length,I=[];for(let C=0;C<_;C++)I[C]=~T.g[C];return new o(I,~T.h).add(y)}n.abs=function(){return P(this)?M(this):this},n.add=function(T){let _=Math.max(this.g.length,T.g.length),I=[],C=0;for(let b=0;b<=_;b++){let A=C+(this.i(b)&65535)+(T.i(b)&65535),w=(A>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);C=w>>>16,A&=65535,w&=65535,I[b]=w<<16|A}return new o(I,I[I.length-1]&-2147483648?-1:0)};function $(T,_){return T.add(M(_))}n.j=function(T){if(k(this)||k(T))return p;if(P(this))return P(T)?M(this).j(M(T)):M(M(this).j(T));if(P(T))return M(this.j(M(T)));if(this.l(E)<0&&T.l(E)<0)return d(this.m()*T.m());let _=this.g.length+T.g.length,I=[];for(var C=0;C<2*_;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(let b=0;b<T.g.length;b++){let A=this.i(C)>>>16,w=this.i(C)&65535,pt=T.i(b)>>>16,qn=T.i(b)&65535;I[2*C+2*b]+=w*qn,Y(I,2*C+2*b),I[2*C+2*b+1]+=A*qn,Y(I,2*C+2*b+1),I[2*C+2*b+1]+=w*pt,Y(I,2*C+2*b+1),I[2*C+2*b+2]+=A*pt,Y(I,2*C+2*b+2)}for(T=0;T<_;T++)I[T]=I[2*T+1]<<16|I[2*T];for(T=_;T<2*_;T++)I[T]=0;return new o(I,0)};function Y(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function ee(T,_){this.g=T,this.h=_}function Ce(T,_){if(k(_))throw Error("division by zero");if(k(T))return new ee(p,p);if(P(T))return _=Ce(M(T),_),new ee(M(_.g),M(_.h));if(P(_))return _=Ce(T,M(_)),new ee(M(_.g),_.h);if(T.g.length>30){if(P(T)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var I=y,C=_;C.l(T)<=0;)I=Je(I),C=Je(C);var b=pe(I,1),A=pe(C,1);for(C=pe(C,2),I=pe(I,2);!k(C);){var w=A.add(C);w.l(T)<=0&&(b=b.add(I),A=w),C=pe(C,1),I=pe(I,1)}return _=$(T,b.j(_)),new ee(b,_)}for(b=p;T.l(_)>=0;){for(I=Math.max(1,Math.floor(T.m()/_.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=C<=48?1:Math.pow(2,C-48),A=d(I),w=A.j(_);P(w)||w.l(T)>0;)I-=C,A=d(I),w=A.j(_);k(A)&&(A=y),b=b.add(A),T=$(T,w)}return new ee(b,T)}n.B=function(T){return Ce(this,T).h},n.and=function(T){let _=Math.max(this.g.length,T.g.length),I=[];for(let C=0;C<_;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},n.or=function(T){let _=Math.max(this.g.length,T.g.length),I=[];for(let C=0;C<_;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},n.xor=function(T){let _=Math.max(this.g.length,T.g.length),I=[];for(let C=0;C<_;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function Je(T){let _=T.g.length+1,I=[];for(let C=0;C<_;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function pe(T,_){let I=_>>5;_%=32;let C=T.g.length-I,b=[];for(let A=0;A<C;A++)b[A]=_>0?T.i(A+I)>>>_|T.i(A+I+1)<<32-_:T.i(A+I);return new o(b,T.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,oT=$2.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Ds=$2.Integer=o}).apply(typeof B2<"u"?B2:typeof self<"u"?self:typeof window<"u"?window:{});var $v=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},As={};var aT,LW,Mu,cT,np,Hv,lT,uT,dT;(function(){var n,e=Object.defineProperty;function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof $v=="object"&&$v];for(var g=0;g<u.length;++g){var v=u[g];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=t(this);function i(u,g){if(g)e:{var v=r;u=u.split(".");for(var D=0;D<u.length-1;D++){var O=u[D];if(!(O in v))break e;v=v[O]}u=u[u.length-1],D=v[u],g=g(D),g!=D&&g!=null&&e(v,u,{configurable:!0,writable:!0,value:g})}}i("Symbol.dispose",function(u){return u||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(u){return u||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(u){return u||function(g){var v=[],D;for(D in g)Object.prototype.hasOwnProperty.call(g,D)&&v.push([D,g[D]]);return v}});var s=s||{},o=this||self;function a(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function c(u,g,v){return u.call.apply(u.bind,arguments)}function d(u,g,v){return d=c,d.apply(null,arguments)}function h(u,g){var v=Array.prototype.slice.call(arguments,1);return function(){var D=v.slice();return D.push.apply(D,arguments),u.apply(this,D)}}function p(u,g){function v(){}v.prototype=g.prototype,u.Z=g.prototype,u.prototype=new v,u.prototype.constructor=u,u.Ob=function(D,O,L){for(var J=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)J[ge-2]=arguments[ge];return g.prototype[O].apply(D,J)}}var y=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?u=>u&&AsyncContext.Snapshot.wrap(u):u=>u;function E(u){let g=u.length;if(g>0){let v=Array(g);for(let D=0;D<g;D++)v[D]=u[D];return v}return[]}function k(u,g){for(let D=1;D<arguments.length;D++){let O=arguments[D];var v=typeof O;if(v=v!="object"?v:O?Array.isArray(O)?"array":v:"null",v=="array"||v=="object"&&typeof O.length=="number"){v=u.length||0;let L=O.length||0;u.length=v+L;for(let J=0;J<L;J++)u[v+J]=O[J]}else u.push(O)}}class P{constructor(g,v){this.i=g,this.j=v,this.h=0,this.g=null}get(){let g;return this.h>0?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function M(u){o.setTimeout(()=>{throw u},0)}function $(){var u=T;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class Y{constructor(){this.h=this.g=null}add(g,v){let D=ee.get();D.set(g,v),this.h?this.h.next=D:this.g=D,this.h=D}}var ee=new P(()=>new Ce,u=>u.reset());class Ce{constructor(){this.next=this.g=this.h=null}set(g,v){this.h=g,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let Je,pe=!1,T=new Y,_=()=>{let u=Promise.resolve(void 0);Je=()=>{u.then(I)}};function I(){for(var u;u=$();){try{u.h.call(u.g)}catch(v){M(v)}var g=ee;g.j(u),g.h<100&&(g.h++,u.next=g.g,g.g=u)}pe=!1}function C(){this.u=this.u,this.C=this.C}C.prototype.u=!1,C.prototype.dispose=function(){this.u||(this.u=!0,this.N())},C.prototype[Symbol.dispose]=function(){this.dispose()},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function b(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}b.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let v=()=>{};o.addEventListener("test",v,g),o.removeEventListener("test",v,g)}catch{}return u})();function w(u){return/^[\s\xa0]*$/.test(u)}function pt(u,g){b.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u&&this.init(u,g)}p(pt,b),pt.prototype.init=function(u,g){let v=this.type=u.type,D=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget,g||(v=="mouseover"?g=u.fromElement:v=="mouseout"&&(g=u.toElement)),this.relatedTarget=g,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=u.pointerType,this.state=u.state,this.i=u,u.defaultPrevented&&pt.Z.h.call(this)},pt.prototype.h=function(){pt.Z.h.call(this);let u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var qn="closure_listenable_"+(Math.random()*1e6|0),nw=0;function Ia(u,g,v,D,O){this.listener=u,this.proxy=null,this.src=g,this.type=v,this.capture=!!D,this.ha=O,this.key=++nw,this.da=this.fa=!1}function oi(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ws(u,g,v){for(let D in u)g.call(v,u[D],D,u)}function ig(u,g){for(let v in u)g.call(void 0,u[v],v,u)}function sg(u){let g={};for(let v in u)g[v]=u[v];return g}let Mr="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Kt(u,g){let v,D;for(let O=1;O<arguments.length;O++){D=arguments[O];for(v in D)u[v]=D[v];for(let L=0;L<Mr.length;L++)v=Mr[L],Object.prototype.hasOwnProperty.call(D,v)&&(u[v]=D[v])}}function al(u){this.src=u,this.g={},this.h=0}al.prototype.add=function(u,g,v,D,O){let L=u.toString();u=this.g[L],u||(u=this.g[L]=[],this.h++);let J=Hd(u,g,D,O);return J>-1?(g=u[J],v||(g.fa=!1)):(g=new Ia(g,this.src,L,!!D,O),g.fa=v,u.push(g)),g};function Qi(u,g){let v=g.type;if(v in u.g){var D=u.g[v],O=Array.prototype.indexOf.call(D,g,void 0),L;(L=O>=0)&&Array.prototype.splice.call(D,O,1),L&&(oi(g),u.g[v].length==0&&(delete u.g[v],u.h--))}}function Hd(u,g,v,D){for(let O=0;O<u.length;++O){let L=u[O];if(!L.da&&L.listener==g&&L.capture==!!v&&L.ha==D)return O}return-1}var Yi="closure_lm_"+(Math.random()*1e6|0),qd={};function og(u,g,v,D,O){if(D&&D.once)return ll(u,g,v,D,O);if(Array.isArray(g)){for(let L=0;L<g.length;L++)og(u,g[L],v,D,O);return null}return v=fl(v),u&&u[qn]?u.J(g,v,a(D)?!!D.capture:!!D,O):Ea(u,g,v,!1,D,O)}function Ea(u,g,v,D,O,L){if(!g)throw Error("Invalid event type");let J=a(O)?!!O.capture:!!O,ge=hl(u);if(ge||(u[Yi]=ge=new al(u)),v=ge.add(g,v,D,J,L),v.proxy)return v;if(D=cl(),v.proxy=D,D.src=u,D.listener=v,u.addEventListener)A||(O=J),O===void 0&&(O=!1),u.addEventListener(g.toString(),D,O);else if(u.attachEvent)u.attachEvent(dl(g.toString()),D);else if(u.addListener&&u.removeListener)u.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return v}function cl(){function u(v){return g.call(u.src,u.listener,v)}let g=ag;return u}function ll(u,g,v,D,O){if(Array.isArray(g)){for(let L=0;L<g.length;L++)ll(u,g[L],v,D,O);return null}return v=fl(v),u&&u[qn]?u.K(g,v,a(D)?!!D.capture:!!D,O):Ea(u,g,v,!0,D,O)}function ul(u,g,v,D,O){if(Array.isArray(g))for(var L=0;L<g.length;L++)ul(u,g[L],v,D,O);else D=a(D)?!!D.capture:!!D,v=fl(v),u&&u[qn]?(u=u.i,L=String(g).toString(),L in u.g&&(g=u.g[L],v=Hd(g,v,D,O),v>-1&&(oi(g[v]),Array.prototype.splice.call(g,v,1),g.length==0&&(delete u.g[L],u.h--)))):u&&(u=hl(u))&&(g=u.g[g.toString()],u=-1,g&&(u=Hd(g,v,D,O)),(v=u>-1?g[u]:null)&&ba(v))}function ba(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[qn])Qi(g.i,u);else{var v=u.type,D=u.proxy;g.removeEventListener?g.removeEventListener(v,D,u.capture):g.detachEvent?g.detachEvent(dl(v),D):g.addListener&&g.removeListener&&g.removeListener(D),(v=hl(g))?(Qi(v,u),v.h==0&&(v.src=null,g[Yi]=null)):oi(u)}}}function dl(u){return u in qd?qd[u]:qd[u]="on"+u}function ag(u,g){if(u.da)u=!0;else{g=new pt(g,this);let v=u.listener,D=u.ha||u.src;u.fa&&ba(u),u=v.call(D,g)}return u}function hl(u){return u=u[Yi],u instanceof al?u:null}var zd="__closure_events_fn_"+(Math.random()*1e9>>>0);function fl(u){return typeof u=="function"?u:(u[zd]||(u[zd]=function(g){return u.handleEvent(g)}),u[zd])}function Qt(){C.call(this),this.i=new al(this),this.M=this,this.G=null}p(Qt,C),Qt.prototype[qn]=!0,Qt.prototype.removeEventListener=function(u,g,v,D){ul(this,u,g,v,D)};function Yt(u,g){var v,D=u.G;if(D)for(v=[];D;D=D.G)v.push(D);if(u=u.M,D=g.type||g,typeof g=="string")g=new b(g,u);else if(g instanceof b)g.target=g.target||u;else{var O=g;g=new b(D,u),Kt(g,O)}O=!0;let L,J;if(v)for(J=v.length-1;J>=0;J--)L=g.g=v[J],O=Ca(L,D,!0,g)&&O;if(L=g.g=u,O=Ca(L,D,!0,g)&&O,O=Ca(L,D,!1,g)&&O,v)for(J=0;J<v.length;J++)L=g.g=v[J],O=Ca(L,D,!1,g)&&O}Qt.prototype.N=function(){if(Qt.Z.N.call(this),this.i){var u=this.i;for(let g in u.g){let v=u.g[g];for(let D=0;D<v.length;D++)oi(v[D]);delete u.g[g],u.h--}}this.G=null},Qt.prototype.J=function(u,g,v,D){return this.i.add(String(u),g,!1,v,D)},Qt.prototype.K=function(u,g,v,D){return this.i.add(String(u),g,!0,v,D)};function Ca(u,g,v,D){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();let O=!0;for(let L=0;L<g.length;++L){let J=g[L];if(J&&!J.da&&J.capture==v){let ge=J.listener,l=J.ha||J.src;J.fa&&Qi(u.i,J),O=ge.call(l,D)!==!1&&O}}return O&&!D.defaultPrevented}function rw(u,g){if(typeof u!="function")if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return Number(g)>2147483647?-1:o.setTimeout(u,g||0)}function pl(u){u.g=rw(()=>{u.g=null,u.i&&(u.i=!1,pl(u))},u.l);let g=u.h;u.h=null,u.m.apply(null,g)}class Gd extends C{constructor(g,v){super(),this.m=g,this.l=v,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:pl(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ji(u){C.call(this),this.h=u,this.g={}}p(Ji,C);var Jt=[];function cn(u){Ws(u.g,function(g,v){this.g.hasOwnProperty(v)&&ba(g)},u),u.g={}}Ji.prototype.N=function(){Ji.Z.N.call(this),cn(this)},Ji.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ks=o.JSON.stringify,cg=o.JSON.parse,lg=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function ug(){}function Qs(){}var Ys={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gl(){b.call(this,"d")}p(gl,b);function Ta(){b.call(this,"c")}p(Ta,b);var Xi={},dg=null;function Js(){return dg=dg||new Qt}Xi.Ia="serverreachability";function Wd(u){b.call(this,Xi.Ia,u)}p(Wd,b);function Xs(u){let g=Js();Yt(g,new Wd(g))}Xi.STAT_EVENT="statevent";function Zs(u,g){b.call(this,Xi.STAT_EVENT,u),this.stat=g}p(Zs,b);function Xt(u){let g=Js();Yt(g,new Zs(g,u))}Xi.Ja="timingevent";function ml(u,g){b.call(this,Xi.Ja,u),this.size=g}p(ml,b);function Xn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},g)}function eo(){this.g=!0}eo.prototype.ua=function(){this.g=!1};function yl(u,g,v,D,O,L){u.info(function(){if(u.g)if(L){var J="",ge=L.split("&");for(let f=0;f<ge.length;f++){var l=ge[f].split("=");if(l.length>1){let m=l[0];l=l[1];let S=m.split("_");J=S.length>=2&&S[1]=="type"?J+(m+"="+l+"&"):J+(m+"=redacted&")}}}else J=null;else J=L;return"XMLHTTP REQ ("+D+") [attempt "+O+"]: "+g+`
`+v+`
`+J})}function hg(u,g,v,D,O,L,J){u.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+O+"]: "+g+`
`+v+`
`+L+" "+J})}function gr(u,g,v,D){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+_n(u,v)+(D?" "+D:"")})}function fg(u,g){u.info(function(){return"TIMEOUT: "+g})}eo.prototype.info=function(){};function _n(u,g){if(!u.g)return g;if(!g)return null;try{let L=JSON.parse(g);if(L){for(u=0;u<L.length;u++)if(Array.isArray(L[u])){var v=L[u];if(!(v.length<2)){var D=v[1];if(Array.isArray(D)&&!(D.length<1)){var O=D[0];if(O!="noop"&&O!="stop"&&O!="close")for(let J=1;J<D.length;J++)D[J]=""}}}}return Ks(L)}catch{return g}}var Sa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},to={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},no;function Kd(){}p(Kd,ug),Kd.prototype.g=function(){return new XMLHttpRequest},no=new Kd;function Da(u){return encodeURIComponent(String(u))}function ro(u){var g=1;u=u.split(":");let v=[];for(;g>0&&u.length;)v.push(u.shift()),g--;return u.length&&v.push(u.join(":")),v}function ai(u,g,v,D){this.j=u,this.i=g,this.l=v,this.S=D||1,this.V=new Ji(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new pg}function pg(){this.i=null,this.g="",this.h=!1}var Aa={},vl={};function xa(u,g,v){u.M=1,u.A=Ma(Zn(g)),u.u=v,u.R=!0,Ra(u,null)}function Ra(u,g){u.F=Date.now(),io(u),u.B=Zn(u.A);var v=u.B,D=u.S;Array.isArray(D)||(D=[String(D)]),wg(v.i,"t",D),u.C=0,v=u.j.L,u.h=new pg,u.g=kl(u.j,v?g:null,!u.u),u.P>0&&(u.O=new Gd(d(u.Y,u,u.g),u.P)),g=u.V,v=u.g,D=u.ba;var O="readystatechange";Array.isArray(O)||(O&&(Jt[0]=O.toString()),O=Jt);for(let L=0;L<O.length;L++){let J=og(v,O[L],D||g.handleEvent,!1,g.h||g);if(!J)break;g.g[J.key]=J}g=u.J?sg(u.J):{},u.u?(u.v||(u.v="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.B,u.v,u.u,g)):(u.v="GET",u.g.ea(u.B,u.v,null,g)),Xs(),yl(u.i,u.v,u.B,u.l,u.S,u.u)}ai.prototype.ba=function(u){u=u.target;let g=this.O;g&&Qe(u)==3?g.j():this.Y(u)},ai.prototype.Y=function(u){try{if(u==this.g)e:{let ge=Qe(this.g),l=this.g.ya(),f=this.g.ca();if(!(ge<3)&&(ge!=3||this.g&&(this.h.h||this.g.la()||Dg(this.g)))){this.K||ge!=4||l==7||(l==8||f<=0?Xs(3):Xs(2)),wl(this);var g=this.g.ca();this.X=g;var v=ci(this);if(this.o=g==200,hg(this.i,this.v,this.B,this.l,this.S,ge,g),this.o){if(this.U&&!this.L){t:{if(this.g){var D,O=this.g;if((D=O.g?O.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(D)){var L=D;break t}}L=null}if(u=L)gr(this.i,this.l,u,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,oo(this,u);else{this.o=!1,this.m=3,Xt(12),Zi(this),so(this);break e}}if(this.R){u=!0;let m;for(;!this.K&&this.C<v.length;)if(m=gg(this,v),m==vl){ge==4&&(this.m=4,Xt(14),u=!1),gr(this.i,this.l,null,"[Incomplete Response]");break}else if(m==Aa){this.m=4,Xt(15),gr(this.i,this.l,v,"[Invalid Chunk]"),u=!1;break}else gr(this.i,this.l,m,null),oo(this,m);if(Qd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ge!=4||v.length!=0||this.h.h||(this.m=1,Xt(16),u=!1),this.o=this.o&&u,!u)gr(this.i,this.l,v,"[Invalid Chunked Response]"),Zi(this),so(this);else if(v.length>0&&!this.W){this.W=!0;var J=this.j;J.g==this&&J.aa&&!J.P&&(J.j.info("Great, no buffering proxy detected. Bytes received: "+v.length),Al(J),J.P=!0,Xt(11))}}else gr(this.i,this.l,v,null),oo(this,v);ge==4&&Zi(this),this.o&&!this.K&&(ge==4?ch(this.j,this):(this.o=!1,io(this)))}else iw(this.g),g==400&&v.indexOf("Unknown SID")>0?(this.m=3,Xt(12)):(this.m=0,Xt(13)),Zi(this),so(this)}}}catch{}finally{}};function ci(u){if(!Qd(u))return u.g.la();let g=Dg(u.g);if(g==="")return"";let v="",D=g.length,O=Qe(u.g)==4;if(!u.h.i){if(typeof TextDecoder>"u")return Zi(u),so(u),"";u.h.i=new o.TextDecoder}for(let L=0;L<D;L++)u.h.h=!0,v+=u.h.i.decode(g[L],{stream:!(O&&L==D-1)});return g.length=0,u.h.g+=v,u.C=0,u.h.g}function Qd(u){return u.g?u.v=="GET"&&u.M!=2&&u.j.Aa:!1}function gg(u,g){var v=u.C,D=g.indexOf(`
`,v);return D==-1?vl:(v=Number(g.substring(v,D)),isNaN(v)?Aa:(D+=1,D+v>g.length?vl:(g=g.slice(D,D+v),u.C=D+v,g)))}ai.prototype.cancel=function(){this.K=!0,Zi(this)};function io(u){u.T=Date.now()+u.H,_l(u,u.H)}function _l(u,g){if(u.D!=null)throw Error("WatchDog timer not null");u.D=Xn(d(u.aa,u),g)}function wl(u){u.D&&(o.clearTimeout(u.D),u.D=null)}ai.prototype.aa=function(){this.D=null;let u=Date.now();u-this.T>=0?(fg(this.i,this.B),this.M!=2&&(Xs(),Xt(17)),Zi(this),this.m=2,so(this)):_l(this,this.T-u)};function so(u){u.j.I==0||u.K||ch(u.j,u)}function Zi(u){wl(u);var g=u.O;g&&typeof g.dispose=="function"&&g.dispose(),u.O=null,cn(u.V),u.g&&(g=u.g,u.g=null,g.abort(),g.dispose())}function oo(u,g){try{var v=u.j;if(v.I!=0&&(v.g==u||ka(v.h,u))){if(!u.L&&ka(v.h,u)&&v.I==3){try{var D=v.Ba.g.parse(g)}catch{D=null}if(Array.isArray(D)&&D.length==3){var O=D;if(O[0]==0){e:if(!v.v){if(v.g)if(v.g.F+3e3<u.F)xl(v),es(v);else break e;go(v),Xt(18)}}else v.xa=O[1],0<v.xa-v.K&&O[2]<37500&&v.F&&v.A==0&&!v.C&&(v.C=Xn(d(v.Va,v),6e3));li(v.h)<=1&&v.ta&&(v.ta=void 0)}else di(v,11)}else if((u.L||v.g==u)&&xl(v),!w(g))for(O=v.Ba.g.parse(g),g=0;g<O.length;g++){let f=O[g],m=f[0];if(!(m<=v.K))if(v.K=m,f=f[1],v.I==2)if(f[0]=="c"){v.M=f[1],v.ba=f[2];let S=f[3];S!=null&&(v.ka=S,v.j.info("VER="+v.ka));let F=f[4];F!=null&&(v.za=F,v.j.info("SVER="+v.za));let U=f[5];U!=null&&typeof U=="number"&&U>0&&(D=1.5*U,v.O=D,v.j.info("backChannelRequestTimeoutMs_="+D)),D=v;let K=u.g;if(K){let We=K.g?K.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(We){var L=D.h;L.g||We.indexOf("spdy")==-1&&We.indexOf("quic")==-1&&We.indexOf("h2")==-1||(L.j=L.l,L.g=new Set,L.h&&(Yd(L,L.h),L.h=null))}if(D.G){let St=K.g?K.g.getResponseHeader("X-HTTP-Session-Id"):null;St&&(D.wa=St,st(D.J,D.G,St))}}v.I=3,v.l&&v.l.ra(),v.aa&&(v.T=Date.now()-u.F,v.j.info("Handshake RTT: "+v.T+"ms")),D=v;var J=u;if(D.na=Rl(D,D.L?D.ba:null,D.W),J.L){Jd(D.h,J);var ge=J,l=D.O;l&&(ge.H=l),ge.D&&(wl(ge),io(ge)),D.g=J}else Dl(D);v.i.length>0&&Gn(v)}else f[0]!="stop"&&f[0]!="close"||di(v,7);else v.I==3&&(f[0]=="stop"||f[0]=="close"?f[0]=="stop"?di(v,7):Sl(v):f[0]!="noop"&&v.l&&v.l.qa(f),v.A=0)}}Xs(4)}catch{}}var mg=class{constructor(u,g){this.g=u,this.map=g}};function Il(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=u.length>0&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function ao(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function li(u){return u.h?1:u.g?u.g.size:0}function ka(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Yd(u,g){u.g?u.g.add(g):u.h=g}function Jd(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}Il.prototype.cancel=function(){if(this.i=Xd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function Xd(u){if(u.h!=null)return u.i.concat(u.h.G);if(u.g!=null&&u.g.size!==0){let g=u.i;for(let v of u.g.values())g=g.concat(v.G);return g}return E(u.i)}var Zd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function eh(u,g){if(u){u=u.split("&");for(let v=0;v<u.length;v++){let D=u[v].indexOf("="),O,L=null;D>=0?(O=u[v].substring(0,D),L=u[v].substring(D+1)):O=u[v],g(O,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function mr(u){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let g;u instanceof mr?(this.l=u.l,co(this,u.j),this.o=u.o,this.g=u.g,Na(this,u.u),this.h=u.h,th(this,Ig(u.i)),this.m=u.m):u&&(g=String(u).match(Zd))?(this.l=!1,co(this,g[1]||"",!0),this.o=Pa(g[2]||""),this.g=Pa(g[3]||"",!0),Na(this,g[4]),this.h=Pa(g[5]||"",!0),th(this,g[6]||"",!0),this.m=Pa(g[7]||"")):(this.l=!1,this.i=new Or(null,this.l))}mr.prototype.toString=function(){let u=[];var g=this.j;g&&u.push(er(g,Oa,!0),":");var v=this.g;return(v||g=="file")&&(u.push("//"),(g=this.o)&&u.push(er(g,Oa,!0),"@"),u.push(Da(v).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.u,v!=null&&u.push(":",String(v))),(v=this.h)&&(this.g&&v.charAt(0)!="/"&&u.push("/"),u.push(er(v,v.charAt(0)=="/"?yg:El,!0))),(v=this.i.toString())&&u.push("?",v),(v=this.m)&&u.push("#",er(v,bl)),u.join("")},mr.prototype.resolve=function(u){let g=Zn(this),v=!!u.j;v?co(g,u.j):v=!!u.o,v?g.o=u.o:v=!!u.g,v?g.g=u.g:v=u.u!=null;var D=u.h;if(v)Na(g,u.u);else if(v=!!u.h){if(D.charAt(0)!="/")if(this.g&&!this.h)D="/"+D;else{var O=g.h.lastIndexOf("/");O!=-1&&(D=g.h.slice(0,O+1)+D)}if(O=D,O==".."||O==".")D="";else if(O.indexOf("./")!=-1||O.indexOf("/.")!=-1){D=O.lastIndexOf("/",0)==0,O=O.split("/");let L=[];for(let J=0;J<O.length;){let ge=O[J++];ge=="."?D&&J==O.length&&L.push(""):ge==".."?((L.length>1||L.length==1&&L[0]!="")&&L.pop(),D&&J==O.length&&L.push("")):(L.push(ge),D=!0)}D=L.join("/")}else D=O}return v?g.h=D:v=u.i.toString()!=="",v?th(g,Ig(u.i)):v=!!u.m,v&&(g.m=u.m),g};function Zn(u){return new mr(u)}function co(u,g,v){u.j=v?Pa(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Na(u,g){if(g){if(g=Number(g),isNaN(g)||g<0)throw Error("Bad port number "+g);u.u=g}else u.u=null}function th(u,g,v){g instanceof Or?(u.i=g,Fa(u.i,u.l)):(v||(g=er(g,ct)),u.i=new Or(g,u.l))}function st(u,g,v){u.i.set(g,v)}function Ma(u){return st(u,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),u}function Pa(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function er(u,g,v){return typeof u=="string"?(u=encodeURI(u).replace(g,Pr),v&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Pr(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Oa=/[#\/\?@]/g,El=/[#\?:]/g,yg=/[#\?]/g,ct=/[#\?@]/g,bl=/#/g;function Or(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function tr(u){u.g||(u.g=new Map,u.h=0,u.i&&eh(u.i,function(g,v){u.add(decodeURIComponent(g.replace(/\+/g," ")),v)}))}n=Or.prototype,n.add=function(u,g){tr(this),this.i=null,u=lo(this,u);let v=this.g.get(u);return v||this.g.set(u,v=[]),v.push(g),this.h+=1,this};function vg(u,g){tr(u),g=lo(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function nh(u,g){return tr(u),g=lo(u,g),u.g.has(g)}n.forEach=function(u,g){tr(this),this.g.forEach(function(v,D){v.forEach(function(O){u.call(g,O,D,this)},this)},this)};function _g(u,g){tr(u);let v=[];if(typeof g=="string")nh(u,g)&&(v=v.concat(u.g.get(lo(u,g))));else for(u=Array.from(u.g.values()),g=0;g<u.length;g++)v=v.concat(u[g]);return v}n.set=function(u,g){return tr(this),this.i=null,u=lo(this,u),nh(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},n.get=function(u,g){return u?(u=_g(this,u),u.length>0?String(u[0]):g):g};function wg(u,g,v){vg(u,g),v.length>0&&(u.i=null,u.g.set(lo(u,g),E(v)),u.h+=v.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],g=Array.from(this.g.keys());for(let D=0;D<g.length;D++){var v=g[D];let O=Da(v);v=_g(this,v);for(let L=0;L<v.length;L++){let J=O;v[L]!==""&&(J+="="+Da(v[L])),u.push(J)}}return this.i=u.join("&")};function Ig(u){let g=new Or;return g.i=u.i,u.g&&(g.g=new Map(u.g),g.h=u.h),g}function lo(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function Fa(u,g){g&&!u.j&&(tr(u),u.i=null,u.g.forEach(function(v,D){let O=D.toLowerCase();D!=O&&(vg(this,D),wg(this,O,v))},u)),u.j=g}function ui(u,g){let v=new eo;if(o.Image){let D=new Image;D.onload=h(Fr,v,"TestLoadImage: loaded",!0,g,D),D.onerror=h(Fr,v,"TestLoadImage: error",!1,g,D),D.onabort=h(Fr,v,"TestLoadImage: abort",!1,g,D),D.ontimeout=h(Fr,v,"TestLoadImage: timeout",!1,g,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=u}else g(!1)}function Eg(u,g){let v=new eo,D=new AbortController,O=setTimeout(()=>{D.abort(),Fr(v,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:D.signal}).then(L=>{clearTimeout(O),L.ok?Fr(v,"TestPingServer: ok",!0,g):Fr(v,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(O),Fr(v,"TestPingServer: error",!1,g)})}function Fr(u,g,v,D,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),D(v)}catch{}}function bg(){this.g=new lg}function Vr(u){this.i=u.Sb||null,this.h=u.ab||!1}p(Vr,ug),Vr.prototype.g=function(){return new Cl(this.i,this.h)};function Cl(u,g){Qt.call(this),this.H=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}p(Cl,Qt),n=Cl.prototype,n.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=u,this.D=g,this.readyState=1,zn(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let g={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};u&&(g.body=u),(this.H||o).fetch(new Request(this.D,g)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Va(this)),this.readyState=0},n.Pa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,zn(this)),this.g&&(this.readyState=3,zn(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Cg(this)}else u.text().then(this.Oa.bind(this),this.ga.bind(this))};function Cg(u){u.j.read().then(u.Ma.bind(u)).catch(u.ga.bind(u))}n.Ma=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.B.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Va(this):zn(this),this.readyState==3&&Cg(this)}},n.Oa=function(u){this.g&&(this.response=this.responseText=u,Va(this))},n.Na=function(u){this.g&&(this.response=u,Va(this))},n.ga=function(){this.g&&Va(this)};function Va(u){u.readyState=4,u.l=null,u.j=null,u.B=null,zn(u)}n.setRequestHeader=function(u,g){this.A.append(u,g)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],g=this.h.entries();for(var v=g.next();!v.done;)v=v.value,u.push(v[0]+": "+v[1]),v=g.next();return u.join(`\r
`)};function zn(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Cl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Tg(u){let g="";return Ws(u,function(v,D){g+=D,g+=":",g+=v,g+=`\r
`}),g}function rh(u,g,v){e:{for(D in v){var D=!1;break e}D=!0}D||(v=Tg(v),typeof u=="string"?v!=null&&Da(v):st(u,g,v))}function ot(u){Qt.call(this),this.headers=new Map,this.L=u||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}p(ot,Qt);var Tl=/^https?$/i,Sg=["POST","PUT"];n=ot.prototype,n.Fa=function(u){this.H=u},n.ea=function(u,g,v,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():no.g(),this.g.onreadystatechange=y(d(this.Ca,this));try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(L){uo(this,L);return}if(u=v||"",v=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var O in D)v.set(O,D[O]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(let L of D.keys())v.set(L,D.get(L));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(v.keys()).find(L=>L.toLowerCase()=="content-type"),O=o.FormData&&u instanceof o.FormData,!(Array.prototype.indexOf.call(Sg,g,void 0)>=0)||D||O||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[L,J]of v)this.g.setRequestHeader(L,J);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(u),this.v=!1}catch(L){uo(this,L)}};function uo(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.o=5,ho(u),fo(u)}function ho(u){u.A||(u.A=!0,Yt(u,"complete"),Yt(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=u||7,Yt(this,"complete"),Yt(this,"abort"),fo(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fo(this,!0)),ot.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?ih(this):this.Xa())},n.Xa=function(){ih(this)};function ih(u){if(u.h&&typeof s<"u"){if(u.v&&Qe(u)==4)setTimeout(u.Ca.bind(u),0);else if(Yt(u,"readystatechange"),Qe(u)==4){u.h=!1;try{let L=u.ca();e:switch(L){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var v;if(!(v=g)){var D;if(D=L===0){let J=String(u.D).match(Zd)[1]||null;!J&&o.self&&o.self.location&&(J=o.self.location.protocol.slice(0,-1)),D=!Tl.test(J?J.toLowerCase():"")}v=D}if(v)Yt(u,"complete"),Yt(u,"success");else{u.o=6;try{var O=Qe(u)>2?u.g.statusText:""}catch{O=""}u.l=O+" ["+u.ca()+"]",ho(u)}}finally{fo(u)}}}}function fo(u,g){if(u.g){u.m&&(clearTimeout(u.m),u.m=null);let v=u.g;u.g=null,g||Yt(u,"ready");try{v.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Qe(u){return u.g?u.g.readyState:0}n.ca=function(){try{return Qe(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),cg(g)}};function Dg(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.F){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function iw(u){let g={};u=(u.g&&Qe(u)>=2&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<u.length;D++){if(w(u[D]))continue;var v=ro(u[D]);let O=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();let L=g[O]||[];g[O]=L,L.push(v)}ig(g,function(D){return D.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function po(u,g,v){return v&&v.internalChannelParams&&v.internalChannelParams[u]||g}function sh(u){this.za=0,this.i=[],this.j=new eo,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=po("failFast",!1,u),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=po("baseRetryDelayMs",5e3,u),this.Za=po("retryDelaySeedMs",1e4,u),this.Ta=po("forwardChannelMaxRetries",2,u),this.va=po("forwardChannelRequestTimeoutMs",2e4,u),this.ma=u&&u.xmlHttpFactory||void 0,this.Ua=u&&u.Rb||void 0,this.Aa=u&&u.useFetchStreams||!1,this.O=void 0,this.L=u&&u.supportsCrossDomainXhr||!1,this.M="",this.h=new Il(u&&u.concurrentRequestLimit),this.Ba=new bg,this.S=u&&u.fastHandshake||!1,this.R=u&&u.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=u&&u.Pb||!1,u&&u.ua&&this.j.ua(),u&&u.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&u&&u.detectBufferingProxy||!1,this.ia=void 0,u&&u.longPollingTimeout&&u.longPollingTimeout>0&&(this.ia=u.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=sh.prototype,n.ka=8,n.I=1,n.connect=function(u,g,v,D){Xt(0),this.W=u,this.H=g||{},v&&D!==void 0&&(this.H.OSID=v,this.H.OAID=D),this.F=this.X,this.J=Rl(this,null,this.W),Gn(this)};function Sl(u){if(oh(u),u.I==3){var g=u.V++,v=Zn(u.J);if(st(v,"SID",u.M),st(v,"RID",g),st(v,"TYPE","terminate"),Lr(u,v),g=new ai(u,u.j,g),g.M=2,g.A=Ma(Zn(v)),v=!1,o.navigator&&o.navigator.sendBeacon)try{v=o.navigator.sendBeacon(g.A.toString(),"")}catch{}!v&&o.Image&&(new Image().src=g.A,v=!0),v||(g.g=kl(g.j,null),g.g.ea(g.A)),g.F=Date.now(),io(g)}lh(u)}function es(u){u.g&&(Al(u),u.g.cancel(),u.g=null)}function oh(u){es(u),u.v&&(o.clearTimeout(u.v),u.v=null),xl(u),u.h.cancel(),u.m&&(typeof u.m=="number"&&o.clearTimeout(u.m),u.m=null)}function Gn(u){if(!ao(u.h)&&!u.m){u.m=!0;var g=u.Ea;Je||_(),pe||(Je(),pe=!0),T.add(g,u),u.D=0}}function Ag(u,g){return li(u.h)>=u.h.j-(u.m?1:0)?!1:u.m?(u.i=g.G.concat(u.i),!0):u.I==1||u.I==2||u.D>=(u.Sa?0:u.Ta)?!1:(u.m=Xn(d(u.Ea,u,g),mo(u,u.D)),u.D++,!0)}n.Ea=function(u){if(this.m)if(this.m=null,this.I==1){if(!u){this.V=Math.floor(Math.random()*1e5),u=this.V++;let O=new ai(this,this.j,u),L=this.o;if(this.U&&(L?(L=sg(L),Kt(L,this.U)):L=this.U),this.u!==null||this.R||(O.J=L,L=null),this.S)e:{for(var g=0,v=0;v<this.i.length;v++){t:{var D=this.i[v];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(g+=D,g>4096){g=v;break e}if(g===4096||v===this.i.length-1){g=v+1;break e}}g=1e3}else g=1e3;g=ah(this,O,g),v=Zn(this.J),st(v,"RID",u),st(v,"CVER",22),this.G&&st(v,"X-HTTP-Session-Id",this.G),Lr(this,v),L&&(this.R?g="headers="+Da(Tg(L))+"&"+g:this.u&&rh(v,this.u,L)),Yd(this.h,O),this.Ra&&st(v,"TYPE","init"),this.S?(st(v,"$req",g),st(v,"SID","null"),O.U=!0,xa(O,v,null)):xa(O,v,g),this.I=2}}else this.I==3&&(u?xg(this,u):this.i.length==0||ao(this.h)||xg(this))};function xg(u,g){var v;g?v=g.l:v=u.V++;let D=Zn(u.J);st(D,"SID",u.M),st(D,"RID",v),st(D,"AID",u.K),Lr(u,D),u.u&&u.o&&rh(D,u.u,u.o),v=new ai(u,u.j,v,u.D+1),u.u===null&&(v.J=u.o),g&&(u.i=g.G.concat(u.i)),g=ah(u,v,1e3),v.H=Math.round(u.va*.5)+Math.round(u.va*.5*Math.random()),Yd(u.h,v),xa(v,D,g)}function Lr(u,g){u.H&&Ws(u.H,function(v,D){st(g,D,v)}),u.l&&Ws({},function(v,D){st(g,D,v)})}function ah(u,g,v){v=Math.min(u.i.length,v);let D=u.l?d(u.l.Ka,u.l,u):null;e:{var O=u.i;let ge=-1;for(;;){let l=["count="+v];ge==-1?v>0?(ge=O[0].g,l.push("ofs="+ge)):ge=0:l.push("ofs="+ge);let f=!0;for(let m=0;m<v;m++){var L=O[m].g;let S=O[m].map;if(L-=ge,L<0)ge=Math.max(0,O[m].g-100),f=!1;else try{L="req"+L+"_"||"";try{var J=S instanceof Map?S:Object.entries(S);for(let[F,U]of J){let K=U;a(U)&&(K=Ks(U)),l.push(L+F+"="+encodeURIComponent(K))}}catch(F){throw l.push(L+"type="+encodeURIComponent("_badmap")),F}}catch{D&&D(S)}}if(f){J=l.join("&");break e}}J=void 0}return u=u.i.splice(0,v),g.G=u,J}function Dl(u){if(!u.g&&!u.v){u.Y=1;var g=u.Da;Je||_(),pe||(Je(),pe=!0),T.add(g,u),u.A=0}}function go(u){return u.g||u.v||u.A>=3?!1:(u.Y++,u.v=Xn(d(u.Da,u),mo(u,u.A)),u.A++,!0)}n.Da=function(){if(this.v=null,La(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var u=4*this.T;this.j.info("BP detection timer enabled: "+u),this.B=Xn(d(this.Wa,this),u)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Xt(10),es(this),La(this))};function Al(u){u.B!=null&&(o.clearTimeout(u.B),u.B=null)}function La(u){u.g=new ai(u,u.j,"rpc",u.Y),u.u===null&&(u.g.J=u.o),u.g.P=0;var g=Zn(u.na);st(g,"RID","rpc"),st(g,"SID",u.M),st(g,"AID",u.K),st(g,"CI",u.F?"0":"1"),!u.F&&u.ia&&st(g,"TO",u.ia),st(g,"TYPE","xmlhttp"),Lr(u,g),u.u&&u.o&&rh(g,u.u,u.o),u.O&&(u.g.H=u.O);var v=u.g;u=u.ba,v.M=1,v.A=Ma(Zn(g)),v.u=null,v.R=!0,Ra(v,u)}n.Va=function(){this.C!=null&&(this.C=null,es(this),go(this),Xt(19))};function xl(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function ch(u,g){var v=null;if(u.g==g){xl(u),Al(u),u.g=null;var D=2}else if(ka(u.h,g))v=g.G,Jd(u.h,g),D=1;else return;if(u.I!=0){if(g.o)if(D==1){v=g.u?g.u.length:0,g=Date.now()-g.F;var O=u.D;D=Js(),Yt(D,new ml(D,v)),Gn(u)}else Dl(u);else if(O=g.m,O==3||O==0&&g.X>0||!(D==1&&Ag(u,g)||D==2&&go(u)))switch(v&&v.length>0&&(g=u.h,g.i=g.i.concat(v)),O){case 1:di(u,5);break;case 4:di(u,10);break;case 3:di(u,6);break;default:di(u,2)}}}function mo(u,g){let v=u.Qa+Math.floor(Math.random()*u.Za);return u.isActive()||(v*=2),v*g}function di(u,g){if(u.j.info("Error code "+g),g==2){var v=d(u.bb,u),D=u.Ua;let O=!D;D=new mr(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||co(D,"https"),Ma(D),O?ui(D.toString(),v):Eg(D.toString(),v)}else Xt(2);u.I=0,u.l&&u.l.pa(g),lh(u),oh(u)}n.bb=function(u){u?(this.j.info("Successfully pinged google.com"),Xt(2)):(this.j.info("Failed to ping google.com"),Xt(1))};function lh(u){if(u.I=0,u.ja=[],u.l){let g=Xd(u.h);(g.length!=0||u.i.length!=0)&&(k(u.ja,g),k(u.ja,u.i),u.h.i.length=0,E(u.i),u.i.length=0),u.l.oa()}}function Rl(u,g,v){var D=v instanceof mr?Zn(v):new mr(v);if(D.g!="")g&&(D.g=g+"."+D.g),Na(D,D.u);else{var O=o.location;D=O.protocol,g=g?g+"."+O.hostname:O.hostname,O=+O.port;let L=new mr(null);D&&co(L,D),g&&(L.g=g),O&&Na(L,O),v&&(L.h=v),D=L}return v=u.G,g=u.wa,v&&g&&st(D,v,g),st(D,"VER",u.ka),Lr(u,D),D}function kl(u,g,v){if(g&&!u.L)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Aa&&!u.ma?new ot(new Vr({ab:v})):new ot(u.ma),g.Fa(u.L),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function uh(){}n=uh.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ts(){}ts.prototype.g=function(u,g){return new Cn(u,g)};function Cn(u,g){Qt.call(this),this.g=new sh(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.sa&&(u?u["X-WebChannel-Client-Profile"]=g.sa:u={"X-WebChannel-Client-Profile":g.sa}),this.g.U=u,(u=g&&g.Qb)&&!w(u)&&(this.g.u=u),this.A=g&&g.supportsCrossDomainXhr||!1,this.v=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!w(g)&&(this.g.G=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new ns(this)}p(Cn,Qt),Cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Cn.prototype.close=function(){Sl(this.g)},Cn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var v={};v.__data__=u,u=v}else this.v&&(v={},v.__data__=Ks(u),u=v);g.i.push(new mg(g.Ya++,u)),g.I==3&&Gn(g)},Cn.prototype.N=function(){this.g.l=null,delete this.j,Sl(this.g),delete this.g,Cn.Z.N.call(this)};function dh(u){gl.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(let v in g){u=v;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}p(dh,gl);function hi(){Ta.call(this),this.status=1}p(hi,Ta);function ns(u){this.g=u}p(ns,uh),ns.prototype.ra=function(){Yt(this.g,"a")},ns.prototype.qa=function(u){Yt(this.g,new dh(u))},ns.prototype.pa=function(u){Yt(this.g,new hi)},ns.prototype.oa=function(){Yt(this.g,"b")},ts.prototype.createWebChannel=ts.prototype.g,Cn.prototype.send=Cn.prototype.o,Cn.prototype.open=Cn.prototype.m,Cn.prototype.close=Cn.prototype.close,dT=As.createWebChannelTransport=function(){return new ts},uT=As.getStatEventTarget=function(){return Js()},lT=As.Event=Xi,Hv=As.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Sa.NO_ERROR=0,Sa.TIMEOUT=8,Sa.HTTP_ERROR=6,np=As.ErrorCode=Sa,to.COMPLETE="complete",cT=As.EventType=to,Qs.EventType=Ys,Ys.OPEN="a",Ys.CLOSE="b",Ys.ERROR="c",Ys.MESSAGE="d",Qt.prototype.listen=Qt.prototype.J,Mu=As.WebChannel=Qs,LW=As.FetchXmlHttpFactory=Vr,ot.prototype.listenOnce=ot.prototype.K,ot.prototype.getLastError=ot.prototype.Ha,ot.prototype.getLastErrorCode=ot.prototype.ya,ot.prototype.getStatus=ot.prototype.ca,ot.prototype.getResponseJson=ot.prototype.La,ot.prototype.getResponseText=ot.prototype.la,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Fa,aT=As.XhrIo=ot}).apply(typeof $v<"u"?$v:typeof self<"u"?self:typeof window<"u"?window:{});var H2="@firebase/firestore",q2="4.9.2";var pn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};pn.UNAUTHENTICATED=new pn(null),pn.GOOGLE_CREDENTIALS=new pn("google-credentials-uid"),pn.FIRST_PARTY=new pn("first-party-uid"),pn.MOCK_USER=new pn("mock-user");var rd="12.3.0";var Lc=new ku("@firebase/firestore");function Pu(){return Lc.logLevel}function ie(n,...e){if(Lc.logLevel<=$e.DEBUG){let t=e.map(nD);Lc.debug(`Firestore (${rd}): ${n}`,...t)}}function Ns(n,...e){if(Lc.logLevel<=$e.ERROR){let t=e.map(nD);Lc.error(`Firestore (${rd}): ${n}`,...t)}}function $u(n,...e){if(Lc.logLevel<=$e.WARN){let t=e.map(nD);Lc.warn(`Firestore (${rd}): ${n}`,...t)}}function nD(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function he(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,OF(n,r,t)}function OF(n,e,t){let r=`FIRESTORE (${rd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Ns(r),new Error(r)}function rt(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||OF(e,i,r)}function Ee(n,e){return n}var z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},ne=class extends Es{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var xs=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Yv=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},yT=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(pn.UNAUTHENTICATED))}shutdown(){}},vT=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},_T=class{constructor(e){this.t=e,this.currentUser=pn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){rt(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new xs;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new xs,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{ie("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(ie("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new xs)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ie("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(rt(typeof r.accessToken=="string",31837,{l:r}),new Yv(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return rt(e===null||typeof e=="string",2055,{h:e}),new pn(e)}},wT=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=pn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},IT=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new wT(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(pn.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Jv=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},ET=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,GO(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){rt(this.o===void 0,3512);let r=s=>{s.error!=null&&ie("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,ie("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{ie("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):ie("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new Jv(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(rt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Jv(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function UW(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var cp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=UW(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function Ve(n,e){return n<e?-1:n>e?1:0}function bT(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return hT(i)===hT(s)?Ve(i,s):hT(i)?1:-1}return Ve(n.length,e.length)}var jW=55296,BW=57343;function hT(n){let e=n.charCodeAt(0);return e>=jW&&e<=BW}function Hu(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var z2="__name__",Xv=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&he(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&he(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Ve(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):bT(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ds.fromString(e.substring(4,e.length-2))}},yt=class n extends Xv{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new ne(z.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},$W=/^[_a-zA-Z][_a-zA-Z0-9]*$/,hr=class n extends Xv{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return $W.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===z2}static keyField(){return new n([z2])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new ne(z.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new ne(z.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ne(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(z.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var le=class n{constructor(e){this.path=e}static fromPath(e){return new n(yt.fromString(e))}static fromName(e){return new n(yt.fromString(e).popFirst(5))}static empty(){return new n(yt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&yt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return yt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new yt(e.slice()))}};function FF(n,e,t){if(!t)throw new ne(z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function HW(n,e,t,r){if(e===!0&&r===!0)throw new ne(z.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function G2(n){if(!le.isDocumentKey(n))throw new ne(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function W2(n){if(le.isDocumentKey(n))throw new ne(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function VF(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function x_(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":he(12329,{type:typeof n})}function Rs(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ne(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=x_(n);throw new ne(z.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Bt(n,e){let t={typeString:n};return e&&(t.value=e),t}function wp(n,e){if(!VF(n))throw new ne(z.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new ne(z.INVALID_ARGUMENT,t);return!0}var K2=-62135596800,Q2=1e6,$t=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*Q2);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ne(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ne(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<K2)throw new ne(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Q2}_compareTo(e){return this.seconds===e.seconds?Ve(this.nanoseconds,e.nanoseconds):Ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wp(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-K2;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};$t._jsonSchemaVersion="firestore/timestamp/1.0",$t._jsonSchema={type:Bt("string",$t._jsonSchemaVersion),seconds:Bt("number"),nanoseconds:Bt("number")};var De=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new $t(0,0))}static max(){return new n(new $t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var lp=-1,CT=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};CT.UNKNOWN_ID=-1;function qW(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=De.fromTimestamp(r===1e9?new $t(t+1,0):new $t(t,r));return new Uc(i,le.empty(),e)}function zW(n){return new Uc(n.readTime,n.key,lp)}var Uc=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(De.min(),le.empty(),lp)}static max(){return new n(De.max(),le.empty(),lp)}};function GW(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=le.comparator(n.documentKey,e.documentKey),t!==0?t:Ve(n.largestBatchId,e.largestBatchId))}var WW="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",TT=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function id(n){if(n.code!==z.FAILED_PRECONDITION||n.message!==WW)throw n;ie("LocalStore","Unexpectedly lost primary lease")}var G=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&he(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let d=c;t(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function KW(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function sd(n){return n.name==="IndexedDbTransactionError"}var rD=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>r.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ue&&this.ue(t),t}}n.ce=-1;return n})(),iD=-1;function R_(n){return n==null}function up(n){return n===0&&1/n==-1/0}function QW(n){return typeof n=="number"&&Number.isInteger(n)&&!up(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var LF="";function YW(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Y2(e)),e=JW(n.get(t),e);return Y2(e)}function JW(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case LF:t+="";break;default:t+=s}}return t}function Y2(n){return n+LF+""}var XW="remoteDocuments",UF="owner";var jF="mutationQueues";var BF="mutations";var $F="documentMutations",ZW="remoteDocumentsV14";var HF="remoteDocumentGlobal";var qF="targets";var zF="targetDocuments";var GF="targetGlobal",WF="collectionParents";var KF="clientMetadata";var QF="bundles";var YF="namedQueries";var eK="indexConfiguration";var tK="indexState";var nK="indexEntries";var JF="documentOverlays";var rK="globals";var iK=[jF,BF,$F,XW,qF,UF,GF,zF,KF,HF,WF,QF,YF],D_e=[...iK,JF],sK=[jF,BF,$F,ZW,qF,UF,GF,zF,KF,HF,WF,QF,YF,JF],oK=sK,aK=[...oK,eK,tK,nK];var A_e=[...aK,rK];function J2(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ia(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function XF(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ct=class n{constructor(e,t){this.comparator=e,this.root=t||Oi.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Oi.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Oi.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Lu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Lu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Lu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Lu(this.root,e,this.comparator,!0)}},Lu=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Oi=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw he(43730,{key:this.key,value:this.value});if(this.right.isRed())throw he(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw he(27949);return e+(this.isRed()?0:1)}};Oi.EMPTY=null,Oi.RED=!0,Oi.BLACK=!1;Oi.EMPTY=new class{constructor(){this.size=0}get key(){throw he(57766)}get value(){throw he(16141)}get color(){throw he(16727)}get left(){throw he(29726)}get right(){throw he(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Oi(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var gn=class n{constructor(e){this.comparator=e,this.data=new Ct(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Zv(this.data.getIterator())}getIteratorFrom(e){return new Zv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Zv=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Dr=class n{constructor(e){this.fields=e,e.sort(hr.comparator)}static empty(){return new n([])}unionWith(e){let t=new gn(hr.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Hu(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var e_=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Mn=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new e_("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Mn.EMPTY_BYTE_STRING=new Mn("");var cK=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ms(n){if(rt(!!n,39018),typeof n=="string"){let e=0,t=cK.exec(n);if(rt(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:mt(n.seconds),nanos:mt(n.nanos)}}function mt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ps(n){return typeof n=="string"?Mn.fromBase64String(n):Mn.fromUint8Array(n)}var ZF="server_timestamp",eV="__type__",tV="__previous_value__",nV="__local_write_time__";function sD(n){return(n?.mapValue?.fields||{})[eV]?.stringValue===ZF}function k_(n){let e=n.mapValue.fields[tV];return sD(e)?k_(e):e}function dp(n){let e=Ms(n.mapValue.fields[nV].timestampValue);return new $t(e.seconds,e.nanos)}var ST=class{constructor(e,t,r,i,s,o,a,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h}},t_="(default)",n_=class n{constructor(e,t){this.projectId=e,this.database=t||t_}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===t_}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var oD="__type__",rV="__max__",qv={mapValue:{fields:{__type__:{stringValue:rV}}}},aD="__vector__",qu="value";function ea(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sD(n)?4:sV(n)?9007199254740991:iV(n)?10:11:he(28295,{value:n})}function Li(n,e){if(n===e)return!0;let t=ea(n);if(t!==ea(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return dp(n).isEqual(dp(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Ms(i.timestampValue),a=Ms(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return Ps(i.bytesValue).isEqual(Ps(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return mt(i.geoPointValue.latitude)===mt(s.geoPointValue.latitude)&&mt(i.geoPointValue.longitude)===mt(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return mt(i.integerValue)===mt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=mt(i.doubleValue),a=mt(s.doubleValue);return o===a?up(o)===up(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return Hu(n.arrayValue.values||[],e.arrayValue.values||[],Li);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(J2(o)!==J2(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Li(o[c],a[c])))return!1;return!0})(n,e);default:return he(52216,{left:n})}}function hp(n,e){return(n.values||[]).find(t=>Li(t,e))!==void 0}function zu(n,e){if(n===e)return 0;let t=ea(n),r=ea(e);if(t!==r)return Ve(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ve(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let a=mt(s.integerValue||s.doubleValue),c=mt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return X2(n.timestampValue,e.timestampValue);case 4:return X2(dp(n),dp(e));case 5:return bT(n.stringValue,e.stringValue);case 6:return(function(s,o){let a=Ps(s),c=Ps(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let a=s.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){let h=Ve(a[d],c[d]);if(h!==0)return h}return Ve(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let a=Ve(mt(s.latitude),mt(o.latitude));return a!==0?a:Ve(mt(s.longitude),mt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return Z2(n.arrayValue,e.arrayValue);case 10:return(function(s,o){let a=s.fields||{},c=o.fields||{},d=a[qu]?.arrayValue,h=c[qu]?.arrayValue,p=Ve(d?.values?.length||0,h?.values?.length||0);return p!==0?p:Z2(d,h)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===qv.mapValue&&o===qv.mapValue)return 0;if(s===qv.mapValue)return 1;if(o===qv.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){let y=bT(c[p],h[p]);if(y!==0)return y;let E=zu(a[c[p]],d[h[p]]);if(E!==0)return E}return Ve(c.length,h.length)})(n.mapValue,e.mapValue);default:throw he(23264,{he:t})}}function X2(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ve(n,e);let t=Ms(n),r=Ms(e),i=Ve(t.seconds,r.seconds);return i!==0?i:Ve(t.nanos,r.nanos)}function Z2(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=zu(t[i],r[i]);if(s)return s}return Ve(t.length,r.length)}function Gu(n){return DT(n)}function DT(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=Ms(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return Ps(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return le.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=DT(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${DT(t.fields[o])}`;return i+"}"})(n.mapValue):he(61005,{value:n})}function Wv(n){switch(ea(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=k_(n);return e?16+Wv(e):16;case 5:return 2*n.stringValue.length;case 6:return Ps(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+Wv(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ia(r.fields,(s,o)=>{i+=s.length+Wv(o)}),i})(n.mapValue);default:throw he(13486,{value:n})}}function eF(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function AT(n){return!!n&&"integerValue"in n}function cD(n){return!!n&&"arrayValue"in n}function tF(n){return!!n&&"nullValue"in n}function nF(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Kv(n){return!!n&&"mapValue"in n}function iV(n){return(n?.mapValue?.fields||{})[oD]?.stringValue===aD}function ip(n){if(n.geoPointValue)return{geoPointValue:H({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:H({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ia(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ip(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ip(n.arrayValue.values[t]);return e}return H({},n)}function sV(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===rV}var R_e={mapValue:{fields:{[oD]:{stringValue:aD},[qu]:{arrayValue:{}}}}};var dr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Kv(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ip(t)}setAll(e){let t=hr.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=ip(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Kv(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Li(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Kv(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ia(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(ip(this.value))}};function oV(n){let e=[];return ia(n.fields,(t,r)=>{let i=new hr([t]);if(Kv(r)){let s=oV(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Dr(e)}var ti=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,De.min(),De.min(),De.min(),dr.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,De.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,De.min(),De.min(),dr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,De.min(),De.min(),dr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Wu=class{constructor(e,t){this.position=e,this.inclusive=t}};function rF(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=le.comparator(le.fromName(o.referenceValue),t.key):r=zu(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function iF(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Li(n.position[t],e.position[t]))return!1;return!0}var Ku=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function lK(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var r_=class{},jt=class n extends r_{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new RT(e,t,r):t==="array-contains"?new MT(e,r):t==="in"?new PT(e,r):t==="not-in"?new OT(e,r):t==="array-contains-any"?new FT(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new kT(e,r):new NT(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(zu(t,this.value)):t!==null&&ea(this.value)===ea(t)&&this.matchesComparison(zu(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return he(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ni=class n extends r_{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return aV(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function aV(n){return n.op==="and"}function cV(n){return uK(n)&&aV(n)}function uK(n){for(let e of n.filters)if(e instanceof ni)return!1;return!0}function xT(n){if(n instanceof jt)return n.field.canonicalString()+n.op.toString()+Gu(n.value);if(cV(n))return n.filters.map(e=>xT(e)).join(",");{let e=n.filters.map(t=>xT(t)).join(",");return`${n.op}(${e})`}}function lV(n,e){return n instanceof jt?(function(r,i){return i instanceof jt&&r.op===i.op&&r.field.isEqual(i.field)&&Li(r.value,i.value)})(n,e):n instanceof ni?(function(r,i){return i instanceof ni&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&lV(o,i.filters[a]),!0):!1})(n,e):void he(19439)}function uV(n){return n instanceof jt?(function(t){return`${t.field.canonicalString()} ${t.op} ${Gu(t.value)}`})(n):n instanceof ni?(function(t){return t.op.toString()+" {"+t.getFilters().map(uV).join(" ,")+"}"})(n):"Filter"}var RT=class extends jt{constructor(e,t,r){super(e,t,r),this.key=le.fromName(r.referenceValue)}matches(e){let t=le.comparator(e.key,this.key);return this.matchesComparison(t)}},kT=class extends jt{constructor(e,t){super(e,"in",t),this.keys=dV("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},NT=class extends jt{constructor(e,t){super(e,"not-in",t),this.keys=dV("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function dV(n,e){return(e.arrayValue?.values||[]).map(t=>le.fromName(t.referenceValue))}var MT=class extends jt{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return cD(t)&&hp(t.arrayValue,this.value)}},PT=class extends jt{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&hp(this.value.arrayValue,t)}},OT=class extends jt{constructor(e,t){super(e,"not-in",t)}matches(e){if(hp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!hp(this.value.arrayValue,t)}},FT=class extends jt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!cD(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>hp(this.value.arrayValue,r))}};var VT=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Te=null}};function sF(n,e=null,t=[],r=[],i=null,s=null,o=null){return new VT(n,e,t,r,i,s,o)}function lD(n){let e=Ee(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>xT(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),R_(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Gu(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Gu(r)).join(",")),e.Te=t}return e.Te}function uD(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!lK(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!lV(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!iF(n.startAt,e.startAt)&&iF(n.endAt,e.endAt)}function LT(n){return le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var jc=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function dK(n,e,t,r,i,s,o,a){return new jc(n,e,t,r,i,s,o,a)}function dD(n){return new jc(n)}function oF(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function hV(n){return n.collectionGroup!==null}function sp(n){let e=Ee(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new gn(hr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Ku(s,r))}),t.has(hr.keyField().canonicalString())||e.Ie.push(new Ku(hr.keyField(),r))}return e.Ie}function Fi(n){let e=Ee(n);return e.Ee||(e.Ee=hK(e,sp(n))),e.Ee}function hK(n,e){if(n.limitType==="F")return sF(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Ku(i.field,s)});let t=n.endAt?new Wu(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Wu(n.startAt.position,n.startAt.inclusive):null;return sF(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function UT(n,e){let t=n.filters.concat([e]);return new jc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function jT(n,e,t){return new jc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function N_(n,e){return uD(Fi(n),Fi(e))&&n.limitType===e.limitType}function fV(n){return`${lD(Fi(n))}|lt:${n.limitType}`}function Ou(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>uV(i)).join(", ")}]`),R_(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Gu(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Gu(i)).join(",")),`Target(${r})`})(Fi(n))}; limitType=${n.limitType})`}function M_(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):le.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of sp(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){let d=rF(o,a,c);return o.inclusive?d<=0:d<0})(r.startAt,sp(r),i)||r.endAt&&!(function(o,a,c){let d=rF(o,a,c);return o.inclusive?d>=0:d>0})(r.endAt,sp(r),i))})(n,e)}function fK(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function pV(n){return(e,t)=>{let r=!1;for(let i of sp(n)){let s=pK(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function pK(n,e,t){let r=n.field.isKeyField()?le.comparator(e.key,t.key):(function(s,o,a){let c=o.data.field(s),d=a.data.field(s);return c!==null&&d!==null?zu(c,d):he(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return he(19790,{direction:n.dir})}}var Os=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ia(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return XF(this.inner)}size(){return this.innerSize}};var gK=new Ct(le.comparator);function Fs(){return gK}var gV=new Ct(le.comparator);function rp(...n){let e=gV;for(let t of n)e=e.insert(t.key,t);return e}function mV(n){let e=gV;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Pc(){return op()}function yV(){return op()}function op(){return new Os(n=>n.toString(),(n,e)=>n.isEqual(e))}var mK=new Ct(le.comparator),yK=new gn(le.comparator);function Le(...n){let e=yK;for(let t of n)e=e.add(t);return e}var vK=new gn(Ve);function _K(){return vK}function hD(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:up(e)?"-0":e}}function vV(n){return{integerValue:""+n}}function wK(n,e){return QW(e)?vV(e):hD(n,e)}var Qu=class{constructor(){this._=void 0}};function IK(n,e,t){return n instanceof Yu?(function(i,s){let o={fields:{[eV]:{stringValue:ZF},[nV]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&sD(s)&&(s=k_(s)),s&&(o.fields[tV]=s),{mapValue:o}})(t,e):n instanceof Bc?wV(n,e):n instanceof $c?IV(n,e):(function(i,s){let o=_V(i,s),a=aF(o)+aF(i.Ae);return AT(o)&&AT(i.Ae)?vV(a):hD(i.serializer,a)})(n,e)}function EK(n,e,t){return n instanceof Bc?wV(n,e):n instanceof $c?IV(n,e):t}function _V(n,e){return n instanceof Ju?(function(r){return AT(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Yu=class extends Qu{},Bc=class extends Qu{constructor(e){super(),this.elements=e}};function wV(n,e){let t=EV(e);for(let r of n.elements)t.some(i=>Li(i,r))||t.push(r);return{arrayValue:{values:t}}}var $c=class extends Qu{constructor(e){super(),this.elements=e}};function IV(n,e){let t=EV(e);for(let r of n.elements)t=t.filter(i=>!Li(i,r));return{arrayValue:{values:t}}}var Ju=class extends Qu{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function aF(n){return mt(n.integerValue||n.doubleValue)}function EV(n){return cD(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function bK(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Bc&&i instanceof Bc||r instanceof $c&&i instanceof $c?Hu(r.elements,i.elements,Li):r instanceof Ju&&i instanceof Ju?Li(r.Ae,i.Ae):r instanceof Yu&&i instanceof Yu})(n.transform,e.transform)}var BT=class{constructor(e,t){this.version=e,this.transformResults=t}},ks=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Qv(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Xu=class{};function bV(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new fp(n.key,ks.none()):new Hc(n.key,n.data,ks.none());{let t=n.data,r=dr.empty(),i=new gn(hr.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ui(n.key,r,new Dr(i.toArray()),ks.none())}}function CK(n,e,t){n instanceof Hc?(function(i,s,o){let a=i.value.clone(),c=lF(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Ui?(function(i,s,o){if(!Qv(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=lF(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(CV(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function ap(n,e,t,r){return n instanceof Hc?(function(s,o,a,c){if(!Qv(s.precondition,o))return a;let d=s.value.clone(),h=uF(s.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Ui?(function(s,o,a,c){if(!Qv(s.precondition,o))return a;let d=uF(s.fieldTransforms,c,o),h=o.data;return h.setAll(CV(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))})(n,e,t,r):(function(s,o,a){return Qv(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function TK(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=_V(r.transform,i||null);s!=null&&(t===null&&(t=dr.empty()),t.set(r.field,s))}return t||null}function cF(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Hu(r,i,(s,o)=>bK(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Hc=class extends Xu{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ui=class extends Xu{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function CV(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function lF(n,e,t){let r=new Map;rt(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,EK(o,a,t[i]))}return r}function uF(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,IK(s,o,e))}return r}var fp=class extends Xu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},$T=class extends Xu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var HT=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&CK(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=ap(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=ap(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=yV();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=bV(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(De.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Le())}isEqual(e){return this.batchId===e.batchId&&Hu(this.mutations,e.mutations,(t,r)=>cF(t,r))&&Hu(this.baseMutations,e.baseMutations,(t,r)=>cF(t,r))}},qT=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){rt(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return mK})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var zT=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var GT=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Lt,He;function SK(n){switch(n){case z.OK:return he(64938);case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0;default:return he(15467,{code:n})}}function TV(n){if(n===void 0)return Ns("GRPC error has no .code"),z.UNKNOWN;switch(n){case Lt.OK:return z.OK;case Lt.CANCELLED:return z.CANCELLED;case Lt.UNKNOWN:return z.UNKNOWN;case Lt.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case Lt.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case Lt.INTERNAL:return z.INTERNAL;case Lt.UNAVAILABLE:return z.UNAVAILABLE;case Lt.UNAUTHENTICATED:return z.UNAUTHENTICATED;case Lt.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case Lt.NOT_FOUND:return z.NOT_FOUND;case Lt.ALREADY_EXISTS:return z.ALREADY_EXISTS;case Lt.PERMISSION_DENIED:return z.PERMISSION_DENIED;case Lt.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case Lt.ABORTED:return z.ABORTED;case Lt.OUT_OF_RANGE:return z.OUT_OF_RANGE;case Lt.UNIMPLEMENTED:return z.UNIMPLEMENTED;case Lt.DATA_LOSS:return z.DATA_LOSS;default:return he(39323,{code:n})}}(He=Lt||(Lt={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";var DK=null;function AK(){return new TextEncoder}var xK=new Ds([4294967295,4294967295],0);function dF(n){let e=AK().encode(n),t=new oT;return t.update(e),new Uint8Array(t.digest())}function hF(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ds([t,r],0),new Ds([i,s],0)]}var WT=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Oc(`Invalid padding: ${t}`);if(r<0)throw new Oc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Oc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Oc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Ds.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(Ds.fromNumber(r)));return i.compare(xK)===1&&(i=new Ds([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=dF(e),[r,i]=hF(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.ge===0)return;let t=dF(e),[r,i]=hF(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);this.Se(o)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Oc=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var i_=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,pp.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(De.min(),i,new Ct(Ve),Fs(),Le())}},pp=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Le(),Le(),Le())}};var Uu=class{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}},s_=class{constructor(e,t){this.targetId=e,this.Ce=t}},o_=class{constructor(e,t,r=Mn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},a_=class{constructor(){this.ve=0,this.Fe=fF(),this.Me=Mn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Le(),t=Le(),r=Le();return this.Fe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:he(38017,{changeType:s})}}),new pp(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=fF()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,rt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},KT=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Fs(),this.Je=zv(),this.He=zv(),this.Ye=new Ct(Ve)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:he(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((r,i)=>{this.rt(i)&&t(i)})}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let s=i.target;if(LT(s))if(r===0){let o=new le(s.path);this.et(t,o,ti.newNoDocument(o,De.min()))}else rt(r===1,20013,{expectedCount:r});else{let o=this._t(t);if(o!==r){let a=this.ut(e),c=a?this.ct(a,e,o):1;if(c!==0){this.it(t);let d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,d)}DK?.lt((function(h,p,y,E,k){let P={localCacheCount:h,existenceFilterCount:p.count,databaseId:y.database,projectId:y.projectId},M=p.unchangedNames;return M&&(P.bloomFilter={applied:k===0,hashCount:M?.hashCount??0,bitmapLength:M?.bits?.bitmap?.length??0,padding:M?.bits?.padding??0,mightContain:$=>E?.mightContain($)??!1}),P})(o,e.Ce,this.Ge.ht(),a,c))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=Ps(r).toUint8Array()}catch(c){if(c instanceof e_)return $u("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new WT(o,i,s)}catch(c){return $u(c instanceof Oc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.et(t,s,null),i++)}),i}Tt(e){let t=new Map;this.ze.forEach((s,o)=>{let a=this.ot(o);if(a){if(s.current&&LT(a.target)){let c=new le(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,ti.newNoDocument(c,e))}s.Be&&(t.set(o,s.ke()),s.qe())}});let r=Le();this.He.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let d=this.ot(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.je.forEach((s,o)=>o.setReadTime(e));let i=new i_(e,t,this.Ye,this.je,r);return this.je=Fs(),this.Je=zv(),this.He=zv(),this.Ye=new Ct(Ve),i}Xe(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new a_,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new gn(Ve),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new gn(Ve),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||ie("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new a_),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function zv(){return new Ct(le.comparator)}function fF(){return new Ct(le.comparator)}var RK={asc:"ASCENDING",desc:"DESCENDING"},kK={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NK={and:"AND",or:"OR"},QT=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function YT(n,e){return n.useProto3Json||R_(e)?e:{value:e}}function c_(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function SV(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function MK(n,e){return c_(n,e.toTimestamp())}function Vi(n){return rt(!!n,49232),De.fromTimestamp((function(t){let r=Ms(t);return new $t(r.seconds,r.nanos)})(n))}function fD(n,e){return JT(n,e).canonicalString()}function JT(n,e){let t=(function(i){return new yt(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function DV(n){let e=yt.fromString(n);return rt(NV(e),10190,{key:e.toString()}),e}function XT(n,e){return fD(n.databaseId,e.path)}function fT(n,e){let t=DV(e);if(t.get(1)!==n.databaseId.projectId)throw new ne(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ne(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new le(xV(t))}function AV(n,e){return fD(n.databaseId,e)}function PK(n){let e=DV(n);return e.length===4?yt.emptyPath():xV(e)}function ZT(n){return new yt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function xV(n){return rt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function pF(n,e,t){return{name:XT(n,e),fields:t.value.mapValue.fields}}function OK(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:he(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,h){return d.useProto3Json?(rt(h===void 0||typeof h=="string",58123),Mn.fromBase64String(h||"")):(rt(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),Mn.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(d){let h=d.code===void 0?z.UNKNOWN:TV(d.code);return new ne(h,d.message||"")})(o);t=new o_(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=fT(n,r.document.name),s=Vi(r.document.updateTime),o=r.document.createTime?Vi(r.document.createTime):De.min(),a=new dr({mapValue:{fields:r.document.fields}}),c=ti.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];t=new Uu(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=fT(n,r.document),s=r.readTime?Vi(r.readTime):De.min(),o=ti.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Uu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=fT(n,r.document),s=r.removedTargetIds||[];t=new Uu([],s,i,null)}else{if(!("filter"in e))return he(11601,{Rt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new GT(i,s),a=r.targetId;t=new s_(a,o)}}return t}function FK(n,e){let t;if(e instanceof Hc)t={update:pF(n,e.key,e.value)};else if(e instanceof fp)t={delete:XT(n,e.key)};else if(e instanceof Ui)t={update:pF(n,e.key,e.data),updateMask:zK(e.fieldMask)};else{if(!(e instanceof $T))return he(16599,{Vt:e.type});t={verify:XT(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let a=o.transform;if(a instanceof Yu)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Bc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof $c)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ju)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw he(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:MK(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:he(27497)})(n,e.precondition)),t}function VK(n,e){return n&&n.length>0?(rt(e!==void 0,14353),n.map(t=>(function(i,s){let o=i.updateTime?Vi(i.updateTime):Vi(s);return o.isEqual(De.min())&&(o=Vi(s)),new BT(o,i.transformResults||[])})(t,e))):[]}function LK(n,e){return{documents:[AV(n,e.path)]}}function UK(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=AV(n,i);let s=(function(d){if(d.length!==0)return kV(ni.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(d){if(d.length!==0)return d.map(h=>(function(y){return{field:Fu(y.field),direction:$K(y.dir)}})(h))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=YT(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:t,parent:i}}function jK(n){let e=PK(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){rt(r===1,65062);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(p){let y=RV(p);return y instanceof ni&&cV(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map(y=>(function(k){return new Ku(Vu(k.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(y))})(t.orderBy));let a=null;t.limit&&(a=(function(p){let y;return y=typeof p=="object"?p.value:p,R_(y)?null:y})(t.limit));let c=null;t.startAt&&(c=(function(p){let y=!!p.before,E=p.values||[];return new Wu(E,y)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){let y=!p.before,E=p.values||[];return new Wu(E,y)})(t.endAt)),dK(e,i,o,s,a,"F",c,d)}function BK(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return he(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function RV(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Vu(t.unaryFilter.field);return jt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Vu(t.unaryFilter.field);return jt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Vu(t.unaryFilter.field);return jt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=Vu(t.unaryFilter.field);return jt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return he(61313);default:return he(60726)}})(n):n.fieldFilter!==void 0?(function(t){return jt.create(Vu(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return he(58110);default:return he(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ni.create(t.compositeFilter.filters.map(r=>RV(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return he(1026)}})(t.compositeFilter.op))})(n):he(30097,{filter:n})}function $K(n){return RK[n]}function HK(n){return kK[n]}function qK(n){return NK[n]}function Fu(n){return{fieldPath:n.canonicalString()}}function Vu(n){return hr.fromServerFormat(n.fieldPath)}function kV(n){return n instanceof jt?(function(t){if(t.op==="=="){if(nF(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NAN"}};if(tF(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(nF(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NOT_NAN"}};if(tF(t.value))return{unaryFilter:{field:Fu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fu(t.field),op:HK(t.op),value:t.value}}})(n):n instanceof ni?(function(t){let r=t.getFilters().map(i=>kV(i));return r.length===1?r[0]:{compositeFilter:{op:qK(t.op),filters:r}}})(n):he(54877,{filter:n})}function zK(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function NV(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var gp=class n{constructor(e,t,r,i,s=De.min(),o=De.min(),a=Mn.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var eS=class{constructor(e){this.yt=e}};function GK(n){let e=jK({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?jT(e,e.limit,"L"):e}var l_=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(mt(e.integerValue));else if("doubleValue"in e){let r=mt(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),up(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=Ms(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Ps(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?sV(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):iV(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):he(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=qu,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(mt(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),le.fromName(e).path.forEach(r=>{this.Ft(t,60),this.Ut(r,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};l_.Kt=new l_;var tS=class{constructor(){this.Cn=new nS}addToCollectionParentIndex(e,t){return this.Cn.add(t),G.resolve()}getCollectionParents(e,t){return G.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return G.resolve()}deleteFieldIndex(e,t){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,t){return G.resolve()}getDocumentsMatchingTarget(e,t){return G.resolve(null)}getIndexType(e,t){return G.resolve(0)}getFieldIndexes(e,t){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,t){return G.resolve(Uc.min())}getMinOffsetFromCollectionGroup(e,t){return G.resolve(Uc.min())}updateCollectionGroup(e,t,r){return G.resolve()}updateIndexEntries(e,t){return G.resolve()}},nS=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new gn(yt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new gn(yt.comparator)).toArray()}};var k_e=new Uint8Array(0);var gF={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},MV=41943040,Sr=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};Sr.DEFAULT_COLLECTION_PERCENTILE=10,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Sr.DEFAULT=new Sr(MV,Sr.DEFAULT_COLLECTION_PERCENTILE,Sr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Sr.DISABLED=new Sr(-1,0,0);var mp=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var mF="LruGarbageCollector",WK=1048576;function yF([n,e],[t,r]){let i=Ve(n,t);return i===0?Ve(e,r):i}var rS=class{constructor(e){this.Ir=e,this.buffer=new gn(yF),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();yF(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},iS=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){ie(mF,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){sd(t)?ie(mF,"Ignoring IndexedDB error during garbage collection: ",t):await id(t)}await this.Vr(3e5)})}},sS=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return G.resolve(rD.ce);let r=new rS(t);return this.mr.forEachTarget(e,i=>r.Ar(i.sequenceNumber)).next(()=>this.mr.pr(e,i=>r.Ar(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ie("LruGarbageCollector","Garbage collection skipped; disabled"),G.resolve(gF)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ie("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gF):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,o,a,c,d,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(ie("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),Pu()<=$e.DEBUG&&ie("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),G.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function KK(n,e){return new sS(n,e)}var oS=class{constructor(){this.changes=new Os(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ti.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?G.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var aS=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var cS=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&ap(r.mutation,i,Dr.empty(),$t.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Le()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Le()){let i=Pc();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=rp();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Pc();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Le()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Fs(),o=op(),a=(function(){return op()})();return t.forEach((c,d)=>{let h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Ui)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),ap(h.mutation,d,h.mutation.getFieldMask(),$t.now())):o.set(d.key,Dr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,h)=>o.set(d,h)),t.forEach((d,h)=>a.set(d,new aS(h,o.get(d)??null))),a))}recalculateAndSaveOverlays(e,t){let r=op(),i=new Ct((o,a)=>o-a),s=Le();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let d=t.get(c);if(d===null)return;let h=r.get(c)||Dr.empty();h=a.applyToLocalView(d,h),r.set(c,h);let p=(i.get(a.batchId)||Le()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),d=c.key,h=c.value,p=yV();h.forEach(y=>{if(!s.has(y)){let E=bV(t.get(y),r.get(y));E!==null&&p.set(y,E),s=s.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return G.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return le.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):hV(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):G.resolve(Pc()),a=lp,c=s;return o.next(d=>G.forEach(d,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(h)?G.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{c=c.insert(h,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,Le())).next(h=>({batchId:a,changes:mV(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new le(t)).next(r=>{let i=rp();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=rp();return this.indexManager.getCollectionParents(e,s).next(a=>G.forEach(a,c=>{let d=(function(p,y){return new jc(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((p,y)=>{o=o.insert(p,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{let h=d.getKey();o.get(h)===null&&(o=o.insert(h,ti.newInvalidDocument(h)))});let a=rp();return o.forEach((c,d)=>{let h=s.get(c);h!==void 0&&ap(h.mutation,d,Dr.empty(),$t.now()),M_(t,d)&&(a=a.insert(c,d))}),a})}};var lS=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return G.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Vi(i.createTime)}})(t)),G.resolve()}getNamedQuery(e,t){return G.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:GK(i.bundledQuery),readTime:Vi(i.readTime)}})(t)),G.resolve()}};var uS=class{constructor(){this.overlays=new Ct(le.comparator),this.qr=new Map}getOverlay(e,t){return G.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Pc();return G.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),G.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.qr.delete(r)),G.resolve()}getOverlaysForCollection(e,t,r){let i=Pc(),s=t.length+1,o=new le(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return G.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ct((d,h)=>d-h),o=this.overlays.getIterator();for(;o.hasNext();){let d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=Pc(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}let a=Pc(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return G.resolve(a)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new zT(t,r));let s=this.qr.get(t);s===void 0&&(s=Le(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}};var dS=class{constructor(){this.sessionToken=Mn.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,G.resolve()}};var yp=class{constructor(){this.Qr=new gn(Ut.$r),this.Ur=new gn(Ut.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new Ut(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Gr(new Ut(e,t))}zr(e,t){e.forEach(r=>this.removeReference(r,t))}jr(e){let t=new le(new yt([])),r=new Ut(t,e),i=new Ut(t,e+1),s=[];return this.Ur.forEachInRange([r,i],o=>{this.Gr(o),s.push(o.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new le(new yt([])),r=new Ut(t,e),i=new Ut(t,e+1),s=Le();return this.Ur.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new Ut(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},Ut=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return le.comparator(e.key,t.key)||Ve(e.Yr,t.Yr)}static Kr(e,t){return Ve(e.Yr,t.Yr)||le.comparator(e.key,t.key)}};var hS=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new gn(Ut.$r)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new HT(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.Zr=this.Zr.add(new Ut(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return G.resolve(o)}lookupMutationBatch(e,t){return G.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),s=i<0?0:i;return G.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?iD:this.tr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new Ut(t,0),i=new Ut(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],o=>{let a=this.Xr(o.Yr);s.push(a)}),G.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new gn(Ve);return t.forEach(i=>{let s=new Ut(i,0),o=new Ut(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],a=>{r=r.add(a.Yr)})}),G.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;le.isDocumentKey(s)||(s=s.child(""));let o=new Ut(new le(s),0),a=new gn(Ve);return this.Zr.forEachWhile(c=>{let d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(c.Yr)),!0)},o),G.resolve(this.ti(a))}ti(e){let t=[];return e.forEach(r=>{let i=this.Xr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){rt(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return G.forEach(t.mutations,i=>{let s=new Ut(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){let r=new Ut(t,0),i=this.Zr.firstAfterOrEqual(r);return G.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var fS=class{constructor(e){this.ri=e,this.docs=(function(){return new Ct(le.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return G.resolve(r?r.document.mutableCopy():ti.newInvalidDocument(t))}getEntries(e,t){let r=Fs();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ti.newInvalidDocument(i))}),G.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Fs(),o=t.path,a=new le(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||GW(zW(h),r)<=0||(i.has(h.key)||M_(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return G.resolve(s)}getAllFromCollectionGroup(e,t,r,i){he(9500)}ii(e,t){return G.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new pS(this)}getSize(e){return G.resolve(this.size)}},pS=class extends oS{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)}),G.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var gS=class{constructor(e){this.persistence=e,this.si=new Os(t=>lD(t),uD),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.oi=0,this._i=new yp,this.targetCount=0,this.ai=mp.ur()}forEachTarget(e,t){return this.si.forEach((r,i)=>t(i)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),G.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new mp(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,G.resolve()}updateTargetData(e,t){return this.Pr(t),G.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.si.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),G.waitFor(s).next(()=>i)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return G.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),G.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),G.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),G.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return G.resolve(r)}containsKey(e,t){return G.resolve(this._i.containsKey(t))}};var u_=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new rD(0),this.li=!1,this.li=!0,this.hi=new dS,this.referenceDelegate=e(this),this.Pi=new gS(this),this.indexManager=new tS,this.remoteDocumentCache=(function(i){return new fS(i)})(r=>this.referenceDelegate.Ti(r)),this.serializer=new eS(t),this.Ii=new lS(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new uS,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new hS(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){ie("MemoryPersistence","Starting transaction:",e);let i=new mS(this.ci.next());return this.referenceDelegate.Ei(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ai(e,t){return G.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}},mS=class extends TT{constructor(e){super(),this.currentSequenceNumber=e}},yS=class n{constructor(e){this.persistence=e,this.Ri=new yp,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw he(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),G.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),G.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),G.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(i=>this.fi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.fi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.fi,r=>{let i=le.fromPath(r);return this.gi(e,i).next(s=>{s||t.removeEntry(i,De.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return G.or([()=>G.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},d_=class n{constructor(e,t){this.persistence=e,this.pi=new Os(r=>YW(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=KK(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return G.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}wr(e){let t=0;return this.pr(e,r=>{t++}).next(()=>t)}pr(e,t){return G.forEach(this.pi,(r,i)=>this.br(e,r,i).next(s=>s?G.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,o=>this.br(e,o,t).next(a=>{a||(r++,s.removeEntry(o,De.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),G.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),G.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),G.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),G.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wv(e.data.value)),t}br(e,t,r){return G.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return G.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var vS=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=Le(),i=Le();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var _S=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var wS=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return LO()?8:KW(VO())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ys(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ws(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new _S;return this.Ss(e,t,o).next(a=>{if(s.result=a,this.Vs)return this.bs(e,t,o,a.size)})}).next(()=>s.result)}bs(e,t,r,i){return r.documentReadCount<this.fs?(Pu()<=$e.DEBUG&&ie("QueryEngine","SDK will not create cache indexes for query:",Ou(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),G.resolve()):(Pu()<=$e.DEBUG&&ie("QueryEngine","Query:",Ou(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(Pu()<=$e.DEBUG&&ie("QueryEngine","The SDK decides to create cache indexes for query:",Ou(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fi(t))):G.resolve())}ys(e,t){if(oF(t))return G.resolve(null);let r=Fi(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=jT(t,null,"F"),r=Fi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Le(...s);return this.ps.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let d=this.Ds(t,a);return this.Cs(t,d,o,c.readTime)?this.ys(e,jT(t,null,"F")):this.vs(e,d,t,c)}))})))}ws(e,t,r,i){return oF(t)||i.isEqual(De.min())?G.resolve(null):this.ps.getDocuments(e,r).next(s=>{let o=this.Ds(t,s);return this.Cs(t,o,r,i)?G.resolve(null):(Pu()<=$e.DEBUG&&ie("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ou(t)),this.vs(e,o,t,qW(i,lp)).next(a=>a))})}Ds(e,t){let r=new gn(pV(e));return t.forEach((i,s)=>{M_(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return Pu()<=$e.DEBUG&&ie("QueryEngine","Using full collection scan to execute query:",Ou(t)),this.ps.getDocumentsMatchingQuery(e,t,Uc.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var pD="LocalStore",QK=3e8,IS=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new Ct(Ve),this.xs=new Os(s=>lD(s),uD),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cS(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}};function YK(n,e,t,r){return new IS(n,e,t,r)}async function PV(n,e){let t=Ee(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=Le();for(let d of i){o.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}for(let d of s){a.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(d=>({Ls:d,removedBatchIds:o,addedBatchIds:a}))})})}function JK(n,e){let t=Ee(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,d,h){let p=d.batch,y=p.keys(),E=G.resolve();return y.forEach(k=>{E=E.next(()=>h.getEntry(c,k)).next(P=>{let M=d.docVersions.get(k);rt(M!==null,48541),P.version.compareTo(M)<0&&(p.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),h.addEntry(P)))})}),E.next(()=>a.mutationQueue.removeMutationBatch(c,p))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=Le();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function OV(n){let e=Ee(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Pi.getLastRemoteSnapshotVersion(t))}function XK(n,e){let t=Ee(n),r=e.snapshotVersion,i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;let a=[];e.targetChanges.forEach((h,p)=>{let y=i.get(p);if(!y)return;a.push(t.Pi.removeMatchingKeys(s,h.removedDocuments,p).next(()=>t.Pi.addMatchingKeys(s,h.addedDocuments,p)));let E=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?E=E.withResumeToken(Mn.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):h.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(h.resumeToken,r)),i=i.insert(p,E),(function(P,M,$){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=QK?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0})(y,E,h)&&a.push(t.Pi.updateTargetData(s,E))});let c=Fs(),d=Le();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(ZK(s,o,e.documentUpdates).next(h=>{c=h.ks,d=h.qs})),!r.isEqual(De.min())){let h=t.Pi.getLastRemoteSnapshotVersion(s).next(p=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return G.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.Ms=i,s))}function ZK(n,e,t){let r=Le(),i=Le();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Fs();return t.forEach((a,c)=>{let d=s.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(De.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):ie(pD,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{ks:o,qs:i}})}function eQ(n,e){let t=Ee(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=iD),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function tQ(n,e){let t=Ee(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Pi.getTargetData(r,e).next(s=>s?(i=s,G.resolve(i)):t.Pi.allocateTargetId(r).next(o=>(i=new gp(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r})}async function ES(n,e,t){let r=Ee(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!sd(o))throw o;ie(pD,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function vF(n,e,t){let r=Ee(n),i=De.min(),s=Le();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(c,d,h){let p=Ee(c),y=p.xs.get(h);return y!==void 0?G.resolve(p.Ms.get(y)):p.Pi.getTargetData(d,h)})(r,o,Fi(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:De.min(),t?s:Le())).next(a=>(nQ(r,fK(e),a),{documents:a,Qs:s})))}function nQ(n,e,t){let r=n.Os.get(e)||De.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Os.set(e,r)}var h_=class{constructor(){this.activeTargetIds=_K()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var bS=class{constructor(){this.Mo=new h_,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new h_,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var CS=class{Oo(e){}shutdown(){}};var _F="ConnectivityMonitor",f_=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ie(_F,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){ie(_F,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Gv=null;function TS(){return Gv===null?Gv=(function(){return 268435456+Math.round(2147483648*Math.random())})():Gv++,"0x"+Gv.toString(16)}var pT="RestConnection",rQ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},SS=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===t_?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){let o=TS(),a=this.zo(e,t.toUriEncodedString());ie(pT,`Sending RPC '${e}' ${o}:`,a,r);let c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,i,s);let{host:d}=new URL(a),h=Iv(d);return this.Jo(e,a,c,r,h).then(p=>(ie(pT,`Received RPC '${e}' ${o}: `,p),p),p=>{throw $u(pT,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}Ho(e,t,r,i,s,o){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+rd})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}zo(e,t){let r=rQ[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var DS=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var Nn="WebChannelConnection",AS=class extends SS{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){let o=TS();return new Promise((a,c)=>{let d=new aT;d.setWithCredentials(!0),d.listenOnce(cT.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case np.NO_ERROR:let p=d.getResponseJson();ie(Nn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case np.TIMEOUT:ie(Nn,`RPC '${e}' ${o} timed out`),c(new ne(z.DEADLINE_EXCEEDED,"Request time out"));break;case np.HTTP_ERROR:let y=d.getStatus();if(ie(Nn,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);let k=E?.error;if(k&&k.status&&k.message){let P=(function($){let Y=$.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(Y)>=0?Y:z.UNKNOWN})(k.status);c(new ne(P,k.message))}else c(new ne(z.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new ne(z.UNAVAILABLE,"Connection failed."));break;default:he(9055,{l_:e,streamId:o,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{ie(Nn,`RPC '${e}' ${o} completed.`)}});let h=JSON.stringify(i);ie(Nn,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)})}T_(e,t,r){let i=TS(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=dT(),a=uT(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=s.join("");ie(Nn,`Creating RPC '${e}' stream ${i}: ${h}`,c);let p=o.createWebChannel(h,c);this.I_(p);let y=!1,E=!1,k=new DS({Yo:M=>{E?ie(Nn,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(y||(ie(Nn,`Opening RPC '${e}' stream ${i} transport.`),p.open(),y=!0),ie(Nn,`RPC '${e}' stream ${i} sending:`,M),p.send(M))},Zo:()=>p.close()}),P=(M,$,Y)=>{M.listen($,ee=>{try{Y(ee)}catch(Ce){setTimeout(()=>{throw Ce},0)}})};return P(p,Mu.EventType.OPEN,()=>{E||(ie(Nn,`RPC '${e}' stream ${i} transport opened.`),k.o_())}),P(p,Mu.EventType.CLOSE,()=>{E||(E=!0,ie(Nn,`RPC '${e}' stream ${i} transport closed`),k.a_(),this.E_(p))}),P(p,Mu.EventType.ERROR,M=>{E||(E=!0,$u(Nn,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),k.a_(new ne(z.UNAVAILABLE,"The operation could not be completed")))}),P(p,Mu.EventType.MESSAGE,M=>{if(!E){let $=M.data[0];rt(!!$,16349);let Y=$,ee=Y?.error||Y[0]?.error;if(ee){ie(Nn,`RPC '${e}' stream ${i} received error:`,ee);let Ce=ee.status,Je=(function(_){let I=Lt[_];if(I!==void 0)return TV(I)})(Ce),pe=ee.message;Je===void 0&&(Je=z.INTERNAL,pe="Unknown error status: "+Ce+" with message "+ee.message),E=!0,k.a_(new ne(Je,pe)),p.close()}else ie(Nn,`RPC '${e}' stream ${i} received:`,$),k.u_($)}}),P(a,lT.STAT_EVENT,M=>{M.stat===Hv.PROXY?ie(Nn,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Hv.NOPROXY&&ie(Nn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.__()},0),k}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}};function gT(){return typeof document<"u"?document:null}function P_(n){return new QT(n,!0)}var p_=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&ie("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var wF="PersistentStream",g_=class{constructor(e,t,r,i,s,o,a,c){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new p_(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===z.RESOURCE_EXHAUSTED?(Ns(t.toString()),Ns("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.D_===t&&this.G_(r,i)},r=>{e(()=>{let i=new ne(z.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)})})}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(i=>{r(()=>this.z_(i))}),this.stream.onMessage(i=>{r(()=>++this.F_==1?this.J_(i):this.onNext(i))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ie(wF,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(ie(wF,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},xS=class extends g_{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=OK(this.serializer,e),r=(function(s){if(!("targetChange"in s))return De.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?De.min():o.readTime?Vi(o.readTime):De.min()})(e);return this.listener.H_(t,r)}Y_(e){let t={};t.database=ZT(this.serializer),t.addTarget=(function(s,o){let a,c=o.target;if(a=LT(c)?{documents:LK(s,c)}:{query:UK(s,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=SV(s,o.resumeToken);let d=YT(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(De.min())>0){a.readTime=c_(s,o.snapshotVersion.toTimestamp());let d=YT(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a})(this.serializer,e);let r=BK(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){let t={};t.database=ZT(this.serializer),t.removeTarget=e,this.q_(t)}},RS=class extends g_{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=VK(e.writeResults,e.commitTime),r=Vi(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=ZT(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>FK(this.serializer,r))};this.q_(t)}};var kS=class{},NS=class extends kS{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new ne(z.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Go(e,JT(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(z.UNKNOWN,s.toString())})}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Ho(e,JT(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(z.UNKNOWN,o.toString())})}terminate(){this.ia=!0,this.connection.terminate()}},MS=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ns(t),this.aa=!1):ie("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var qc="RemoteStore",PS=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(o=>{r.enqueueAndForget(async()=>{zc(this)&&(ie(qc,"Restarting streams for network reachability change."),await(async function(c){let d=Ee(c);d.Ea.add(4),await Ip(d),d.Ra.set("Unknown"),d.Ea.delete(4),await O_(d)})(this))})}),this.Ra=new MS(r,i)}};async function O_(n){if(zc(n))for(let e of n.da)await e(!0)}async function Ip(n){for(let e of n.da)await e(!1)}function FV(n,e){let t=Ee(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),vD(t)?yD(t):od(t).O_()&&mD(t,e))}function gD(n,e){let t=Ee(n),r=od(t);t.Ia.delete(e),r.O_()&&VV(t,e),t.Ia.size===0&&(r.O_()?r.L_():zc(t)&&t.Ra.set("Unknown"))}function mD(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}od(n).Y_(e)}function VV(n,e){n.Va.Ue(e),od(n).Z_(e)}function yD(n){n.Va=new KT({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),od(n).start(),n.Ra.ua()}function vD(n){return zc(n)&&!od(n).x_()&&n.Ia.size>0}function zc(n){return Ee(n).Ea.size===0}function LV(n){n.Va=void 0}async function iQ(n){n.Ra.set("Online")}async function sQ(n){n.Ia.forEach((e,t)=>{mD(n,e)})}async function oQ(n,e){LV(n),vD(n)?(n.Ra.ha(e),yD(n)):n.Ra.set("Unknown")}async function aQ(n,e,t){if(n.Ra.set("Online"),e instanceof o_&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let a of s.targetIds)i.Ia.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ia.delete(a),i.Va.removeTarget(a))})(n,e)}catch(r){ie(qc,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await m_(n,r)}else if(e instanceof Uu?n.Va.Ze(e):e instanceof s_?n.Va.st(e):n.Va.tt(e),!t.isEqual(De.min()))try{let r=await OV(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let a=s.Va.Tt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let h=s.Ia.get(d);h&&s.Ia.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{let h=s.Ia.get(c);if(!h)return;s.Ia.set(c,h.withResumeToken(Mn.EMPTY_BYTE_STRING,h.snapshotVersion)),VV(s,c);let p=new gp(h.target,c,d,h.sequenceNumber);mD(s,p)}),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){ie(qc,"Failed to raise snapshot:",r),await m_(n,r)}}async function m_(n,e,t){if(!sd(e))throw e;n.Ea.add(1),await Ip(n),n.Ra.set("Offline"),t||(t=()=>OV(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{ie(qc,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await O_(n)})}function UV(n,e){return e().catch(t=>m_(n,t,e))}async function F_(n){let e=Ee(n),t=ta(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:iD;for(;cQ(e);)try{let i=await eQ(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,lQ(e,i)}catch(i){await m_(e,i)}jV(e)&&BV(e)}function cQ(n){return zc(n)&&n.Ta.length<10}function lQ(n,e){n.Ta.push(e);let t=ta(n);t.O_()&&t.X_&&t.ea(e.mutations)}function jV(n){return zc(n)&&!ta(n).x_()&&n.Ta.length>0}function BV(n){ta(n).start()}async function uQ(n){ta(n).ra()}async function dQ(n){let e=ta(n);for(let t of n.Ta)e.ea(t.mutations)}async function hQ(n,e,t){let r=n.Ta.shift(),i=qT.from(r,e,t);await UV(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await F_(n)}async function fQ(n,e){e&&ta(n).X_&&await(async function(r,i){if((function(o){return SK(o)&&o!==z.ABORTED})(i.code)){let s=r.Ta.shift();ta(r).B_(),await UV(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await F_(r)}})(n,e),jV(n)&&BV(n)}async function IF(n,e){let t=Ee(n);t.asyncQueue.verifyOperationInProgress(),ie(qc,"RemoteStore received new credentials");let r=zc(t);t.Ea.add(3),await Ip(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await O_(t)}async function pQ(n,e){let t=Ee(n);e?(t.Ea.delete(2),await O_(t)):e||(t.Ea.add(2),await Ip(t),t.Ra.set("Unknown"))}function od(n){return n.ma||(n.ma=(function(t,r,i){let s=Ee(t);return s.sa(),new xS(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:iQ.bind(null,n),t_:sQ.bind(null,n),r_:oQ.bind(null,n),H_:aQ.bind(null,n)}),n.da.push(async e=>{e?(n.ma.B_(),vD(n)?yD(n):n.Ra.set("Unknown")):(await n.ma.stop(),LV(n))})),n.ma}function ta(n){return n.fa||(n.fa=(function(t,r,i){let s=Ee(t);return s.sa(),new RS(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:uQ.bind(null,n),r_:fQ.bind(null,n),ta:dQ.bind(null,n),na:hQ.bind(null,n)}),n.da.push(async e=>{e?(n.fa.B_(),await F_(n)):(await n.fa.stop(),n.Ta.length>0&&(ie(qc,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))})),n.fa}var OS=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new xs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(z.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function _D(n,e){if(Ns("AsyncQueue",`${e}: ${n}`),sd(n))return new ne(z.UNAVAILABLE,`${e}: ${n}`);throw n}var y_=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||le.comparator(t.key,r.key):(t,r)=>le.comparator(t.key,r.key),this.keyedMap=rp(),this.sortedSet=new Ct(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var v_=class{constructor(){this.ga=new Ct(le.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):he(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}},Zu=class n{constructor(e,t,r,i,s,o,a,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,y_.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&N_(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var FS=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}},VS=class{constructor(){this.queries=EF(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=Ee(t),s=i.queries;i.queries=EF(),s.forEach((o,a)=>{for(let c of a.Sa)c.onError(r)})})(this,new ne(z.ABORTED,"Firestore shutting down"))}};function EF(){return new Os(n=>fV(n),N_)}async function gQ(n,e){let t=Ee(n),r=3,i=e.query,s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new FS,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let a=_D(o,`Initialization of query '${Ou(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&wD(t)}async function mQ(n,e){let t=Ee(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function yQ(n,e){let t=Ee(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.Sa)a.Fa(i)&&(r=!0);o.wa=i}}r&&wD(t)}function vQ(n,e,t){let r=Ee(n),i=r.queries.get(e);if(i)for(let s of i.Sa)s.onError(t);r.queries.delete(e)}function wD(n){n.Ca.forEach(e=>{e.next()})}var LS,bF;(bF=LS||(LS={})).Ma="default",bF.Cache="cache";var US=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Zu(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Zu.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==LS.Cache}};var __=class{constructor(e){this.key=e}},w_=class{constructor(e){this.key=e}},jS=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Le(),this.mutatedKeys=Le(),this.eu=pV(e),this.tu=new y_(this.eu)}get nu(){return this.Ya}ru(e,t){let r=t?t.iu:new v_,i=t?t.tu:this.tu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let y=i.get(h),E=M_(this.query,p)?p:null,k=!!y&&this.mutatedKeys.has(y.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations),M=!1;y&&E?y.data.isEqual(E.data)?k!==P&&(r.track({type:3,doc:E}),M=!0):this.su(y,E)||(r.track({type:2,doc:E}),M=!0,(c&&this.eu(E,c)>0||d&&this.eu(E,d)<0)&&(a=!0)):!y&&E?(r.track({type:0,doc:E}),M=!0):y&&!E&&(r.track({type:1,doc:y}),M=!0,(c||d)&&(a=!0)),M&&(E?(o=o.add(E),s=P?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{tu:o,iu:r,Cs:a,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let o=e.iu.ya();o.sort((h,p)=>(function(E,k){let P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return he(20277,{Rt:M})}};return P(E)-P(k)})(h.type,p.type)||this.eu(h.doc,p.doc)),this.ou(r),i=i??!1;let a=t&&!i?this._u():[],c=this.Xa.size===0&&this.current&&!i?1:0,d=c!==this.Za;return this.Za=c,o.length!==0||d?{snapshot:new Zu(this.query,e.tu,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new v_,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(t=>this.Ya=this.Ya.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ya=this.Ya.delete(t)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=Le(),this.tu.forEach(r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))});let t=[];return e.forEach(r=>{this.Xa.has(r)||t.push(new w_(r))}),this.Xa.forEach(r=>{e.has(r)||t.push(new __(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=Le();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Zu.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},ID="SyncEngine",BS=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},$S=class{constructor(e){this.key=e,this.hu=!1}},HS=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Os(a=>fV(a),N_),this.Iu=new Map,this.Eu=new Set,this.du=new Ct(le.comparator),this.Au=new Map,this.Ru=new yp,this.Vu={},this.mu=new Map,this.fu=mp.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function _Q(n,e,t=!0){let r=WV(n),i,s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await $V(r,e,t,!0),i}async function wQ(n,e){let t=WV(n);await $V(t,e,!0,!1)}async function $V(n,e,t,r){let i=await tQ(n.localStore,Fi(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=await IQ(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&FV(n.remoteStore,i),a}async function IQ(n,e,t,r,i){n.pu=(p,y,E)=>(async function(P,M,$,Y){let ee=M.view.ru($);ee.Cs&&(ee=await vF(P.localStore,M.query,!1).then(({documents:T})=>M.view.ru(T,ee)));let Ce=Y&&Y.targetChanges.get(M.targetId),Je=Y&&Y.targetMismatches.get(M.targetId)!=null,pe=M.view.applyChanges(ee,P.isPrimaryClient,Ce,Je);return TF(P,M.targetId,pe.au),pe.snapshot})(n,p,y,E);let s=await vF(n.localStore,e,!0),o=new jS(e,s.Qs),a=o.ru(s.documents),c=pp.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(a,n.isPrimaryClient,c);TF(n,t,d.au);let h=new BS(e,t,o);return n.Tu.set(e,h),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),d.snapshot}async function EQ(n,e,t){let r=Ee(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(o=>!N_(o,e))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ES(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&gD(r.remoteStore,i.targetId),qS(r,i.targetId)}).catch(id)):(qS(r,i.targetId),await ES(r.localStore,i.targetId,!0))}async function bQ(n,e){let t=Ee(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),gD(t.remoteStore,r.targetId))}async function CQ(n,e,t){let r=kQ(n);try{let i=await(function(o,a){let c=Ee(o),d=$t.now(),h=a.reduce((E,k)=>E.add(k.key),Le()),p,y;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let k=Fs(),P=Le();return c.Ns.getEntries(E,h).next(M=>{k=M,k.forEach(($,Y)=>{Y.isValidDocument()||(P=P.add($))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,k)).next(M=>{p=M;let $=[];for(let Y of a){let ee=TK(Y,p.get(Y.key).overlayedDocument);ee!=null&&$.push(new Ui(Y.key,ee,oV(ee.value.mapValue),ks.exists(!0)))}return c.mutationQueue.addMutationBatch(E,d,$,a)}).next(M=>{y=M;let $=M.applyToLocalDocumentSet(p,P);return c.documentOverlayCache.saveOverlays(E,M.batchId,$)})}).then(()=>({batchId:y.batchId,changes:mV(p)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,c){let d=o.Vu[o.currentUser.toKey()];d||(d=new Ct(Ve)),d=d.insert(a,c),o.Vu[o.currentUser.toKey()]=d})(r,i.batchId,t),await Ep(r,i.changes),await F_(r.remoteStore)}catch(i){let s=_D(i,"Failed to persist write");t.reject(s)}}async function HV(n,e){let t=Ee(n);try{let r=await XK(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Au.get(s);o&&(rt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?rt(o.hu,14607):i.removedDocuments.size>0&&(rt(o.hu,42227),o.hu=!1))}),await Ep(t,r,e)}catch(r){await id(r)}}function CF(n,e,t){let r=Ee(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach((s,o)=>{let a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(o,a){let c=Ee(o);c.onlineState=a;let d=!1;c.queries.forEach((h,p)=>{for(let y of p.Sa)y.va(a)&&(d=!0)}),d&&wD(c)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function TQ(n,e,t){let r=Ee(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),s=i&&i.key;if(s){let o=new Ct(le.comparator);o=o.insert(s,ti.newNoDocument(s,De.min()));let a=Le().add(s),c=new i_(De.min(),new Map,new Ct(Ve),o,a);await HV(r,c),r.du=r.du.remove(s),r.Au.delete(e),ED(r)}else await ES(r.localStore,e,!1).then(()=>qS(r,e,t)).catch(id)}async function SQ(n,e){let t=Ee(n),r=e.batch.batchId;try{let i=await JK(t.localStore,e);zV(t,r,null),qV(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ep(t,i)}catch(i){await id(i)}}async function DQ(n,e,t){let r=Ee(n);try{let i=await(function(o,a){let c=Ee(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(p=>(rt(p!==null,37113),h=p.keys(),c.mutationQueue.removeMutationBatch(d,p))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})})(r.localStore,e);zV(r,e,t),qV(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ep(r,i)}catch(i){await id(i)}}function qV(n,e){(n.mu.get(e)||[]).forEach(t=>{t.resolve()}),n.mu.delete(e)}function zV(n,e,t){let r=Ee(n),i=r.Vu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function qS(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach(r=>{n.Ru.containsKey(r)||GV(n,r)})}function GV(n,e){n.Eu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(gD(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),ED(n))}function TF(n,e,t){for(let r of t)r instanceof __?(n.Ru.addReference(r.key,e),AQ(n,r)):r instanceof w_?(ie(ID,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||GV(n,r.key)):he(19791,{wu:r})}function AQ(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(ie(ID,"New document in limbo: "+t),n.Eu.add(r),ED(n))}function ED(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new le(yt.fromString(e)),r=n.fu.next();n.Au.set(r,new $S(t)),n.du=n.du.insert(t,r),FV(n.remoteStore,new gp(Fi(dD(t.path)),r,"TargetPurposeLimboResolution",rD.ce))}}async function Ep(n,e,t){let r=Ee(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((a,c)=>{o.push(r.pu(c,e,t).then(d=>{if((d||t)&&r.isPrimaryClient){let h=d?!d.fromCache:t?.targetChanges.get(c.targetId)?.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(d){i.push(d);let h=vS.As(c.targetId,d);s.push(h)}}))}),await Promise.all(o),r.Pu.H_(i),await(async function(c,d){let h=Ee(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>G.forEach(d,y=>G.forEach(y.Es,E=>h.persistence.referenceDelegate.addReference(p,y.targetId,E)).next(()=>G.forEach(y.ds,E=>h.persistence.referenceDelegate.removeReference(p,y.targetId,E)))))}catch(p){if(!sd(p))throw p;ie(pD,"Failed to update sequence numbers: "+p)}for(let p of d){let y=p.targetId;if(!p.fromCache){let E=h.Ms.get(y),k=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(k);h.Ms=h.Ms.insert(y,P)}}})(r.localStore,s))}async function xQ(n,e){let t=Ee(n);if(!t.currentUser.isEqual(e)){ie(ID,"User change. New user:",e.toKey());let r=await PV(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach(a=>{a.forEach(c=>{c.reject(new ne(z.CANCELLED,o))})}),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ep(t,r.Ls)}}function RQ(n,e){let t=Ee(n),r=t.Au.get(e);if(r&&r.hu)return Le().add(r.key);{let i=Le(),s=t.Iu.get(e);if(!s)return i;for(let o of s){let a=t.Tu.get(o);i=i.unionWith(a.view.nu)}return i}}function WV(n){let e=Ee(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=HV.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RQ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=TQ.bind(null,e),e.Pu.H_=yQ.bind(null,e.eventManager),e.Pu.yu=vQ.bind(null,e.eventManager),e}function kQ(n){let e=Ee(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=SQ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=DQ.bind(null,e),e}var KV=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=P_(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,r){return null}Mu(t,r){return null}vu(t){return YK(this.persistence,new wS,t.initialUser,this.serializer)}Cu(t){return new u_(yS.mi,this.serializer)}Du(t){return new bS}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),zS=class extends KV{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){rt(this.persistence.referenceDelegate instanceof d_,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new iS(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Sr.withCacheSize(this.cacheSizeBytes):Sr.DEFAULT;return new u_(r=>d_.mi(r,t),this.serializer)}};var NQ=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>CF(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=xQ.bind(null,this.syncEngine),await pQ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new VS})()}createDatastore(t){let r=P_(t.databaseInfo.databaseId),i=(function(o){return new AS(o)})(t.databaseInfo);return(function(o,a,c,d){return new NS(o,a,c,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,a,c){return new PS(i,s,o,a,c)})(this.localStore,this.datastore,t.asyncQueue,r=>CF(this.syncEngine,r,0),(function(){return f_.v()?new f_:new CS})())}createSyncEngine(t,r){return(function(s,o,a,c,d,h,p){let y=new HS(s,o,a,c,d,h);return p&&(y.gu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){let i=Ee(r);ie(qc,"RemoteStore shutting down."),i.Ea.add(5),await Ip(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}return n.provider={build:()=>new n},n})();var GS=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ns("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var na="FirestoreClient",WS=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=pn.UNAUTHENTICATED,this.clientId=cp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{ie(na,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ie(na,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new xs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=_D(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function mT(n,e){n.asyncQueue.verifyOperationInProgress(),ie(na,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await PV(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function SF(n,e){n.asyncQueue.verifyOperationInProgress();let t=await MQ(n);ie(na,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>IF(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>IF(e.remoteStore,i)),n._onlineComponents=e}async function MQ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ie(na,"Using user provided OfflineComponentProvider");try{await mT(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===z.FAILED_PRECONDITION||i.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;$u("Error using user provided cache. Falling back to memory cache: "+t),await mT(n,new KV)}}else ie(na,"Using default OfflineComponentProvider"),await mT(n,new zS(void 0));return n._offlineComponents}async function QV(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ie(na,"Using user provided OnlineComponentProvider"),await SF(n,n._uninitializedComponentsProvider._online)):(ie(na,"Using default OnlineComponentProvider"),await SF(n,new NQ))),n._onlineComponents}function PQ(n){return QV(n).then(e=>e.syncEngine)}async function DF(n){let e=await QV(n),t=e.eventManager;return t.onListen=_Q.bind(null,e.syncEngine),t.onUnlisten=EQ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wQ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=bQ.bind(null,e.syncEngine),t}function YV(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var AF=new Map;var JV="firestore.googleapis.com",xF=!0,I_=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new ne(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=JV,this.ssl=xF}else this.host=e.host,this.ssl=e.ssl??xF;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=MV;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<WK)throw new ne(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HW("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=YV(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new ne(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new ne(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new ne(z.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},ed=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new I_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new I_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new yT;switch(r.type){case"firstParty":return new IT(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=AF.get(t);r&&(ie("ComponentProvider","Removing Datastore"),AF.delete(t),r.terminate())})(this),Promise.resolve()}};function OQ(n,e,t,r={}){n=Rs(n,ed);let i=Iv(e),s=n._getSettings(),o=ce(H({},s),{emulatorOptions:n._getEmulatorOptions()}),a=`${e}:${t}`;i&&(PO(`https://${a}`),FO("Firestore",!0)),s.host!==JV&&s.host!==a&&$u("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let c=ce(H({},s),{host:a,ssl:i,emulatorOptions:r});if(!Ru(c,o)&&(n._setSettings(c),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=pn.MOCK_USER;else{d=OO(r.mockUserToken,n._app?.options.projectId);let p=r.mockUserToken.sub||r.mockUserToken.user_id;if(!p)throw new ne(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new pn(p)}n._authCredentials=new vT(new Yv(d,h))}}var td=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},mn=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yo(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(wp(t,n._jsonSchema))return new n(e,r||null,new le(yt.fromString(t.referencePath)))}};mn._jsonSchemaVersion="firestore/documentReference/1.0",mn._jsonSchema={type:Bt("string",mn._jsonSchemaVersion),referencePath:Bt("string")};var Yo=class n extends td{constructor(e,t,r){super(e,t,dD(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new mn(this.firestore,null,new le(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function bp(n,e,...t){if(n=ei(n),FF("collection","path",e),n instanceof ed){let r=yt.fromString(e,...t);return W2(r),new Yo(n,null,r)}{if(!(n instanceof mn||n instanceof Yo))throw new ne(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(yt.fromString(e,...t));return W2(r),new Yo(n.firestore,null,r)}}function Ar(n,e,...t){if(n=ei(n),arguments.length===1&&(e=cp.newId()),FF("doc","path",e),n instanceof ed){let r=yt.fromString(e,...t);return G2(r),new mn(n,null,new le(r))}{if(!(n instanceof mn||n instanceof Yo))throw new ne(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(yt.fromString(e,...t));return G2(r),new mn(n.firestore,n instanceof Yo?n.converter:null,new le(r))}}var RF="AsyncQueue",E_=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new p_(this,"async_queue_retry"),this._c=()=>{let r=gT();r&&ie(RF,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=gT();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=gT();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let t=new xs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!sd(e))throw e;ie(RF,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let t=this.ac.then(()=>(this.rc=!0,e().catch(r=>{throw this.nc=r,this.rc=!1,Ns("INTERNAL UNHANDLED ERROR: ",kF(r)),r}).then(r=>(this.rc=!1,r))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=OS.createAndSchedule(this,e,t,r,s=>this.hc(s));return this.tc.push(i),i}uc(){this.nc&&he(47125,{Pc:kF(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function kF(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function NF(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var ra=class extends ed{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new E_,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new E_(e),this._firestoreClient=void 0,await e}}};function V_(n,e){let t=typeof n=="object"?n:KO(),r=typeof n=="string"?n:e||t_,i=zO(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=MO("firestore");s&&OQ(i,...s)}return i}function XV(n){if(n._terminated)throw new ne(z.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||FQ(n),n._firestoreClient}function FQ(n){let e=n._freezeSettings(),t=(function(i,s,o,a){return new ST(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,YV(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new WS(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}var Jo=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Mn.fromBase64String(e))}catch(t){throw new ne(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Mn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wp(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};Jo._jsonSchemaVersion="firestore/bytes/1.0",Jo._jsonSchema={type:Bt("string",Jo._jsonSchemaVersion),bytes:Bt("string")};var nd=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new ne(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new hr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var vp=class{constructor(e){this._methodName=e}};var Xo=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ne(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ne(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ve(this._lat,e._lat)||Ve(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(wp(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};Xo._jsonSchemaVersion="firestore/geoPoint/1.0",Xo._jsonSchema={type:Bt("string",Xo._jsonSchemaVersion),latitude:Bt("number"),longitude:Bt("number")};var Zo=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wp(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new ne(z.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};Zo._jsonSchemaVersion="firestore/vectorValue/1.0",Zo._jsonSchema={type:Bt("string",Zo._jsonSchemaVersion),vectorValues:Bt("object")};var VQ=/^__.*__$/,KS=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hc(e,this.data,t,this.fieldTransforms)}},b_=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ui(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function ZV(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw he(40011,{Ac:n})}}var QS=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n(H(H({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return T_(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(ZV(this.Ac)&&VQ.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},YS=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||P_(e)}Cc(e,t,r,i=!1){return new QS({Ac:e,methodName:t,Dc:r,path:hr.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function bD(n){let e=n._freezeSettings(),t=P_(n._databaseId);return new YS(n._databaseId,!!e.ignoreUndefinedProperties,t)}function LQ(n,e,t,r,i,s={}){let o=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);CD("Data must be an object, but it was:",o,r);let a=eL(r,o),c,d;if(s.merge)c=new Dr(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){let h=[];for(let p of s.mergeFields){let y=JS(e,p,t);if(!o.contains(y))throw new ne(z.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);nL(h,y)||h.push(y)}c=new Dr(h),d=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,d=o.fieldTransforms;return new KS(new dr(a),c,d)}var C_=class n extends vp{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function UQ(n,e,t,r){let i=n.Cc(1,e,t);CD("Data must be an object, but it was:",i,r);let s=[],o=dr.empty();ia(r,(c,d)=>{let h=TD(e,c,t);d=ei(d);let p=i.yc(h);if(d instanceof C_)s.push(h);else{let y=Cp(d,p);y!=null&&(s.push(h),o.set(h,y))}});let a=new Dr(s);return new b_(o,a,i.fieldTransforms)}function jQ(n,e,t,r,i,s){let o=n.Cc(1,e,t),a=[JS(e,r,t)],c=[i];if(s.length%2!=0)throw new ne(z.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)a.push(JS(e,s[y])),c.push(s[y+1]);let d=[],h=dr.empty();for(let y=a.length-1;y>=0;--y)if(!nL(d,a[y])){let E=a[y],k=c[y];k=ei(k);let P=o.yc(E);if(k instanceof C_)d.push(E);else{let M=Cp(k,P);M!=null&&(d.push(E),h.set(E,M))}}let p=new Dr(d);return new b_(h,p,o.fieldTransforms)}function BQ(n,e,t,r=!1){return Cp(t,n.Cc(r?4:3,e))}function Cp(n,e){if(tL(n=ei(n)))return CD("Unsupported field value:",e,n),eL(n,e);if(n instanceof vp)return(function(r,i){if(!ZV(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let a of r){let c=Cp(a,i.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=ei(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return wK(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=$t.fromDate(r);return{timestampValue:c_(i.serializer,s)}}if(r instanceof $t){let s=new $t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:c_(i.serializer,s)}}if(r instanceof Xo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Jo)return{bytesValue:SV(i.serializer,r._byteString)};if(r instanceof mn){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:fD(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Zo)return(function(o,a){return{mapValue:{fields:{[oD]:{stringValue:aD},[qu]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.Sc("VectorValues must only contain numeric values.");return hD(a.serializer,d)})}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${x_(r)}`)})(n,e)}function eL(n,e){let t={};return XF(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ia(n,(r,i)=>{let s=Cp(i,e.mc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function tL(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof $t||n instanceof Xo||n instanceof Jo||n instanceof mn||n instanceof vp||n instanceof Zo)}function CD(n,e,t){if(!tL(t)||!VF(t)){let r=x_(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function JS(n,e,t){if((e=ei(e))instanceof nd)return e._internalPath;if(typeof e=="string")return TD(n,e);throw T_("Field path arguments must be of type string or ",n,!1,void 0,t)}var $Q=new RegExp("[~\\*/\\[\\]]");function TD(n,e,t){if(e.search($Q)>=0)throw T_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new nd(...e.split("."))._internalPath}catch{throw T_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function T_(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new ne(z.INVALID_ARGUMENT,a+n+c)}function nL(n,e){return n.some(t=>t.isEqual(e))}var S_=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new mn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new XS(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(SD("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},XS=class extends S_{data(){return super.data()}};function SD(n,e){return typeof e=="string"?TD(n,e):e instanceof nd?e._internalPath:e._delegate._internalPath}function HQ(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new ne(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var _p=class{},ZS=class extends _p{};function Tp(n,e,...t){let r=[];e instanceof _p&&r.push(e),r=r.concat(t),(function(s){let o=s.filter(c=>c instanceof eD).length,a=s.filter(c=>c instanceof D_).length;if(o>1||o>0&&a>0)throw new ne(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var D_=class n extends ZS{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return rL(e._query,t),new td(e.firestore,e.converter,UT(e._query,t))}_parse(e){let t=bD(e.firestore);return(function(s,o,a,c,d,h,p){let y;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ne(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){PF(p,h);let k=[];for(let P of p)k.push(MF(c,s,P));y={arrayValue:{values:k}}}else y=MF(c,s,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||PF(p,h),y=BQ(a,o,p,h==="in"||h==="not-in");return jt.create(d,h,y)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Sp(n,e,t){let r=e,i=SD("where",n);return D_._create(i,r,t)}var eD=class n extends _p{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ni.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)rL(o,c),o=UT(o,c)})(e._query,t),new td(e.firestore,e.converter,UT(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};function MF(n,e,t){if(typeof(t=ei(t))=="string"){if(t==="")throw new ne(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hV(e)&&t.indexOf("/")!==-1)throw new ne(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(yt.fromString(t));if(!le.isDocumentKey(r))throw new ne(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return eF(n,new le(r))}if(t instanceof mn)return eF(n,t._key);throw new ne(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${x_(t)}.`)}function PF(n,e){if(!Array.isArray(n)||n.length===0)throw new ne(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function rL(n,e){let t=(function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new ne(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ne(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var tD=class{convertValue(e,t="none"){switch(ea(e)){case 0:return null;case 1:return e.booleanValue;case 2:return mt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ps(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw he(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ia(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){let t=e.fields?.[qu].arrayValue?.values?.map(r=>mt(r.doubleValue));return new Zo(t)}convertGeoPoint(e){return new Xo(mt(e.latitude),mt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=k_(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(dp(e));default:return null}}convertTimestamp(e){let t=Ms(e);return new $t(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=yt.fromString(e);rt(NV(r),9688,{name:e});let i=new n_(r.get(1),r.get(3)),s=new le(r.popFirst(5));return i.isEqual(t)||Ns(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function qQ(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Fc=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Vc=class n extends S_{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new ju(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(SD("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ne(z.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Vc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Vc._jsonSchema={type:Bt("string",Vc._jsonSchemaVersion),bundleSource:Bt("string","DocumentSnapshot"),bundleName:Bt("string"),bundle:Bt("string")};var ju=class extends Vc{data(e={}){return super.data(e)}},Bu=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new ju(this._firestore,this._userDataWriter,r.key,r,new Fc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ne(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new ju(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new ju(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:zQ(a.type),doc:c,oldIndex:d,newIndex:h}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ne(z.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=cp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function zQ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return he(61501,{type:n})}}Bu._jsonSchemaVersion="firestore/querySnapshot/1.0",Bu._jsonSchema={type:Bt("string",Bu._jsonSchemaVersion),bundleSource:Bt("string","QuerySnapshot"),bundleName:Bt("string"),bundle:Bt("string")};var A_=class extends tD{constructor(e){super(),this.firestore=e}convertBytes(e){return new Jo(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new mn(this.firestore,null,t)}};function ad(n,e,t){n=Rs(n,mn);let r=Rs(n.firestore,ra),i=qQ(n.converter,e,t);return DD(r,[LQ(bD(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,ks.none())])}function Dp(n,e,t,...r){n=Rs(n,mn);let i=Rs(n.firestore,ra),s=bD(i),o;return o=typeof(e=ei(e))=="string"||e instanceof nd?jQ(s,"updateDoc",n._key,e,t,r):UQ(s,"updateDoc",n._key,e),DD(i,[o.toMutation(n._key,ks.exists(!0))])}function Ap(n){return DD(Rs(n.firestore,ra),[new fp(n._key,ks.none())])}function xp(n,...e){n=ei(n);let t={includeMetadataChanges:!1,source:"default"},r=0;typeof e[r]!="object"||NF(e[r])||(t=e[r++]);let i={includeMetadataChanges:t.includeMetadataChanges,source:t.source};if(NF(e[r])){let c=e[r];e[r]=c.next?.bind(c),e[r+1]=c.error?.bind(c),e[r+2]=c.complete?.bind(c)}let s,o,a;if(n instanceof mn)o=Rs(n.firestore,ra),a=dD(n._key.path),s={next:c=>{e[r]&&e[r](GQ(o,n,c))},error:e[r+1],complete:e[r+2]};else{let c=Rs(n,td);o=Rs(c.firestore,ra),a=c._query;let d=new A_(o);s={next:h=>{e[r]&&e[r](new Bu(o,d,c,h))},error:e[r+1],complete:e[r+2]},HQ(n._query)}return(function(d,h,p,y){let E=new GS(y),k=new US(h,E,p);return d.asyncQueue.enqueueAndForget(async()=>gQ(await DF(d),k)),()=>{E.Nu(),d.asyncQueue.enqueueAndForget(async()=>mQ(await DF(d),k))}})(XV(o),a,i,s)}function DD(n,e){return(function(r,i){let s=new xs;return r.asyncQueue.enqueueAndForget(async()=>CQ(await PQ(r),i,s)),s.promise})(XV(n),e)}function GQ(n,e,t){let r=t.docs.get(e._key),i=new A_(n);return new Vc(n,i,e._key,r,new Fc(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(i){rd=i})(WO),zf(new bs("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new ra(new _T(r.getProvider("auth-internal")),new ET(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new ne(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new n_(d.options.projectId,h)})(o,i),o);return s=H({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),zo(H2,q2,e),zo(H2,q2,"esm2020")})();var iL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},sL={};var Vs,AD;(function(){var n;function e(T,_){function I(){}I.prototype=_.prototype,T.D=_.prototype,T.prototype=new I,T.prototype.constructor=T,T.C=function(C,b,A){for(var w=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)w[pt-2]=arguments[pt];return _.prototype[b].apply(C,w)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(T,_,I){I||(I=0);var C=Array(16);if(typeof _=="string")for(var b=0;16>b;++b)C[b]=_.charCodeAt(I++)|_.charCodeAt(I++)<<8|_.charCodeAt(I++)<<16|_.charCodeAt(I++)<<24;else for(b=0;16>b;++b)C[b]=_[I++]|_[I++]<<8|_[I++]<<16|_[I++]<<24;_=T.g[0],I=T.g[1],b=T.g[2];var A=T.g[3],w=_+(A^I&(b^A))+C[0]+3614090360&4294967295;_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[1]+3905402710&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[2]+606105819&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[3]+3250441966&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(A^I&(b^A))+C[4]+4118548399&4294967295,_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[5]+1200080426&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[6]+2821735955&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[7]+4249261313&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(A^I&(b^A))+C[8]+1770035416&4294967295,_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[9]+2336552879&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[10]+4294925233&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[11]+2304563134&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(A^I&(b^A))+C[12]+1804603682&4294967295,_=I+(w<<7&4294967295|w>>>25),w=A+(b^_&(I^b))+C[13]+4254626195&4294967295,A=_+(w<<12&4294967295|w>>>20),w=b+(I^A&(_^I))+C[14]+2792965006&4294967295,b=A+(w<<17&4294967295|w>>>15),w=I+(_^b&(A^_))+C[15]+1236535329&4294967295,I=b+(w<<22&4294967295|w>>>10),w=_+(b^A&(I^b))+C[1]+4129170786&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[6]+3225465664&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[11]+643717713&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[0]+3921069994&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(b^A&(I^b))+C[5]+3593408605&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[10]+38016083&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[15]+3634488961&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[4]+3889429448&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(b^A&(I^b))+C[9]+568446438&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[14]+3275163606&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[3]+4107603335&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[8]+1163531501&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(b^A&(I^b))+C[13]+2850285829&4294967295,_=I+(w<<5&4294967295|w>>>27),w=A+(I^b&(_^I))+C[2]+4243563512&4294967295,A=_+(w<<9&4294967295|w>>>23),w=b+(_^I&(A^_))+C[7]+1735328473&4294967295,b=A+(w<<14&4294967295|w>>>18),w=I+(A^_&(b^A))+C[12]+2368359562&4294967295,I=b+(w<<20&4294967295|w>>>12),w=_+(I^b^A)+C[5]+4294588738&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[8]+2272392833&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[11]+1839030562&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[14]+4259657740&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(I^b^A)+C[1]+2763975236&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[4]+1272893353&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[7]+4139469664&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[10]+3200236656&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(I^b^A)+C[13]+681279174&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[0]+3936430074&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[3]+3572445317&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[6]+76029189&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(I^b^A)+C[9]+3654602809&4294967295,_=I+(w<<4&4294967295|w>>>28),w=A+(_^I^b)+C[12]+3873151461&4294967295,A=_+(w<<11&4294967295|w>>>21),w=b+(A^_^I)+C[15]+530742520&4294967295,b=A+(w<<16&4294967295|w>>>16),w=I+(b^A^_)+C[2]+3299628645&4294967295,I=b+(w<<23&4294967295|w>>>9),w=_+(b^(I|~A))+C[0]+4096336452&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[7]+1126891415&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[14]+2878612391&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[5]+4237533241&4294967295,I=b+(w<<21&4294967295|w>>>11),w=_+(b^(I|~A))+C[12]+1700485571&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[3]+2399980690&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[10]+4293915773&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[1]+2240044497&4294967295,I=b+(w<<21&4294967295|w>>>11),w=_+(b^(I|~A))+C[8]+1873313359&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[15]+4264355552&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[6]+2734768916&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[13]+1309151649&4294967295,I=b+(w<<21&4294967295|w>>>11),w=_+(b^(I|~A))+C[4]+4149444226&4294967295,_=I+(w<<6&4294967295|w>>>26),w=A+(I^(_|~b))+C[11]+3174756917&4294967295,A=_+(w<<10&4294967295|w>>>22),w=b+(_^(A|~I))+C[2]+718787259&4294967295,b=A+(w<<15&4294967295|w>>>17),w=I+(A^(b|~_))+C[9]+3951481745&4294967295,T.g[0]=T.g[0]+_&4294967295,T.g[1]=T.g[1]+(b+(w<<21&4294967295|w>>>11))&4294967295,T.g[2]=T.g[2]+b&4294967295,T.g[3]=T.g[3]+A&4294967295}r.prototype.u=function(T,_){_===void 0&&(_=T.length);for(var I=_-this.blockSize,C=this.B,b=this.h,A=0;A<_;){if(b==0)for(;A<=I;)i(this,T,A),A+=this.blockSize;if(typeof T=="string"){for(;A<_;)if(C[b++]=T.charCodeAt(A++),b==this.blockSize){i(this,C),b=0;break}}else for(;A<_;)if(C[b++]=T[A++],b==this.blockSize){i(this,C),b=0;break}}this.h=b,this.o+=_},r.prototype.v=function(){var T=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);T[0]=128;for(var _=1;_<T.length-8;++_)T[_]=0;var I=8*this.o;for(_=T.length-8;_<T.length;++_)T[_]=I&255,I/=256;for(this.u(T),T=Array(16),_=I=0;4>_;++_)for(var C=0;32>C;C+=8)T[I++]=this.g[_]>>>C&255;return T};function s(T,_){var I=a;return Object.prototype.hasOwnProperty.call(I,T)?I[T]:I[T]=_(T)}function o(T,_){this.h=_;for(var I=[],C=!0,b=T.length-1;0<=b;b--){var A=T[b]|0;C&&A==_||(I[b]=A,C=!1)}this.g=I}var a={};function c(T){return-128<=T&&128>T?s(T,function(_){return new o([_|0],0>_?-1:0)}):new o([T|0],0>T?-1:0)}function d(T){if(isNaN(T)||!isFinite(T))return p;if(0>T)return M(d(-T));for(var _=[],I=1,C=0;T>=I;C++)_[C]=T/I|0,I*=4294967296;return new o(_,0)}function h(T,_){if(T.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(T.charAt(0)=="-")return M(h(T.substring(1),_));if(0<=T.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=d(Math.pow(_,8)),C=p,b=0;b<T.length;b+=8){var A=Math.min(8,T.length-b),w=parseInt(T.substring(b,b+A),_);8>A?(A=d(Math.pow(_,A)),C=C.j(A).add(d(w))):(C=C.j(I),C=C.add(d(w)))}return C}var p=c(0),y=c(1),E=c(16777216);n=o.prototype,n.m=function(){if(P(this))return-M(this).m();for(var T=0,_=1,I=0;I<this.g.length;I++){var C=this.i(I);T+=(0<=C?C:4294967296+C)*_,_*=4294967296}return T},n.toString=function(T){if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(k(this))return"0";if(P(this))return"-"+M(this).toString(T);for(var _=d(Math.pow(T,6)),I=this,C="";;){var b=Ce(I,_).g;I=$(I,b.j(_));var A=((0<I.g.length?I.g[0]:I.h)>>>0).toString(T);if(I=b,k(I))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},n.i=function(T){return 0>T?0:T<this.g.length?this.g[T]:this.h};function k(T){if(T.h!=0)return!1;for(var _=0;_<T.g.length;_++)if(T.g[_]!=0)return!1;return!0}function P(T){return T.h==-1}n.l=function(T){return T=$(this,T),P(T)?-1:k(T)?0:1};function M(T){for(var _=T.g.length,I=[],C=0;C<_;C++)I[C]=~T.g[C];return new o(I,~T.h).add(y)}n.abs=function(){return P(this)?M(this):this},n.add=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],C=0,b=0;b<=_;b++){var A=C+(this.i(b)&65535)+(T.i(b)&65535),w=(A>>>16)+(this.i(b)>>>16)+(T.i(b)>>>16);C=w>>>16,A&=65535,w&=65535,I[b]=w<<16|A}return new o(I,I[I.length-1]&-2147483648?-1:0)};function $(T,_){return T.add(M(_))}n.j=function(T){if(k(this)||k(T))return p;if(P(this))return P(T)?M(this).j(M(T)):M(M(this).j(T));if(P(T))return M(this.j(M(T)));if(0>this.l(E)&&0>T.l(E))return d(this.m()*T.m());for(var _=this.g.length+T.g.length,I=[],C=0;C<2*_;C++)I[C]=0;for(C=0;C<this.g.length;C++)for(var b=0;b<T.g.length;b++){var A=this.i(C)>>>16,w=this.i(C)&65535,pt=T.i(b)>>>16,qn=T.i(b)&65535;I[2*C+2*b]+=w*qn,Y(I,2*C+2*b),I[2*C+2*b+1]+=A*qn,Y(I,2*C+2*b+1),I[2*C+2*b+1]+=w*pt,Y(I,2*C+2*b+1),I[2*C+2*b+2]+=A*pt,Y(I,2*C+2*b+2)}for(C=0;C<_;C++)I[C]=I[2*C+1]<<16|I[2*C];for(C=_;C<2*_;C++)I[C]=0;return new o(I,0)};function Y(T,_){for(;(T[_]&65535)!=T[_];)T[_+1]+=T[_]>>>16,T[_]&=65535,_++}function ee(T,_){this.g=T,this.h=_}function Ce(T,_){if(k(_))throw Error("division by zero");if(k(T))return new ee(p,p);if(P(T))return _=Ce(M(T),_),new ee(M(_.g),M(_.h));if(P(_))return _=Ce(T,M(_)),new ee(M(_.g),_.h);if(30<T.g.length){if(P(T)||P(_))throw Error("slowDivide_ only works with positive integers.");for(var I=y,C=_;0>=C.l(T);)I=Je(I),C=Je(C);var b=pe(I,1),A=pe(C,1);for(C=pe(C,2),I=pe(I,2);!k(C);){var w=A.add(C);0>=w.l(T)&&(b=b.add(I),A=w),C=pe(C,1),I=pe(I,1)}return _=$(T,b.j(_)),new ee(b,_)}for(b=p;0<=T.l(_);){for(I=Math.max(1,Math.floor(T.m()/_.m())),C=Math.ceil(Math.log(I)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=d(I),w=A.j(_);P(w)||0<w.l(T);)I-=C,A=d(I),w=A.j(_);k(A)&&(A=y),b=b.add(A),T=$(T,w)}return new ee(b,T)}n.A=function(T){return Ce(this,T).h},n.and=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],C=0;C<_;C++)I[C]=this.i(C)&T.i(C);return new o(I,this.h&T.h)},n.or=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],C=0;C<_;C++)I[C]=this.i(C)|T.i(C);return new o(I,this.h|T.h)},n.xor=function(T){for(var _=Math.max(this.g.length,T.g.length),I=[],C=0;C<_;C++)I[C]=this.i(C)^T.i(C);return new o(I,this.h^T.h)};function Je(T){for(var _=T.g.length+1,I=[],C=0;C<_;C++)I[C]=T.i(C)<<1|T.i(C-1)>>>31;return new o(I,T.h)}function pe(T,_){var I=_>>5;_%=32;for(var C=T.g.length-I,b=[],A=0;A<C;A++)b[A]=0<_?T.i(A+I)>>>_|T.i(A+I+1)<<32-_:T.i(A+I);return new o(b,T.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,AD=sL.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Vs=sL.Integer=o}).apply(typeof iL<"u"?iL:typeof self<"u"?self:typeof window<"u"?window:{});var L_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ls={};var xD,WQ,cd,RD,Rp,U_,kD,ND,MD;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(l,f,m){return l==Array.prototype||l==Object.prototype||(l[f]=m.value),l};function t(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof L_=="object"&&L_];for(var f=0;f<l.length;++f){var m=l[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var r=t(this);function i(l,f){if(f)e:{var m=r;l=l.split(".");for(var S=0;S<l.length-1;S++){var F=l[S];if(!(F in m))break e;m=m[F]}l=l[l.length-1],S=m[l],f=f(S),f!=S&&f!=null&&e(m,l,{configurable:!0,writable:!0,value:f})}}function s(l,f){l instanceof String&&(l+="");var m=0,S=!1,F={next:function(){if(!S&&m<l.length){var U=m++;return{value:f(U,l[U]),done:!1}}return S=!0,{done:!0,value:void 0}}};return F[Symbol.iterator]=function(){return F},F}i("Array.prototype.values",function(l){return l||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(l){var f=typeof l;return f=f!="object"?f:l?Array.isArray(l)?"array":f:"null",f=="array"||f=="object"&&typeof l.length=="number"}function d(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function h(l,f,m){return l.call.apply(l.bind,arguments)}function p(l,f,m){if(!l)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var F=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(F,S),l.apply(f,F)}}return function(){return l.apply(f,arguments)}}function y(l,f,m){return y=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,y.apply(null,arguments)}function E(l,f){var m=Array.prototype.slice.call(arguments,1);return function(){var S=m.slice();return S.push.apply(S,arguments),l.apply(this,S)}}function k(l,f){function m(){}m.prototype=f.prototype,l.aa=f.prototype,l.prototype=new m,l.prototype.constructor=l,l.Qb=function(S,F,U){for(var K=Array(arguments.length-2),We=2;We<arguments.length;We++)K[We-2]=arguments[We];return f.prototype[F].apply(S,K)}}function P(l){let f=l.length;if(0<f){let m=Array(f);for(let S=0;S<f;S++)m[S]=l[S];return m}return[]}function M(l,f){for(let m=1;m<arguments.length;m++){let S=arguments[m];if(c(S)){let F=l.length||0,U=S.length||0;l.length=F+U;for(let K=0;K<U;K++)l[F+K]=S[K]}else l.push(S)}}class ${constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function Y(l){return/^[\s\xa0]*$/.test(l)}function ee(){var l=a.navigator;return l&&(l=l.userAgent)?l:""}function Ce(l){return Ce[" "](l),l}Ce[" "]=function(){};var Je=ee().indexOf("Gecko")!=-1&&!(ee().toLowerCase().indexOf("webkit")!=-1&&ee().indexOf("Edge")==-1)&&!(ee().indexOf("Trident")!=-1||ee().indexOf("MSIE")!=-1)&&ee().indexOf("Edge")==-1;function pe(l,f,m){for(let S in l)f.call(m,l[S],S,l)}function T(l,f){for(let m in l)f.call(void 0,l[m],m,l)}function _(l){let f={};for(let m in l)f[m]=l[m];return f}let I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(l,f){let m,S;for(let F=1;F<arguments.length;F++){S=arguments[F];for(m in S)l[m]=S[m];for(let U=0;U<I.length;U++)m=I[U],Object.prototype.hasOwnProperty.call(S,m)&&(l[m]=S[m])}}function b(l){var f=1;l=l.split(":");let m=[];for(;0<f&&l.length;)m.push(l.shift()),f--;return l.length&&m.push(l.join(":")),m}function A(l){a.setTimeout(()=>{throw l},0)}function w(){var l=Ws;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class pt{constructor(){this.h=this.g=null}add(f,m){let S=qn.get();S.set(f,m),this.h?this.h.next=S:this.g=S,this.h=S}}var qn=new $(()=>new nw,l=>l.reset());class nw{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let Ia,oi=!1,Ws=new pt,ig=()=>{let l=a.Promise.resolve(void 0);Ia=()=>{l.then(sg)}};var sg=()=>{for(var l;l=w();){try{l.h.call(l.g)}catch(m){A(m)}var f=qn;f.j(l),100>f.h&&(f.h++,l.next=f.g,f.g=l)}oi=!1};function Mr(){this.s=this.s,this.C=this.C}Mr.prototype.s=!1,Mr.prototype.ma=function(){this.s||(this.s=!0,this.N())},Mr.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Kt(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}Kt.prototype.h=function(){this.defaultPrevented=!0};var al=(function(){if(!a.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return l})();function Qi(l,f){if(Kt.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l){var m=this.type=l.type,S=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;if(this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget){if(Je){e:{try{Ce(f.nodeName);var F=!0;break e}catch{}F=!1}F||(f=null)}}else m=="mouseover"?f=l.fromElement:m=="mouseout"&&(f=l.toElement);this.relatedTarget=f,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=typeof l.pointerType=="string"?l.pointerType:Hd[l.pointerType]||"",this.state=l.state,this.i=l,l.defaultPrevented&&Qi.aa.h.call(this)}}k(Qi,Kt);var Hd={2:"touch",3:"pen",4:"mouse"};Qi.prototype.h=function(){Qi.aa.h.call(this);var l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Yi="closure_listenable_"+(1e6*Math.random()|0),qd=0;function og(l,f,m,S,F){this.listener=l,this.proxy=null,this.src=f,this.type=m,this.capture=!!S,this.ha=F,this.key=++qd,this.da=this.fa=!1}function Ea(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function cl(l){this.src=l,this.g={},this.h=0}cl.prototype.add=function(l,f,m,S,F){var U=l.toString();l=this.g[U],l||(l=this.g[U]=[],this.h++);var K=ul(l,f,S,F);return-1<K?(f=l[K],m||(f.fa=!1)):(f=new og(f,this.src,U,!!S,F),f.fa=m,l.push(f)),f};function ll(l,f){var m=f.type;if(m in l.g){var S=l.g[m],F=Array.prototype.indexOf.call(S,f,void 0),U;(U=0<=F)&&Array.prototype.splice.call(S,F,1),U&&(Ea(f),l.g[m].length==0&&(delete l.g[m],l.h--))}}function ul(l,f,m,S){for(var F=0;F<l.length;++F){var U=l[F];if(!U.da&&U.listener==f&&U.capture==!!m&&U.ha==S)return F}return-1}var ba="closure_lm_"+(1e6*Math.random()|0),dl={};function ag(l,f,m,S,F){if(S&&S.once)return fl(l,f,m,S,F);if(Array.isArray(f)){for(var U=0;U<f.length;U++)ag(l,f[U],m,S,F);return null}return m=Ji(m),l&&l[Yi]?l.K(f,m,d(S)?!!S.capture:!!S,F):hl(l,f,m,!1,S,F)}function hl(l,f,m,S,F,U){if(!f)throw Error("Invalid event type");var K=d(F)?!!F.capture:!!F,We=pl(l);if(We||(l[ba]=We=new cl(l)),m=We.add(f,m,S,K,U),m.proxy)return m;if(S=zd(),m.proxy=S,S.src=l,S.listener=m,l.addEventListener)al||(F=K),F===void 0&&(F=!1),l.addEventListener(f.toString(),S,F);else if(l.attachEvent)l.attachEvent(Ca(f.toString()),S);else if(l.addListener&&l.removeListener)l.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return m}function zd(){function l(m){return f.call(l.src,l.listener,m)}let f=rw;return l}function fl(l,f,m,S,F){if(Array.isArray(f)){for(var U=0;U<f.length;U++)fl(l,f[U],m,S,F);return null}return m=Ji(m),l&&l[Yi]?l.L(f,m,d(S)?!!S.capture:!!S,F):hl(l,f,m,!0,S,F)}function Qt(l,f,m,S,F){if(Array.isArray(f))for(var U=0;U<f.length;U++)Qt(l,f[U],m,S,F);else S=d(S)?!!S.capture:!!S,m=Ji(m),l&&l[Yi]?(l=l.i,f=String(f).toString(),f in l.g&&(U=l.g[f],m=ul(U,m,S,F),-1<m&&(Ea(U[m]),Array.prototype.splice.call(U,m,1),U.length==0&&(delete l.g[f],l.h--)))):l&&(l=pl(l))&&(f=l.g[f.toString()],l=-1,f&&(l=ul(f,m,S,F)),(m=-1<l?f[l]:null)&&Yt(m))}function Yt(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Yi])ll(f.i,l);else{var m=l.type,S=l.proxy;f.removeEventListener?f.removeEventListener(m,S,l.capture):f.detachEvent?f.detachEvent(Ca(m),S):f.addListener&&f.removeListener&&f.removeListener(S),(m=pl(f))?(ll(m,l),m.h==0&&(m.src=null,f[ba]=null)):Ea(l)}}}function Ca(l){return l in dl?dl[l]:dl[l]="on"+l}function rw(l,f){if(l.da)l=!0;else{f=new Qi(f,this);var m=l.listener,S=l.ha||l.src;l.fa&&Yt(l),l=m.call(S,f)}return l}function pl(l){return l=l[ba],l instanceof cl?l:null}var Gd="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ji(l){return typeof l=="function"?l:(l[Gd]||(l[Gd]=function(f){return l.handleEvent(f)}),l[Gd])}function Jt(){Mr.call(this),this.i=new cl(this),this.M=this,this.F=null}k(Jt,Mr),Jt.prototype[Yi]=!0,Jt.prototype.removeEventListener=function(l,f,m,S){Qt(this,l,f,m,S)};function cn(l,f){var m,S=l.F;if(S)for(m=[];S;S=S.F)m.push(S);if(l=l.M,S=f.type||f,typeof f=="string")f=new Kt(f,l);else if(f instanceof Kt)f.target=f.target||l;else{var F=f;f=new Kt(S,l),C(f,F)}if(F=!0,m)for(var U=m.length-1;0<=U;U--){var K=f.g=m[U];F=Ks(K,S,!0,f)&&F}if(K=f.g=l,F=Ks(K,S,!0,f)&&F,F=Ks(K,S,!1,f)&&F,m)for(U=0;U<m.length;U++)K=f.g=m[U],F=Ks(K,S,!1,f)&&F}Jt.prototype.N=function(){if(Jt.aa.N.call(this),this.i){var l=this.i,f;for(f in l.g){for(var m=l.g[f],S=0;S<m.length;S++)Ea(m[S]);delete l.g[f],l.h--}}this.F=null},Jt.prototype.K=function(l,f,m,S){return this.i.add(String(l),f,!1,m,S)},Jt.prototype.L=function(l,f,m,S){return this.i.add(String(l),f,!0,m,S)};function Ks(l,f,m,S){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();for(var F=!0,U=0;U<f.length;++U){var K=f[U];if(K&&!K.da&&K.capture==m){var We=K.listener,St=K.ha||K.src;K.fa&&ll(l.i,K),F=We.call(St,S)!==!1&&F}}return F&&!S.defaultPrevented}function cg(l,f,m){if(typeof l=="function")m&&(l=y(l,m));else if(l&&typeof l.handleEvent=="function")l=y(l.handleEvent,l);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(l,f||0)}function lg(l){l.g=cg(()=>{l.g=null,l.i&&(l.i=!1,lg(l))},l.l);let f=l.h;l.h=null,l.m.apply(null,f)}class ug extends Mr{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:lg(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Qs(l){Mr.call(this),this.h=l,this.g={}}k(Qs,Mr);var Ys=[];function gl(l){pe(l.g,function(f,m){this.g.hasOwnProperty(m)&&Yt(f)},l),l.g={}}Qs.prototype.N=function(){Qs.aa.N.call(this),gl(this)},Qs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ta=a.JSON.stringify,Xi=a.JSON.parse,dg=class{stringify(l){return a.JSON.stringify(l,void 0)}parse(l){return a.JSON.parse(l,void 0)}};function Js(){}Js.prototype.h=null;function Wd(l){return l.h||(l.h=l.i())}function Xs(){}var Zs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Xt(){Kt.call(this,"d")}k(Xt,Kt);function ml(){Kt.call(this,"c")}k(ml,Kt);var Xn={},eo=null;function yl(){return eo=eo||new Jt}Xn.La="serverreachability";function hg(l){Kt.call(this,Xn.La,l)}k(hg,Kt);function gr(l){let f=yl();cn(f,new hg(f))}Xn.STAT_EVENT="statevent";function fg(l,f){Kt.call(this,Xn.STAT_EVENT,l),this.stat=f}k(fg,Kt);function _n(l){let f=yl();cn(f,new fg(f,l))}Xn.Ma="timingevent";function Sa(l,f){Kt.call(this,Xn.Ma,l),this.size=f}k(Sa,Kt);function to(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){l()},f)}function no(){this.g=!0}no.prototype.xa=function(){this.g=!1};function Kd(l,f,m,S,F,U){l.info(function(){if(l.g)if(U)for(var K="",We=U.split("&"),St=0;St<We.length;St++){var Ke=We[St].split("=");if(1<Ke.length){var Tn=Ke[0];Ke=Ke[1];var Sn=Tn.split("_");K=2<=Sn.length&&Sn[1]=="type"?K+(Tn+"="+Ke+"&"):K+(Tn+"=redacted&")}}else K=null;else K=U;return"XMLHTTP REQ ("+S+") [attempt "+F+"]: "+f+`
`+m+`
`+K})}function Da(l,f,m,S,F,U,K){l.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+F+"]: "+f+`
`+m+`
`+U+" "+K})}function ro(l,f,m,S){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+pg(l,m)+(S?" "+S:"")})}function ai(l,f){l.info(function(){return"TIMEOUT: "+f})}no.prototype.info=function(){};function pg(l,f){if(!l.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(l=0;l<m.length;l++)if(Array.isArray(m[l])){var S=m[l];if(!(2>S.length)){var F=S[1];if(Array.isArray(F)&&!(1>F.length)){var U=F[0];if(U!="noop"&&U!="stop"&&U!="close")for(var K=1;K<F.length;K++)F[K]=""}}}}return Ta(m)}catch{return f}}var Aa={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vl={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xa;function Ra(){}k(Ra,Js),Ra.prototype.g=function(){return new XMLHttpRequest},Ra.prototype.i=function(){return{}},xa=new Ra;function ci(l,f,m,S){this.j=l,this.i=f,this.l=m,this.R=S||1,this.U=new Qs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qd}function Qd(){this.i=null,this.g="",this.h=!1}var gg={},io={};function _l(l,f,m){l.L=1,l.v=bl(Pr(f)),l.m=m,l.P=!0,wl(l,null)}function wl(l,f){l.F=Date.now(),oo(l),l.A=Pr(l.v);var m=l.A,S=l.R;Array.isArray(S)||(S=[String(S)]),bg(m.i,"t",S),l.C=0,m=l.j.J,l.h=new Qd,l.g=g(l.j,m?f:null,!l.m),0<l.O&&(l.M=new ug(y(l.Y,l,l.g),l.O)),f=l.U,m=l.g,S=l.ca;var F="readystatechange";Array.isArray(F)||(F&&(Ys[0]=F.toString()),F=Ys);for(var U=0;U<F.length;U++){var K=ag(m,F[U],S||f.handleEvent,!1,f.h||f);if(!K)break;f.g[K.key]=K}f=l.H?_(l.H):{},l.m?(l.u||(l.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.A,l.u,l.m,f)):(l.u="GET",l.g.ea(l.A,l.u,null,f)),gr(),Kd(l.i,l.u,l.A,l.l,l.R,l.m)}ci.prototype.ca=function(l){l=l.target;let f=this.M;f&&Gn(l)==3?f.j():this.Y(l)},ci.prototype.Y=function(l){try{if(l==this.g)e:{let Sn=Gn(this.g);var f=this.g.Ba();let Nl=this.g.Z();if(!(3>Sn)&&(Sn!=3||this.g&&(this.h.h||this.g.oa()||Ag(this.g)))){this.J||Sn!=4||f==7||(f==8||0>=Nl?gr(3):gr(2)),Il(this);var m=this.g.Z();this.X=m;t:if(so(this)){var S=Ag(this.g);l="";var F=S.length,U=Gn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){li(this),ao(this);var K="";break t}this.h.i=new a.TextDecoder}for(f=0;f<F;f++)this.h.h=!0,l+=this.h.i.decode(S[f],{stream:!(U&&f==F-1)});S.length=0,this.h.g+=l,this.C=0,K=this.h.g}else K=this.g.oa();if(this.o=m==200,Da(this.i,this.u,this.A,this.l,this.R,Sn,m),this.o){if(this.T&&!this.K){t:{if(this.g){var We,St=this.g;if((We=St.g?St.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(We)){var Ke=We;break t}}Ke=null}if(m=Ke)ro(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ka(this,m);else{this.o=!1,this.s=3,_n(12),li(this),ao(this);break e}}if(this.P){m=!0;let Ur;for(;!this.J&&this.C<K.length;)if(Ur=Zi(this,K),Ur==io){Sn==4&&(this.s=4,_n(14),m=!1),ro(this.i,this.l,null,"[Incomplete Response]");break}else if(Ur==gg){this.s=4,_n(15),ro(this.i,this.l,K,"[Invalid Chunk]"),m=!1;break}else ro(this.i,this.l,Ur,null),ka(this,Ur);if(so(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Sn!=4||K.length!=0||this.h.h||(this.s=1,_n(16),m=!1),this.o=this.o&&m,!m)ro(this.i,this.l,K,"[Invalid Chunked Response]"),li(this),ao(this);else if(0<K.length&&!this.W){this.W=!0;var Tn=this.j;Tn.g==this&&Tn.ba&&!Tn.M&&(Tn.j.info("Great, no buffering proxy detected. Bytes received: "+K.length),kl(Tn),Tn.M=!0,_n(11))}}else ro(this.i,this.l,K,null),ka(this,K);Sn==4&&li(this),this.o&&!this.J&&(Sn==4?Cn(this.j,this):(this.o=!1,oo(this)))}else xg(this.g),m==400&&0<K.indexOf("Unknown SID")?(this.s=3,_n(12)):(this.s=0,_n(13)),li(this),ao(this)}}}catch{}finally{}};function so(l){return l.g?l.u=="GET"&&l.L!=2&&l.j.Ca:!1}function Zi(l,f){var m=l.C,S=f.indexOf(`
`,m);return S==-1?io:(m=Number(f.substring(m,S)),isNaN(m)?gg:(S+=1,S+m>f.length?io:(f=f.slice(S,S+m),l.C=S+m,f)))}ci.prototype.cancel=function(){this.J=!0,li(this)};function oo(l){l.S=Date.now()+l.I,mg(l,l.I)}function mg(l,f){if(l.B!=null)throw Error("WatchDog timer not null");l.B=to(y(l.ba,l),f)}function Il(l){l.B&&(a.clearTimeout(l.B),l.B=null)}ci.prototype.ba=function(){this.B=null;let l=Date.now();0<=l-this.S?(ai(this.i,this.A),this.L!=2&&(gr(),_n(17)),li(this),this.s=2,ao(this)):mg(this,this.S-l)};function ao(l){l.j.G==0||l.J||Cn(l.j,l)}function li(l){Il(l);var f=l.M;f&&typeof f.ma=="function"&&f.ma(),l.M=null,gl(l.U),l.g&&(f=l.g,l.g=null,f.abort(),f.ma())}function ka(l,f){try{var m=l.j;if(m.G!=0&&(m.g==l||eh(m.h,l))){if(!l.K&&eh(m.h,l)&&m.G==3){try{var S=m.Da.g.parse(f)}catch{S=null}if(Array.isArray(S)&&S.length==3){var F=S;if(F[0]==0){e:if(!m.u){if(m.g)if(m.g.F+3e3<l.F)ts(m),go(m);else break e;Rl(m),_n(18)}}else m.za=F[1],0<m.za-m.T&&37500>F[2]&&m.F&&m.v==0&&!m.C&&(m.C=to(y(m.Za,m),6e3));if(1>=Zd(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else hi(m,11)}else if((l.K||m.g==l)&&ts(m),!Y(f))for(F=m.Da.g.parse(f),f=0;f<F.length;f++){let Ke=F[f];if(m.T=Ke[0],Ke=Ke[1],m.G==2)if(Ke[0]=="c"){m.K=Ke[1],m.ia=Ke[2];let Tn=Ke[3];Tn!=null&&(m.la=Tn,m.j.info("VER="+m.la));let Sn=Ke[4];Sn!=null&&(m.Aa=Sn,m.j.info("SVER="+m.Aa));let Nl=Ke[5];Nl!=null&&typeof Nl=="number"&&0<Nl&&(S=1.5*Nl,m.L=S,m.j.info("backChannelRequestTimeoutMs_="+S)),S=m;let Ur=l.g;if(Ur){let Rg=Ur.g?Ur.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rg){var U=S.h;U.g||Rg.indexOf("spdy")==-1&&Rg.indexOf("quic")==-1&&Rg.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(mr(U,U.h),U.h=null))}if(S.D){let sw=Ur.g?Ur.g.getResponseHeader("X-HTTP-Session-Id"):null;sw&&(S.ya=sw,ct(S.I,S.D,sw))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-l.F,m.j.info("Handshake RTT: "+m.R+"ms")),S=m;var K=l;if(S.qa=u(S,S.J?S.ia:null,S.W),K.K){Zn(S.h,K);var We=K,St=S.L;St&&(We.I=St),We.B&&(Il(We),oo(We)),S.g=K}else lh(S);0<m.i.length&&La(m)}else Ke[0]!="stop"&&Ke[0]!="close"||hi(m,7);else m.G==3&&(Ke[0]=="stop"||Ke[0]=="close"?Ke[0]=="stop"?hi(m,7):Dl(m):Ke[0]!="noop"&&m.l&&m.l.ta(Ke),m.v=0)}}gr(4)}catch{}}var Yd=class{constructor(l,f){this.g=l,this.map=f}};function Jd(l){this.l=l||10,a.PerformanceNavigationTiming?(l=a.performance.getEntriesByType("navigation"),l=0<l.length&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xd(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function Zd(l){return l.h?1:l.g?l.g.size:0}function eh(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function mr(l,f){l.g?l.g.add(f):l.h=f}function Zn(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}Jd.prototype.cancel=function(){if(this.i=co(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let l of this.g.values())l.cancel();this.g.clear()}};function co(l){if(l.h!=null)return l.i.concat(l.h.D);if(l.g!=null&&l.g.size!==0){let f=l.i;for(let m of l.g.values())f=f.concat(m.D);return f}return P(l.i)}function Na(l){if(l.V&&typeof l.V=="function")return l.V();if(typeof Map<"u"&&l instanceof Map||typeof Set<"u"&&l instanceof Set)return Array.from(l.values());if(typeof l=="string")return l.split("");if(c(l)){for(var f=[],m=l.length,S=0;S<m;S++)f.push(l[S]);return f}f=[],m=0;for(S in l)f[m++]=l[S];return f}function th(l){if(l.na&&typeof l.na=="function")return l.na();if(!l.V||typeof l.V!="function"){if(typeof Map<"u"&&l instanceof Map)return Array.from(l.keys());if(!(typeof Set<"u"&&l instanceof Set)){if(c(l)||typeof l=="string"){var f=[];l=l.length;for(var m=0;m<l;m++)f.push(m);return f}f=[],m=0;for(let S in l)f[m++]=S;return f}}}function st(l,f){if(l.forEach&&typeof l.forEach=="function")l.forEach(f,void 0);else if(c(l)||typeof l=="string")Array.prototype.forEach.call(l,f,void 0);else for(var m=th(l),S=Na(l),F=S.length,U=0;U<F;U++)f.call(void 0,S[U],m&&m[U],l)}var Ma=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pa(l,f){if(l){l=l.split("&");for(var m=0;m<l.length;m++){var S=l[m].indexOf("="),F=null;if(0<=S){var U=l[m].substring(0,S);F=l[m].substring(S+1)}else U=l[m];f(U,F?decodeURIComponent(F.replace(/\+/g," ")):"")}}}function er(l){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,l instanceof er){this.h=l.h,Oa(this,l.j),this.o=l.o,this.g=l.g,El(this,l.s),this.l=l.l;var f=l.i,m=new Fa;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),yg(this,m),this.m=l.m}else l&&(f=String(l).match(Ma))?(this.h=!1,Oa(this,f[1]||"",!0),this.o=Or(f[2]||""),this.g=Or(f[3]||"",!0),El(this,f[4]),this.l=Or(f[5]||"",!0),yg(this,f[6]||"",!0),this.m=Or(f[7]||"")):(this.h=!1,this.i=new Fa(null,this.h))}er.prototype.toString=function(){var l=[],f=this.j;f&&l.push(tr(f,nh,!0),":");var m=this.g;return(m||f=="file")&&(l.push("//"),(f=this.o)&&l.push(tr(f,nh,!0),"@"),l.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&l.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&l.push("/"),l.push(tr(m,m.charAt(0)=="/"?wg:_g,!0))),(m=this.i.toString())&&l.push("?",m),(m=this.m)&&l.push("#",tr(m,lo)),l.join("")};function Pr(l){return new er(l)}function Oa(l,f,m){l.j=m?Or(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function El(l,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);l.s=f}else l.s=null}function yg(l,f,m){f instanceof Fa?(l.i=f,Cl(l.i,l.h)):(m||(f=tr(f,Ig)),l.i=new Fa(f,l.h))}function ct(l,f,m){l.i.set(f,m)}function bl(l){return ct(l,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),l}function Or(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function tr(l,f,m){return typeof l=="string"?(l=encodeURI(l).replace(f,vg),m&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function vg(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var nh=/[#\/\?@]/g,_g=/[#\?:]/g,wg=/[#\?]/g,Ig=/[#\?@]/g,lo=/#/g;function Fa(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function ui(l){l.g||(l.g=new Map,l.h=0,l.i&&Pa(l.i,function(f,m){l.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=Fa.prototype,n.add=function(l,f){ui(this),this.i=null,l=Vr(this,l);var m=this.g.get(l);return m||this.g.set(l,m=[]),m.push(f),this.h+=1,this};function Eg(l,f){ui(l),f=Vr(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function Fr(l,f){return ui(l),f=Vr(l,f),l.g.has(f)}n.forEach=function(l,f){ui(this),this.g.forEach(function(m,S){m.forEach(function(F){l.call(f,F,S,this)},this)},this)},n.na=function(){ui(this);let l=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let S=0;S<f.length;S++){let F=l[S];for(let U=0;U<F.length;U++)m.push(f[S])}return m},n.V=function(l){ui(this);let f=[];if(typeof l=="string")Fr(this,l)&&(f=f.concat(this.g.get(Vr(this,l))));else{l=Array.from(this.g.values());for(let m=0;m<l.length;m++)f=f.concat(l[m])}return f},n.set=function(l,f){return ui(this),this.i=null,l=Vr(this,l),Fr(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},n.get=function(l,f){return l?(l=this.V(l),0<l.length?String(l[0]):f):f};function bg(l,f,m){Eg(l,f),0<m.length&&(l.i=null,l.g.set(Vr(l,f),P(m)),l.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let l=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var S=f[m];let U=encodeURIComponent(String(S)),K=this.V(S);for(S=0;S<K.length;S++){var F=U;K[S]!==""&&(F+="="+encodeURIComponent(String(K[S]))),l.push(F)}}return this.i=l.join("&")};function Vr(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function Cl(l,f){f&&!l.j&&(ui(l),l.i=null,l.g.forEach(function(m,S){var F=S.toLowerCase();S!=F&&(Eg(this,S),bg(this,F,m))},l)),l.j=f}function Cg(l,f){let m=new no;if(a.Image){let S=new Image;S.onload=E(zn,m,"TestLoadImage: loaded",!0,f,S),S.onerror=E(zn,m,"TestLoadImage: error",!1,f,S),S.onabort=E(zn,m,"TestLoadImage: abort",!1,f,S),S.ontimeout=E(zn,m,"TestLoadImage: timeout",!1,f,S),a.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=l}else f(!1)}function Va(l,f){let m=new no,S=new AbortController,F=setTimeout(()=>{S.abort(),zn(m,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:S.signal}).then(U=>{clearTimeout(F),U.ok?zn(m,"TestPingServer: ok",!0,f):zn(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(F),zn(m,"TestPingServer: error",!1,f)})}function zn(l,f,m,S,F){try{F&&(F.onload=null,F.onerror=null,F.onabort=null,F.ontimeout=null),S(m)}catch{}}function Tg(){this.g=new dg}function rh(l,f,m){let S=m||"";try{st(l,function(F,U){let K=F;d(F)&&(K=Ta(F)),f.push(S+U+"="+encodeURIComponent(K))})}catch(F){throw f.push(S+"type="+encodeURIComponent("_badmap")),F}}function ot(l){this.l=l.Ub||null,this.j=l.eb||!1}k(ot,Js),ot.prototype.g=function(){return new Tl(this.l,this.j)},ot.prototype.i=(function(l){return function(){return l}})({});function Tl(l,f){Jt.call(this),this.D=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}k(Tl,Jt),n=Tl.prototype,n.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=l,this.A=f,this.readyState=1,ho(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};l&&(f.body=l),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,uo(this)),this.readyState=0},n.Sa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,ho(this)),this.g&&(this.readyState=3,ho(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Sg(this)}else l.text().then(this.Ra.bind(this),this.ga.bind(this))};function Sg(l){l.j.read().then(l.Pa.bind(l)).catch(l.ga.bind(l))}n.Pa=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?uo(this):ho(this),this.readyState==3&&Sg(this)}},n.Ra=function(l){this.g&&(this.response=this.responseText=l,uo(this))},n.Qa=function(l){this.g&&(this.response=l,uo(this))},n.ga=function(){this.g&&uo(this)};function uo(l){l.readyState=4,l.l=null,l.j=null,l.v=null,ho(l)}n.setRequestHeader=function(l,f){this.u.append(l,f)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let l=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,l.push(m[0]+": "+m[1]),m=f.next();return l.join(`\r
`)};function ho(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(Tl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function ih(l){let f="";return pe(l,function(m,S){f+=S,f+=":",f+=m,f+=`\r
`}),f}function fo(l,f,m){e:{for(S in m){var S=!1;break e}S=!0}S||(m=ih(m),typeof l=="string"?m!=null&&encodeURIComponent(String(m)):ct(l,f,m))}function Qe(l){Jt.call(this),this.headers=new Map,this.o=l||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}k(Qe,Jt);var Dg=/^https?$/i,iw=["POST","PUT"];n=Qe.prototype,n.Ha=function(l){this.J=l},n.ea=function(l,f,m,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xa.g(),this.v=this.o?Wd(this.o):Wd(xa),this.g.onreadystatechange=y(this.Ea,this);try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(U){po(this,U);return}if(l=m||"",m=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var F in S)m.set(F,S[F]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(let U of S.keys())m.set(U,S.get(U));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(m.keys()).find(U=>U.toLowerCase()=="content-type"),F=a.FormData&&l instanceof a.FormData,!(0<=Array.prototype.indexOf.call(iw,f,void 0))||S||F||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[U,K]of m)this.g.setRequestHeader(U,K);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{oh(this),this.u=!0,this.g.send(l),this.u=!1}catch(U){po(this,U)}};function po(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.m=5,sh(l),es(l)}function sh(l){l.A||(l.A=!0,cn(l,"complete"),cn(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=l||7,cn(this,"complete"),cn(this,"abort"),es(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),es(this,!0)),Qe.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Sl(this):this.bb())},n.bb=function(){Sl(this)};function Sl(l){if(l.h&&typeof o<"u"&&(!l.v[1]||Gn(l)!=4||l.Z()!=2)){if(l.u&&Gn(l)==4)cg(l.Ea,0,l);else if(cn(l,"readystatechange"),Gn(l)==4){l.h=!1;try{let K=l.Z();e:switch(K){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var m;if(!(m=f)){var S;if(S=K===0){var F=String(l.D).match(Ma)[1]||null;!F&&a.self&&a.self.location&&(F=a.self.location.protocol.slice(0,-1)),S=!Dg.test(F?F.toLowerCase():"")}m=S}if(m)cn(l,"complete"),cn(l,"success");else{l.m=6;try{var U=2<Gn(l)?l.g.statusText:""}catch{U=""}l.l=U+" ["+l.Z()+"]",sh(l)}}finally{es(l)}}}}function es(l,f){if(l.g){oh(l);let m=l.g,S=l.v[0]?()=>{}:null;l.g=null,l.v=null,f||cn(l,"ready");try{m.onreadystatechange=S}catch{}}}function oh(l){l.I&&(a.clearTimeout(l.I),l.I=null)}n.isActive=function(){return!!this.g};function Gn(l){return l.g?l.g.readyState:0}n.Z=function(){try{return 2<Gn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),Xi(f)}};function Ag(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.H){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function xg(l){let f={};l=(l.g&&2<=Gn(l)&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<l.length;S++){if(Y(l[S]))continue;var m=b(l[S]);let F=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let U=f[F]||[];f[F]=U,U.push(m)}T(f,function(S){return S.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lr(l,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[l]||f}function ah(l){this.Aa=0,this.i=[],this.j=new no,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Lr("failFast",!1,l),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Lr("baseRetryDelayMs",5e3,l),this.cb=Lr("retryDelaySeedMs",1e4,l),this.Wa=Lr("forwardChannelMaxRetries",2,l),this.wa=Lr("forwardChannelRequestTimeoutMs",2e4,l),this.pa=l&&l.xmlHttpFactory||void 0,this.Xa=l&&l.Tb||void 0,this.Ca=l&&l.useFetchStreams||!1,this.L=void 0,this.J=l&&l.supportsCrossDomainXhr||!1,this.K="",this.h=new Jd(l&&l.concurrentRequestLimit),this.Da=new Tg,this.P=l&&l.fastHandshake||!1,this.O=l&&l.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=l&&l.Rb||!1,l&&l.xa&&this.j.xa(),l&&l.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&l&&l.detectBufferingProxy||!1,this.ja=void 0,l&&l.longPollingTimeout&&0<l.longPollingTimeout&&(this.ja=l.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=ah.prototype,n.la=8,n.G=1,n.connect=function(l,f,m,S){_n(0),this.W=l,this.H=f||{},m&&S!==void 0&&(this.H.OSID=m,this.H.OAID=S),this.F=this.X,this.I=u(this,null,this.W),La(this)};function Dl(l){if(Al(l),l.G==3){var f=l.U++,m=Pr(l.I);if(ct(m,"SID",l.K),ct(m,"RID",f),ct(m,"TYPE","terminate"),mo(l,m),f=new ci(l,l.j,f),f.L=2,f.v=bl(Pr(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=g(f.j,null),f.g.ea(f.v)),f.F=Date.now(),oo(f)}ns(l)}function go(l){l.g&&(kl(l),l.g.cancel(),l.g=null)}function Al(l){go(l),l.u&&(a.clearTimeout(l.u),l.u=null),ts(l),l.h.cancel(),l.s&&(typeof l.s=="number"&&a.clearTimeout(l.s),l.s=null)}function La(l){if(!Xd(l.h)&&!l.s){l.s=!0;var f=l.Ga;Ia||ig(),oi||(Ia(),oi=!0),Ws.add(f,l),l.B=0}}function xl(l,f){return Zd(l.h)>=l.h.j-(l.s?1:0)?!1:l.s?(l.i=f.D.concat(l.i),!0):l.G==1||l.G==2||l.B>=(l.Va?0:l.Wa)?!1:(l.s=to(y(l.Ga,l,f),dh(l,l.B)),l.B++,!0)}n.Ga=function(l){if(this.s)if(this.s=null,this.G==1){if(!l){this.U=Math.floor(1e5*Math.random()),l=this.U++;let F=new ci(this,this.j,l),U=this.o;if(this.S&&(U?(U=_(U),C(U,this.S)):U=this.S),this.m!==null||this.O||(F.H=U,U=null),this.P)e:{for(var f=0,m=0;m<this.i.length;m++){t:{var S=this.i[m];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(f+=S,4096<f){f=m;break e}if(f===4096||m===this.i.length-1){f=m+1;break e}}f=1e3}else f=1e3;f=di(this,F,f),m=Pr(this.I),ct(m,"RID",l),ct(m,"CVER",22),this.D&&ct(m,"X-HTTP-Session-Id",this.D),mo(this,m),U&&(this.O?f="headers="+encodeURIComponent(String(ih(U)))+"&"+f:this.m&&fo(m,this.m,U)),mr(this.h,F),this.Ua&&ct(m,"TYPE","init"),this.P?(ct(m,"$req",f),ct(m,"SID","null"),F.T=!0,_l(F,m,null)):_l(F,m,f),this.G=2}}else this.G==3&&(l?ch(this,l):this.i.length==0||Xd(this.h)||ch(this))};function ch(l,f){var m;f?m=f.l:m=l.U++;let S=Pr(l.I);ct(S,"SID",l.K),ct(S,"RID",m),ct(S,"AID",l.T),mo(l,S),l.m&&l.o&&fo(S,l.m,l.o),m=new ci(l,l.j,m,l.B+1),l.m===null&&(m.H=l.o),f&&(l.i=f.D.concat(l.i)),f=di(l,m,1e3),m.I=Math.round(.5*l.wa)+Math.round(.5*l.wa*Math.random()),mr(l.h,m),_l(m,S,f)}function mo(l,f){l.H&&pe(l.H,function(m,S){ct(f,S,m)}),l.l&&st({},function(m,S){ct(f,S,m)})}function di(l,f,m){m=Math.min(l.i.length,m);var S=l.l?y(l.l.Na,l.l,l):null;e:{var F=l.i;let U=-1;for(;;){let K=["count="+m];U==-1?0<m?(U=F[0].g,K.push("ofs="+U)):U=0:K.push("ofs="+U);let We=!0;for(let St=0;St<m;St++){let Ke=F[St].g,Tn=F[St].map;if(Ke-=U,0>Ke)U=Math.max(0,F[St].g-100),We=!1;else try{rh(Tn,K,"req"+Ke+"_")}catch{S&&S(Tn)}}if(We){S=K.join("&");break e}}}return l=l.i.splice(0,m),f.D=l,S}function lh(l){if(!l.g&&!l.u){l.Y=1;var f=l.Fa;Ia||ig(),oi||(Ia(),oi=!0),Ws.add(f,l),l.v=0}}function Rl(l){return l.g||l.u||3<=l.v?!1:(l.Y++,l.u=to(y(l.Fa,l),dh(l,l.v)),l.v++,!0)}n.Fa=function(){if(this.u=null,uh(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var l=2*this.R;this.j.info("BP detection timer enabled: "+l),this.A=to(y(this.ab,this),l)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_n(10),go(this),uh(this))};function kl(l){l.A!=null&&(a.clearTimeout(l.A),l.A=null)}function uh(l){l.g=new ci(l,l.j,"rpc",l.Y),l.m===null&&(l.g.H=l.o),l.g.O=0;var f=Pr(l.qa);ct(f,"RID","rpc"),ct(f,"SID",l.K),ct(f,"AID",l.T),ct(f,"CI",l.F?"0":"1"),!l.F&&l.ja&&ct(f,"TO",l.ja),ct(f,"TYPE","xmlhttp"),mo(l,f),l.m&&l.o&&fo(f,l.m,l.o),l.L&&(l.g.I=l.L);var m=l.g;l=l.ia,m.L=1,m.v=bl(Pr(f)),m.m=null,m.P=!0,wl(m,l)}n.Za=function(){this.C!=null&&(this.C=null,go(this),Rl(this),_n(19))};function ts(l){l.C!=null&&(a.clearTimeout(l.C),l.C=null)}function Cn(l,f){var m=null;if(l.g==f){ts(l),kl(l),l.g=null;var S=2}else if(eh(l.h,f))m=f.D,Zn(l.h,f),S=1;else return;if(l.G!=0){if(f.o)if(S==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var F=l.B;S=yl(),cn(S,new Sa(S,m)),La(l)}else lh(l);else if(F=f.s,F==3||F==0&&0<f.X||!(S==1&&xl(l,f)||S==2&&Rl(l)))switch(m&&0<m.length&&(f=l.h,f.i=f.i.concat(m)),F){case 1:hi(l,5);break;case 4:hi(l,10);break;case 3:hi(l,6);break;default:hi(l,2)}}}function dh(l,f){let m=l.Ta+Math.floor(Math.random()*l.cb);return l.isActive()||(m*=2),m*f}function hi(l,f){if(l.j.info("Error code "+f),f==2){var m=y(l.fb,l),S=l.Xa;let F=!S;S=new er(S||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Oa(S,"https"),bl(S),F?Cg(S.toString(),m):Va(S.toString(),m)}else _n(2);l.G=0,l.l&&l.l.sa(f),ns(l),Al(l)}n.fb=function(l){l?(this.j.info("Successfully pinged google.com"),_n(2)):(this.j.info("Failed to ping google.com"),_n(1))};function ns(l){if(l.G=0,l.ka=[],l.l){let f=co(l.h);(f.length!=0||l.i.length!=0)&&(M(l.ka,f),M(l.ka,l.i),l.h.i.length=0,P(l.i),l.i.length=0),l.l.ra()}}function u(l,f,m){var S=m instanceof er?Pr(m):new er(m);if(S.g!="")f&&(S.g=f+"."+S.g),El(S,S.s);else{var F=a.location;S=F.protocol,f=f?f+"."+F.hostname:F.hostname,F=+F.port;var U=new er(null);S&&Oa(U,S),f&&(U.g=f),F&&El(U,F),m&&(U.l=m),S=U}return m=l.D,f=l.ya,m&&f&&ct(S,m,f),ct(S,"VER",l.la),mo(l,S),S}function g(l,f,m){if(f&&!l.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Ca&&!l.pa?new Qe(new ot({eb:m})):new Qe(l.pa),f.Ha(l.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function v(){}n=v.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function D(){}D.prototype.g=function(l,f){return new O(l,f)};function O(l,f){Jt.call(this),this.g=new ah(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(l?l["X-WebChannel-Client-Profile"]=f.va:l={"X-WebChannel-Client-Profile":f.va}),this.g.S=l,(l=f&&f.Sb)&&!Y(l)&&(this.g.m=l),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!Y(f)&&(this.g.D=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new ge(this)}k(O,Jt),O.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},O.prototype.close=function(){Dl(this.g)},O.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var m={};m.__data__=l,l=m}else this.u&&(m={},m.__data__=Ta(l),l=m);f.i.push(new Yd(f.Ya++,l)),f.G==3&&La(f)},O.prototype.N=function(){this.g.l=null,delete this.j,Dl(this.g),delete this.g,O.aa.N.call(this)};function L(l){Xt.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){e:{for(let m in f){l=m;break e}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}k(L,Xt);function J(){ml.call(this),this.status=1}k(J,ml);function ge(l){this.g=l}k(ge,v),ge.prototype.ua=function(){cn(this.g,"a")},ge.prototype.ta=function(l){cn(this.g,new L(l))},ge.prototype.sa=function(l){cn(this.g,new J)},ge.prototype.ra=function(){cn(this.g,"b")},D.prototype.createWebChannel=D.prototype.g,O.prototype.send=O.prototype.o,O.prototype.open=O.prototype.m,O.prototype.close=O.prototype.close,MD=Ls.createWebChannelTransport=function(){return new D},ND=Ls.getStatEventTarget=function(){return yl()},kD=Ls.Event=Xn,U_=Ls.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Aa.NO_ERROR=0,Aa.TIMEOUT=8,Aa.HTTP_ERROR=6,Rp=Ls.ErrorCode=Aa,vl.COMPLETE="complete",RD=Ls.EventType=vl,Xs.EventType=Zs,Zs.OPEN="a",Zs.CLOSE="b",Zs.ERROR="c",Zs.MESSAGE="d",Jt.prototype.listen=Jt.prototype.K,cd=Ls.WebChannel=Xs,WQ=Ls.FetchXmlHttpFactory=ot,Qe.prototype.listenOnce=Qe.prototype.L,Qe.prototype.getLastError=Qe.prototype.Ka,Qe.prototype.getLastErrorCode=Qe.prototype.Ba,Qe.prototype.getStatus=Qe.prototype.Z,Qe.prototype.getResponseJson=Qe.prototype.Oa,Qe.prototype.getResponseText=Qe.prototype.oa,Qe.prototype.send=Qe.prototype.ea,Qe.prototype.setWithCredentials=Qe.prototype.Ha,xD=Ls.XhrIo=Qe}).apply(typeof L_<"u"?L_:typeof self<"u"?self:typeof window<"u"?window:{});var oL="@firebase/firestore",aL="4.8.0";var yn=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};yn.UNAUTHENTICATED=new yn(null),yn.GOOGLE_CREDENTIALS=new yn("google-credentials-uid"),yn.FIRST_PARTY=new yn("first-party-uid"),yn.MOCK_USER=new yn("mock-user");var Ad="11.10.0";var Jc=new Ni("@firebase/firestore");function ld(){return Jc.logLevel}function re(n,...e){if(Jc.logLevel<=Fe.DEBUG){let t=e.map(Cx);Jc.debug(`Firestore (${Ad}): ${n}`,...t)}}function js(n,...e){if(Jc.logLevel<=Fe.ERROR){let t=e.map(Cx);Jc.error(`Firestore (${Ad}): ${n}`,...t)}}function la(n,...e){if(Jc.logLevel<=Fe.WARN){let t=e.map(Cx);Jc.warn(`Firestore (${Ad}): ${n}`,...t)}}function Cx(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function fe(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,ZL(n,r,t)}function ZL(n,e,t){let r=`FIRESTORE (${Ad}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw js(r),new Error(r)}function it(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||ZL(e,i,r)}function be(n,e){return n}var q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},te=class extends ur{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ji=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var G_=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},LD=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(yn.UNAUTHENTICATED))}shutdown(){}},UD=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},jD=class{constructor(e){this.t=e,this.currentUser=yn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){it(this.o===void 0,42304);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new ji;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ji,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(re("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ji)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(it(typeof r.accessToken=="string",31837,{l:r}),new G_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return it(e===null||typeof e=="string",2055,{h:e}),new yn(e)}},BD=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=yn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},$D=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new BD(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(yn.FIRST_PARTY))}shutdown(){}invalidateToken(){}},W_=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},HD=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Tr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){it(this.o===void 0,3512);let r=s=>{s.error!=null&&re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,re("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new W_(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(it(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new W_(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function KQ(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}function eU(){return new TextEncoder}var Fp=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=KQ(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function Ne(n,e){return n<e?-1:n>e?1:0}function qD(n,e){let t=0;for(;t<n.length&&t<e.length;){let r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return Ne(r,i);{let s=eU(),o=QQ(s.encode(cL(n,t)),s.encode(cL(e,t)));return o!==0?o:Ne(r,i)}}t+=r>65535?2:1}return Ne(n.length,e.length)}function cL(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function QQ(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Ne(n[t],e[t]);return Ne(n.length,e.length)}function md(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var lL="__name__",K_=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&fe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&fe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Ne(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):qD(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vs.fromString(e.substring(4,e.length-2))}},_t=class n extends K_{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new te(q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},YQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/,pr=class n extends K_{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return YQ.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===lL}static keyField(){return new n([lL])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new te(q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new te(q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new te(q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new te(q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var ue=class n{constructor(e){this.path=e}static fromPath(e){return new n(_t.fromString(e))}static fromName(e){return new n(_t.fromString(e).popFirst(5))}static empty(){return new n(_t.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&_t.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return _t.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new _t(e.slice()))}};function tU(n,e,t){if(!t)throw new te(q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function JQ(n,e,t,r){if(e===!0&&r===!0)throw new te(q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function uL(n){if(!ue.isDocumentKey(n))throw new te(q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function dL(n){if(ue.isDocumentKey(n))throw new te(q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function nU(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function D0(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":fe(12329,{type:typeof n})}function Bi(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new te(q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=D0(n);throw new te(q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function Gt(n,e){let t={typeString:n};return e&&(t.value=e),t}function Kp(n,e){if(!nU(n))throw new te(q.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new te(q.INVALID_ARGUMENT,t);return!0}var hL=-62135596800,fL=1e6,Wt=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*fL);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new te(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new te(q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<hL)throw new te(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/fL}_compareTo(e){return this.seconds===e.seconds?Ne(this.nanoseconds,e.nanoseconds):Ne(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Kp(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-hL;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Wt._jsonSchemaVersion="firestore/timestamp/1.0",Wt._jsonSchema={type:Gt("string",Wt._jsonSchemaVersion),seconds:Gt("number"),nanoseconds:Gt("number")};var Ae=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new Wt(0,0))}static max(){return new n(new Wt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Vp=-1,zD=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};zD.UNKNOWN_ID=-1;function XQ(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Ae.fromTimestamp(r===1e9?new Wt(t+1,0):new Wt(t,r));return new Xc(i,ue.empty(),e)}function ZQ(n){return new Xc(n.readTime,n.key,Vp)}var Xc=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(Ae.min(),ue.empty(),Vp)}static max(){return new n(Ae.max(),ue.empty(),Vp)}};function eY(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ue.comparator(n.documentKey,e.documentKey),t!==0?t:Ne(n.largestBatchId,e.largestBatchId))}var tY="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",GD=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function xd(n){if(n.code!==q.FAILED_PRECONDITION||n.message!==tY)throw n;re("LocalStore","Unexpectedly lost primary lease")}var W=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&fe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let d=c;t(e[d]).next(h=>{o[d]=h,++a,a===s&&r(o)},h=>i(h))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function nY(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Rd(n){return n.name==="IndexedDbTransactionError"}var Tx=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this._e(i),this.ae=i=>r.writeSequenceNumber(i))}_e(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.ae&&this.ae(t),t}}n.ue=-1;return n})(),Sx=-1;function A0(n){return n==null}function Lp(n){return n===0&&1/n==-1/0}function rY(n){return typeof n=="number"&&Number.isInteger(n)&&!Lp(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var rU="";function iY(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=pL(e)),e=sY(n.get(t),e);return pL(e)}function sY(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case rU:t+="";break;default:t+=s}}return t}function pL(n){return n+rU+""}var oY="remoteDocuments",iU="owner";var sU="mutationQueues";var oU="mutations";var aU="documentMutations",aY="remoteDocumentsV14";var cU="remoteDocumentGlobal";var lU="targets";var uU="targetDocuments";var dU="targetGlobal",hU="collectionParents";var fU="clientMetadata";var pU="bundles";var gU="namedQueries";var cY="indexConfiguration";var lY="indexState";var uY="indexEntries";var mU="documentOverlays";var dY="globals";var hY=[sU,oU,aU,oY,lU,iU,dU,uU,fU,cU,hU,pU,gU],K_e=[...hY,mU],fY=[sU,oU,aU,aY,lU,iU,dU,uU,fU,cU,hU,pU,gU,mU],pY=fY,gY=[...pY,cY,lY,uY];var Q_e=[...gY,dY];function gL(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ga(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function yU(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Tt=class n{constructor(e,t){this.comparator=e,this.root=t||$i.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,$i.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$i.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new fd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new fd(this.root,e,this.comparator,!1)}getReverseIterator(){return new fd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new fd(this.root,e,this.comparator,!0)}},fd=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},$i=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw fe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw fe(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw fe(27949);return e+(this.isRed()?0:1)}};$i.EMPTY=null,$i.RED=!0,$i.BLACK=!1;$i.EMPTY=new class{constructor(){this.size=0}get key(){throw fe(57766)}get value(){throw fe(16141)}get color(){throw fe(16727)}get left(){throw fe(29726)}get right(){throw fe(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new $i(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var vn=class n{constructor(e){this.comparator=e,this.data=new Tt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Q_(this.data.getIterator())}getIteratorFrom(e){return new Q_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},Q_=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Rr=class n{constructor(e){this.fields=e,e.sort(pr.comparator)}static empty(){return new n([])}unionWith(e){let t=new vn(pr.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return md(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Y_=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var On=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Y_("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ne(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};On.EMPTY_BYTE_STRING=new On("");var mY=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(n){if(it(!!n,39018),typeof n=="string"){let e=0,t=mY.exec(n);if(it(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:vt(n.seconds),nanos:vt(n.nanos)}}function vt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function $s(n){return typeof n=="string"?On.fromBase64String(n):On.fromUint8Array(n)}var vU="server_timestamp",_U="__type__",wU="__previous_value__",IU="__local_write_time__";function Dx(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[_U])===null||t===void 0?void 0:t.stringValue)===vU}function x0(n){let e=n.mapValue.fields[wU];return Dx(e)?x0(e):e}function Up(n){let e=Bs(n.mapValue.fields[IU].timestampValue);return new Wt(e.seconds,e.nanos)}var WD=class{constructor(e,t,r,i,s,o,a,c,d,h){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=d,this.isUsingEmulator=h}},J_="(default)",X_=class n{constructor(e,t){this.projectId=e,this.database=t||J_}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===J_}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var Ax="__type__",EU="__max__",j_={mapValue:{fields:{__type__:{stringValue:EU}}}},xx="__vector__",yd="value";function ua(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Dx(n)?4:CU(n)?9007199254740991:bU(n)?10:11:fe(28295,{value:n})}function zi(n,e){if(n===e)return!0;let t=ua(n);if(t!==ua(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Up(n).isEqual(Up(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Bs(i.timestampValue),a=Bs(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return $s(i.bytesValue).isEqual($s(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return vt(i.geoPointValue.latitude)===vt(s.geoPointValue.latitude)&&vt(i.geoPointValue.longitude)===vt(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return vt(i.integerValue)===vt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=vt(i.doubleValue),a=vt(s.doubleValue);return o===a?Lp(o)===Lp(a):isNaN(o)&&isNaN(a)}return!1})(n,e);case 9:return md(n.arrayValue.values||[],e.arrayValue.values||[],zi);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(gL(o)!==gL(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!zi(o[c],a[c])))return!1;return!0})(n,e);default:return fe(52216,{left:n})}}function jp(n,e){return(n.values||[]).find(t=>zi(t,e))!==void 0}function vd(n,e){if(n===e)return 0;let t=ua(n),r=ua(e);if(t!==r)return Ne(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Ne(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let a=vt(s.integerValue||s.doubleValue),c=vt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,e);case 3:return mL(n.timestampValue,e.timestampValue);case 4:return mL(Up(n),Up(e));case 5:return qD(n.stringValue,e.stringValue);case 6:return(function(s,o){let a=$s(s),c=$s(o);return a.compareTo(c)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let a=s.split("/"),c=o.split("/");for(let d=0;d<a.length&&d<c.length;d++){let h=Ne(a[d],c[d]);if(h!==0)return h}return Ne(a.length,c.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let a=Ne(vt(s.latitude),vt(o.latitude));return a!==0?a:Ne(vt(s.longitude),vt(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return yL(n.arrayValue,e.arrayValue);case 10:return(function(s,o){var a,c,d,h;let p=s.fields||{},y=o.fields||{},E=(a=p[yd])===null||a===void 0?void 0:a.arrayValue,k=(c=y[yd])===null||c===void 0?void 0:c.arrayValue,P=Ne(((d=E?.values)===null||d===void 0?void 0:d.length)||0,((h=k?.values)===null||h===void 0?void 0:h.length)||0);return P!==0?P:yL(E,k)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===j_.mapValue&&o===j_.mapValue)return 0;if(s===j_.mapValue)return 1;if(o===j_.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),d=o.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){let y=qD(c[p],h[p]);if(y!==0)return y;let E=vd(a[c[p]],d[h[p]]);if(E!==0)return E}return Ne(c.length,h.length)})(n.mapValue,e.mapValue);default:throw fe(23264,{le:t})}}function mL(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Ne(n,e);let t=Bs(n),r=Bs(e),i=Ne(t.seconds,r.seconds);return i!==0?i:Ne(t.nanos,r.nanos)}function yL(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=vd(t[i],r[i]);if(s)return s}return Ne(t.length,r.length)}function _d(n){return KD(n)}function KD(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=Bs(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return $s(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ue.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=KD(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${KD(t.fields[o])}`;return i+"}"})(n.mapValue):fe(61005,{value:n})}function H_(n){switch(ua(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=x0(n);return e?16+H_(e):16;case 5:return 2*n.stringValue.length;case 6:return $s(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce((i,s)=>i+H_(s),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return ga(r.fields,(s,o)=>{i+=s.length+H_(o)}),i})(n.mapValue);default:throw fe(13486,{value:n})}}function vL(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function QD(n){return!!n&&"integerValue"in n}function Rx(n){return!!n&&"arrayValue"in n}function _L(n){return!!n&&"nullValue"in n}function wL(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function q_(n){return!!n&&"mapValue"in n}function bU(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{})[Ax])===null||t===void 0?void 0:t.stringValue)===xx}function Np(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return ga(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Np(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Np(n.arrayValue.values[t]);return e}return Object.assign({},n)}function CU(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===EU}var J_e={mapValue:{fields:{[Ax]:{stringValue:xx},[yd]:{arrayValue:{}}}}};var fr=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!q_(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Np(t)}setAll(e){let t=pr.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Np(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());q_(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return zi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];q_(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){ga(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(Np(this.value))}};function TU(n){let e=[];return ga(n.fields,(t,r)=>{let i=new pr([t]);if(q_(r)){let s=TU(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Rr(e)}var ri=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,Ae.min(),Ae.min(),Ae.min(),fr.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,Ae.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,Ae.min(),Ae.min(),fr.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,Ae.min(),Ae.min(),fr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ae.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ae.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var wd=class{constructor(e,t){this.position=e,this.inclusive=t}};function IL(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=ue.comparator(ue.fromName(o.referenceValue),t.key):r=vd(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function EL(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!zi(n.position[t],e.position[t]))return!1;return!0}var Zc=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function yY(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Z_=class{},zt=class n extends Z_{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new JD(e,t,r):t==="array-contains"?new eA(e,r):t==="in"?new tA(e,r):t==="not-in"?new nA(e,r):t==="array-contains-any"?new rA(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new XD(e,r):new ZD(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(vd(t,this.value)):t!==null&&ua(this.value)===ua(t)&&this.matchesComparison(vd(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},ii=class n extends Z_{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new n(e,t)}matches(e){return SU(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}};function SU(n){return n.op==="and"}function DU(n){return vY(n)&&SU(n)}function vY(n){for(let e of n.filters)if(e instanceof ii)return!1;return!0}function YD(n){if(n instanceof zt)return n.field.canonicalString()+n.op.toString()+_d(n.value);if(DU(n))return n.filters.map(e=>YD(e)).join(",");{let e=n.filters.map(t=>YD(t)).join(",");return`${n.op}(${e})`}}function AU(n,e){return n instanceof zt?(function(r,i){return i instanceof zt&&r.op===i.op&&r.field.isEqual(i.field)&&zi(r.value,i.value)})(n,e):n instanceof ii?(function(r,i){return i instanceof ii&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&AU(o,i.filters[a]),!0):!1})(n,e):void fe(19439)}function xU(n){return n instanceof zt?(function(t){return`${t.field.canonicalString()} ${t.op} ${_d(t.value)}`})(n):n instanceof ii?(function(t){return t.op.toString()+" {"+t.getFilters().map(xU).join(" ,")+"}"})(n):"Filter"}var JD=class extends zt{constructor(e,t,r){super(e,t,r),this.key=ue.fromName(r.referenceValue)}matches(e){let t=ue.comparator(e.key,this.key);return this.matchesComparison(t)}},XD=class extends zt{constructor(e,t){super(e,"in",t),this.keys=RU("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},ZD=class extends zt{constructor(e,t){super(e,"not-in",t),this.keys=RU("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function RU(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>ue.fromName(r.referenceValue))}var eA=class extends zt{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Rx(t)&&jp(t.arrayValue,this.value)}},tA=class extends zt{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&jp(this.value.arrayValue,t)}},nA=class extends zt{constructor(e,t){super(e,"not-in",t)}matches(e){if(jp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!jp(this.value.arrayValue,t)}},rA=class extends zt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Rx(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>jp(this.value.arrayValue,r))}};var iA=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.Pe=null}};function bL(n,e=null,t=[],r=[],i=null,s=null,o=null){return new iA(n,e,t,r,i,s,o)}function kx(n){let e=be(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>YD(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>(function(s){return s.field.canonicalString()+s.dir})(r)).join(","),A0(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>_d(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>_d(r)).join(",")),e.Pe=t}return e.Pe}function Nx(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yY(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!AU(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!EL(n.startAt,e.startAt)&&EL(n.endAt,e.endAt)}function sA(n){return ue.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var da=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}};function _Y(n,e,t,r,i,s,o,a){return new da(n,e,t,r,i,s,o,a)}function Mx(n){return new da(n)}function CL(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function kU(n){return n.collectionGroup!==null}function Mp(n){let e=be(n);if(e.Te===null){e.Te=[];let t=new Set;for(let s of e.explicitOrderBy)e.Te.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new vn(pr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(a=a.add(d.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Te.push(new Zc(s,r))}),t.has(pr.keyField().canonicalString())||e.Te.push(new Zc(pr.keyField(),r))}return e.Te}function Hi(n){let e=be(n);return e.Ie||(e.Ie=wY(e,Mp(n))),e.Ie}function wY(n,e){if(n.limitType==="F")return bL(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Zc(i.field,s)});let t=n.endAt?new wd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new wd(n.startAt.position,n.startAt.inclusive):null;return bL(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function oA(n,e){let t=n.filters.concat([e]);return new da(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function aA(n,e,t){return new da(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function R0(n,e){return Nx(Hi(n),Hi(e))&&n.limitType===e.limitType}function NU(n){return`${kx(Hi(n))}|lt:${n.limitType}`}function ud(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>xU(i)).join(", ")}]`),A0(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>_d(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>_d(i)).join(",")),`Target(${r})`})(Hi(n))}; limitType=${n.limitType})`}function k0(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ue.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of Mp(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,a,c){let d=IL(o,a,c);return o.inclusive?d<=0:d<0})(r.startAt,Mp(r),i)||r.endAt&&!(function(o,a,c){let d=IL(o,a,c);return o.inclusive?d>=0:d>0})(r.endAt,Mp(r),i))})(n,e)}function IY(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function MU(n){return(e,t)=>{let r=!1;for(let i of Mp(n)){let s=EY(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function EY(n,e,t){let r=n.field.isKeyField()?ue.comparator(e.key,t.key):(function(s,o,a){let c=o.data.field(s),d=a.data.field(s);return c!==null&&d!==null?vd(c,d):fe(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return fe(19790,{direction:n.dir})}}var Hs=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ga(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return yU(this.inner)}size(){return this.innerSize}};var bY=new Tt(ue.comparator);function qs(){return bY}var PU=new Tt(ue.comparator);function kp(...n){let e=PU;for(let t of n)e=e.insert(t.key,t);return e}function OU(n){let e=PU;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Gc(){return Pp()}function FU(){return Pp()}function Pp(){return new Hs(n=>n.toString(),(n,e)=>n.isEqual(e))}var CY=new Tt(ue.comparator),TY=new vn(ue.comparator);function Ue(...n){let e=TY;for(let t of n)e=e.add(t);return e}var SY=new vn(Ne);function DY(){return SY}function Px(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Lp(e)?"-0":e}}function VU(n){return{integerValue:""+n}}function AY(n,e){return rY(e)?VU(e):Px(n,e)}var Id=class{constructor(){this._=void 0}};function xY(n,e,t){return n instanceof el?(function(i,s){let o={fields:{[_U]:{stringValue:vU},[IU]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Dx(s)&&(s=x0(s)),s&&(o.fields[wU]=s),{mapValue:o}})(t,e):n instanceof tl?UU(n,e):n instanceof nl?jU(n,e):(function(i,s){let o=LU(i,s),a=TL(o)+TL(i.Ee);return QD(o)&&QD(i.Ee)?VU(a):Px(i.serializer,a)})(n,e)}function RY(n,e,t){return n instanceof tl?UU(n,e):n instanceof nl?jU(n,e):t}function LU(n,e){return n instanceof Ed?(function(r){return QD(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var el=class extends Id{},tl=class extends Id{constructor(e){super(),this.elements=e}};function UU(n,e){let t=BU(e);for(let r of n.elements)t.some(i=>zi(i,r))||t.push(r);return{arrayValue:{values:t}}}var nl=class extends Id{constructor(e){super(),this.elements=e}};function jU(n,e){let t=BU(e);for(let r of n.elements)t=t.filter(i=>!zi(i,r));return{arrayValue:{values:t}}}var Ed=class extends Id{constructor(e,t){super(),this.serializer=e,this.Ee=t}};function TL(n){return vt(n.integerValue||n.doubleValue)}function BU(n){return Rx(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var cA=class{constructor(e,t){this.field=e,this.transform=t}};function kY(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof tl&&i instanceof tl||r instanceof nl&&i instanceof nl?md(r.elements,i.elements,zi):r instanceof Ed&&i instanceof Ed?zi(r.Ee,i.Ee):r instanceof el&&i instanceof el})(n.transform,e.transform)}var lA=class{constructor(e,t){this.version=e,this.transformResults=t}},Us=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function z_(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var bd=class{};function $U(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Bp(n.key,Us.none()):new rl(n.key,n.data,Us.none());{let t=n.data,r=fr.empty(),i=new vn(pr.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Gi(n.key,r,new Rr(i.toArray()),Us.none())}}function NY(n,e,t){n instanceof rl?(function(i,s,o){let a=i.value.clone(),c=DL(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,e,t):n instanceof Gi?(function(i,s,o){if(!z_(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=DL(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(HU(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Op(n,e,t,r){return n instanceof rl?(function(s,o,a,c){if(!z_(s.precondition,o))return a;let d=s.value.clone(),h=AL(s.fieldTransforms,c,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null})(n,e,t,r):n instanceof Gi?(function(s,o,a,c){if(!z_(s.precondition,o))return a;let d=AL(s.fieldTransforms,c,o),h=o.data;return h.setAll(HU(s)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))})(n,e,t,r):(function(s,o,a){return z_(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,e,t)}function MY(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=LU(r.transform,i||null);s!=null&&(t===null&&(t=fr.empty()),t.set(r.field,s))}return t||null}function SL(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&md(r,i,(s,o)=>kY(s,o))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var rl=class extends bd{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Gi=class extends bd{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function HU(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function DL(n,e,t){let r=new Map;it(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,RY(o,a,t[i]))}return r}function AL(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,xY(s,o,e))}return r}var Bp=class extends bd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},uA=class extends bd{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var dA=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&NY(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Op(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Op(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=FU();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=$U(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(Ae.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ue())}isEqual(e){return this.batchId===e.batchId&&md(this.mutations,e.mutations,(t,r)=>SL(t,r))&&md(this.baseMutations,e.baseMutations,(t,r)=>SL(t,r))}},hA=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){it(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let i=(function(){return CY})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var fA=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var pA=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Ht,qe;function PY(n){switch(n){case q.OK:return fe(64938);case q.CANCELLED:case q.UNKNOWN:case q.DEADLINE_EXCEEDED:case q.RESOURCE_EXHAUSTED:case q.INTERNAL:case q.UNAVAILABLE:case q.UNAUTHENTICATED:return!1;case q.INVALID_ARGUMENT:case q.NOT_FOUND:case q.ALREADY_EXISTS:case q.PERMISSION_DENIED:case q.FAILED_PRECONDITION:case q.ABORTED:case q.OUT_OF_RANGE:case q.UNIMPLEMENTED:case q.DATA_LOSS:return!0;default:return fe(15467,{code:n})}}function qU(n){if(n===void 0)return js("GRPC error has no .code"),q.UNKNOWN;switch(n){case Ht.OK:return q.OK;case Ht.CANCELLED:return q.CANCELLED;case Ht.UNKNOWN:return q.UNKNOWN;case Ht.DEADLINE_EXCEEDED:return q.DEADLINE_EXCEEDED;case Ht.RESOURCE_EXHAUSTED:return q.RESOURCE_EXHAUSTED;case Ht.INTERNAL:return q.INTERNAL;case Ht.UNAVAILABLE:return q.UNAVAILABLE;case Ht.UNAUTHENTICATED:return q.UNAUTHENTICATED;case Ht.INVALID_ARGUMENT:return q.INVALID_ARGUMENT;case Ht.NOT_FOUND:return q.NOT_FOUND;case Ht.ALREADY_EXISTS:return q.ALREADY_EXISTS;case Ht.PERMISSION_DENIED:return q.PERMISSION_DENIED;case Ht.FAILED_PRECONDITION:return q.FAILED_PRECONDITION;case Ht.ABORTED:return q.ABORTED;case Ht.OUT_OF_RANGE:return q.OUT_OF_RANGE;case Ht.UNIMPLEMENTED:return q.UNIMPLEMENTED;case Ht.DATA_LOSS:return q.DATA_LOSS;default:return fe(39323,{code:n})}}(qe=Ht||(Ht={}))[qe.OK=0]="OK",qe[qe.CANCELLED=1]="CANCELLED",qe[qe.UNKNOWN=2]="UNKNOWN",qe[qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",qe[qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",qe[qe.NOT_FOUND=5]="NOT_FOUND",qe[qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",qe[qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",qe[qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",qe[qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",qe[qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",qe[qe.ABORTED=10]="ABORTED",qe[qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",qe[qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",qe[qe.INTERNAL=13]="INTERNAL",qe[qe.UNAVAILABLE=14]="UNAVAILABLE",qe[qe.DATA_LOSS=15]="DATA_LOSS";var xL=null;var OY=new Vs([4294967295,4294967295],0);function RL(n){let e=eU().encode(n),t=new AD;return t.update(e),new Uint8Array(t.digest())}function kL(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Vs([t,r],0),new Vs([i,s],0)]}var gA=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Wc(`Invalid padding: ${t}`);if(r<0)throw new Wc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Wc(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Wc(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=Vs.fromNumber(this.fe)}pe(e,t,r){let i=e.add(t.multiply(Vs.fromNumber(r)));return i.compare(OY)===1&&(i=new Vs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;let t=RL(e),[r,i]=kL(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);if(!this.ye(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.fe===0)return;let t=RL(e),[r,i]=kL(t);for(let s=0;s<this.hashCount;s++){let o=this.pe(r,i,s);this.we(o)}}we(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Wc=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var e0=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,$p.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(Ae.min(),i,new Tt(Ne),qs(),Ue())}},$p=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Ue(),Ue(),Ue())}};var pd=class{constructor(e,t,r,i){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=i}},t0=class{constructor(e,t){this.targetId=e,this.De=t}},n0=class{constructor(e,t,r=On.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},r0=class{constructor(){this.ve=0,this.Ce=NL(),this.Fe=On.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ue(),t=Ue(),r=Ue();return this.Ce.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:fe(38017,{changeType:s})}}),new $p(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=NL()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,it(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}},mA=class{constructor(e){this.We=e,this.Ge=new Map,this.ze=qs(),this.je=B_(),this.Je=B_(),this.He=new Tt(Ne)}Ye(e){for(let t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(let t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,t=>{let r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:fe(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach((r,i)=>{this.nt(i)&&t(i)})}it(e){let t=e.targetId,r=e.De.count,i=this.st(t);if(i){let s=i.target;if(sA(s))if(r===0){let o=new ue(s.path);this.Xe(t,o,ri.newNoDocument(o,Ae.min()))}else it(r===1,20013,{expectedCount:r});else{let o=this.ot(t);if(o!==r){let a=this._t(e),c=a?this.ut(a,e,o):1;if(c!==0){this.rt(t);let d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,d)}xL?.ct((function(h,p,y,E,k){var P,M,$,Y,ee,Ce;let Je={localCacheCount:h,existenceFilterCount:p.count,databaseId:y.database,projectId:y.projectId},pe=p.unchangedNames;return pe&&(Je.bloomFilter={applied:k===0,hashCount:(P=pe?.hashCount)!==null&&P!==void 0?P:0,bitmapLength:(Y=($=(M=pe?.bits)===null||M===void 0?void 0:M.bitmap)===null||$===void 0?void 0:$.length)!==null&&Y!==void 0?Y:0,padding:(Ce=(ee=pe?.bits)===null||ee===void 0?void 0:ee.padding)!==null&&Ce!==void 0?Ce:0,mightContain:T=>{var _;return(_=E?.mightContain(T))!==null&&_!==void 0&&_}}),Je})(o,e.De,this.We.lt(),a,c))}}}}_t(e){let t=e.De.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,a;try{o=$s(r).toUint8Array()}catch(c){if(c instanceof Y_)return la("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new gA(o,i,s)}catch(c){return la(c instanceof Wc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.fe===0?null:a}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){let r=this.We.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let o=this.We.lt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Xe(t,s,null),i++)}),i}Pt(e){let t=new Map;this.Ge.forEach((s,o)=>{let a=this.st(o);if(a){if(s.current&&sA(a.target)){let c=new ue(a.target.path);this.Tt(c).has(o)||this.It(o,c)||this.Xe(o,c,ri.newNoDocument(c,e))}s.Ne&&(t.set(o,s.Le()),s.ke())}});let r=Ue();this.Je.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let d=this.st(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ze.forEach((s,o)=>o.setReadTime(e));let i=new e0(e,t,this.He,this.ze,r);return this.ze=qs(),this.je=B_(),this.Je=B_(),this.He=new Tt(Ne),i}Ze(e,t){if(!this.nt(e))return;let r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;let i=this.tt(e);this.It(e,t)?i.qe(t,1):i.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){let t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new r0,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new vn(Ne),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new vn(Ne),this.je=this.je.insert(e,t)),t}nt(e){let t=this.st(e)!==null;return t||re("WatchChangeAggregator","Detected inactive target",e),t}st(e){let t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new r0),this.We.getRemoteKeysForTarget(e).forEach(t=>{this.Xe(e,t,null)})}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}};function B_(){return new Tt(ue.comparator)}function NL(){return new Tt(ue.comparator)}var FY={asc:"ASCENDING",desc:"DESCENDING"},VY={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LY={and:"AND",or:"OR"},yA=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function vA(n,e){return n.useProto3Json||A0(e)?e:{value:e}}function i0(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function zU(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function UY(n,e){return i0(n,e.toTimestamp())}function qi(n){return it(!!n,49232),Ae.fromTimestamp((function(t){let r=Bs(t);return new Wt(r.seconds,r.nanos)})(n))}function Ox(n,e){return _A(n,e).canonicalString()}function _A(n,e){let t=(function(i){return new _t(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function GU(n){let e=_t.fromString(n);return it(JU(e),10190,{key:e.toString()}),e}function wA(n,e){return Ox(n.databaseId,e.path)}function PD(n,e){let t=GU(e);if(t.get(1)!==n.databaseId.projectId)throw new te(q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new te(q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ue(KU(t))}function WU(n,e){return Ox(n.databaseId,e)}function jY(n){let e=GU(n);return e.length===4?_t.emptyPath():KU(e)}function IA(n){return new _t(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function KU(n){return it(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ML(n,e,t){return{name:wA(n,e),fields:t.value.mapValue.fields}}function BY(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:fe(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(d,h){return d.useProto3Json?(it(h===void 0||typeof h=="string",58123),On.fromBase64String(h||"")):(it(h===void 0||h instanceof Buffer||h instanceof Uint8Array,16193),On.fromUint8Array(h||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&(function(d){let h=d.code===void 0?q.UNKNOWN:qU(d.code);return new te(h,d.message||"")})(o);t=new n0(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=PD(n,r.document.name),s=qi(r.document.updateTime),o=r.document.createTime?qi(r.document.createTime):Ae.min(),a=new fr({mapValue:{fields:r.document.fields}}),c=ri.newFoundDocument(i,s,o,a),d=r.targetIds||[],h=r.removedTargetIds||[];t=new pd(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=PD(n,r.document),s=r.readTime?qi(r.readTime):Ae.min(),o=ri.newNoDocument(i,s),a=r.removedTargetIds||[];t=new pd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=PD(n,r.document),s=r.removedTargetIds||[];t=new pd([],s,i,null)}else{if(!("filter"in e))return fe(11601,{At:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new pA(i,s),a=r.targetId;t=new t0(a,o)}}return t}function $Y(n,e){let t;if(e instanceof rl)t={update:ML(n,e.key,e.value)};else if(e instanceof Bp)t={delete:wA(n,e.key)};else if(e instanceof Gi)t={update:ML(n,e.key,e.data),updateMask:JY(e.fieldMask)};else{if(!(e instanceof uA))return fe(16599,{Rt:e.type});t={verify:wA(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>(function(s,o){let a=o.transform;if(a instanceof el)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof tl)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof nl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Ed)return{fieldPath:o.field.canonicalString(),increment:a.Ee};throw fe(20930,{transform:o.transform})})(0,r))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:UY(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:fe(27497)})(n,e.precondition)),t}function HY(n,e){return n&&n.length>0?(it(e!==void 0,14353),n.map(t=>(function(i,s){let o=i.updateTime?qi(i.updateTime):qi(s);return o.isEqual(Ae.min())&&(o=qi(s)),new lA(o,i.transformResults||[])})(t,e))):[]}function qY(n,e){return{documents:[WU(n,e.path)]}}function zY(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=WU(n,i);let s=(function(d){if(d.length!==0)return YU(ii.create(d,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(d){if(d.length!==0)return d.map(h=>(function(y){return{field:dd(y.field),direction:KY(y.dir)}})(h))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let a=vA(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{Vt:t,parent:i}}function GY(n){let e=jY(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){it(r===1,65062);let h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];t.where&&(s=(function(p){let y=QU(p);return y instanceof ii&&DU(y)?y.getFilters():[y]})(t.where));let o=[];t.orderBy&&(o=(function(p){return p.map(y=>(function(k){return new Zc(hd(k.field),(function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(y))})(t.orderBy));let a=null;t.limit&&(a=(function(p){let y;return y=typeof p=="object"?p.value:p,A0(y)?null:y})(t.limit));let c=null;t.startAt&&(c=(function(p){let y=!!p.before,E=p.values||[];return new wd(E,y)})(t.startAt));let d=null;return t.endAt&&(d=(function(p){let y=!p.before,E=p.values||[];return new wd(E,y)})(t.endAt)),_Y(e,i,o,s,a,"F",c,d)}function WY(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function QU(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=hd(t.unaryFilter.field);return zt.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=hd(t.unaryFilter.field);return zt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=hd(t.unaryFilter.field);return zt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=hd(t.unaryFilter.field);return zt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return fe(61313);default:return fe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return zt.create(hd(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return fe(58110);default:return fe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return ii.create(t.compositeFilter.filters.map(r=>QU(r)),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return fe(1026)}})(t.compositeFilter.op))})(n):fe(30097,{filter:n})}function KY(n){return FY[n]}function QY(n){return VY[n]}function YY(n){return LY[n]}function dd(n){return{fieldPath:n.canonicalString()}}function hd(n){return pr.fromServerFormat(n.fieldPath)}function YU(n){return n instanceof zt?(function(t){if(t.op==="=="){if(wL(t.value))return{unaryFilter:{field:dd(t.field),op:"IS_NAN"}};if(_L(t.value))return{unaryFilter:{field:dd(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(wL(t.value))return{unaryFilter:{field:dd(t.field),op:"IS_NOT_NAN"}};if(_L(t.value))return{unaryFilter:{field:dd(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dd(t.field),op:QY(t.op),value:t.value}}})(n):n instanceof ii?(function(t){let r=t.getFilters().map(i=>YU(i));return r.length===1?r[0]:{compositeFilter:{op:YY(t.op),filters:r}}})(n):fe(54877,{filter:n})}function JY(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function JU(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Hp=class n{constructor(e,t,r,i,s=Ae.min(),o=Ae.min(),a=On.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var EA=class{constructor(e){this.gt=e}};function XY(n){let e=GY({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?aA(e,e.limit,"L"):e}var s0=class{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(vt(e.integerValue));else if("doubleValue"in e){let r=vt(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),Lp(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=Bs(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt($s(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?CU(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):bU(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):fe(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){let r=e.fields||{};this.Ct(t,55);for(let i of Object.keys(r))this.xt(i,t),this.Dt(r[i],t)}Lt(e,t){var r,i;let s=e.fields||{};this.Ct(t,53);let o=yd,a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Ct(t,15),t.Ft(vt(a)),this.xt(o,t),this.Dt(s[o],t)}qt(e,t){let r=e.values||[];this.Ct(t,50);for(let i of r)this.Dt(i,t)}Bt(e,t){this.Ct(t,37),ue.fromName(e).path.forEach(r=>{this.Ct(t,60),this.$t(r,t)})}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}};s0.Ut=new s0;var bA=class{constructor(){this.Dn=new CA}addToCollectionParentIndex(e,t){return this.Dn.add(t),W.resolve()}getCollectionParents(e,t){return W.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return W.resolve()}deleteFieldIndex(e,t){return W.resolve()}deleteAllFieldIndexes(e){return W.resolve()}createTargetIndexes(e,t){return W.resolve()}getDocumentsMatchingTarget(e,t){return W.resolve(null)}getIndexType(e,t){return W.resolve(0)}getFieldIndexes(e,t){return W.resolve([])}getNextCollectionGroupToUpdate(e){return W.resolve(null)}getMinOffset(e,t){return W.resolve(Xc.min())}getMinOffsetFromCollectionGroup(e,t){return W.resolve(Xc.min())}updateCollectionGroup(e,t,r){return W.resolve()}updateIndexEntries(e,t){return W.resolve()}},CA=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new vn(_t.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new vn(_t.comparator)).toArray()}};var X_e=new Uint8Array(0);var PL={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},XU=41943040,xr=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};xr.DEFAULT_COLLECTION_PERCENTILE=10,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,xr.DEFAULT=new xr(XU,xr.DEFAULT_COLLECTION_PERCENTILE,xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),xr.DISABLED=new xr(-1,0,0);var qp=class n{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new n(0)}static ur(){return new n(-1)}};var OL="LruGarbageCollector",ZY=1048576;function FL([n,e],[t,r]){let i=Ne(n,t);return i===0?Ne(e,r):i}var TA=class{constructor(e){this.Tr=e,this.buffer=new vn(FL),this.Ir=0}dr(){return++this.Ir}Er(e){let t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();FL(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},SA=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){re(OL,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){Rd(t)?re(OL,"Ignoring IndexedDB error during garbage collection: ",t):await xd(t)}await this.Rr(3e5)})}},DA=class{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return W.resolve(Tx.ue);let r=new TA(t);return this.Vr.forEachTarget(e,i=>r.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>r.Er(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(re("LruGarbageCollector","Garbage collection skipped; disabled"),W.resolve(PL)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(re("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),PL):this.pr(e,t))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,i,s,o,a,c,d,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),ld()<=Fe.DEBUG&&re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${p} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),W.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}};function eJ(n,e){return new DA(n,e)}var AA=class{constructor(){this.changes=new Hs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ri.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?W.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var xA=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var RA=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Op(r.mutation,i,Rr.empty(),Wt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ue()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ue()){let i=Gc();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=kp();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=Gc();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ue()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=qs(),o=Pp(),a=(function(){return Pp()})();return t.forEach((c,d)=>{let h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof Gi)?s=s.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),Op(h.mutation,d,h.mutation.getFieldMask(),Wt.now())):o.set(d.key,Rr.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,h)=>o.set(d,h)),t.forEach((d,h)=>{var p;return a.set(d,new xA(h,(p=o.get(d))!==null&&p!==void 0?p:null))}),a))}recalculateAndSaveOverlays(e,t){let r=Pp(),i=new Tt((o,a)=>o-a),s=Ue();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let d=t.get(c);if(d===null)return;let h=r.get(c)||Rr.empty();h=a.applyToLocalView(d,h),r.set(c,h);let p=(i.get(a.batchId)||Ue()).add(c);i=i.insert(a.batchId,p)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),d=c.key,h=c.value,p=FU();h.forEach(y=>{if(!s.has(y)){let E=$U(t.get(y),r.get(y));E!==null&&p.set(y,E),s=s.add(y)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return W.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return ue.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):kU(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):W.resolve(Gc()),a=Vp,c=s;return o.next(d=>W.forEach(d,(h,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(h)?W.resolve():this.remoteDocumentCache.getEntry(e,h).next(y=>{c=c.insert(h,y)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,Ue())).next(h=>({batchId:a,changes:OU(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ue(t)).next(r=>{let i=kp();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=kp();return this.indexManager.getCollectionParents(e,s).next(a=>W.forEach(a,c=>{let d=(function(p,y){return new da(y,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)})(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((p,y)=>{o=o.insert(p,y)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((c,d)=>{let h=d.getKey();o.get(h)===null&&(o=o.insert(h,ri.newInvalidDocument(h)))});let a=kp();return o.forEach((c,d)=>{let h=s.get(c);h!==void 0&&Op(h.mutation,d,Rr.empty(),Wt.now()),k0(t,d)&&(a=a.insert(c,d))}),a})}};var kA=class{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return W.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:qi(i.createTime)}})(t)),W.resolve()}getNamedQuery(e,t){return W.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(i){return{name:i.name,query:XY(i.bundledQuery),readTime:qi(i.readTime)}})(t)),W.resolve()}};var NA=class{constructor(){this.overlays=new Tt(ue.comparator),this.kr=new Map}getOverlay(e,t){return W.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Gc();return W.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.wt(e,t,s)}),W.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.kr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.kr.delete(r)),W.resolve()}getOverlaysForCollection(e,t,r){let i=Gc(),s=t.length+1,o=new ue(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return W.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Tt((d,h)=>d-h),o=this.overlays.getIterator();for(;o.hasNext();){let d=o.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let h=s.get(d.largestBatchId);h===null&&(h=Gc(),s=s.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}let a=Gc(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>a.set(d,h)),!(a.size()>=i)););return W.resolve(a)}wt(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.kr.get(i.largestBatchId).delete(r.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new fA(t,r));let s=this.kr.get(t);s===void 0&&(s=Ue(),this.kr.set(t,s)),this.kr.set(t,s.add(r.key))}};var MA=class{constructor(){this.sessionToken=On.EMPTY_BYTE_STRING}getSessionToken(e){return W.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,W.resolve()}};var zp=class{constructor(){this.qr=new vn(qt.Qr),this.$r=new vn(qt.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){let r=new qt(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Wr(new qt(e,t))}Gr(e,t){e.forEach(r=>this.removeReference(r,t))}zr(e){let t=new ue(new _t([])),r=new qt(t,e),i=new qt(t,e+1),s=[];return this.$r.forEachInRange([r,i],o=>{this.Wr(o),s.push(o.key)}),s}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){let t=new ue(new _t([])),r=new qt(t,e),i=new qt(t,e+1),s=Ue();return this.$r.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new qt(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},qt=class{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return ue.comparator(e.key,t.key)||Ne(e.Hr,t.Hr)}static Ur(e,t){return Ne(e.Hr,t.Hr)||ue.comparator(e.key,t.key)}};var PA=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new vn(qt.Qr)}checkEmpty(e){return W.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new dA(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.Yr=this.Yr.add(new qt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return W.resolve(o)}lookupMutationBatch(e,t){return W.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.Xr(r),s=i<0?0:i;return W.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return W.resolve(this.mutationQueue.length===0?Sx:this.er-1)}getAllMutationBatches(e){return W.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new qt(t,0),i=new qt(t,Number.POSITIVE_INFINITY),s=[];return this.Yr.forEachInRange([r,i],o=>{let a=this.Zr(o.Hr);s.push(a)}),W.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new vn(Ne);return t.forEach(i=>{let s=new qt(i,0),o=new qt(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([s,o],a=>{r=r.add(a.Hr)})}),W.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;ue.isDocumentKey(s)||(s=s.child(""));let o=new qt(new ue(s),0),a=new vn(Ne);return this.Yr.forEachWhile(c=>{let d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(a=a.add(c.Hr)),!0)},o),W.resolve(this.ei(a))}ei(e){let t=[];return e.forEach(r=>{let i=this.Zr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){it(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return W.forEach(t.mutations,i=>{let s=new qt(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,t){let r=new qt(t,0),i=this.Yr.firstAfterOrEqual(r);return W.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,W.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){let t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var OA=class{constructor(e){this.ni=e,this.docs=(function(){return new Tt(ue.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return W.resolve(r?r.document.mutableCopy():ri.newInvalidDocument(t))}getEntries(e,t){let r=qs();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ri.newInvalidDocument(i))}),W.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=qs(),o=t.path,a=new ue(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:d,value:{document:h}}=c.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||eY(ZQ(h),r)<=0||(i.has(h.key)||k0(t,h))&&(s=s.insert(h.key,h.mutableCopy()))}return W.resolve(s)}getAllFromCollectionGroup(e,t,r,i){fe(9500)}ri(e,t){return W.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new FA(this)}getSize(e){return W.resolve(this.size)}},FA=class extends AA{constructor(e){super(),this.Or=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Or.addEntry(e,i)):this.Or.removeEntry(r)}),W.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}};var VA=class{constructor(e){this.persistence=e,this.ii=new Hs(t=>kx(t),Nx),this.lastRemoteSnapshotVersion=Ae.min(),this.highestTargetId=0,this.si=0,this.oi=new zp,this.targetCount=0,this._i=qp.ar()}forEachTarget(e,t){return this.ii.forEach((r,i)=>t(i)),W.resolve()}getLastRemoteSnapshotVersion(e){return W.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return W.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),W.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),W.resolve()}hr(e){this.ii.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this._i=new qp(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,W.resolve()}updateTargetData(e,t){return this.hr(t),W.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,W.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.ii.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.ii.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),W.waitFor(s).next(()=>i)}getTargetCount(e){return W.resolve(this.targetCount)}getTargetData(e,t){let r=this.ii.get(t)||null;return W.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),W.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),W.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),W.resolve()}getMatchingKeysForTargetId(e,t){let r=this.oi.Jr(t);return W.resolve(r)}containsKey(e,t){return W.resolve(this.oi.containsKey(t))}};var o0=class{constructor(e,t){this.ai={},this.overlays={},this.ui=new Tx(0),this.ci=!1,this.ci=!0,this.li=new MA,this.referenceDelegate=e(this),this.hi=new VA(this),this.indexManager=new bA,this.remoteDocumentCache=(function(i){return new OA(i)})(r=>this.referenceDelegate.Pi(r)),this.serializer=new EA(t),this.Ti=new kA(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new NA,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new PA(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){re("MemoryPersistence","Starting transaction:",e);let i=new LA(this.ui.next());return this.referenceDelegate.Ii(),r(i).next(s=>this.referenceDelegate.di(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ei(e,t){return W.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,t)))}},LA=class extends GD{constructor(e){super(),this.currentSequenceNumber=e}},UA=class n{constructor(e){this.persistence=e,this.Ai=new zp,this.Ri=null}static Vi(e){return new n(e)}get mi(){if(this.Ri)return this.Ri;throw fe(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),W.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),W.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),W.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach(i=>this.mi.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.mi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Ii(){this.Ri=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return W.forEach(this.mi,r=>{let i=ue.fromPath(r);return this.fi(e,i).next(s=>{s||t.removeEntry(i,Ae.min())})}).next(()=>(this.Ri=null,t.apply(e)))}updateLimboDocument(e,t){return this.fi(e,t).next(r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())})}Pi(e){return 0}fi(e,t){return W.or([()=>W.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}},a0=class n{constructor(e,t){this.persistence=e,this.gi=new Hs(r=>iY(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=eJ(this,t)}static Vi(e,t){return new n(e,t)}Ii(){}di(e){return W.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){let t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}yr(e){let t=0;return this.gr(e,r=>{t++}).next(()=>t)}gr(e,t){return W.forEach(this.gi,(r,i)=>this.Sr(e,r,i).next(s=>s?W.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,t).next(a=>{a||(r++,s.removeEntry(o,Ae.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),W.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),W.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),W.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),W.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=H_(e.data.value)),t}Sr(e,t,r){return W.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.gi.get(t);return W.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var jA=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=i}static Es(e,t){let r=Ue(),i=Ue();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var BA=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var $A=class{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return KP()?8:nY(fn())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ps(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.ys(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new BA;return this.ws(e,t,o).next(a=>{if(s.result=a,this.Rs)return this.Ss(e,t,o,a.size)})}).next(()=>s.result)}Ss(e,t,r,i){return r.documentReadCount<this.Vs?(ld()<=Fe.DEBUG&&re("QueryEngine","SDK will not create cache indexes for query:",ud(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),W.resolve()):(ld()<=Fe.DEBUG&&re("QueryEngine","Query:",ud(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.fs*i?(ld()<=Fe.DEBUG&&re("QueryEngine","The SDK decides to create cache indexes for query:",ud(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hi(t))):W.resolve())}ps(e,t){if(CL(t))return W.resolve(null);let r=Hi(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=aA(t,null,"F"),r=Hi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Ue(...s);return this.gs.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let d=this.bs(t,a);return this.Ds(t,d,o,c.readTime)?this.ps(e,aA(t,null,"F")):this.vs(e,d,t,c)}))})))}ys(e,t,r,i){return CL(t)||i.isEqual(Ae.min())?W.resolve(null):this.gs.getDocuments(e,r).next(s=>{let o=this.bs(t,s);return this.Ds(t,o,r,i)?W.resolve(null):(ld()<=Fe.DEBUG&&re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ud(t)),this.vs(e,o,t,XQ(i,Vp)).next(a=>a))})}bs(e,t){let r=new vn(MU(e));return t.forEach((i,s)=>{k0(e,s)&&(r=r.add(s))}),r}Ds(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}ws(e,t,r){return ld()<=Fe.DEBUG&&re("QueryEngine","Using full collection scan to execute query:",ud(t)),this.gs.getDocumentsMatchingQuery(e,t,Xc.min(),r)}vs(e,t,r,i){return this.gs.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Fx="LocalStore",tJ=3e8,HA=class{constructor(e,t,r,i){this.persistence=e,this.Cs=t,this.serializer=i,this.Fs=new Tt(Ne),this.Ms=new Hs(s=>kx(s),Nx),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RA(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Fs))}};function nJ(n,e,t,r){return new HA(n,e,t,r)}async function ZU(n,e){let t=be(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ns(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=Ue();for(let d of i){o.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}for(let d of s){a.push(d.batchId);for(let h of d.mutations)c=c.add(h.key)}return t.localDocuments.getDocuments(r,c).next(d=>({Bs:d,removedBatchIds:o,addedBatchIds:a}))})})}function rJ(n,e){let t=be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Os.newChangeBuffer({trackRemovals:!0});return(function(a,c,d,h){let p=d.batch,y=p.keys(),E=W.resolve();return y.forEach(k=>{E=E.next(()=>h.getEntry(c,k)).next(P=>{let M=d.docVersions.get(k);it(M!==null,48541),P.version.compareTo(M)<0&&(p.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),h.addEntry(P)))})}),E.next(()=>a.mutationQueue.removeMutationBatch(c,p))})(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(a){let c=Ue();for(let d=0;d<a.mutationResults.length;++d)a.mutationResults[d].transformResults.length>0&&(c=c.add(a.batch.mutations[d].key));return c})(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function ej(n){let e=be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.hi.getLastRemoteSnapshotVersion(t))}function iJ(n,e){let t=be(n),r=e.snapshotVersion,i=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Os.newChangeBuffer({trackRemovals:!0});i=t.Fs;let a=[];e.targetChanges.forEach((h,p)=>{let y=i.get(p);if(!y)return;a.push(t.hi.removeMatchingKeys(s,h.removedDocuments,p).next(()=>t.hi.addMatchingKeys(s,h.addedDocuments,p)));let E=y.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?E=E.withResumeToken(On.EMPTY_BYTE_STRING,Ae.min()).withLastLimboFreeSnapshotVersion(Ae.min()):h.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(h.resumeToken,r)),i=i.insert(p,E),(function(P,M,$){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=tJ?!0:$.addedDocuments.size+$.modifiedDocuments.size+$.removedDocuments.size>0})(y,E,h)&&a.push(t.hi.updateTargetData(s,E))});let c=qs(),d=Ue();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(sJ(s,o,e.documentUpdates).next(h=>{c=h.Ls,d=h.ks})),!r.isEqual(Ae.min())){let h=t.hi.getLastRemoteSnapshotVersion(s).next(p=>t.hi.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(h)}return W.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.Fs=i,s))}function sJ(n,e,t){let r=Ue(),i=Ue();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=qs();return t.forEach((a,c)=>{let d=s.get(a);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(Ae.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):re(Fx,"Ignoring outdated watch update for ",a,". Current version:",d.version," Watch version:",c.version)}),{Ls:o,ks:i}})}function oJ(n,e){let t=be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Sx),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function aJ(n,e){let t=be(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.hi.getTargetData(r,e).next(s=>s?(i=s,W.resolve(i)):t.hi.allocateTargetId(r).next(o=>(i=new Hp(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Fs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r})}async function qA(n,e,t){let r=be(n),i=r.Fs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Rd(o))throw o;re(Fx,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(i.target)}function VL(n,e,t){let r=be(n),i=Ae.min(),s=Ue();return r.persistence.runTransaction("Execute query","readwrite",o=>(function(c,d,h){let p=be(c),y=p.Ms.get(h);return y!==void 0?W.resolve(p.Fs.get(y)):p.hi.getTargetData(d,h)})(r,o,Hi(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Cs.getDocumentsMatchingQuery(o,e,t?i:Ae.min(),t?s:Ue())).next(a=>(cJ(r,IY(e),a),{documents:a,qs:s})))}function cJ(n,e,t){let r=n.xs.get(e)||Ae.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.xs.set(e,r)}var c0=class{constructor(){this.activeTargetIds=DY()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var zA=class{constructor(){this.Fo=new c0,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new c0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var GA=class{xo(e){}shutdown(){}};var LL="ConnectivityMonitor",l0=class{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){re(LL,"Network connectivity changed: AVAILABLE");for(let e of this.ko)e(0)}Lo(){re(LL,"Network connectivity changed: UNAVAILABLE");for(let e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var $_=null;function WA(){return $_===null?$_=(function(){return 268435456+Math.round(2147483648*Math.random())})():$_++,"0x"+$_.toString(16)}var OD="RestConnection",lJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},KA=class{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${i}`,this.Ko=this.databaseId.database===J_?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Wo(e,t,r,i,s){let o=WA(),a=this.Go(e,t.toUriEncodedString());re(OD,`Sending RPC '${e}' ${o}:`,a,r);let c={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(c,i,s);let{host:d}=new URL(a),h=Lo(d);return this.jo(e,a,c,r,h).then(p=>(re(OD,`Received RPC '${e}' ${o}: `,p),p),p=>{throw la(OD,`RPC '${e}' ${o} failed with error: `,p,"url: ",a,"request:",r),p})}Jo(e,t,r,i,s,o){return this.Wo(e,t,r,i,s)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ad})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}Go(e,t){let r=lJ[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}};var QA=class{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}};var Pn="WebChannelConnection",YA=class extends KA{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,i,s){let o=WA();return new Promise((a,c)=>{let d=new xD;d.setWithCredentials(!0),d.listenOnce(RD.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Rp.NO_ERROR:let p=d.getResponseJson();re(Pn,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),a(p);break;case Rp.TIMEOUT:re(Pn,`RPC '${e}' ${o} timed out`),c(new te(q.DEADLINE_EXCEEDED,"Request time out"));break;case Rp.HTTP_ERROR:let y=d.getStatus();if(re(Pn,`RPC '${e}' ${o} failed with status:`,y,"response text:",d.getResponseText()),y>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);let k=E?.error;if(k&&k.status&&k.message){let P=(function($){let Y=$.toLowerCase().replace(/_/g,"-");return Object.values(q).indexOf(Y)>=0?Y:q.UNKNOWN})(k.status);c(new te(P,k.message))}else c(new te(q.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new te(q.UNAVAILABLE,"Connection failed."));break;default:fe(9055,{c_:e,streamId:o,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{re(Pn,`RPC '${e}' ${o} completed.`)}});let h=JSON.stringify(i);re(Pn,`RPC '${e}' ${o} sending request:`,i),d.send(t,"POST",h,r,15)})}P_(e,t,r){let i=WA(),s=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=MD(),a=ND(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.zo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let h=s.join("");re(Pn,`Creating RPC '${e}' stream ${i}: ${h}`,c);let p=o.createWebChannel(h,c);this.T_(p);let y=!1,E=!1,k=new QA({Ho:M=>{E?re(Pn,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(y||(re(Pn,`Opening RPC '${e}' stream ${i} transport.`),p.open(),y=!0),re(Pn,`RPC '${e}' stream ${i} sending:`,M),p.send(M))},Yo:()=>p.close()}),P=(M,$,Y)=>{M.listen($,ee=>{try{Y(ee)}catch(Ce){setTimeout(()=>{throw Ce},0)}})};return P(p,cd.EventType.OPEN,()=>{E||(re(Pn,`RPC '${e}' stream ${i} transport opened.`),k.s_())}),P(p,cd.EventType.CLOSE,()=>{E||(E=!0,re(Pn,`RPC '${e}' stream ${i} transport closed`),k.__(),this.I_(p))}),P(p,cd.EventType.ERROR,M=>{E||(E=!0,la(Pn,`RPC '${e}' stream ${i} transport errored. Name:`,M.name,"Message:",M.message),k.__(new te(q.UNAVAILABLE,"The operation could not be completed")))}),P(p,cd.EventType.MESSAGE,M=>{var $;if(!E){let Y=M.data[0];it(!!Y,16349);let ee=Y,Ce=ee?.error||(($=ee[0])===null||$===void 0?void 0:$.error);if(Ce){re(Pn,`RPC '${e}' stream ${i} received error:`,Ce);let Je=Ce.status,pe=(function(I){let C=Ht[I];if(C!==void 0)return qU(C)})(Je),T=Ce.message;pe===void 0&&(pe=q.INTERNAL,T="Unknown error status: "+Je+" with message "+Ce.message),E=!0,k.__(new te(pe,T)),p.close()}else re(Pn,`RPC '${e}' stream ${i} received:`,Y),k.a_(Y)}}),P(a,kD.STAT_EVENT,M=>{M.stat===U_.PROXY?re(Pn,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===U_.NOPROXY&&re(Pn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{k.o_()},0),k}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(t=>t===e)}};function FD(){return typeof document<"u"?document:null}function N0(n){return new yA(n,!0)}var u0=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=i,this.A_=s,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();let t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),i=Math.max(0,t-r);i>0&&re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}};var UL="PersistentStream",d0=class{constructor(e,t,r,i,s,o,a,c){this.Fi=e,this.w_=r,this.S_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new u0(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===q.RESOURCE_EXHAUSTED?(js(t.toString()),js("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;let e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.b_===t&&this.W_(r,i)},r=>{e(()=>{let i=new te(q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(i)})})}W_(e,t){let r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{r(()=>this.G_(i))}),this.stream.onMessage(i=>{r(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return re(UL,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget(()=>this.b_===e?t():(re(UL,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},JA=class extends d0{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();let t=BY(this.serializer,e),r=(function(s){if(!("targetChange"in s))return Ae.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?Ae.min():o.readTime?qi(o.readTime):Ae.min()})(e);return this.listener.J_(t,r)}H_(e){let t={};t.database=IA(this.serializer),t.addTarget=(function(s,o){let a,c=o.target;if(a=sA(c)?{documents:qY(s,c)}:{query:zY(s,c).Vt},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=zU(s,o.resumeToken);let d=vA(s,o.expectedCount);d!==null&&(a.expectedCount=d)}else if(o.snapshotVersion.compareTo(Ae.min())>0){a.readTime=i0(s,o.snapshotVersion.toTimestamp());let d=vA(s,o.expectedCount);d!==null&&(a.expectedCount=d)}return a})(this.serializer,e);let r=WY(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){let t={};t.database=IA(this.serializer),t.removeTarget=e,this.k_(t)}},XA=class extends d0{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return it(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,it(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){it(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();let t=HY(e.writeResults,e.commitTime),r=qi(e.commitTime);return this.listener.ta(r,t)}na(){let e={};e.database=IA(this.serializer),this.k_(e)}X_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>$Y(this.serializer,r))};this.k_(t)}};var ZA=class{},ex=class extends ZA{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new te(q.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Wo(e,_A(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new te(q.UNKNOWN,s.toString())})}Jo(e,t,r,i,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Jo(e,_A(t,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(q.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}},tx=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(js(t),this._a=!1):re("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}};var il="RemoteStore",nx=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=s,this.Ea.xo(o=>{r.enqueueAndForget(async()=>{sl(this)&&(re(il,"Restarting streams for network reachability change."),await(async function(c){let d=be(c);d.Ia.add(4),await Qp(d),d.Aa.set("Unknown"),d.Ia.delete(4),await M0(d)})(this))})}),this.Aa=new tx(r,i)}};async function M0(n){if(sl(n))for(let e of n.da)await e(!0)}async function Qp(n){for(let e of n.da)await e(!1)}function tj(n,e){let t=be(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),jx(t)?Ux(t):kd(t).x_()&&Lx(t,e))}function Vx(n,e){let t=be(n),r=kd(t);t.Ta.delete(e),r.x_()&&nj(t,e),t.Ta.size===0&&(r.x_()?r.B_():sl(t)&&t.Aa.set("Unknown"))}function Lx(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ae.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}kd(n).H_(e)}function nj(n,e){n.Ra.$e(e),kd(n).Y_(e)}function Ux(n){n.Ra=new mA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),kd(n).start(),n.Aa.aa()}function jx(n){return sl(n)&&!kd(n).M_()&&n.Ta.size>0}function sl(n){return be(n).Ia.size===0}function rj(n){n.Ra=void 0}async function uJ(n){n.Aa.set("Online")}async function dJ(n){n.Ta.forEach((e,t)=>{Lx(n,e)})}async function hJ(n,e){rj(n),jx(n)?(n.Aa.la(e),Ux(n)):n.Aa.set("Unknown")}async function fJ(n,e,t){if(n.Aa.set("Online"),e instanceof n0&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let a of s.targetIds)i.Ta.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.Ta.delete(a),i.Ra.removeTarget(a))})(n,e)}catch(r){re(il,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await h0(n,r)}else if(e instanceof pd?n.Ra.Ye(e):e instanceof t0?n.Ra.it(e):n.Ra.et(e),!t.isEqual(Ae.min()))try{let r=await ej(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let a=s.Ra.Pt(o);return a.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let h=s.Ta.get(d);h&&s.Ta.set(d,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,d)=>{let h=s.Ta.get(c);if(!h)return;s.Ta.set(c,h.withResumeToken(On.EMPTY_BYTE_STRING,h.snapshotVersion)),nj(s,c);let p=new Hp(h.target,c,d,h.sequenceNumber);Lx(s,p)}),s.remoteSyncer.applyRemoteEvent(a)})(n,t)}catch(r){re(il,"Failed to raise snapshot:",r),await h0(n,r)}}async function h0(n,e,t){if(!Rd(e))throw e;n.Ia.add(1),await Qp(n),n.Aa.set("Offline"),t||(t=()=>ej(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{re(il,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await M0(n)})}function ij(n,e){return e().catch(t=>h0(n,t,e))}async function P0(n){let e=be(n),t=ha(e),r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Sx;for(;pJ(e);)try{let i=await oJ(e.localStore,r);if(i===null){e.Pa.length===0&&t.B_();break}r=i.batchId,gJ(e,i)}catch(i){await h0(e,i)}sj(e)&&oj(e)}function pJ(n){return sl(n)&&n.Pa.length<10}function gJ(n,e){n.Pa.push(e);let t=ha(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function sj(n){return sl(n)&&!ha(n).M_()&&n.Pa.length>0}function oj(n){ha(n).start()}async function mJ(n){ha(n).na()}async function yJ(n){let e=ha(n);for(let t of n.Pa)e.X_(t.mutations)}async function vJ(n,e,t){let r=n.Pa.shift(),i=hA.from(r,e,t);await ij(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await P0(n)}async function _J(n,e){e&&ha(n).Z_&&await(async function(r,i){if((function(o){return PY(o)&&o!==q.ABORTED})(i.code)){let s=r.Pa.shift();ha(r).N_(),await ij(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await P0(r)}})(n,e),sj(n)&&oj(n)}async function jL(n,e){let t=be(n);t.asyncQueue.verifyOperationInProgress(),re(il,"RemoteStore received new credentials");let r=sl(t);t.Ia.add(3),await Qp(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await M0(t)}async function wJ(n,e){let t=be(n);e?(t.Ia.delete(2),await M0(t)):e||(t.Ia.add(2),await Qp(t),t.Aa.set("Unknown"))}function kd(n){return n.Va||(n.Va=(function(t,r,i){let s=be(t);return s.ia(),new JA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:uJ.bind(null,n),e_:dJ.bind(null,n),n_:hJ.bind(null,n),J_:fJ.bind(null,n)}),n.da.push(async e=>{e?(n.Va.N_(),jx(n)?Ux(n):n.Aa.set("Unknown")):(await n.Va.stop(),rj(n))})),n.Va}function ha(n){return n.ma||(n.ma=(function(t,r,i){let s=be(t);return s.ia(),new XA(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:mJ.bind(null,n),n_:_J.bind(null,n),ea:yJ.bind(null,n),ta:vJ.bind(null,n)}),n.da.push(async e=>{e?(n.ma.N_(),await P0(n)):(await n.ma.stop(),n.Pa.length>0&&(re(il,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))})),n.ma}var rx=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ji,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Bx(n,e){if(js("AsyncQueue",`${e}: ${n}`),Rd(n))return new te(q.UNAVAILABLE,`${e}: ${n}`);throw n}var f0=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ue.comparator(t.key,r.key):(t,r)=>ue.comparator(t.key,r.key),this.keyedMap=kp(),this.sortedSet=new Tt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var p0=class{constructor(){this.fa=new Tt(ue.comparator)}track(e){let t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):fe(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){let e=[];return this.fa.inorderTraversal((t,r)=>{e.push(r)}),e}},Cd=class n{constructor(e,t,r,i,s,o,a,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,f0.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&R0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var ix=class{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}},sx=class{constructor(){this.queries=BL(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){let i=be(t),s=i.queries;i.queries=BL(),s.forEach((o,a)=>{for(let c of a.wa)c.onError(r)})})(this,new te(q.ABORTED,"Firestore shutting down"))}};function BL(){return new Hs(n=>NU(n),R0)}async function aj(n,e){let t=be(n),r=3,i=e.query,s=t.queries.get(i);s?!s.Sa()&&e.ba()&&(r=2):(s=new ix,r=e.ba()?0:1);try{switch(r){case 0:s.ya=await t.onListen(i,!0);break;case 1:s.ya=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let a=Bx(o,`Initialization of query '${ud(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.wa.push(e),e.va(t.onlineState),s.ya&&e.Ca(s.ya)&&$x(t)}async function cj(n,e){let t=be(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.wa.indexOf(e);o>=0&&(s.wa.splice(o,1),s.wa.length===0?i=e.ba()?0:1:!s.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function IJ(n,e){let t=be(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.wa)a.Ca(i)&&(r=!0);o.ya=i}}r&&$x(t)}function EJ(n,e,t){let r=be(n),i=r.queries.get(e);if(i)for(let s of i.wa)s.onError(t);r.queries.delete(e)}function $x(n){n.Da.forEach(e=>{e.next()})}var ox,$L;($L=ox||(ox={})).Fa="default",$L.Cache="cache";var g0=class{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Cd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;let r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;let t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Cd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==ox.Cache}};var m0=class{constructor(e){this.key=e}},y0=class{constructor(e){this.key=e}},ax=class{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ue(),this.mutatedKeys=Ue(),this.Xa=MU(e),this.eu=new f0(this.Xa)}get tu(){return this.Ha}nu(e,t){let r=t?t.ru:new p0,i=t?t.eu:this.eu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{let y=i.get(h),E=k0(this.query,p)?p:null,k=!!y&&this.mutatedKeys.has(y.key),P=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations),M=!1;y&&E?y.data.isEqual(E.data)?k!==P&&(r.track({type:3,doc:E}),M=!0):this.iu(y,E)||(r.track({type:2,doc:E}),M=!0,(c&&this.Xa(E,c)>0||d&&this.Xa(E,d)<0)&&(a=!0)):!y&&E?(r.track({type:0,doc:E}),M=!0):y&&!E&&(r.track({type:1,doc:y}),M=!0,(c||d)&&(a=!0)),M&&(E?(o=o.add(E),s=P?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),r.track({type:1,doc:h})}return{eu:o,ru:r,Ds:a,mutatedKeys:s}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;let o=e.ru.pa();o.sort((h,p)=>(function(E,k){let P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe(20277,{At:M})}};return P(E)-P(k)})(h.type,p.type)||this.Xa(h.doc,p.doc)),this.su(r),i=i!=null&&i;let a=t&&!i?this.ou():[],c=this.Za.size===0&&this.current&&!i?1:0,d=c!==this.Ya;return this.Ya=c,o.length!==0||d?{snapshot:new Cd(this.query,e.eu,s,o,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:a}:{_u:a}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new p0,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}ou(){if(!this.current)return[];let e=this.Za;this.Za=Ue(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});let t=[];return e.forEach(r=>{this.Za.has(r)||t.push(new y0(r))}),this.Za.forEach(r=>{e.has(r)||t.push(new m0(r))}),t}uu(e){this.Ha=e.qs,this.Za=Ue();let t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Cd.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}},Hx="SyncEngine",cx=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},lx=class{constructor(e){this.key=e,this.lu=!1}},ux=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Hs(a=>NU(a),R0),this.Tu=new Map,this.Iu=new Set,this.du=new Tt(ue.comparator),this.Eu=new Map,this.Au=new zp,this.Ru={},this.Vu=new Map,this.mu=qp.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}};async function bJ(n,e,t=!0){let r=pj(n),i,s=r.Pu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.cu()):i=await lj(r,e,t,!0),i}async function CJ(n,e){let t=pj(n);await lj(t,e,!0,!1)}async function lj(n,e,t,r){let i=await aJ(n.localStore,Hi(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),a;return r&&(a=await TJ(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&tj(n.remoteStore,i),a}async function TJ(n,e,t,r,i){n.gu=(p,y,E)=>(async function(P,M,$,Y){let ee=M.view.nu($);ee.Ds&&(ee=await VL(P.localStore,M.query,!1).then(({documents:T})=>M.view.nu(T,ee)));let Ce=Y&&Y.targetChanges.get(M.targetId),Je=Y&&Y.targetMismatches.get(M.targetId)!=null,pe=M.view.applyChanges(ee,P.isPrimaryClient,Ce,Je);return qL(P,M.targetId,pe._u),pe.snapshot})(n,p,y,E);let s=await VL(n.localStore,e,!0),o=new ax(e,s.qs),a=o.nu(s.documents),c=$p.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=o.applyChanges(a,n.isPrimaryClient,c);qL(n,t,d._u);let h=new cx(e,t,o);return n.Pu.set(e,h),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),d.snapshot}async function SJ(n,e,t){let r=be(n),i=r.Pu.get(e),s=r.Tu.get(i.targetId);if(s.length>1)return r.Tu.set(i.targetId,s.filter(o=>!R0(o,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await qA(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Vx(r.remoteStore,i.targetId),dx(r,i.targetId)}).catch(xd)):(dx(r,i.targetId),await qA(r.localStore,i.targetId,!0))}async function DJ(n,e){let t=be(n),r=t.Pu.get(e),i=t.Tu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Vx(t.remoteStore,r.targetId))}async function AJ(n,e,t){let r=OJ(n);try{let i=await(function(o,a){let c=be(o),d=Wt.now(),h=a.reduce((E,k)=>E.add(k.key),Ue()),p,y;return c.persistence.runTransaction("Locally write mutations","readwrite",E=>{let k=qs(),P=Ue();return c.Os.getEntries(E,h).next(M=>{k=M,k.forEach(($,Y)=>{Y.isValidDocument()||(P=P.add($))})}).next(()=>c.localDocuments.getOverlayedDocuments(E,k)).next(M=>{p=M;let $=[];for(let Y of a){let ee=MY(Y,p.get(Y.key).overlayedDocument);ee!=null&&$.push(new Gi(Y.key,ee,TU(ee.value.mapValue),Us.exists(!0)))}return c.mutationQueue.addMutationBatch(E,d,$,a)}).next(M=>{y=M;let $=M.applyToLocalDocumentSet(p,P);return c.documentOverlayCache.saveOverlays(E,M.batchId,$)})}).then(()=>({batchId:y.batchId,changes:OU(p)}))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,a,c){let d=o.Ru[o.currentUser.toKey()];d||(d=new Tt(Ne)),d=d.insert(a,c),o.Ru[o.currentUser.toKey()]=d})(r,i.batchId,t),await Yp(r,i.changes),await P0(r.remoteStore)}catch(i){let s=Bx(i,"Failed to persist write");t.reject(s)}}async function uj(n,e){let t=be(n);try{let r=await iJ(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.Eu.get(s);o&&(it(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?it(o.lu,14607):i.removedDocuments.size>0&&(it(o.lu,42227),o.lu=!1))}),await Yp(t,r,e)}catch(r){await xd(r)}}function HL(n,e,t){let r=be(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Pu.forEach((s,o)=>{let a=o.view.va(e);a.snapshot&&i.push(a.snapshot)}),(function(o,a){let c=be(o);c.onlineState=a;let d=!1;c.queries.forEach((h,p)=>{for(let y of p.wa)y.va(a)&&(d=!0)}),d&&$x(c)})(r.eventManager,e),i.length&&r.hu.J_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function xJ(n,e,t){let r=be(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Eu.get(e),s=i&&i.key;if(s){let o=new Tt(ue.comparator);o=o.insert(s,ri.newNoDocument(s,Ae.min()));let a=Ue().add(s),c=new e0(Ae.min(),new Map,new Tt(Ne),o,a);await uj(r,c),r.du=r.du.remove(s),r.Eu.delete(e),qx(r)}else await qA(r.localStore,e,!1).then(()=>dx(r,e,t)).catch(xd)}async function RJ(n,e){let t=be(n),r=e.batch.batchId;try{let i=await rJ(t.localStore,e);hj(t,r,null),dj(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Yp(t,i)}catch(i){await xd(i)}}async function kJ(n,e,t){let r=be(n);try{let i=await(function(o,a){let c=be(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,a).next(p=>(it(p!==null,37113),h=p.keys(),c.mutationQueue.removeMutationBatch(d,p))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})})(r.localStore,e);hj(r,e,t),dj(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Yp(r,i)}catch(i){await xd(i)}}function dj(n,e){(n.Vu.get(e)||[]).forEach(t=>{t.resolve()}),n.Vu.delete(e)}function hj(n,e,t){let r=be(n),i=r.Ru[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ru[r.currentUser.toKey()]=i}}function dx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach(r=>{n.Au.containsKey(r)||fj(n,r)})}function fj(n,e){n.Iu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Vx(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),qx(n))}function qL(n,e,t){for(let r of t)r instanceof m0?(n.Au.addReference(r.key,e),NJ(n,r)):r instanceof y0?(re(Hx,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||fj(n,r.key)):fe(19791,{yu:r})}function NJ(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(re(Hx,"New document in limbo: "+t),n.Iu.add(r),qx(n))}function qx(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Iu.values().next().value;n.Iu.delete(e);let t=new ue(_t.fromString(e)),r=n.mu.next();n.Eu.set(r,new lx(t)),n.du=n.du.insert(t,r),tj(n.remoteStore,new Hp(Hi(Mx(t.path)),r,"TargetPurposeLimboResolution",Tx.ue))}}async function Yp(n,e,t){let r=be(n),i=[],s=[],o=[];r.Pu.isEmpty()||(r.Pu.forEach((a,c)=>{o.push(r.gu(c,e,t).then(d=>{var h;if((d||t)&&r.isPrimaryClient){let p=d?!d.fromCache:(h=t?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(d){i.push(d);let p=jA.Es(c.targetId,d);s.push(p)}}))}),await Promise.all(o),r.hu.J_(i),await(async function(c,d){let h=be(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>W.forEach(d,y=>W.forEach(y.Is,E=>h.persistence.referenceDelegate.addReference(p,y.targetId,E)).next(()=>W.forEach(y.ds,E=>h.persistence.referenceDelegate.removeReference(p,y.targetId,E)))))}catch(p){if(!Rd(p))throw p;re(Fx,"Failed to update sequence numbers: "+p)}for(let p of d){let y=p.targetId;if(!p.fromCache){let E=h.Fs.get(y),k=E.snapshotVersion,P=E.withLastLimboFreeSnapshotVersion(k);h.Fs=h.Fs.insert(y,P)}}})(r.localStore,s))}async function MJ(n,e){let t=be(n);if(!t.currentUser.isEqual(e)){re(Hx,"User change. New user:",e.toKey());let r=await ZU(t.localStore,e);t.currentUser=e,(function(s,o){s.Vu.forEach(a=>{a.forEach(c=>{c.reject(new te(q.CANCELLED,o))})}),s.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Yp(t,r.Bs)}}function PJ(n,e){let t=be(n),r=t.Eu.get(e);if(r&&r.lu)return Ue().add(r.key);{let i=Ue(),s=t.Tu.get(e);if(!s)return i;for(let o of s){let a=t.Pu.get(o);i=i.unionWith(a.view.tu)}return i}}function pj(n){let e=be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=uj.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=PJ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=xJ.bind(null,e),e.hu.J_=IJ.bind(null,e.eventManager),e.hu.pu=EJ.bind(null,e.eventManager),e}function OJ(n){let e=be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=RJ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=kJ.bind(null,e),e}var gj=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=N0(t.databaseInfo.databaseId),this.sharedClientState=this.bu(t),this.persistence=this.Du(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Cu(t,this.localStore),this.indexBackfillerScheduler=this.Fu(t,this.localStore)}Cu(t,r){return null}Fu(t,r){return null}vu(t){return nJ(this.persistence,new $A,t.initialUser,this.serializer)}Du(t){return new o0(UA.Vi,this.serializer)}bu(t){return new zA}async terminate(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}return n.provider={build:()=>new n},n})(),hx=class extends gj{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){it(this.persistence.referenceDelegate instanceof a0,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new SA(r,e.asyncQueue,t)}Du(e){let t=this.cacheSizeBytes!==void 0?xr.withCacheSize(this.cacheSizeBytes):xr.DEFAULT;return new o0(r=>a0.Vi(r,t),this.serializer)}};var FJ=(()=>{class n{async initialize(t,r){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>HL(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=MJ.bind(null,this.syncEngine),await wJ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new sx})()}createDatastore(t){let r=N0(t.databaseInfo.databaseId),i=(function(o){return new YA(o)})(t.databaseInfo);return(function(o,a,c,d){return new ex(o,a,c,d)})(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return(function(i,s,o,a,c){return new nx(i,s,o,a,c)})(this.localStore,this.datastore,t.asyncQueue,r=>HL(this.syncEngine,r,0),(function(){return l0.C()?new l0:new GA})())}createSyncEngine(t,r){return(function(s,o,a,c,d,h,p){let y=new ux(s,o,a,c,d,h);return p&&(y.fu=!0),y})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}async terminate(){var t,r;await(async function(s){let o=be(s);re(il,"RemoteStore shutting down."),o.Ia.add(5),await Qp(o),o.Ea.shutdown(),o.Aa.set("Unknown")})(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}return n.provider={build:()=>new n},n})();var v0=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):js("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var fa="FirestoreClient",fx=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=yn.UNAUTHENTICATED,this.clientId=Fp.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{re(fa,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(re(fa,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ji;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Bx(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function VD(n,e){n.asyncQueue.verifyOperationInProgress(),re(fa,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await ZU(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>{la("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then(()=>{re("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{la("Terminating Firestore due to IndexedDb database deletion failed",i)})}),n._offlineComponents=e}async function zL(n,e){n.asyncQueue.verifyOperationInProgress();let t=await VJ(n);re(fa,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>jL(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>jL(e.remoteStore,i)),n._onlineComponents=e}async function VJ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){re(fa,"Using user provided OfflineComponentProvider");try{await VD(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===q.FAILED_PRECONDITION||i.code===q.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;la("Error using user provided cache. Falling back to memory cache: "+t),await VD(n,new gj)}}else re(fa,"Using default OfflineComponentProvider"),await VD(n,new hx(void 0));return n._offlineComponents}async function mj(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(re(fa,"Using user provided OnlineComponentProvider"),await zL(n,n._uninitializedComponentsProvider._online)):(re(fa,"Using default OnlineComponentProvider"),await zL(n,new FJ))),n._onlineComponents}function LJ(n){return mj(n).then(e=>e.syncEngine)}async function px(n){let e=await mj(n),t=e.eventManager;return t.onListen=bJ.bind(null,e.syncEngine),t.onUnlisten=SJ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=CJ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=DJ.bind(null,e.syncEngine),t}function UJ(n,e,t={}){let r=new ji;return n.asyncQueue.enqueueAndForget(async()=>(function(s,o,a,c,d){let h=new v0({next:y=>{h.Ou(),o.enqueueAndForget(()=>cj(s,p)),y.fromCache&&c.source==="server"?d.reject(new te(q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(y)},error:y=>d.reject(y)}),p=new g0(a,h,{includeMetadataChanges:!0,ka:!0});return aj(s,p)})(await px(n),n.asyncQueue,e,t,r)),r.promise}function yj(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var GL=new Map;var vj="firestore.googleapis.com",WL=!0,_0=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vj,this.ssl=WL}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:WL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=XU;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<ZY)throw new te(q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}JQ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=yj((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new te(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new te(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new te(q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Td=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new _0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new te(q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new te(q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new _0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new LD;switch(r.type){case"firstParty":return new $D(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=GL.get(t);r&&(re("ComponentProvider","Removing Datastore"),GL.delete(t),r.terminate())})(this),Promise.resolve()}};function _j(n,e,t,r={}){var i;n=Bi(n,Td);let s=Lo(e),o=n._getSettings(),a=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),c=`${e}:${t}`;s&&(hv(`https://${c}`),fv("Firestore",!0)),o.host!==vj&&o.host!==c&&la("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let d=Object.assign(Object.assign({},o),{host:c,ssl:s,emulatorOptions:r});if(!ki(d,a)&&(n._setSettings(d),r.mockUserToken)){let h,p;if(typeof r.mockUserToken=="string")h=r.mockUserToken,p=yn.MOCK_USER;else{h=$P(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new te(q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new yn(y)}n._authCredentials=new UD(new G_(h,p))}}var pa=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},bn=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new sa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(Kp(t,n._jsonSchema))return new n(e,r||null,new ue(_t.fromString(t.referencePath)))}};bn._jsonSchemaVersion="firestore/documentReference/1.0",bn._jsonSchema={type:Gt("string",bn._jsonSchemaVersion),referencePath:Gt("string")};var sa=class n extends pa{constructor(e,t,r){super(e,t,Mx(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new ue(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function wj(n,e,...t){if(n=an(n),tU("collection","path",e),n instanceof Td){let r=_t.fromString(e,...t);return dL(r),new sa(n,null,r)}{if(!(n instanceof bn||n instanceof sa))throw new te(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(_t.fromString(e,...t));return dL(r),new sa(n.firestore,null,r)}}function zx(n,e,...t){if(n=an(n),arguments.length===1&&(e=Fp.newId()),tU("doc","path",e),n instanceof Td){let r=_t.fromString(e,...t);return uL(r),new bn(n,null,new ue(r))}{if(!(n instanceof bn||n instanceof sa))throw new te(q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(_t.fromString(e,...t));return uL(r),new bn(n.firestore,n instanceof sa?n.converter:null,new ue(r))}}var KL="AsyncQueue",w0=class{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new u0(this,"async_queue_retry"),this.oc=()=>{let r=FD();r&&re(KL,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;let t=FD();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;let t=FD();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});let t=new ji;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Rd(e))throw e;re(KL,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){let t=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,js("INTERNAL UNHANDLED ERROR: ",QL(r)),r}).then(r=>(this.nc=!1,r))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);let i=rx.createAndSchedule(this,e,t,r,s=>this.lc(s));return this.ec.push(i),i}ac(){this.tc&&fe(47125,{hc:QL(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(let t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){let t=this.ec.indexOf(e);this.ec.splice(t,1)}};function QL(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}function YL(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1})(n,["next","error","complete"])}var zs=class extends Td{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new w0,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new w0(e),this._firestoreClient=void 0,await e}}};function Ij(n,e){let t=typeof n=="object"?n:Sc(),r=typeof n=="string"?n:e||J_,i=Su(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=BP("firestore");s&&_j(i,...s)}return i}function Gx(n){if(n._terminated)throw new te(q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||jJ(n),n._firestoreClient}function jJ(n){var e,t,r;let i=n._freezeSettings(),s=(function(a,c,d,h){return new WD(a,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,yj(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new fx(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&(function(a){let c=a?._online.build();return{_offline:a?._offline.build(c),_online:c}})(n._componentsProvider))}var oa=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(On.fromBase64String(e))}catch(t){throw new te(q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(On.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Kp(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};oa._jsonSchemaVersion="firestore/bytes/1.0",oa._jsonSchema={type:Gt("string",oa._jsonSchemaVersion),bytes:Gt("string")};var Sd=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new te(q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Dd=class{constructor(e){this._methodName=e}};var aa=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new te(q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new te(q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ne(this._lat,e._lat)||Ne(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(Kp(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};aa._jsonSchemaVersion="firestore/geoPoint/1.0",aa._jsonSchema={type:Gt("string",aa._jsonSchemaVersion),latitude:Gt("number"),longitude:Gt("number")};var ca=class n{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Kp(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(t=>typeof t=="number"))return new n(e.vectorValues);throw new te(q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};ca._jsonSchemaVersion="firestore/vectorValue/1.0",ca._jsonSchema={type:Gt("string",ca._jsonSchemaVersion),vectorValues:Gt("object")};var BJ=/^__.*__$/,gx=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Gi(e,this.data,this.fieldMask,t,this.fieldTransforms):new rl(e,this.data,t,this.fieldTransforms)}},I0=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gi(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Ej(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe(40011,{Ec:n})}}var mx=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ac(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.fc(e),i}gc(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Rc({path:r,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return b0(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Ej(this.Ec)&&BJ.test(e))throw this.wc('Document fields cannot begin and end with "__"')}},yx=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||N0(e)}Dc(e,t,r,i=!1){return new mx({Ec:e,methodName:t,bc:r,path:pr.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Wx(n){let e=n._freezeSettings(),t=N0(n._databaseId);return new yx(n._databaseId,!!e.ignoreUndefinedProperties,t)}function $J(n,e,t,r,i,s={}){let o=n.Dc(s.merge||s.mergeFields?2:0,e,t,i);Kx("Data must be an object, but it was:",o,r);let a=bj(r,o),c,d;if(s.merge)c=new Rr(o.fieldMask),d=o.fieldTransforms;else if(s.mergeFields){let h=[];for(let p of s.mergeFields){let y=_x(e,p,t);if(!o.contains(y))throw new te(q.INVALID_ARGUMENT,`Field '${y}' is specified in your field mask but missing from your input data.`);Tj(h,y)||h.push(y)}c=new Rr(h),d=o.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,d=o.fieldTransforms;return new gx(new fr(a),c,d)}var E0=class n extends Dd{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};var vx=class n extends Dd{_toFieldTransform(e){return new cA(e.path,new el)}isEqual(e){return e instanceof n}};function HJ(n,e,t,r){let i=n.Dc(1,e,t);Kx("Data must be an object, but it was:",i,r);let s=[],o=fr.empty();ga(r,(c,d)=>{let h=Qx(e,c,t);d=an(d);let p=i.gc(h);if(d instanceof E0)s.push(h);else{let y=Jp(d,p);y!=null&&(s.push(h),o.set(h,y))}});let a=new Rr(s);return new I0(o,a,i.fieldTransforms)}function qJ(n,e,t,r,i,s){let o=n.Dc(1,e,t),a=[_x(e,r,t)],c=[i];if(s.length%2!=0)throw new te(q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let y=0;y<s.length;y+=2)a.push(_x(e,s[y])),c.push(s[y+1]);let d=[],h=fr.empty();for(let y=a.length-1;y>=0;--y)if(!Tj(d,a[y])){let E=a[y],k=c[y];k=an(k);let P=o.gc(E);if(k instanceof E0)d.push(E);else{let M=Jp(k,P);M!=null&&(d.push(E),h.set(E,M))}}let p=new Rr(d);return new I0(h,p,o.fieldTransforms)}function zJ(n,e,t,r=!1){return Jp(t,n.Dc(r?4:3,e))}function Jp(n,e){if(Cj(n=an(n)))return Kx("Unsupported field value:",e,n),bj(n,e);if(n instanceof Dd)return(function(r,i){if(!Ej(i.Ec))throw i.wc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let a of r){let c=Jp(a,i.yc(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=an(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return AY(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Wt.fromDate(r);return{timestampValue:i0(i.serializer,s)}}if(r instanceof Wt){let s=new Wt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:i0(i.serializer,s)}}if(r instanceof aa)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof oa)return{bytesValue:zU(i.serializer,r._byteString)};if(r instanceof bn){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ox(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof ca)return(function(o,a){return{mapValue:{fields:{[Ax]:{stringValue:xx},[yd]:{arrayValue:{values:o.toArray().map(d=>{if(typeof d!="number")throw a.wc("VectorValues must only contain numeric values.");return Px(a.serializer,d)})}}}}}})(r,i);throw i.wc(`Unsupported field value: ${D0(r)}`)})(n,e)}function bj(n,e){let t={};return yU(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ga(n,(r,i)=>{let s=Jp(i,e.Vc(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function Cj(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Wt||n instanceof aa||n instanceof oa||n instanceof bn||n instanceof Dd||n instanceof ca)}function Kx(n,e,t){if(!Cj(t)||!nU(t)){let r=D0(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function _x(n,e,t){if((e=an(e))instanceof Sd)return e._internalPath;if(typeof e=="string")return Qx(n,e);throw b0("Field path arguments must be of type string or ",n,!1,void 0,t)}var GJ=new RegExp("[~\\*/\\[\\]]");function Qx(n,e,t){if(e.search(GJ)>=0)throw b0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Sd(...e.split("."))._internalPath}catch{throw b0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function b0(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new te(q.INVALID_ARGUMENT,a+n+c)}function Tj(n,e){return n.some(t=>t.isEqual(e))}var C0=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new wx(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(O0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},wx=class extends C0{data(){return super.data()}};function O0(n,e){return typeof e=="string"?Qx(n,e):e instanceof Sd?e._internalPath:e._delegate._internalPath}function Sj(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new te(q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Gp=class{},T0=class extends Gp{};function Dj(n,e,...t){let r=[];e instanceof Gp&&r.push(e),r=r.concat(t),(function(s){let o=s.filter(c=>c instanceof Ix).length,a=s.filter(c=>c instanceof S0).length;if(o>1||o>0&&a>0)throw new te(q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var S0=class n extends T0{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Rj(e._query,t),new pa(e.firestore,e.converter,oA(e._query,t))}_parse(e){let t=Wx(e.firestore);return(function(s,o,a,c,d,h,p){let y;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new te(q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){XL(p,h);let k=[];for(let P of p)k.push(JL(c,s,P));y={arrayValue:{values:k}}}else y=JL(c,s,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||XL(p,h),y=zJ(a,o,p,h==="in"||h==="not-in");return zt.create(d,h,y)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function Aj(n,e,t){let r=e,i=O0("where",n);return S0._create(i,r,t)}var Ix=class n extends Gp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:ii.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)Rj(o,c),o=oA(o,c)})(e._query,t),new pa(e.firestore,e.converter,oA(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Ex=class n extends T0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,s,o){if(i.startAt!==null)throw new te(q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new te(q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Zc(s,o)})(e._query,this._field,this._direction);return new pa(e.firestore,e.converter,(function(i,s){let o=i.explicitOrderBy.concat([s]);return new da(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}};function xj(n,e="asc"){let t=e,r=O0("orderBy",n);return Ex._create(r,t)}function JL(n,e,t){if(typeof(t=an(t))=="string"){if(t==="")throw new te(q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kU(e)&&t.indexOf("/")!==-1)throw new te(q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(_t.fromString(t));if(!ue.isDocumentKey(r))throw new te(q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return vL(n,new ue(r))}if(t instanceof bn)return vL(n,t._key);throw new te(q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${D0(t)}.`)}function XL(n,e){if(!Array.isArray(n)||n.length===0)throw new te(q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Rj(n,e){let t=(function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new te(q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var bx=class{convertValue(e,t="none"){switch(ua(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes($s(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw fe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return ga(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[yd].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>vt(o.doubleValue));return new ca(s)}convertGeoPoint(e){return new aa(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=x0(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Up(e));default:return null}}convertTimestamp(e){let t=Bs(e);return new Wt(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=_t.fromString(e);it(JU(r),9688,{name:e});let i=new X_(r.get(1),r.get(3)),s=new ue(r.popFirst(5));return i.isEqual(t)||js(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function WJ(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Kc=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Qc=class n extends C0{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new gd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(O0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new te(q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};Qc._jsonSchemaVersion="firestore/documentSnapshot/1.0",Qc._jsonSchema={type:Gt("string",Qc._jsonSchemaVersion),bundleSource:Gt("string","DocumentSnapshot"),bundleName:Gt("string"),bundle:Gt("string")};var gd=class extends Qc{data(e={}){return super.data(e)}},Yc=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Kc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new gd(this._firestore,this._userDataWriter,r.key,r,new Kc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new te(q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new gd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Kc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new gd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Kc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,h=-1;return a.type!==0&&(d=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:KJ(a.type),doc:c,oldIndex:d,newIndex:h}})}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new te(q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Fp.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach(s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function KJ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe(61501,{type:n})}}Yc._jsonSchemaVersion="firestore/querySnapshot/1.0",Yc._jsonSchema={type:Gt("string",Yc._jsonSchemaVersion),bundleSource:Gt("string","QuerySnapshot"),bundleName:Gt("string"),bundle:Gt("string")};var Wp=class extends bx{constructor(e){super(),this.firestore=e}convertBytes(e){return new oa(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,t)}};function kj(n){n=Bi(n,pa);let e=Bi(n.firestore,zs),t=Gx(e),r=new Wp(e);return Sj(n._query),UJ(t,n._query).then(i=>new Yc(e,r,n,i))}function Nj(n,e,t,...r){n=Bi(n,bn);let i=Bi(n.firestore,zs),s=Wx(i),o;return o=typeof(e=an(e))=="string"||e instanceof Sd?qJ(s,"updateDoc",n._key,e,t,r):HJ(s,"updateDoc",n._key,e),Yx(i,[o.toMutation(n._key,Us.exists(!0))])}function Mj(n){return Yx(Bi(n.firestore,zs),[new Bp(n._key,Us.none())])}function Pj(n,e){let t=Bi(n.firestore,zs),r=zx(n),i=WJ(n.converter,e);return Yx(t,[$J(Wx(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Us.exists(!1))]).then(()=>r)}function Oj(n,...e){var t,r,i;n=an(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||YL(e[o])||(s=e[o++]);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(YL(e[o])){let p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let c,d,h;if(n instanceof bn)d=Bi(n.firestore,zs),h=Mx(n._key.path),c={next:p=>{e[o]&&e[o](QJ(d,n,p))},error:e[o+1],complete:e[o+2]};else{let p=Bi(n,pa);d=Bi(p.firestore,zs),h=p._query;let y=new Wp(d);c={next:E=>{e[o]&&e[o](new Yc(d,y,p,E))},error:e[o+1],complete:e[o+2]},Sj(n._query)}return(function(y,E,k,P){let M=new v0(P),$=new g0(E,M,k);return y.asyncQueue.enqueueAndForget(async()=>aj(await px(y),$)),()=>{M.Ou(),y.asyncQueue.enqueueAndForget(async()=>cj(await px(y),$))}})(Gx(d),h,a,c)}function Yx(n,e){return(function(r,i){let s=new ji;return r.asyncQueue.enqueueAndForget(async()=>AJ(await LJ(r),i,s)),s.promise})(Gx(n),e)}function QJ(n,e,t){let r=t.docs.get(e._key),i=new Wp(n);return new Qc(n,i,e._key,r,new Kc(t.hasPendingWrites,t.fromCache),e.converter)}function Nd(){return new vx("serverTimestamp")}(function(e,t=!0){(function(i){Ad=i})(jo),Xr(new Hn("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new zs(new jD(r.getProvider("auth-internal")),new HD(o,r.getProvider("app-check-internal")),(function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new te(q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new X_(d.options.projectId,h)})(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),bt(oL,aL,e),bt(oL,aL,"esm2017")})();var si=class{constructor(e){return e}},Fj="firestore",Jx=class{constructor(){return Au(Fj)}};var Xx=new ae("angularfire2.firestore-instances");function YJ(n,e){let t=Uf(Fj,n,e);return t&&new si(t)}function JJ(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new si(r)}}var XJ={provide:Jx,deps:[[new or,Xx]]},ZJ={provide:si,useFactory:YJ,deps:[[new or,Xx],Is]};function Vj(n,...e){return bt("angularfire",Bo.full,"fst"),nr([ZJ,XJ,{provide:Xx,useFactory:JJ(n),multi:!0,deps:[gt,At,$o,Ac,[new or,tp],[new or,xu],...e]}])}var F0=En(Pj,!0,2);var ma=En(wj,!0,2);var V0=En(Mj,!0,2);var ya=En(zx,!0,2);var Zx=En(kj,!0);var Lj=En(Ij,!0);var L0=En(Oj,!0);var Uj=En(xj,!0,2),U0=En(Dj,!0,2);var Md=En(Nj,!0,2);var jj=En(Aj,!0,2);var Pd={production:!0,firebase:{apiKey:"AIzaSyA3FfYeMQ9WiWHlNKU1wsaMt8v3TOuNn_I",authDomain:"homeneeds-21223.firebaseapp.com",projectId:"homeneeds-21223",storageBucket:"homeneeds-21223.firebasestorage.app",messagingSenderId:"278167644572",appId:"1:278167644572:web:c5ca2a5c3e4da71fda4059",measurementId:"G-HXX054VJJ6"},apiUrl:"https://home-needs-psi.vercel.app"};var Qj=(()=>{class n{_renderer;_elementRef;onChange=t=>{};onTouched=()=>{};constructor(t,r){this._renderer=t,this._elementRef=r}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static \u0275fac=function(r){return new(r||n)(Be(fs),Be(Si))};static \u0275dir=xn({type:n})}return n})(),s1=(()=>{class n extends Qj{static \u0275fac=(()=>{let t;return function(i){return(t||(t=hs(n)))(i||n)}})();static \u0275dir=xn({type:n,features:[gs]})}return n})(),q0=new ae("");var eX={provide:q0,useExisting:ls(()=>Wi),multi:!0};function tX(){let n=Er()?Er().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var nX=new ae(""),Wi=(()=>{class n extends Qj{_compositionMode;_composing=!1;constructor(t,r,i){super(t,r),this._compositionMode=i,this._compositionMode==null&&(this._compositionMode=!tX())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static \u0275fac=function(r){return new(r||n)(Be(fs),Be(Si),Be(nX,8))};static \u0275dir=xn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&Q("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},standalone:!1,features:[uu([eX]),gs]})}return n})();var rX=new ae(""),iX=new ae("");function Yj(n){return n!=null}function Jj(n){return ko(n)?Pt(n):n}function Xj(n){let e={};return n.forEach(t=>{e=t!=null?H(H({},e),t):e}),Object.keys(e).length===0?null:e}function Zj(n,e){return e.map(t=>t(n))}function sX(n){return!n.validate}function e4(n){return n.map(e=>sX(e)?e:t=>e.validate(t))}function oX(n){if(!n)return null;let e=n.filter(Yj);return e.length==0?null:function(t){return Xj(Zj(t,e))}}function t4(n){return n!=null?oX(e4(n)):null}function aX(n){if(!n)return null;let e=n.filter(Yj);return e.length==0?null:function(t){let r=Zj(t,e).map(Jj);return Ow(r).pipe(ut(Xj))}}function n4(n){return n!=null?aX(e4(n)):null}function Bj(n,e){return n===null?[e]:Array.isArray(n)?[...n,e]:[n,e]}function cX(n){return n._rawValidators}function lX(n){return n._rawAsyncValidators}function e1(n){return n?Array.isArray(n)?n:[n]:[]}function B0(n,e){return Array.isArray(n)?n.includes(e):n===e}function $j(n,e){let t=e1(e);return e1(n).forEach(i=>{B0(t,i)||t.push(i)}),t}function Hj(n,e){return e1(e).filter(t=>!B0(n,t))}var $0=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=t4(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=n4(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return this.control?this.control.hasError(e,t):!1}getError(e,t){return this.control?this.control.getError(e,t):null}},t1=class extends $0{name;get formDirective(){return null}get path(){return null}},ng=class extends $0{_parent=null;name=null;valueAccessor=null},n1=class{_cd;constructor(e){this._cd=e}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}};var va=(()=>{class n extends n1{constructor(t){super(t)}static \u0275fac=function(r){return new(r||n)(Be(ng,2))};static \u0275dir=xn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&Rn("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},standalone:!1,features:[gs]})}return n})();var Xp="VALID",j0="INVALID",Od="PENDING",Zp="DISABLED",ol=class{},H0=class extends ol{value;source;constructor(e,t){super(),this.value=e,this.source=t}},eg=class extends ol{pristine;source;constructor(e,t){super(),this.pristine=e,this.source=t}},tg=class extends ol{touched;source;constructor(e,t){super(),this.touched=e,this.source=t}},Fd=class extends ol{status;source;constructor(e,t){super(),this.status=e,this.source=t}};var r1=class extends ol{source;constructor(e){super(),this.source=e}};function uX(n){return(z0(n)?n.validators:n)||null}function dX(n){return Array.isArray(n)?t4(n):n||null}function hX(n,e){return(z0(e)?e.asyncValidators:n)||null}function fX(n){return Array.isArray(n)?n4(n):n||null}function z0(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}var i1=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(e,t){this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get status(){return rn(this.statusReactive)}set status(e){rn(()=>this.statusReactive.set(e))}_status=nt(()=>this.statusReactive());statusReactive=Se(void 0);get valid(){return this.status===Xp}get invalid(){return this.status===j0}get pending(){return this.status==Od}get disabled(){return this.status===Zp}get enabled(){return this.status!==Zp}errors;get pristine(){return rn(this.pristineReactive)}set pristine(e){rn(()=>this.pristineReactive.set(e))}_pristine=nt(()=>this.pristineReactive());pristineReactive=Se(!0);get dirty(){return!this.pristine}get touched(){return rn(this.touchedReactive)}set touched(e){rn(()=>this.touchedReactive.set(e))}_touched=nt(()=>this.touchedReactive());touchedReactive=Se(!1);get untouched(){return!this.touched}_events=new en;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators($j(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators($j(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Hj(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Hj(e,this._rawAsyncValidators))}hasValidator(e){return B0(this._rawValidators,e)}hasAsyncValidator(e){return B0(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){let t=this.touched===!1;this.touched=!0;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsTouched(ce(H({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new tg(!0,r))}markAllAsDirty(e={}){this.markAsDirty({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsDirty(e))}markAllAsTouched(e={}){this.markAsTouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(e))}markAsUntouched(e={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:e.emitEvent,sourceControl:r})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,r),t&&e.emitEvent!==!1&&this._events.next(new tg(!1,r))}markAsDirty(e={}){let t=this.pristine===!0;this.pristine=!1;let r=e.sourceControl??this;this._parent&&!e.onlySelf&&this._parent.markAsDirty(ce(H({},e),{sourceControl:r})),t&&e.emitEvent!==!1&&this._events.next(new eg(!1,r))}markAsPristine(e={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=e.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:e.emitEvent})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e,r),t&&e.emitEvent!==!1&&this._events.next(new eg(!0,r))}markAsPending(e={}){this.status=Od;let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new Fd(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.markAsPending(ce(H({},e),{sourceControl:t}))}disable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Zp,this.errors=null,this._forEachChild(i=>{i.disable(ce(H({},e),{onlySelf:!0}))}),this._updateValue();let r=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new H0(this.value,r)),this._events.next(new Fd(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ce(H({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){let t=this._parentMarkedDirty(e.onlySelf);this.status=Xp,this._forEachChild(r=>{r.enable(ce(H({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ce(H({},e),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e,t){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Xp||this.status===Od)&&this._runAsyncValidator(r,e.emitEvent)}let t=e.sourceControl??this;e.emitEvent!==!1&&(this._events.next(new H0(this.value,t)),this._events.next(new Fd(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(ce(H({},e),{sourceControl:t}))}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Zp:Xp}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e,t){if(this.asyncValidator){this.status=Od,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1,shouldHaveEmitted:e!==!1};let r=Jj(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:e})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let e=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,e}return!1}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(e){let t=e;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e,t,r){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),(e||r)&&this._events.next(new Fd(this.status,t)),this._parent&&this._parent._updateControlsErrors(e,t,r)}_initObservables(){this.valueChanges=new Dt,this.statusChanges=new Dt}_calculateStatus(){return this._allControlsDisabled()?Zp:this.errors?j0:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Od)?Od:this._anyControlsHaveStatus(j0)?j0:Xp}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!e.onlySelf&&this._parent._updatePristine(e,t),i&&this._events.next(new eg(this.pristine,t))}_updateTouched(e={},t){this.touched=this._anyControlsTouched(),this._events.next(new tg(this.touched,t)),this._parent&&!e.onlySelf&&this._parent._updateTouched(e,t)}_onDisabledChange=[];_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){z0(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let t=this._parent&&this._parent.dirty;return!e&&!!t&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=dX(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=fX(this._rawAsyncValidators)}};var r4=new ae("",{factory:()=>o1}),o1="always";function pX(n,e){return[...e.path,n]}function gX(n,e,t=o1){yX(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||t==="always")&&e.valueAccessor.setDisabledState?.(n.disabled),vX(n,e),wX(n,e),_X(n,e),mX(n,e)}function qj(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function mX(n,e){if(e.valueAccessor.setDisabledState){let t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}function yX(n,e){let t=cX(n);e.validator!==null?n.setValidators(Bj(t,e.validator)):typeof t=="function"&&n.setValidators([t]);let r=lX(n);e.asyncValidator!==null?n.setAsyncValidators(Bj(r,e.asyncValidator)):typeof r=="function"&&n.setAsyncValidators([r]);let i=()=>n.updateValueAndValidity();qj(e._rawValidators,i),qj(e._rawAsyncValidators,i)}function vX(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&i4(n,e)})}function _X(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&i4(n,e),n.updateOn!=="submit"&&n.markAsTouched()})}function i4(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function wX(n,e){let t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}function IX(n,e){if(!n.hasOwnProperty("model"))return!1;let t=n.model;return t.isFirstChange()?!0:!Object.is(e,t.currentValue)}function EX(n){return Object.getPrototypeOf(n.constructor)===s1}function bX(n,e){if(!e)return null;Array.isArray(e);let t,r,i;return e.forEach(s=>{s.constructor===Wi?t=s:EX(s)?r=s:i=s}),i||r||t||null}function zj(n,e){let t=n.indexOf(e);t>-1&&n.splice(t,1)}function Gj(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var CX=class extends i1{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(e=null,t,r){super(uX(t),hX(r,t)),this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),z0(t)&&(t.nonNullable||t.initialValueIsDefault)&&(Gj(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),t.overwriteDefaultValue&&(this.defaultValue=this.value),this._pendingChange=!1,t?.emitEvent!==!1&&this._events.next(new r1(this))}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){zj(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){zj(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Gj(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var TX={provide:ng,useExisting:ls(()=>Gs)},Wj=Promise.resolve(),Gs=(()=>{class n extends ng{_changeDetectorRef;callSetDisabledState;control=new CX;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Dt;constructor(t,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=bX(this,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),IX(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){gX(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){Wj.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&hu(r);Wj.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?pX(t,this._parent):[t]}static \u0275fac=function(r){return new(r||n)(Be(t1,9),Be(rX,10),Be(iX,10),Be(q0,10),Be(yc,8),Be(r4,8))};static \u0275dir=xn({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[uu([TX]),gs,xo]})}return n})();var SX={provide:q0,useExisting:ls(()=>_a),multi:!0};function s4(n,e){return n==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function DX(n){return n.split(":")[0]}var _a=(()=>{class n extends s1{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;appRefInjector=j(No).injector;destroyRef=j(Ir);cdr=j(yc);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,dy({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(t){this.cdr.markForCheck(),this.value=t;let r=this._getOptionId(t),i=s4(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=DX(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=hs(n)))(i||n)}})();static \u0275dir=xn({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&Q("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[uu([SX]),gs]})}return n})(),Vd=(()=>{class n{_element;_renderer;_select;id;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(s4(this.id,t)),this._select._writeValueAfterRender())}set value(t){this._setElementValue(t),this._select&&this._select._writeValueAfterRender()}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(r){return new(r||n)(Be(Si),Be(fs),Be(_a,9))};static \u0275dir=xn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),AX={provide:q0,useExisting:ls(()=>o4),multi:!0};function Kj(n,e){return n==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${n}: ${e}`.slice(0,50))}function xX(n){return n.split(":")[0]}var o4=(()=>{class n extends s1{value;_optionMap=new Map;_idCounter=0;set compareWith(t){this._compareWith=t}_compareWith=Object.is;writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(s=>this._getOptionId(s));r=(s,o)=>{s._setSelected(i.indexOf(o.toString())>-1)}}else r=(i,s)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],s=r.selectedOptions;if(s!==void 0){let o=s;for(let a=0;a<o.length;a++){let c=o[a],d=this._getOptionValue(c.value);i.push(d)}}else{let o=r.options;for(let a=0;a<o.length;a++){let c=o[a];if(c.selected){let d=this._getOptionValue(c.value);i.push(d)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=xX(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static \u0275fac=(()=>{let t;return function(i){return(t||(t=hs(n)))(i||n)}})();static \u0275dir=xn({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&Q("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[uu([AX]),gs]})}return n})(),Ld=(()=>{class n{_element;_renderer;_select;id;_value;constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(Kj(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(Kj(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(r){return new(r||n)(Be(Si),Be(fs),Be(o4,9))};static \u0275dir=xn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();var RX=(()=>{class n{static \u0275fac=function(r){return new(r||n)};static \u0275mod=ps({type:n});static \u0275inj=yi({})}return n})();var wa=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:r4,useValue:t.callSetDisabledState??o1}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=ps({type:n});static \u0275inj=yi({imports:[RX]})}return n})();var kX="firebase",NX="12.6.0";zo(kX,NX,"app");var kr=class n{firestore=j(si);usersCollection=ma(this.firestore,"users");users=Se([]);currentUser=Se(null);loading=Se(!0);error=Se(null);migrationInProgress=Se(!1);constructor(){this.subscribeToUsers(),this.restoreSession()}subscribeToUsers(){let e=U0(this.usersCollection,Uj("name"));L0(e,t=>{let r=t.docs.map(i=>{let s=i.data();return ce(H({id:i.id},s),{userId:s.userId||null,lastActive:s.lastActive?.toDate?s.lastActive.toDate():s.lastActive,createdAt:s.createdAt?.toDate?s.createdAt.toDate():s.createdAt})});this.users.set(r),this.updateCurrentUserReference(r),this.loading.set(!1),this.migrateUsersWithoutUserId(r)},t=>{console.error("Error fetching users",t),this.error.set(t.message),this.loading.set(!1)})}async migrateUsersWithoutUserId(e){if(this.migrationInProgress())return;let t=e.filter(r=>!r.userId);if(t.length!==0){this.migrationInProgress.set(!0),console.log(`\u{1F504} Migrating ${t.length} user(s) without userId...`);try{let r=t.map(async s=>{let o=this.generateUserId();return console.log(`  \u2192 Migrating user "${s.name}" (${s.id}) \u2192 userId: ${o}`),await this.updateUser(s.id,{userId:o}),{name:s.name,userId:o}}),i=await Promise.all(r);console.log(`\u2705 Successfully migrated ${i.length} user(s):`,i)}catch(r){console.error("\u274C Error during user migration:",r)}finally{this.migrationInProgress.set(!1)}}}restoreSession(){localStorage.getItem("currentUserId")&&this.users().length>0&&this.updateCurrentUserReference(this.users())}updateCurrentUserReference(e){let t=localStorage.getItem("currentUserId");if(t){let r=e.find(i=>i.id===t);r&&(this.currentUser.set(r),r.status!=="active"&&this.updateUser(r.id,{status:"active",lastActive:Nd()}))}}async login(e){if(!e.userId){let t=this.generateUserId();await this.updateUser(e.id,{userId:t}),e=ce(H({},e),{userId:t})}localStorage.setItem("currentUserId",e.id),this.currentUser.set(e),await this.updateUser(e.id,{status:"active",lastActive:Nd()})}async logout(){let e=this.currentUser();e&&await this.updateUser(e.id,{status:"offline",lastActive:Nd()}),localStorage.removeItem("currentUserId"),this.currentUser.set(null)}async createUser(e){let t=this.generateUserId();await F0(this.usersCollection,ce(H({},e),{userId:t,status:e.status||"pending",lastActive:Nd(),createdAt:Nd()}))}generateUserId(){let e=Date.now().toString(36),t=Math.random().toString(36).substring(2,8);return`user_${e}_${t}`}async updateUser(e,t){await Md(ya(this.firestore,"users",e),t)}async deleteUser(e){await V0(ya(this.firestore,"users",e))}async manualMigrateAllUsers(){let t=this.users().filter(s=>!s.userId);if(t.length===0)return console.log("\u2705 All users already have userId assigned."),{migrated:0,errors:0};let r=0,i=0;for(let s of t)try{let o=this.generateUserId();await this.updateUser(s.id,{userId:o}),console.log(`\u2705 Migrated user "${s.name}" \u2192 ${o}`),r++}catch(o){console.error(`\u274C Failed to migrate user "${s.name}":`,o),i++}return{migrated:r,errors:i}}getUsersNeedingMigration(){return this.users().filter(e=>!e.userId)}static \u0275fac=function(t){return new(t||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ki=class n{userService=j(kr);firestore;TASKS_COLLECTION="overview_tasks";tasksSignal=Se([]);tasks=nt(()=>this.tasksSignal());unsubTasks=null;constructor(){let e=Wf(Pd.firebase);this.firestore=V_(e),Ao(()=>{let t=this.userService.currentUser();this.cleanupSubscription(),t?this.initRealtimeData(t.userId):this.tasksSignal.set([])})}getCurrentUserId(){return this.userService.currentUser()?.userId||""}cleanupSubscription(){this.unsubTasks&&(this.unsubTasks(),this.unsubTasks=null)}initRealtimeData(e){if(!e)return;let t=Tp(bp(this.firestore,this.TASKS_COLLECTION),Sp("userId","==",e));this.unsubTasks=xp(t,r=>{let i=r.docs.map(s=>{let o=s.data(),a=o.dueDate&&typeof o.dueDate.toDate=="function"?o.dueDate.toDate():o.dueDate?new Date(o.dueDate):null,c=o.createdAt&&typeof o.createdAt.toDate=="function"?o.createdAt.toDate():new Date;return ce(H({},o),{dueDate:a,createdAt:c})});i.sort((s,o)=>new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime()),this.tasksSignal.set(i)})}async createTask(e){let t=this.getCurrentUserId();if(!t)throw new Error("User must be logged in to create tasks");let r=`task_${Date.now()}_${Math.random().toString(36).substr(2,5)}`;await ad(Ar(this.firestore,this.TASKS_COLLECTION,r),ce(H({},e),{id:r,userId:t,createdAt:new Date}))}async updateTask(e,t){await Dp(Ar(this.firestore,this.TASKS_COLLECTION,e),t)}async deleteTask(e){await Ap(Ar(this.firestore,this.TASKS_COLLECTION,e))}ngOnDestroy(){this.cleanupSubscription()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var rg=["bg-red-500","bg-orange-500","bg-amber-500","bg-green-500","bg-emerald-500","bg-teal-500","bg-cyan-500","bg-blue-500","bg-indigo-500","bg-violet-500","bg-purple-500","bg-fuchsia-500","bg-pink-500","bg-rose-500","bg-slate-500"],a4=[{id:"groceries",label:"Groceries",color:"bg-amber-400",textColor:"text-amber-400"},{id:"chores",label:"Chores",color:"bg-blue-400",textColor:"text-blue-400"},{id:"repairs",label:"Repairs",color:"bg-purple-500",textColor:"text-purple-400"},{id:"other",label:"Other",color:"bg-slate-400",textColor:"text-slate-400"}];var Nr=class n{dialog=Se(null);confirm(e,t="Confirm"){return new Promise(r=>{this.dialog.set({message:e,title:t,type:"confirm",confirmText:"Confirm",cancelText:"Cancel",resolve:r})})}alert(e,t="Alert"){return new Promise(r=>{this.dialog.set({message:e,title:t,type:"info",confirmText:"OK",resolve:r})})}close(e){let t=this.dialog();t&&(t.resolve(e),this.dialog.set(null))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var Ud=class n{firestore=j(si);userService=j(kr);COLLECTION="assignees";assigneesSignal=Se([]);assignees=nt(()=>this.assigneesSignal());unsubAssignees=null;constructor(){Ao(()=>{let e=this.userService.currentUser();this.cleanupSubscription(),e?this.subscribeToAssignees(e.userId):this.assigneesSignal.set([])})}getCurrentUserId(){return this.userService.currentUser()?.userId||""}cleanupSubscription(){this.unsubAssignees&&(this.unsubAssignees(),this.unsubAssignees=null)}subscribeToAssignees(e){if(!e)return;let t=U0(ma(this.firestore,this.COLLECTION),jj("userId","==",e));this.unsubAssignees=L0(t,r=>{let i=r.docs.map(s=>H({id:s.id},s.data()));i.sort((s,o)=>s.name.localeCompare(o.name)),this.assigneesSignal.set(i)},r=>{console.error("Error fetching assignees:",r)})}async createAssignee(e,t){let r=this.getCurrentUserId();if(!r)throw new Error("User must be logged in to create assignees");let i=e.charAt(0).toUpperCase();await F0(ma(this.firestore,this.COLLECTION),{name:e,color:t,initial:i,userId:r})}async updateAssignee(e,t){t.name&&(t.initial=t.name.charAt(0).toUpperCase()),await Md(ya(this.firestore,this.COLLECTION,e),t)}async deleteAssignee(e){await V0(ya(this.firestore,this.COLLECTION,e))}getAssignee(e){return this.assigneesSignal().find(t=>t.id===e)}ngOnDestroy(){this.cleanupSubscription()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var MX=(n,e)=>e.id;function PX(n,e){if(n&1){let t=Oe();x(0,"button",17),Q("click",function(){let i=X(t).$implicit,s=B();return Z(s.assigneeColor=i)}),R()}if(n&2){let t=e.$implicit,r=B();ft(t),Rn("ring-slate-400",r.assigneeColor===t)("ring-transparent",r.assigneeColor!==t)}}function OX(n,e){if(n&1){let t=Oe();x(0,"button",18),Q("click",function(){X(t);let i=B();return Z(i.resetForm())}),N(1," Cancel "),R()}}function FX(n,e){if(n&1){let t=Oe();x(0,"div",15)(1,"div",19)(2,"div",20),N(3),R(),x(4,"span",21),N(5),R()(),x(6,"div",22)(7,"button",23),Q("click",function(){let i=X(t).$implicit,s=B();return Z(s.editAssignee(i))}),x(8,"span",24),N(9,"edit"),R()(),x(10,"button",25),Q("click",function(){let i=X(t).$implicit,s=B();return Z(s.deleteAssignee(i.id))}),x(11,"span",24),N(12,"delete"),R()()()()}if(n&2){let t=e.$implicit;V(2),ft(t.color),V(),lt(" ",t.initial," "),V(2),Re(t.name)}}function VX(n,e){n&1&&(x(0,"div",16),N(1,"No assignees yet"),R())}var W0=class n{close=new Dt;assigneeService=j(Ud);overviewService=j(Ki);dialogService=j(Nr);assignees=this.assigneeService.assignees;assigneeColors=rg;editingAssignee=null;assigneeName="";assigneeColor=rg[0];onClose(){this.close.emit()}resetForm(){this.editingAssignee=null,this.assigneeName="",this.assigneeColor=this.assigneeColors[0]}editAssignee(e){this.editingAssignee=e,this.assigneeName=e.name,this.assigneeColor=e.color}async saveAssignee(){this.assigneeName.trim()&&(this.editingAssignee?await this.assigneeService.updateAssignee(this.editingAssignee.id,{name:this.assigneeName,color:this.assigneeColor}):await this.assigneeService.createAssignee(this.assigneeName,this.assigneeColor),this.resetForm())}async deleteAssignee(e){if(this.overviewService.tasks().filter(r=>r.assigneeId===e).length>0){await this.dialogService.alert("Cannot delete assignee with active tasks.");return}await this.dialogService.confirm("Delete this assignee?","Confirm")&&await this.assigneeService.deleteAssignee(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Bn({type:n,selectors:[["app-assignee-management"]],outputs:{close:"close"},decls:22,vars:5,consts:[[1,"fixed","inset-0","z-[60]","flex","items-center","justify-center","p-4","bg-black/50","backdrop-blur-sm","animate-in","fade-in","duration-200"],[1,"bg-white","dark:bg-surface-dark","w-full","max-w-sm","rounded-2xl","shadow-xl","overflow-hidden","animate-in","zoom-in-95","duration-200","border","border-slate-200","dark:border-border-dark","flex","flex-col","max-h-[80vh]"],[1,"p-4","border-b","border-slate-100","dark:border-border-dark","flex","justify-between","items-center","bg-slate-50/50","dark:bg-black/20"],[1,"font-bold","text-lg","text-slate-900","dark:text-white"],[1,"p-1","rounded-full","hover:bg-slate-200","dark:hover:bg-border-dark","transition-colors",3,"click"],[1,"material-symbols-outlined"],[1,"flex-1","overflow-y-auto","p-4","space-y-3"],[1,"bg-slate-50","dark:bg-black/20","p-3","rounded-xl","space-y-3"],["type","text","placeholder","Name (e.g. Alex)",1,"w-full","h-10","px-3","rounded-lg","bg-white","dark:bg-surface-dark","border","border-slate-200","dark:border-border-dark","text-sm","focus:border-primary","focus:ring-1","focus:ring-primary","outline-none","text-slate-900","dark:text-white",3,"ngModelChange","ngModel"],[1,"flex","flex-wrap","gap-2"],[1,"size-6","rounded-full","transition-transform","hover:scale-110","ring-2","ring-offset-1","dark:ring-offset-surface-dark",3,"class","ring-slate-400","ring-transparent"],[1,"flex","justify-end","gap-2"],[1,"text-xs","text-slate-500","font-bold","hover:text-slate-700","dark:hover:text-slate-300","px-2"],[1,"h-8","px-4","bg-primary","text-slate-900","rounded-lg","text-xs","font-bold","hover:bg-primary-hover","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"space-y-2"],[1,"flex","items-center","justify-between","p-2","rounded-lg","hover:bg-slate-50","dark:hover:bg-white/5","group","border","border-transparent","hover:border-slate-100","dark:hover:border-border-dark","transition-all"],[1,"text-center","py-6","text-slate-400","text-sm"],[1,"size-6","rounded-full","transition-transform","hover:scale-110","ring-2","ring-offset-1","dark:ring-offset-surface-dark",3,"click"],[1,"text-xs","text-slate-500","font-bold","hover:text-slate-700","dark:hover:text-slate-300","px-2",3,"click"],[1,"flex","items-center","gap-3"],[1,"size-8","rounded-full","flex","items-center","justify-center","text-xs","font-bold","text-white","shadow-sm"],[1,"text-sm","font-bold","text-slate-900","dark:text-white"],[1,"flex","gap-1","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"size-7","rounded","bg-white","dark:bg-black/20","border","border-slate-200","dark:border-border-dark","flex","items-center","justify-center","text-slate-500","hover:text-primary","transition-colors",3,"click"],[1,"material-symbols-outlined","text-[14px]"],[1,"size-7","rounded","bg-white","dark:bg-black/20","border","border-slate-200","dark:border-border-dark","flex","items-center","justify-center","text-slate-500","hover:text-red-500","transition-colors",3,"click"]],template:function(t,r){t&1&&(x(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),N(4,"Manage Assignees"),R(),x(5,"button",4),Q("click",function(){return r.onClose()}),x(6,"span",5),N(7,"close"),R()()(),x(8,"div",6)(9,"div",7)(10,"input",8),on("ngModelChange",function(s){return dn(r.assigneeName,s)||(r.assigneeName=s),s}),R(),x(11,"div",9),wt(12,PX,1,6,"button",10,cu),R(),x(14,"div",11),ye(15,OX,2,0,"button",12),x(16,"button",13),Q("click",function(){return r.saveAssignee()}),N(17),R()()(),x(18,"div",14),wt(19,FX,13,4,"div",15,MX,!1,VX,2,0,"div",16),R()()()()),t&2&&(V(10),sn("ngModel",r.assigneeName),V(2),It(r.assigneeColors),V(3),ve(r.editingAssignee?15:-1),V(),Ge("disabled",!r.assigneeName.trim()),V(),lt(" ",r.editingAssignee?"Update":"Add"," "),V(2),It(r.assignees()))},dependencies:[Cr,wa,Wi,va,Gs],encapsulation:2})};var jd=[{id:"produce",userId:"system",name:"Produce",icon:"nutrition",color:"text-green-500",isDefault:!0,createdAt:new Date},{id:"dairy",userId:"system",name:"Dairy & Eggs",icon:"water_drop",color:"text-blue-400",isDefault:!0,createdAt:new Date},{id:"pantry",userId:"system",name:"Pantry",icon:"soup_kitchen",color:"text-orange-400",isDefault:!0,createdAt:new Date},{id:"baby",userId:"system",name:"Baby Needs",icon:"child_care",color:"text-pink-500",isDefault:!0,createdAt:new Date},{id:"other",userId:"system",name:"Other",icon:"category",color:"text-slate-400",isDefault:!0,createdAt:new Date}],c4=["nutrition","water_drop","soup_kitchen","category","local_dining","bakery_dining","icecream","liquor","coffee","lunch_dining","restaurant","fastfood","ramen_dining","set_meal","egg","cake","cookie","local_pizza","kebab_dining","rice_bowl"],l4=["text-green-500","text-blue-400","text-orange-400","text-slate-400","text-red-500","text-purple-500","text-pink-500","text-yellow-500","text-teal-500","text-indigo-500","text-cyan-500","text-lime-500"];var a1=[{name:"Red Apples",category:"produce",imageUrl:"https://images.pexels.com/photos/102104/pexels-photo-102104.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Bananas",category:"produce",imageUrl:"https://images.pexels.com/photos/2872755/pexels-photo-2872755.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Oranges",category:"produce",imageUrl:"https://images.pexels.com/photos/327098/pexels-photo-327098.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Strawberries",category:"produce",imageUrl:"https://images.pexels.com/photos/46174/strawberries-berries-fruit-freshness-46174.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Blueberries",category:"produce",imageUrl:"https://images.pexels.com/photos/1153655/pexels-photo-1153655.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Grapes",category:"produce",imageUrl:"https://images.pexels.com/photos/60021/grapes-wine-fruit-vines-60021.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Lemons",category:"produce",imageUrl:"https://images.pexels.com/photos/1414110/pexels-photo-1414110.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Limes",category:"produce",imageUrl:"https://images.pexels.com/photos/1435736/pexels-photo-1435736.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Watermelon",category:"produce",imageUrl:"https://images.pexels.com/photos/1313267/pexels-photo-1313267.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Pineapple",category:"produce",imageUrl:"https://images.pexels.com/photos/947879/pexels-photo-947879.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Mangoes",category:"produce",imageUrl:"https://images.pexels.com/photos/918643/pexels-photo-918643.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Avocados",category:"produce",imageUrl:"https://images.pexels.com/photos/557659/pexels-photo-557659.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Peaches",category:"produce",imageUrl:"https://images.pexels.com/photos/1028599/pexels-photo-1028599.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Pears",category:"produce",imageUrl:"https://images.pexels.com/photos/568471/pexels-photo-568471.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cherries",category:"produce",imageUrl:"https://images.pexels.com/photos/175727/pexels-photo-175727.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Kiwi",category:"produce",imageUrl:"https://images.pexels.com/photos/51312/kiwi-fruit-vitamins-healthy-eating-51312.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Raspberries",category:"produce",imageUrl:"https://images.pexels.com/photos/892808/pexels-photo-892808.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Pomegranate",category:"produce",imageUrl:"https://images.pexels.com/photos/65256/pomegranate-open-cores-fruit-65256.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Grapefruit",category:"produce",imageUrl:"https://images.pexels.com/photos/1171170/pexels-photo-1171170.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Coconut",category:"produce",imageUrl:"https://images.pexels.com/photos/1030973/pexels-photo-1030973.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Broccoli",category:"produce",imageUrl:"https://images.pexels.com/photos/47347/broccoli-vegetable-food-healthy-47347.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Carrots",category:"produce",imageUrl:"https://images.pexels.com/photos/143133/pexels-photo-143133.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Spinach",category:"produce",imageUrl:"https://images.pexels.com/photos/2325843/pexels-photo-2325843.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Tomatoes",category:"produce",imageUrl:"https://images.pexels.com/photos/1367242/pexels-photo-1367242.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cucumbers",category:"produce",imageUrl:"https://images.pexels.com/photos/37528/cucumber-salad-food-healthy-37528.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Bell Peppers",category:"produce",imageUrl:"https://images.pexels.com/photos/128536/pexels-photo-128536.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Onions",category:"produce",imageUrl:"https://images.pexels.com/photos/144206/pexels-photo-144206.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Garlic",category:"produce",imageUrl:"https://images.pexels.com/photos/1392585/pexels-photo-1392585.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Potatoes",category:"produce",imageUrl:"https://images.pexels.com/photos/144248/potatoes-vegetables-erdfrucht-bio-144248.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Sweet Potatoes",category:"produce",imageUrl:"https://images.pexels.com/photos/2284166/pexels-photo-2284166.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Lettuce",category:"produce",imageUrl:"https://images.pexels.com/photos/1199562/pexels-photo-1199562.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cabbage",category:"produce",imageUrl:"https://images.pexels.com/photos/2518893/pexels-photo-2518893.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cauliflower",category:"produce",imageUrl:"https://images.pexels.com/photos/6316515/pexels-photo-6316515.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Zucchini",category:"produce",imageUrl:"https://images.pexels.com/photos/128420/pexels-photo-128420.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Eggplant",category:"produce",imageUrl:"https://images.pexels.com/photos/321551/pexels-photo-321551.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Green Beans",category:"produce",imageUrl:"https://images.pexels.com/photos/63286/peas-green-beans-vegetables-63286.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Asparagus",category:"produce",imageUrl:"https://images.pexels.com/photos/351679/pexels-photo-351679.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Celery",category:"produce",imageUrl:"https://images.pexels.com/photos/2893635/pexels-photo-2893635.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Mushrooms",category:"produce",imageUrl:"https://images.pexels.com/photos/36438/mushrooms-brown-mushrooms-cook-eat.jpg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Corn",category:"produce",imageUrl:"https://images.pexels.com/photos/547263/pexels-photo-547263.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Ginger",category:"produce",imageUrl:"https://images.pexels.com/photos/161556/ginger-plant-asia-rhizome-161556.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Fresh Basil",category:"produce",imageUrl:"https://images.pexels.com/photos/1171182/pexels-photo-1171182.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Green Onions",category:"produce",imageUrl:"https://images.pexels.com/photos/4197447/pexels-photo-4197447.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Red Cabbage",category:"produce",imageUrl:"https://images.pexels.com/photos/6316517/pexels-photo-6316517.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Radishes",category:"produce",imageUrl:"https://images.pexels.com/photos/244393/pexels-photo-244393.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1}];var c1=[{name:"Whole Milk",category:"dairy",imageUrl:"https://images.pexels.com/photos/248412/pexels-photo-248412.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"2% Reduced Fat Milk",category:"dairy",imageUrl:"https://images.pexels.com/photos/2198626/pexels-photo-2198626.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Skim Milk",category:"dairy",imageUrl:"https://images.pexels.com/photos/725998/pexels-photo-725998.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Heavy Cream",category:"dairy",imageUrl:"https://images.pexels.com/photos/357573/pexels-photo-357573.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Half & Half",category:"dairy",imageUrl:"https://images.pexels.com/photos/416528/pexels-photo-416528.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Almond Milk",category:"dairy",imageUrl:"https://images.pexels.com/photos/3735180/pexels-photo-3735180.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Oat Milk",category:"dairy",imageUrl:"https://images.pexels.com/photos/5946627/pexels-photo-5946627.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Coconut Milk",category:"dairy",imageUrl:"https://images.pexels.com/photos/4202490/pexels-photo-4202490.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Large Eggs",category:"dairy",imageUrl:"https://images.pexels.com/photos/162712/egg-white-food-protein-162712.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Organic Free Range Eggs",category:"dairy",imageUrl:"https://images.pexels.com/photos/6941041/pexels-photo-6941041.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Egg Whites",category:"dairy",imageUrl:"https://images.pexels.com/photos/4110008/pexels-photo-4110008.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Brown Eggs",category:"dairy",imageUrl:"https://images.pexels.com/photos/4045570/pexels-photo-4045570.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cheddar Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/821365/pexels-photo-821365.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Mozzarella",category:"dairy",imageUrl:"https://images.pexels.com/photos/4109943/pexels-photo-4109943.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Parmesan",category:"dairy",imageUrl:"https://images.pexels.com/photos/4187779/pexels-photo-4187779.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Swiss Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/773253/pexels-photo-773253.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cream Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/4397919/pexels-photo-4397919.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Feta Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/4197908/pexels-photo-4197908.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Blue Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/4198018/pexels-photo-4198018.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Goat Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/4198041/pexels-photo-4198041.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Brie",category:"dairy",imageUrl:"https://images.pexels.com/photos/6287530/pexels-photo-6287530.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cottage Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/5946609/pexels-photo-5946609.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Ricotta",category:"dairy",imageUrl:"https://images.pexels.com/photos/6287535/pexels-photo-6287535.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Shredded Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/4198024/pexels-photo-4198024.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"String Cheese",category:"dairy",imageUrl:"https://images.pexels.com/photos/4198020/pexels-photo-4198020.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Butter",category:"dairy",imageUrl:"https://images.pexels.com/photos/531334/pexels-photo-531334.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Unsalted Butter",category:"dairy",imageUrl:"https://images.pexels.com/photos/4110003/pexels-photo-4110003.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Margarine",category:"dairy",imageUrl:"https://images.pexels.com/photos/4397916/pexels-photo-4397916.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Greek Yogurt",category:"dairy",imageUrl:"https://images.pexels.com/photos/1435706/pexels-photo-1435706.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Plain Yogurt",category:"dairy",imageUrl:"https://images.pexels.com/photos/3669638/pexels-photo-3669638.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Flavored Yogurt",category:"dairy",imageUrl:"https://images.pexels.com/photos/4051580/pexels-photo-4051580.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Yogurt Drinks",category:"dairy",imageUrl:"https://images.pexels.com/photos/3625372/pexels-photo-3625372.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Sour Cream",category:"dairy",imageUrl:"https://images.pexels.com/photos/4397923/pexels-photo-4397923.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Whipped Cream",category:"dairy",imageUrl:"https://images.pexels.com/photos/3026806/pexels-photo-3026806.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1}];var l1=[{name:"Spaghetti",category:"pantry",imageUrl:"https://images.pexels.com/photos/4518844/pexels-photo-4518844.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Penne Pasta",category:"pantry",imageUrl:"https://images.pexels.com/photos/1437267/pexels-photo-1437267.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Macaroni",category:"pantry",imageUrl:"https://images.pexels.com/photos/4518710/pexels-photo-4518710.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Jasmine Rice",category:"pantry",imageUrl:"https://images.pexels.com/photos/4110251/pexels-photo-4110251.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Brown Rice",category:"pantry",imageUrl:"https://images.pexels.com/photos/4110377/pexels-photo-4110377.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Quinoa",category:"pantry",imageUrl:"https://images.pexels.com/photos/6740535/pexels-photo-6740535.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Oatmeal",category:"pantry",imageUrl:"https://images.pexels.com/photos/216951/pexels-photo-216951.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Bread Crumbs",category:"pantry",imageUrl:"https://images.pexels.com/photos/4110476/pexels-photo-4110476.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Canned Tomatoes",category:"pantry",imageUrl:"https://images.pexels.com/photos/5945755/pexels-photo-5945755.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Tomato Sauce",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198012/pexels-photo-4198012.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Tomato Paste",category:"pantry",imageUrl:"https://images.pexels.com/photos/5945757/pexels-photo-5945757.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Black Beans",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198019/pexels-photo-4198019.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Kidney Beans",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198015/pexels-photo-4198015.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Chickpeas",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198017/pexels-photo-4198017.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Canned Corn",category:"pantry",imageUrl:"https://images.pexels.com/photos/7469406/pexels-photo-7469406.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Canned Tuna",category:"pantry",imageUrl:"https://images.pexels.com/photos/5718026/pexels-photo-5718026.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Chicken Broth",category:"pantry",imageUrl:"https://images.pexels.com/photos/5938358/pexels-photo-5938358.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Vegetable Broth",category:"pantry",imageUrl:"https://images.pexels.com/photos/5938356/pexels-photo-5938356.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Coconut Milk (Canned)",category:"pantry",imageUrl:"https://images.pexels.com/photos/4202490/pexels-photo-4202490.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Olive Oil",category:"pantry",imageUrl:"https://images.pexels.com/photos/1022385/pexels-photo-1022385.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Vegetable Oil",category:"pantry",imageUrl:"https://images.pexels.com/photos/4202482/pexels-photo-4202482.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Coconut Oil",category:"pantry",imageUrl:"https://images.pexels.com/photos/4202486/pexels-photo-4202486.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Balsamic Vinegar",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198037/pexels-photo-4198037.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Apple Cider Vinegar",category:"pantry",imageUrl:"https://images.pexels.com/photos/6957100/pexels-photo-6957100.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Soy Sauce",category:"pantry",imageUrl:"https://images.pexels.com/photos/4518578/pexels-photo-4518578.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"All-Purpose Flour",category:"pantry",imageUrl:"https://images.pexels.com/photos/5765/flour-powder-wheat-jar.jpg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Whole Wheat Flour",category:"pantry",imageUrl:"https://images.pexels.com/photos/4110256/pexels-photo-4110256.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Sugar",category:"pantry",imageUrl:"https://images.pexels.com/photos/2523650/pexels-photo-2523650.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Brown Sugar",category:"pantry",imageUrl:"https://images.pexels.com/photos/4110521/pexels-photo-4110521.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Powdered Sugar",category:"pantry",imageUrl:"https://images.pexels.com/photos/5946613/pexels-photo-5946613.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baking Soda",category:"pantry",imageUrl:"https://images.pexels.com/photos/5946608/pexels-photo-5946608.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baking Powder",category:"pantry",imageUrl:"https://images.pexels.com/photos/5946610/pexels-photo-5946610.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Vanilla Extract",category:"pantry",imageUrl:"https://images.pexels.com/photos/5946611/pexels-photo-5946611.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cocoa Powder",category:"pantry",imageUrl:"https://images.pexels.com/photos/65882/chocolate-dark-coffee-confiserie-65882.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Chocolate Chips",category:"pantry",imageUrl:"https://images.pexels.com/photos/918327/pexels-photo-918327.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Yeast",category:"pantry",imageUrl:"https://images.pexels.com/photos/5946612/pexels-photo-5946612.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Honey",category:"pantry",imageUrl:"https://images.pexels.com/photos/302163/pexels-photo-302163.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Maple Syrup",category:"pantry",imageUrl:"https://images.pexels.com/photos/7474239/pexels-photo-7474239.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Peanut Butter",category:"pantry",imageUrl:"https://images.pexels.com/photos/5469076/pexels-photo-5469076.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Almond Butter",category:"pantry",imageUrl:"https://images.pexels.com/photos/5469079/pexels-photo-5469079.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Jam/Jelly",category:"pantry",imageUrl:"https://images.pexels.com/photos/1638927/pexels-photo-1638927.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Nutella",category:"pantry",imageUrl:"https://images.pexels.com/photos/4110533/pexels-photo-4110533.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Salt",category:"pantry",imageUrl:"https://images.pexels.com/photos/3296398/pexels-photo-3296398.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Black Pepper",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198056/pexels-photo-4198056.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Garlic Powder",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198051/pexels-photo-4198051.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Onion Powder",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198053/pexels-photo-4198053.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Paprika",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198054/pexels-photo-4198054.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cumin",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198060/pexels-photo-4198060.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cinnamon",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198055/pexels-photo-4198055.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Italian Seasoning",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198057/pexels-photo-4198057.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Chili Powder",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198059/pexels-photo-4198059.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Oregano",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198062/pexels-photo-4198062.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Bay Leaves",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198064/pexels-photo-4198064.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Ketchup",category:"pantry",imageUrl:"https://images.pexels.com/photos/5945565/pexels-photo-5945565.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Mustard",category:"pantry",imageUrl:"https://images.pexels.com/photos/5945566/pexels-photo-5945566.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Mayonnaise",category:"pantry",imageUrl:"https://images.pexels.com/photos/4397921/pexels-photo-4397921.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Hot Sauce",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198048/pexels-photo-4198048.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"BBQ Sauce",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198047/pexels-photo-4198047.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Worcestershire Sauce",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198044/pexels-photo-4198044.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Almonds",category:"pantry",imageUrl:"https://images.pexels.com/photos/1013420/pexels-photo-1013420.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Walnuts",category:"pantry",imageUrl:"https://images.pexels.com/photos/4202493/pexels-photo-4202493.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cashews",category:"pantry",imageUrl:"https://images.pexels.com/photos/4202491/pexels-photo-4202491.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Raisins",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198033/pexels-photo-4198033.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Dried Cranberries",category:"pantry",imageUrl:"https://images.pexels.com/photos/4198031/pexels-photo-4198031.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Cereal",category:"pantry",imageUrl:"https://images.pexels.com/photos/135525/pexels-photo-135525.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Granola",category:"pantry",imageUrl:"https://images.pexels.com/photos/3872433/pexels-photo-3872433.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Crackers",category:"pantry",imageUrl:"https://images.pexels.com/photos/4110452/pexels-photo-4110452.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Tortilla Chips",category:"pantry",imageUrl:"https://images.pexels.com/photos/5737254/pexels-photo-5737254.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Popcorn",category:"pantry",imageUrl:"https://images.pexels.com/photos/33129/popcorn-movie-party-entertainment.jpg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Coffee",category:"pantry",imageUrl:"https://images.pexels.com/photos/585753/pexels-photo-585753.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Tea",category:"pantry",imageUrl:"https://images.pexels.com/photos/227908/pexels-photo-227908.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Hot Chocolate Mix",category:"pantry",imageUrl:"https://images.pexels.com/photos/5946618/pexels-photo-5946618.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1}];var u1=[{name:"Diapers (Newborn)",category:"baby",imageUrl:"https://placehold.co/200x200/E6E6FA/555555?text=Newborn+Diapers",isInCart:!1,isChecked:!1},{name:"Diapers (Size 1)",category:"baby",imageUrl:"https://placehold.co/200x200/E6E6FA/555555?text=Size+1+Diapers",isInCart:!1,isChecked:!1},{name:"Diapers (Size 2)",category:"baby",imageUrl:"https://placehold.co/200x200/E6E6FA/555555?text=Size+2+Diapers",isInCart:!1,isChecked:!1},{name:"Diapers (Size 3)",category:"baby",imageUrl:"https://placehold.co/200x200/E6E6FA/555555?text=Size+3+Diapers",isInCart:!1,isChecked:!1},{name:"Baby Wipes",category:"baby",imageUrl:"https://placehold.co/200x200/F0FFFF/555555?text=Baby+Wipes",isInCart:!1,isChecked:!1},{name:"Diaper Rash Cream",category:"baby",imageUrl:"https://images.pexels.com/photos/6941883/pexels-photo-6941883.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Diaper Disposal Bags",category:"baby",imageUrl:"https://images.pexels.com/photos/4239013/pexels-photo-4239013.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Formula",category:"baby",imageUrl:"https://images.pexels.com/photos/6941096/pexels-photo-6941096.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Cereal",category:"baby",imageUrl:"https://images.pexels.com/photos/6941098/pexels-photo-6941098.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Food Pouches",category:"baby",imageUrl:"https://images.pexels.com/photos/6941099/pexels-photo-6941099.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Food Jars",category:"baby",imageUrl:"https://images.pexels.com/photos/6941100/pexels-photo-6941100.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Snacks",category:"baby",imageUrl:"https://images.pexels.com/photos/6941101/pexels-photo-6941101.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Puffs",category:"baby",imageUrl:"https://images.pexels.com/photos/6941102/pexels-photo-6941102.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Teething Biscuits",category:"baby",imageUrl:"https://images.pexels.com/photos/6941103/pexels-photo-6941103.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Water",category:"baby",imageUrl:"https://images.pexels.com/photos/1000084/pexels-photo-1000084.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Bottles",category:"baby",imageUrl:"https://placehold.co/200x200/FFFACD/555555?text=Baby+Bottles",isInCart:!1,isChecked:!1},{name:"Bottle Nipples",category:"baby",imageUrl:"https://placehold.co/200x200/FFFACD/555555?text=Bottle+Nipples",isInCart:!1,isChecked:!1},{name:"Sippy Cups",category:"baby",imageUrl:"https://images.pexels.com/photos/3663068/pexels-photo-3663068.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Spoons",category:"baby",imageUrl:"https://images.pexels.com/photos/6941885/pexels-photo-6941885.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Bowls",category:"baby",imageUrl:"https://images.pexels.com/photos/6941886/pexels-photo-6941886.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Bibs",category:"baby",imageUrl:"https://placehold.co/200x200/FFE4E1/555555?text=Baby+Bibs",isInCart:!1,isChecked:!1},{name:"Bottle Brush",category:"baby",imageUrl:"https://images.pexels.com/photos/6941887/pexels-photo-6941887.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Bottle Sterilizer",category:"baby",imageUrl:"https://images.pexels.com/photos/6941888/pexels-photo-6941888.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Shampoo",category:"baby",imageUrl:"https://images.pexels.com/photos/3993398/pexels-photo-3993398.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Body Wash",category:"baby",imageUrl:"https://images.pexels.com/photos/3993399/pexels-photo-3993399.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Lotion",category:"baby",imageUrl:"https://images.pexels.com/photos/6941889/pexels-photo-6941889.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Oil",category:"baby",imageUrl:"https://images.pexels.com/photos/6941890/pexels-photo-6941890.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Powder",category:"baby",imageUrl:"https://images.pexels.com/photos/6941891/pexels-photo-6941891.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Sunscreen",category:"baby",imageUrl:"https://images.pexels.com/photos/6941892/pexels-photo-6941892.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Nail Clippers",category:"baby",imageUrl:"https://images.pexels.com/photos/6941893/pexels-photo-6941893.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Thermometer",category:"baby",imageUrl:"https://images.pexels.com/photos/6941894/pexels-photo-6941894.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Nasal Aspirator",category:"baby",imageUrl:"https://images.pexels.com/photos/6941895/pexels-photo-6941895.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Cotton Balls",category:"baby",imageUrl:"https://images.pexels.com/photos/4465124/pexels-photo-4465124.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Q-Tips",category:"baby",imageUrl:"https://images.pexels.com/photos/4465125/pexels-photo-4465125.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Tylenol",category:"baby",imageUrl:"https://images.pexels.com/photos/6941900/pexels-photo-6941900.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Baby Ibuprofen",category:"baby",imageUrl:"https://images.pexels.com/photos/6941901/pexels-photo-6941901.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Gripe Water",category:"baby",imageUrl:"https://images.pexels.com/photos/6941902/pexels-photo-6941902.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Gas Drops",category:"baby",imageUrl:"https://images.pexels.com/photos/6941903/pexels-photo-6941903.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Teething Gel",category:"baby",imageUrl:"https://images.pexels.com/photos/6941904/pexels-photo-6941904.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Saline Drops",category:"baby",imageUrl:"https://images.pexels.com/photos/6941905/pexels-photo-6941905.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Vitamin D Drops",category:"baby",imageUrl:"https://images.pexels.com/photos/6941906/pexels-photo-6941906.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Pacifiers",category:"baby",imageUrl:"https://placehold.co/200x200/FFB6C1/555555?text=Pacifiers",isInCart:!1,isChecked:!1},{name:"Teething Toys",category:"baby",imageUrl:"https://placehold.co/200x200/FFB6C1/555555?text=Teething+Toys",isInCart:!1,isChecked:!1},{name:"Baby Blanket",category:"baby",imageUrl:"https://placehold.co/200x200/FFE4E1/555555?text=Baby+Blanket",isInCart:!1,isChecked:!1},{name:"Swaddle Wrap",category:"baby",imageUrl:"https://placehold.co/200x200/FFE4E1/555555?text=Swaddle+Wrap",isInCart:!1,isChecked:!1},{name:"Burp Cloths",category:"baby",imageUrl:"https://placehold.co/200x200/FFE4E1/555555?text=Burp+Cloths",isInCart:!1,isChecked:!1},{name:"Baby Detergent",category:"baby",imageUrl:"https://images.pexels.com/photos/4239091/pexels-photo-4239091.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Stain Remover",category:"baby",imageUrl:"https://images.pexels.com/photos/4239092/pexels-photo-4239092.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1},{name:"Fabric Softener",category:"baby",imageUrl:"https://images.pexels.com/photos/4239093/pexels-photo-4239093.jpeg?auto=compress&cs=tinysrgb&w=200&h=200&fit=crop",isInCart:!1,isChecked:!1}];var Bd=class n{userService=j(kr);firestore;GROCERIES_COLLECTION="groceries";CATEGORIES_COLLECTION="categories";unsubGroceries=null;unsubCategories=null;groceriesSignal=Se([]);categoriesSignal=Se([...jd]);searchQuerySignal=Se("");selectedCategorySignal=Se("all");sortBySignal=Se("name");isLoadingSignal=Se(!0);errorSignal=Se(null);isSeededSignal=Se(!1);categories=nt(()=>this.categoriesSignal());categoryIds=nt(()=>this.categoriesSignal().map(e=>e.id));isLoading=nt(()=>this.isLoadingSignal());groceries=nt(()=>{let e=this.groceriesSignal(),t=this.searchQuerySignal().toLowerCase(),r=this.selectedCategorySignal(),i=this.sortBySignal();return t&&(e=e.filter(s=>s.name.toLowerCase().includes(t))),r==="cart"?e=e.filter(s=>s.isInCart):r!=="all"&&(e=e.filter(s=>s.category===r)),e=[...e].sort((s,o)=>{switch(i){case"name":return s.name.localeCompare(o.name);case"category":return s.category.localeCompare(o.category);case"date":return new Date(o.createdAt).getTime()-new Date(s.createdAt).getTime();default:return 0}}),e});cartItems=nt(()=>this.groceriesSignal().filter(e=>e.isInCart));checkedItems=nt(()=>this.cartItems().filter(e=>e.isChecked));uncheckedItems=nt(()=>this.cartItems().filter(e=>!e.isChecked));searchQuery=nt(()=>this.searchQuerySignal());selectedCategory=nt(()=>this.selectedCategorySignal());sortBy=nt(()=>this.sortBySignal());error=nt(()=>this.errorSignal());groceriesByCategory=nt(()=>{let e=this.groceries(),t=this.categoriesSignal(),r={};return t.forEach(i=>{r[i.id]=[]}),e.forEach(i=>{r[i.category]?r[i.category].push(i):r.other&&r.other.push(i)}),r});constructor(){let e=Wf(Pd.firebase);this.firestore=V_(e),Ao(()=>{let t=this.userService.currentUser();this.cleanupSubscriptions(),t?(this.initializeFirestoreListeners(t.userId),this.checkAndMigrateData(t.userId)):(this.groceriesSignal.set([]),this.categoriesSignal.set([...jd]),this.isLoadingSignal.set(!1))})}getCurrentUserId(){return this.userService.currentUser()?.userId||""}cleanupSubscriptions(){this.unsubGroceries&&(this.unsubGroceries(),this.unsubGroceries=null),this.unsubCategories&&(this.unsubCategories(),this.unsubCategories=null)}initializeFirestoreListeners(e){if(!e)return;this.isLoadingSignal.set(!0);let t=Tp(bp(this.firestore,this.GROCERIES_COLLECTION),Sp("userId","==",e));this.unsubGroceries=xp(t,i=>{let s=i.docs.map(o=>{let a=o.data();return ce(H({id:o.id},a),{createdAt:a.createdAt?.toDate?a.createdAt.toDate():new Date(a.createdAt),updatedAt:a.updatedAt?.toDate?a.updatedAt.toDate():new Date(a.updatedAt)})});this.groceriesSignal.set(s),this.isLoadingSignal.set(!1),s.length===0&&!this.isSeededSignal()&&this.seedInitialData(e)},i=>{console.error("Error loading groceries:",i),this.errorSignal.set(i.message),this.isLoadingSignal.set(!1)});let r=Tp(bp(this.firestore,this.CATEGORIES_COLLECTION),Sp("userId","in",["system",e]));this.unsubCategories=xp(r,i=>{if(i.empty)jd.forEach(s=>this.saveCategoryToFirestore(s)),this.categoriesSignal.set([...jd]);else{let s=i.docs.map(c=>{let d=c.data();return ce(H({id:c.id},d),{createdAt:d.createdAt?.toDate?d.createdAt.toDate():new Date(d.createdAt)})}),o=s.map(c=>c.id),a=jd.filter(c=>!o.includes(c.id));a.length>0?(a.forEach(c=>this.saveCategoryToFirestore(c)),this.categoriesSignal.set([...s,...a])):this.categoriesSignal.set(s)}},i=>{console.error("Error loading categories:",i)})}async seedInitialData(e){if(this.isSeededSignal())return;this.isSeededSignal.set(!0),console.log("Seeding initial grocery data for user:",e);let t=[...a1,...c1,...l1,...u1],r=t.map(i=>this.create(i));await Promise.all(r),console.log(`Seeded ${t.length} grocery items for user ${e}`)}async saveCategoryToFirestore(e){let t=Ar(this.firestore,this.CATEGORIES_COLLECTION,e.id);await ad(t,ce(H({},e),{createdAt:e.createdAt}))}async createCategory(e){let t=this.getCurrentUserId();if(!t)throw new Error("User must be logged in to create categories");let r=ce(H({},e),{id:this.generateCategoryId(e.name),userId:t,isDefault:!1,createdAt:new Date});return await this.saveCategoryToFirestore(r),r}getCategory(e){return this.categoriesSignal().find(t=>t.id===e)}async updateCategory(e,t){let r=this.getCategory(e);if(!r||r.isDefault)return;let i=Ar(this.firestore,this.CATEGORIES_COLLECTION,e);return await Dp(i,t),H(H({},r),t)}deleteCategory(e){let t=this.getCategory(e);if(!t)return{success:!1,error:"Category not found"};if(t.isDefault)return{success:!1,error:"Cannot delete default categories"};let r=this.groceriesSignal().filter(s=>s.category===e);if(r.length>0)return{success:!1,error:`Cannot delete category "${t.name}" because it has ${r.length} item(s). Please move or delete the items first.`};let i=Ar(this.firestore,this.CATEGORIES_COLLECTION,e);return Ap(i),{success:!0}}getItemCountInCategory(e){return this.groceriesSignal().filter(t=>t.category===e).length}getCategoryLabel(e){return this.getCategory(e)?.name||e}getCategoryIcon(e){return this.getCategory(e)?.icon||"category"}getCategoryColor(e){return this.getCategory(e)?.color||"text-slate-400"}setSearchQuery(e){this.searchQuerySignal.set(e)}setCategory(e){this.selectedCategorySignal.set(e)}setSortBy(e){this.sortBySignal.set(e)}async create(e){let t=this.getCurrentUserId();if(!t)throw new Error("User must be logged in to create items");let r=ce(H({},e),{id:this.generateId(),userId:t,createdAt:new Date,updatedAt:new Date}),i=Ar(this.firestore,this.GROCERIES_COLLECTION,r.id);return await ad(i,r),r}async update(e,t){let r=this.groceriesSignal().find(s=>s.id===e);if(!r)return;let i=Ar(this.firestore,this.GROCERIES_COLLECTION,e);return await Dp(i,ce(H({},t),{updatedAt:new Date})),ce(H(H({},r),t),{updatedAt:new Date})}async delete(e){let t=Ar(this.firestore,this.GROCERIES_COLLECTION,e);return await Ap(t),!0}getById(e){return this.groceriesSignal().find(t=>t.id===e)}async addToCart(e){await this.update(e,{isInCart:!0})}async removeFromCart(e){await this.update(e,{isInCart:!1,isChecked:!1})}async toggleChecked(e){let t=this.getById(e);t&&await this.update(e,{isChecked:!t.isChecked})}async clearCart(){let t=this.cartItems().map(r=>this.update(r.id,{isInCart:!1,isChecked:!1}));await Promise.all(t)}async resetToSeedData(){let t=this.groceriesSignal().map(r=>this.delete(r.id));await Promise.all(t),this.isSeededSignal.set(!1)}HISTORY_COLLECTION="shopping_history";async saveToHistory(){let e=this.getCurrentUserId();if(!e)return;let t=this.cartItems();if(t.length===0)return;let r=`history_${Date.now()}`,i=Ar(this.firestore,this.HISTORY_COLLECTION,r),s={id:r,userId:e,date:new Date,itemCount:t.length,items:t.map(o=>({id:o.id,name:o.name,category:o.category,checked:o.isChecked})),completed:!0};await ad(i,s)}generateId(){return`grocery_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}generateCategoryId(e){return`cat_${e.toLowerCase().replace(/\s+/g,"_")}_${Date.now()}`}checkAndMigrateData(e){localStorage.getItem(`homeneeds_seed_version_${e}`)!=="v13"&&(console.log(`Migrating data to v13 for user ${e}...`),this.migrateMissingSeedData().then(()=>{localStorage.setItem(`homeneeds_seed_version_${e}`,"v13")}))}async migrateMissingSeedData(){console.log("Checking for missing seed items...");let e=this.groceriesSignal(),r=[...a1,...c1,...l1,...u1].filter(i=>!e.some(s=>s.name===i.name));r.length>0?(console.log(`Adding ${r.length} missing items...`),await Promise.all(r.map(i=>this.create(i)))):console.log("All seed items are present.")}ngOnDestroy(){this.cleanupSubscriptions()}static \u0275fac=function(t){return new(t||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var Q0=(n,e)=>e.id;function LX(n,e){if(n&1&&kt(0,"img",38),n&2){let t=B().$implicit;Ge("src",t.imageUrl,Qn)}}function UX(n,e){if(n&1&&(x(0,"span",40)(1,"span",46),N(2,"alarm"),R(),N(3),Zh(4,"date"),R()),n&2){let t=B().$implicit;V(3),lt(" ",ef(4,1,t.dueDate,"MMM d, h:mm a")," ")}}function jX(n,e){if(n&1&&(x(0,"div",48),N(1),R()),n&2){let t=e;ft(t.color),Ge("title","Assigned to "+t.name),V(),lt(" ",t.initial," ")}}function BX(n,e){if(n&1&&ye(0,jX,2,4,"div",47),n&2){let t,r=B(4);ve((t=r.getAssigneeById(e))?0:-1,t)}}function $X(n,e){if(n&1&&(x(0,"span",41),N(1),R()),n&2){let t=B().$implicit;V(),Re(t.description)}}function HX(n,e){if(n&1){let t=Oe();x(0,"div",31)(1,"span",32),N(2,"drag_indicator"),R(),x(3,"label",33)(4,"input",34),Q("change",function(){let i=X(t).$implicit,s=B(3);return Z(s.toggleComplete(i))}),R(),x(5,"span",35),N(6,"check"),R()(),x(7,"div",36),Q("click",function(){let i=X(t).$implicit,s=B(3);return Z(s.edit(i))}),x(8,"div",37),ye(9,LX,1,1,"img",38),x(10,"span",39),N(11),R(),ye(12,UX,5,4,"span",40),ye(13,BX,1,1),R(),ye(14,$X,2,1,"span",41),R(),x(15,"div",42)(16,"button",43),Q("click",function(){let i=X(t).$implicit,s=B(3);return Z(s.edit(i))}),x(17,"span",44),N(18,"edit"),R()(),x(19,"button",45),Q("click",function(){let i=X(t).$implicit,s=B(3);return Z(s.delete(i.id))}),x(20,"span",44),N(21,"delete"),R()()()()}if(n&2){let t,r=e.$implicit;Rn("opacity-50",r.isCompleted),V(4),Ge("checked",r.isCompleted),V(5),ve(r.imageUrl?9:-1),V(),Rn("line-through",r.isCompleted)("text-slate-500",r.isCompleted),V(),lt(" ",r.title," "),V(),ve(r.dueDate?12:-1),V(),ve((t=r.assigneeId)?13:-1,t),V(),ve(r.description?14:-1)}}function qX(n,e){if(n&1&&(x(0,"section",24)(1,"div",25)(2,"h3",26),kt(3,"span",27),N(4),R(),x(5,"span",28),N(6),R()(),x(7,"div",29),wt(8,HX,22,12,"div",30,Q0),R()()),n&2){let t=B().$implicit,r=B();Ge("id","section-"+t.id),V(3),ft(t.color),V(),lt(" ",t.label," "),V(),ft(t.color+" "+t.textColor+" bg-opacity-10"),V(),lt(" ",r.groupedTasks()[t.id].length," Items "),V(2),It(r.groupedTasks()[t.id])}}function zX(n,e){if(n&1&&ye(0,qX,10,7,"section",24),n&2){let t=e.$implicit,r=B();ve(r.groupedTasks()[t.id]&&r.groupedTasks()[t.id].length>0?0:-1)}}function GX(n,e){n&1&&(x(0,"div",20)(1,"span",49),N(2,"task_alt"),R(),x(3,"h3",50),N(4,"All caught up!"),R(),x(5,"p",51),N(6,"Create a task to get started."),R()())}function WX(n,e){n&1&&(x(0,"span",77),N(1,"check"),R())}function KX(n,e){if(n&1){let t=Oe();x(0,"button",75),Q("click",function(){let i=X(t).$implicit,s=B(3);return Z(s.selectCategory(i.id))}),kt(1,"span",76),N(2),ye(3,WX,2,0,"span",77),R()}if(n&2){let t=e.$implicit,r=B(3);V(),ft(t.color),V(),lt(" ",t.label," "),V(),ve(r.taskCategory===t.id?3:-1)}}function QX(n,e){if(n&1&&(x(0,"div",63),wt(1,KX,4,4,"button",74,Q0),R()),n&2){let t=B(2);V(),It(t.categories)}}function YX(n,e){if(n&1&&(x(0,"option",69),N(1),R()),n&2){let t=e.$implicit;Ge("value",t.id),V(),Re(t.name)}}function JX(n,e){if(n&1){let t=Oe();x(0,"div",23)(1,"div",52)(2,"div",53)(3,"h3",54),N(4),R(),x(5,"button",55),Q("click",function(){X(t);let i=B();return Z(i.toggleAddModal(!1))}),x(6,"span",56),N(7,"close"),R()()(),x(8,"div",57)(9,"div")(10,"label",58),N(11,"Task Title"),R(),x(12,"input",59),on("ngModelChange",function(i){X(t);let s=B();return dn(s.taskTitle,i)||(s.taskTitle=i),Z(i)}),R()(),x(13,"div")(14,"label",58),N(15,"Category"),R(),x(16,"div",60)(17,"button",61),Q("click",function(){X(t);let i=B();return Z(i.toggleCategoryDropdown())}),x(18,"span"),N(19),R(),x(20,"span",62),N(21,"expand_more"),R()(),ye(22,QX,3,0,"div",63),R()(),x(23,"div")(24,"div",64)(25,"label",65),N(26,"Assignee"),R(),x(27,"button",66),Q("click",function(){X(t);let i=B();return Z(i.openManageAssignees())}),N(28,"Manage"),R()(),x(29,"select",67),on("ngModelChange",function(i){X(t);let s=B();return dn(s.taskAssigneeId,i)||(s.taskAssigneeId=i),Z(i)}),x(30,"option",68),N(31,"Unassigned"),R(),wt(32,YX,2,2,"option",69,Q0),R()(),x(34,"div")(35,"label",58),N(36,"Due Date"),R(),x(37,"input",70),on("ngModelChange",function(i){X(t);let s=B();return dn(s.taskDueDate,i)||(s.taskDueDate=i),Z(i)}),R()()(),x(38,"div",71)(39,"button",72),Q("click",function(){X(t);let i=B();return Z(i.toggleAddModal(!1))}),N(40,"Cancel"),R(),x(41,"button",73),Q("click",function(){X(t);let i=B();return Z(i.saveTask())}),N(42,"Save Task"),R()()()()}if(n&2){let t=B();V(4),Re(t.editingTask?"Edit Task":"New Task"),V(8),sn("ngModel",t.taskTitle),V(7),Re(t.getSelectedCategoryLabel()),V(3),ve(t.showCategoryDropdown?22:-1),V(7),sn("ngModel",t.taskAssigneeId),V(3),It(t.assignees()),V(5),sn("ngModel",t.taskDueDate)}}function XX(n,e){if(n&1){let t=Oe();x(0,"app-assignee-management",78),Q("close",function(){X(t);let i=B();return Z(i.closeAssigneeModal())}),R()}}var K0=class n{overviewService=j(Ki);dialogService=j(Nr);assigneeService=j(Ud);groceryService=j(Bd);tasks=this.overviewService.tasks;assignees=this.assigneeService.assignees;categories=a4;assigneeColors=rg;groupedTasks=nt(()=>{let e=this.tasks(),t={};return this.categories.forEach(r=>t[r.id]=[]),t.other=[],e.forEach(r=>{let i=r.category;t[i]?t[i].push(r):t.other.push(r)}),t});totalPending=nt(()=>this.tasks().filter(e=>!e.isCompleted).length);activeCategoriesCount=nt(()=>{let e=this.groupedTasks();return Object.values(e).filter(t=>t.length>0).length});showAddModal=!1;editingTask=null;taskTitle="";taskCategory="groceries";taskDueDate="";taskAssigneeId="";showCategoryDropdown=!1;showAssigneeModal=!1;constructor(){}toggleAddModal(e){this.showAddModal=e,e||this.resetForm()}resetForm(){this.editingTask=null,this.taskTitle="",this.taskCategory="groceries",this.taskDueDate="",this.taskAssigneeId="",this.showCategoryDropdown=!1}toggleCategoryDropdown(){this.showCategoryDropdown=!this.showCategoryDropdown}selectCategory(e){this.taskCategory=e,this.showCategoryDropdown=!1}getSelectedCategoryLabel(){return this.categories.find(e=>e.id===this.taskCategory)?.label||"Select Category"}async saveTask(){if(!this.taskTitle.trim())return;let e={title:this.taskTitle,category:this.taskCategory,assigneeId:this.taskAssigneeId||void 0,isCompleted:!1,dueDate:this.taskDueDate?new Date(this.taskDueDate):null};this.editingTask?await this.overviewService.updateTask(this.editingTask.id,{title:this.taskTitle,category:this.taskCategory,assigneeId:this.taskAssigneeId||void 0,dueDate:this.taskDueDate?new Date(this.taskDueDate):null}):await this.overviewService.createTask(e),this.toggleAddModal(!1)}async toggleComplete(e){let t=!e.isCompleted;if(await this.overviewService.updateTask(e.id,{isCompleted:t}),t&&e.category==="groceries"){let r=this.groceryService.groceries().find(i=>i.name===e.title);r&&r.isInCart&&await this.groceryService.update(r.id,{isInCart:!1,isChecked:!1})}}async delete(e){if(await this.dialogService.confirm("Delete this task?","Delete Task")){let t=this.tasks().find(r=>r.id===e);if(await this.overviewService.deleteTask(e),t&&t.category==="groceries"){let r=this.groceryService.groceries().find(i=>i.name===t.title);r&&r.isInCart&&await this.groceryService.update(r.id,{isInCart:!1,isChecked:!1})}}}edit(e){this.editingTask=e,this.taskTitle=e.title,this.taskCategory=e.category,this.taskAssigneeId=e.assigneeId||"",this.taskDueDate=e.dueDate?new Date(e.dueDate.getTime()-e.dueDate.getTimezoneOffset()*6e4).toISOString().slice(0,16):"",this.showAddModal=!0}openManageAssignees(){this.showAssigneeModal=!0}closeAssigneeModal(){this.showAssigneeModal=!1}getAssigneeById(e){if(e)return this.assignees().find(t=>t.id===e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Bn({type:n,selectors:[["app-overview"]],hostAttrs:[1,"flex-1","h-screen","flex","flex-col","overflow-hidden"],decls:39,vars:5,consts:[["id","overview-page",1,"flex-1","flex","flex-col","h-screen","overflow-y-auto","relative","bg-slate-50","dark:bg-background-dark"],[1,"px-8","pt-8","pb-4","w-full","z-10","flex","flex-col","gap-4","sticky","top-0","bg-slate-50/90","dark:bg-background-dark/90","backdrop-blur-sm"],[1,"flex","flex-col","w-full","group"],[1,"flex","w-full","items-center","rounded-full","h-14","bg-white","dark:bg-surface-dark","shadow-sm","border","border-slate-200","dark:border-border-dark","focus-within:border-primary","focus-within:ring-1","focus-within:ring-primary","transition-all","duration-300","px-6"],[1,"material-symbols-outlined","text-slate-400","dark:text-text-muted","group-focus-within:text-primary","transition-colors"],["id","overview-search-input","placeholder","Search for items to buy, fix, or clean...",1,"w-full","bg-transparent","border-none","focus:ring-0","text-base","font-medium","text-slate-900","dark:text-white","placeholder:text-slate-400","dark:placeholder:text-text-muted-darker","ml-3"],[1,"bg-primary","hover:bg-primary-hover","text-slate-900","p-2","rounded-full","transition-colors","flex","items-center","justify-center",3,"click"],[1,"material-symbols-outlined","text-[20px]","font-bold"],[1,"flex","items-center","gap-3","px-2"],[1,"text-xs","uppercase","font-bold","text-slate-500","dark:text-text-muted","tracking-wider"],["id","filter-chips",1,"flex","gap-2","text-slate-600","dark:text-slate-400","text-sm"],[1,"px-3","py-1","bg-white","dark:bg-surface-dark","rounded-full","border","border-slate-200","dark:border-border-dark","cursor-pointer","hover:border-primary"],[1,"flex-1","overflow-y-auto","px-8","pb-20","scroll-smooth"],[1,"w-full","flex","flex-col","gap-10"],[1,"flex","flex-wrap","justify-between","items-end","gap-4","mt-4","border-b","border-border-dark","pb-6"],[1,"text-4xl","font-black","text-slate-900","dark:text-white","tracking-tight","mb-2"],[1,"text-slate-500","dark:text-text-muted"],[1,"flex","gap-3"],[1,"flex","items-center","gap-2","px-5","py-2.5","rounded-full","bg-primary","text-slate-900","font-bold","text-sm","hover:bg-primary-hover","transition-colors","shadow-lg","shadow-primary/20",3,"click"],[1,"material-symbols-outlined","text-sm"],[1,"text-center","py-20","animate-in","fade-in","zoom-in-50","duration-500"],[1,"absolute","bottom-10","right-10","w-16","h-16","bg-primary","hover:bg-primary-hover","rounded-full","shadow-2xl","shadow-primary/20","text-slate-900","flex","items-center","justify-center","transition-transform","hover:scale-105","active:scale-95","z-40",3,"click"],[1,"material-symbols-outlined",2,"font-size","32px"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4","bg-black/50","backdrop-blur-sm","animate-in","fade-in","duration-200"],[3,"id"],[1,"flex","items-center","justify-between","mb-5"],[1,"text-2xl","font-bold","text-slate-900","dark:text-white","flex","items-center","gap-3"],[1,"w-2","h-8","rounded-full","block"],[1,"text-xs","font-bold","px-3","py-1","rounded-full","bg-opacity-10"],[1,"grid","grid-cols-1","gap-3"],[1,"group","flex","items-center","gap-3","p-4","rounded-xl","bg-white","dark:bg-surface-dark","border","border-transparent","dark:border-border-dark","hover:border-primary/30","transition-all","duration-200","shadow-sm","hover:shadow-md","dark:shadow-none","relative","overflow-hidden","active:scale-[0.99]","active:shadow-inner",3,"opacity-50"],[1,"group","flex","items-center","gap-3","p-4","rounded-xl","bg-white","dark:bg-surface-dark","border","border-transparent","dark:border-border-dark","hover:border-primary/30","transition-all","duration-200","shadow-sm","hover:shadow-md","dark:shadow-none","relative","overflow-hidden","active:scale-[0.99]","active:shadow-inner"],[1,"material-symbols-outlined","text-slate-300","dark:text-border-dark","group-hover:text-slate-400","dark:group-hover:text-slate-500","cursor-grab","select-none","transition-colors"],[1,"relative","flex","items-center","p-2","rounded-full","cursor-pointer"],["type","checkbox",1,"peer","h-6","w-6","cursor-pointer","appearance-none","rounded-full","border-2","border-slate-400","dark:border-slate-500","transition-all","checked:border-primary","checked:bg-primary",3,"change","checked"],[1,"material-symbols-outlined","absolute","inset-0","flex","items-center","justify-center","text-white","text-[18px]","opacity-0","peer-checked:opacity-100","pointer-events-none","transition-opacity"],[1,"flex","flex-col","flex-1","min-w-0","cursor-pointer",3,"click"],[1,"flex","items-center","gap-3"],["alt","",1,"size-8","rounded-lg","object-cover","bg-slate-100","dark:bg-black/20","border","border-slate-200","dark:border-border-dark","shrink-0",3,"src"],[1,"text-base","font-bold","text-slate-900","dark:text-white","group-hover:text-primary","transition-colors","truncate"],[1,"hidden","sm:inline-flex","items-center","gap-1","px-2","py-0.5","rounded-md","text-[10px]","font-bold","uppercase","tracking-wider","bg-slate-100","text-slate-500","dark:bg-slate-800","dark:text-slate-400"],[1,"text-sm","text-slate-500","dark:text-text-muted-darker","truncate"],[1,"flex","items-center","gap-1","sm:gap-2","opacity-100","sm:opacity-0","group-hover:opacity-100","transition-opacity","z-20"],["title","Edit",1,"p-2","text-slate-400","hover:text-white","hover:bg-border-dark","rounded-full","transition-colors",3,"click"],[1,"material-symbols-outlined","text-[20px]"],["title","Delete",1,"p-2","text-slate-400","hover:text-rose-400","hover:bg-border-dark","rounded-full","transition-colors",3,"click"],[1,"material-symbols-outlined","text-[12px]"],[1,"size-6","rounded-full","flex","items-center","justify-center","text-[10px]","font-bold","text-white","ring-2","ring-white","dark:ring-surface-dark","ml-1",3,"title","class"],[1,"size-6","rounded-full","flex","items-center","justify-center","text-[10px]","font-bold","text-white","ring-2","ring-white","dark:ring-surface-dark","ml-1",3,"title"],[1,"material-symbols-outlined","text-6xl","text-slate-300","dark:text-slate-600"],[1,"mt-4","text-xl","font-bold","text-slate-500","dark:text-slate-400"],[1,"text-slate-400","dark:text-slate-500"],[1,"bg-white","dark:bg-surface-dark","w-full","max-w-md","rounded-2xl","shadow-xl","overflow-hidden","animate-in","zoom-in-95","duration-200","border","border-slate-200","dark:border-border-dark"],[1,"p-4","border-b","border-slate-100","dark:border-border-dark","flex","justify-between","items-center"],[1,"font-bold","text-lg","text-slate-900","dark:text-white"],[1,"p-1","rounded-full","hover:bg-slate-100","dark:hover:bg-border-dark","transition-colors",3,"click"],[1,"material-symbols-outlined"],[1,"p-6","space-y-4"],[1,"block","text-sm","font-medium","text-slate-700","dark:text-slate-300","mb-1"],["type","text","placeholder","e.g. Buy Milk",1,"w-full","px-4","py-2","rounded-lg","bg-slate-50","dark:bg-black/20","border","border-slate-200","dark:border-border-dark","focus:border-primary","focus:ring-1","focus:ring-primary","outline-none","text-slate-900","dark:text-white",3,"ngModelChange","ngModel"],[1,"relative"],[1,"w-full","px-4","py-2","rounded-lg","bg-slate-50","dark:bg-black/20","border","border-slate-200","dark:border-border-dark","focus:border-primary","focus:ring-1","focus:ring-primary","outline-none","text-slate-900","dark:text-white","text-left","flex","justify-between","items-center",3,"click"],[1,"material-symbols-outlined","text-slate-500"],[1,"absolute","top-full","left-0","right-0","mt-1","bg-white","dark:bg-surface-dark","border","border-slate-200","dark:border-border-dark","rounded-lg","shadow-xl","z-50","overflow-hidden","animate-in","fade-in","zoom-in-95","duration-100","max-h-48","overflow-y-auto"],[1,"flex","justify-between","items-center","mb-1"],[1,"block","text-sm","font-medium","text-slate-700","dark:text-slate-300"],[1,"text-xs","text-primary","font-bold","hover:underline",3,"click"],[1,"w-full","px-4","py-2","rounded-lg","bg-slate-50","dark:bg-black/20","border","border-slate-200","dark:border-border-dark","focus:border-primary","focus:ring-1","focus:ring-primary","outline-none","text-slate-900","dark:text-white",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["type","datetime-local",1,"w-full","px-4","py-2","rounded-lg","bg-slate-50","dark:bg-black/20","border","border-slate-200","dark:border-border-dark","focus:border-primary","focus:ring-1","focus:ring-primary","outline-none","text-slate-900","dark:text-white",3,"ngModelChange","ngModel"],[1,"p-4","bg-slate-50","dark:bg-black/20","flex","justify-end","gap-3"],[1,"px-4","py-2","rounded-lg","text-slate-600","dark:text-slate-400","font-medium","hover:bg-slate-200","dark:hover:bg-border-dark","transition-colors",3,"click"],[1,"px-4","py-2","rounded-lg","bg-primary","text-slate-900","font-bold","hover:bg-primary-hover","transition-colors","shadow-lg","shadow-primary/20",3,"click"],[1,"w-full","px-4","py-3","text-left","text-slate-700","dark:text-white","hover:bg-slate-50","dark:hover:bg-border-dark","transition-colors","flex","items-center","gap-2"],[1,"w-full","px-4","py-3","text-left","text-slate-700","dark:text-white","hover:bg-slate-50","dark:hover:bg-border-dark","transition-colors","flex","items-center","gap-2",3,"click"],[1,"w-3","h-3","rounded-full"],[1,"material-symbols-outlined","ml-auto","text-primary","text-sm"],[3,"close"]],template:function(t,r){t&1&&(x(0,"main",0)(1,"div",1)(2,"label",2)(3,"div",3)(4,"span",4),N(5,"search"),R(),kt(6,"input",5),x(7,"button",6),Q("click",function(){return r.toggleAddModal(!0)}),x(8,"span",7),N(9,"add"),R()()()(),x(10,"div",8)(11,"span",9),N(12,"Filter by Due Date:"),R(),x(13,"div",10)(14,"span",11),N(15,"All"),R(),x(16,"span",11),N(17,"Today"),R()()()(),x(18,"div",12)(19,"div",13)(20,"div",14)(21,"div")(22,"h2",15),N(23,"My Lists"),R(),x(24,"p",16),N(25),R()(),x(26,"div",17)(27,"button",18),Q("click",function(){return r.toggleAddModal(!0)}),x(28,"span",19),N(29,"add_task"),R(),N(30," New Task "),R()()(),wt(31,zX,1,1,null,null,Q0),ye(33,GX,7,0,"div",20),R()(),x(34,"button",21),Q("click",function(){return r.toggleAddModal(!0)}),x(35,"span",22),N(36,"add"),R()(),ye(37,JX,43,6,"div",23),ye(38,XX,1,0,"app-assignee-management"),R()),t&2&&(V(25),wy("You have ",r.totalPending()," pending items across ",r.activeCategoriesCount()," categories."),V(6),It(r.categories),V(2),ve(r.activeCategoriesCount()===0&&(!r.groupedTasks().other||r.groupedTasks().other.length===0)?33:-1),V(4),ve(r.showAddModal?37:-1),V(),ve(r.showAssigneeModal?38:-1))},dependencies:[Cr,wa,Vd,Ld,Wi,_a,va,Gs,W0,lf],encapsulation:2})};var $d=class n{MAX_WIDTH=400;MAX_HEIGHT=400;QUALITY=.7;async compressImage(e){return new Promise((t,r)=>{let i=new FileReader;i.onload=s=>{let o=new Image;o.onload=()=>{try{let a=document.createElement("canvas"),{width:c,height:d}=o;c>d?c>this.MAX_WIDTH&&(d=Math.round(d*this.MAX_WIDTH/c),c=this.MAX_WIDTH):d>this.MAX_HEIGHT&&(c=Math.round(c*this.MAX_HEIGHT/d),d=this.MAX_HEIGHT),a.width=c,a.height=d;let h=a.getContext("2d");if(!h){r(new Error("Could not get canvas context"));return}h.drawImage(o,0,0,c,d);let p=a.toDataURL("image/jpeg",this.QUALITY);t(p)}catch(a){r(a)}},o.onerror=()=>{r(new Error("Failed to load image"))},o.src=s.target?.result},i.onerror=()=>{r(new Error("Failed to read file"))},i.readAsDataURL(e)})}isValidImageFile(e){return["image/jpeg","image/png","image/gif","image/webp"].includes(e.type)}formatFileSize(e){return e<1024?e+" B":e<1024*1024?(e/1024).toFixed(1)+" KB":(e/(1024*1024)).toFixed(1)+" MB"}static \u0275fac=function(t){return new(t||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var Y0=(n,e)=>e.id,ZX=(n,e)=>e.value;function eZ(n,e){if(n&1){let t=Oe();x(0,"button",40),Q("click",function(){let i=X(t).$implicit,s=B(2);return Z(s.onSortChange(i.value))}),N(1),R()}if(n&2){let t=e.$implicit,r=B(2);Rn("bg-primary-10",r.sortBy()===t.value)("text-primary",r.sortBy()===t.value)("text-slate-700",r.sortBy()!==t.value)("dark:text-slate-300",r.sortBy()!==t.value),V(),lt(" ",t.label," ")}}function tZ(n,e){if(n&1&&(x(0,"div",10),wt(1,eZ,2,9,"button",39,ZX),R()),n&2){let t=B();V(),It(t.sortOptions)}}function nZ(n,e){if(n&1&&(x(0,"div",15)(1,"div",41)(2,"div",42)(3,"span",43),N(4,"error"),R()(),x(5,"div",44)(6,"h3",45),N(7,"Connection Error"),R(),x(8,"div",46)(9,"p"),N(10),R(),x(11,"p",47),N(12,"Please check your Firestore Security Rules or Auth configuration."),R()()()()()),n&2){let t=B();V(10),Re(t.error())}}function rZ(n,e){if(n&1){let t=Oe();x(0,"div",48)(1,"button",49),Q("click",function(i){X(t);let s=B().$implicit;return B().startEditCategory(s),Z(i.stopPropagation())}),x(2,"span",50),N(3,"edit"),R()(),x(4,"button",51),Q("click",function(i){X(t);let s=B().$implicit;return B().deleteCategory(s.id),Z(i.stopPropagation())}),x(5,"span",50),N(6,"close"),R()()()}}function iZ(n,e){if(n&1){let t=Oe();x(0,"div",30)(1,"button",28),Q("click",function(){let i=X(t).$implicit,s=B();return Z(s.onCategoryChange(i.id))}),x(2,"span",29),N(3),R(),x(4,"p"),N(5),R(),ye(6,rZ,7,0,"div",48),R()()}if(n&2){let t=e.$implicit,r=B();V(),ft(r.selectedCategory()===t.id?"flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-slate-900 dark:bg-white px-4 pr-2 hover:opacity-90 transition-opacity":"flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-white dark:bg-surface-dark border border-slate-200 dark:border-border-dark px-4 pr-2 hover:bg-slate-50 dark:hover:bg-border-dark transition-colors"),V(),ft(t.color),V(),Re(t.icon),V(),ft(r.selectedCategory()===t.id?"text-white dark:text-slate-900 text-sm font-bold":"text-slate-600 dark:text-slate-300 text-sm font-medium"),V(),lt(" ",t.name," "),V(),ve(t.isDefault?-1:6)}}function sZ(n,e){if(n&1){let t=Oe();x(0,"img",66),Q("error",function(i){X(t);let s=B(4);return Z(s.handleImageError(i))}),R()}if(n&2){let t=B().$implicit;Ge("alt",t.name)("src",t.imageUrl,Qn)}}function oZ(n,e){n&1&&(x(0,"div",60)(1,"span",67),N(2,"grocery"),R()())}function aZ(n,e){if(n&1){let t=Oe();x(0,"span",68),N(1,"In Cart"),R(),x(2,"button",69),Q("click",function(){X(t);let i=B().$implicit,s=B(3);return Z(s.removeFromCart(i.id))}),x(3,"span",32),N(4,"remove_shopping_cart"),R()()}}function cZ(n,e){if(n&1){let t=Oe();x(0,"button",70),Q("click",function(){X(t);let i=B().$implicit,s=B(3);return Z(s.addToCart(i.id))}),x(1,"span",4),N(2,"add_shopping_cart"),R()()}}function lZ(n,e){if(n&1){let t=Oe();x(0,"div",57)(1,"div",2)(2,"div",58),ye(3,sZ,1,2,"img",59)(4,oZ,3,0,"div",60),R(),x(5,"div")(6,"h4",61),N(7),R()()(),x(8,"div",62),ye(9,aZ,5,0)(10,cZ,3,0,"button",63),x(11,"button",64),Q("click",function(){let i=X(t).$implicit,s=B(3);return Z(s.startEdit(i))}),x(12,"span",32),N(13,"edit"),R()(),x(14,"button",65),Q("click",function(){let i=X(t).$implicit,s=B(3);return Z(s.deleteItem(i.id))}),x(15,"span",32),N(16,"delete"),R()()()()}if(n&2){let t=e.$implicit;V(3),ve(t.imageUrl?3:4),V(4),Re(t.name),V(2),ve(t.isInCart?9:10)}}function uZ(n,e){if(n&1&&(x(0,"section",52)(1,"div",53)(2,"h3",54)(3,"span",19),N(4),R(),N(5),R(),x(6,"span",55),N(7),R()(),x(8,"div",56),wt(9,lZ,17,3,"div",57,Y0),R()()),n&2){let t=B().$implicit,r=B();Ge("id","section-"+t.id),V(3),ft(t.color),V(),Re(t.icon),V(),lt(" ",t.name," "),V(2),lt("",r.getItemCount(t.id)," items"),V(2),It(r.groceriesByCategory()[t.id])}}function dZ(n,e){if(n&1&&ye(0,uZ,11,6,"section",52),n&2){let t=e.$implicit,r=B();ve(r.groceriesByCategory()[t.id]&&r.groceriesByCategory()[t.id].length>0?0:-1)}}function hZ(n,e){if(n&1){let t=Oe();x(0,"button",76),Q("click",function(){X(t);let i=B(2);return Z(i.onCategoryChange("all"))}),N(1," Browse all items "),R()}}function fZ(n,e){if(n&1&&(x(0,"div",34)(1,"div",71)(2,"span",72),N(3,"search_off"),R()(),x(4,"h3",73),N(5,"No items found"),R(),x(6,"p",74),N(7," We couldn't find any items matching your current filters. "),R(),ye(8,hZ,2,0,"button",75),R()),n&2){let t=B();V(8),ve(t.selectedCategory()!=="all"?8:-1)}}function pZ(n,e){if(n&1&&(x(0,"span",37),N(1),R()),n&2){let t=B();V(),Re(t.getTotalCartItems())}}function gZ(n,e){n&1&&(x(0,"div",83)(1,"span",98),N(2,"progress_activity"),R(),x(3,"span",99),N(4,"Compressing..."),R()())}function mZ(n,e){if(n&1){let t=Oe();x(0,"img",100),Q("error",function(i){X(t);let s=B(2);return Z(s.handleImageError(i))}),R()}if(n&2){let t=B(2);Ge("src",t.editItemImageUrl,Qn)}}function yZ(n,e){n&1&&(x(0,"span",85),N(1,"image"),R())}function vZ(n,e){if(n&1){let t=Oe();x(0,"button",101),Q("click",function(){X(t);let i=B(2);return Z(i.removeImage())}),x(1,"span",50),N(2,"close"),R()()}}function _Z(n,e){if(n&1&&(x(0,"option",94),N(1),R()),n&2){let t=e.$implicit;Ge("value",t.id),V(),Re(t.name)}}function wZ(n,e){if(n&1){let t=Oe();x(0,"div",77),Q("click",function(){X(t);let i=B();return Z(i.cancelEdit())}),x(1,"div",78),Q("click",function(i){return X(t),Z(i.stopPropagation())}),x(2,"h3",79),N(3),R(),x(4,"div",80)(5,"div",81)(6,"div",8)(7,"div",82),ye(8,gZ,5,0,"div",83)(9,mZ,1,1,"img",84)(10,yZ,2,0,"span",85),R(),ye(11,vZ,3,0,"button",86),R(),x(12,"label",87)(13,"input",88),Q("change",function(i){X(t);let s=B();return Z(s.onImageFileSelected(i))}),R(),x(14,"span",89)(15,"span",32),N(16,"upload"),R(),N(17),R()(),x(18,"p",90),N(19,"Images are compressed automatically"),R()(),x(20,"div")(21,"label",91),N(22,"Item Name"),R(),x(23,"input",92),on("ngModelChange",function(i){X(t);let s=B();return dn(s.editItemName,i)||(s.editItemName=i),Z(i)}),R()(),x(24,"div")(25,"label",91),N(26,"Category"),R(),x(27,"select",93),on("ngModelChange",function(i){X(t);let s=B();return dn(s.editItemCategory,i)||(s.editItemCategory=i),Z(i)}),wt(28,_Z,2,2,"option",94,Y0),R()()(),x(30,"div",95)(31,"button",96),Q("click",function(){X(t);let i=B();return Z(i.cancelEdit())}),N(32,"Cancel"),R(),x(33,"button",97),Q("click",function(){X(t);let i=B();return Z(i.saveEdit())}),N(34,"Save"),R()()()()}if(n&2){let t=B();V(3),Re(t.editingItem?"Edit Item":"Add Item"),V(5),ve(t.isUploadingImage?8:t.editItemImageUrl?9:10),V(3),ve(t.editItemImageUrl&&!t.isUploadingImage?11:-1),V(2),Ge("disabled",t.isUploadingImage),V(4),lt(" ",t.editItemImageUrl?"Change Image":"Upload Image"," "),V(6),sn("ngModel",t.editItemName),V(4),sn("ngModel",t.editItemCategory),V(),It(t.categories()),V(5),Ge("disabled",t.isUploadingImage)}}function IZ(n,e){if(n&1){let t=Oe();x(0,"button",28),Q("click",function(){let i=X(t).$implicit,s=B(2);return Z(s.editCategoryIcon=i)}),x(1,"span",19),N(2),R()()}if(n&2){let t=e.$implicit,r=B(2);ft(r.editCategoryIcon===t?"size-10 rounded-lg bg-primary text-white flex items-center justify-center":"size-10 rounded-lg bg-white dark:bg-surface-dark border border-slate-200 dark:border-border-dark flex items-center justify-center hover:border-primary transition-colors"),V(2),Re(t)}}function EZ(n,e){if(n&1){let t=Oe();x(0,"button",28),Q("click",function(){let i=X(t).$implicit,s=B(2);return Z(s.editCategoryColor=i)}),x(1,"span",19),N(2,"circle"),R()()}if(n&2){let t=e.$implicit,r=B(2);ft(r.editCategoryColor===t?"size-10 rounded-lg bg-white dark:bg-surface-dark border-2 border-primary flex items-center justify-center":"size-10 rounded-lg bg-white dark:bg-surface-dark border border-slate-200 dark:border-border-dark flex items-center justify-center hover:border-primary transition-colors"),V(),ft(t)}}function bZ(n,e){if(n&1){let t=Oe();x(0,"div",77),Q("click",function(){X(t);let i=B();return Z(i.closeCategoryModal())}),x(1,"div",78),Q("click",function(i){return X(t),Z(i.stopPropagation())}),x(2,"h3",79),N(3),R(),x(4,"div",80)(5,"div",102)(6,"div",103)(7,"span",104),N(8),R(),x(9,"span",105),N(10),R()()(),x(11,"div")(12,"label",91),N(13,"Category Name"),R(),x(14,"input",106),on("ngModelChange",function(i){X(t);let s=B();return dn(s.editCategoryName,i)||(s.editCategoryName=i),Z(i)}),R()(),x(15,"div")(16,"label",107),N(17,"Icon"),R(),x(18,"div",108),wt(19,IZ,3,3,"button",109,cu),R()(),x(21,"div")(22,"label",107),N(23,"Color"),R(),x(24,"div",110),wt(25,EZ,3,4,"button",109,cu),R()()(),x(27,"div",95)(28,"button",96),Q("click",function(){X(t);let i=B();return Z(i.closeCategoryModal())}),N(29,"Cancel"),R(),x(30,"button",111),Q("click",function(){X(t);let i=B();return Z(i.saveCategory())}),N(31,"Save"),R()()()()}if(n&2){let t=B();V(3),Re(t.editingCategory?"Edit Category":"Add Category"),V(4),ft(t.editCategoryColor),V(),Re(t.editCategoryIcon),V(2),Re(t.editCategoryName||"Category Name"),V(4),sn("ngModel",t.editCategoryName),V(5),It(t.availableIcons),V(6),It(t.availableColors)}}var J0=class n{groceryService=j(Bd);imageService=j($d);dialogService=j(Nr);overviewService=j(Ki);groceries=this.groceryService.groceries;groceriesByCategory=this.groceryService.groceriesByCategory;cartItems=this.groceryService.cartItems;checkedItems=this.groceryService.checkedItems;uncheckedItems=this.groceryService.uncheckedItems;searchQuery=this.groceryService.searchQuery;selectedCategory=this.groceryService.selectedCategory;sortBy=this.groceryService.sortBy;categories=this.groceryService.categories;categoryIds=this.groceryService.categoryIds;error=this.groceryService.error;isLoading=this.groceryService.isLoading;availableIcons=c4;availableColors=l4;newItemName="";showAddModal=!1;isAddingFromSidebar=!1;editingItem=null;editItemName="";editItemCategory="other";editItemImageUrl="";isUploadingImage=!1;showMobileCart=!1;toggleMobileCart(){this.showMobileCart=!this.showMobileCart}showCategoryModal=!1;editingCategory=null;editCategoryName="";editCategoryIcon="category";editCategoryColor="text-slate-400";sortOptions=[{value:"name",label:"Name"},{value:"category",label:"Category"},{value:"date",label:"Date Added"}];showSortDropdown=!1;openAddCategoryModal(){this.editingCategory=null,this.editCategoryName="",this.editCategoryIcon="category",this.editCategoryColor="text-slate-400",this.showCategoryModal=!0}startEditCategory(e){e.isDefault||(this.editingCategory=e,this.editCategoryName=e.name,this.editCategoryIcon=e.icon,this.editCategoryColor=e.color,this.showCategoryModal=!0)}async saveCategory(){this.editCategoryName.trim()&&(this.editingCategory?await this.groceryService.updateCategory(this.editingCategory.id,{name:this.editCategoryName.trim(),icon:this.editCategoryIcon,color:this.editCategoryColor}):await this.groceryService.createCategory({name:this.editCategoryName.trim(),icon:this.editCategoryIcon,color:this.editCategoryColor}),this.closeCategoryModal())}async deleteCategory(e){let t=this.groceryService.getCategory(e);if(!t||t.isDefault)return;let r=this.groceryService.getItemCountInCategory(e);if(r>0){await this.dialogService.alert(`Cannot delete category "${t.name}" because it has ${r} item(s). Please move or delete the items first.`);return}if(await this.dialogService.confirm(`Delete category "${t.name}"?`,"Delete Category")){let i=this.groceryService.deleteCategory(e);!i.success&&i.error&&await this.dialogService.alert(i.error)}}closeCategoryModal(){this.editingCategory=null,this.editCategoryName="",this.editCategoryIcon="category",this.editCategoryColor="text-slate-400",this.showCategoryModal=!1}async onImageFileSelected(e){let t=e.target,r=t.files?.[0];if(r){if(!this.imageService.isValidImageFile(r)){await this.dialogService.alert("Please select a valid image file (JPEG, PNG, GIF, or WebP)");return}this.isUploadingImage=!0;try{let i=await this.imageService.compressImage(r);this.editItemImageUrl=i}catch(i){console.error("Error compressing image:",i),await this.dialogService.alert("Failed to process image. Please try again.")}finally{this.isUploadingImage=!1,t.value=""}}}removeImage(){this.editItemImageUrl=""}onSearch(e){let t=e.target;this.groceryService.setSearchQuery(t.value)}onCategoryChange(e){this.groceryService.setCategory(e)}onSortChange(e){this.groceryService.setSortBy(e),this.showSortDropdown=!1}toggleSortDropdown(){this.showSortDropdown=!this.showSortDropdown}async addItem(){this.newItemName.trim()&&(await this.groceryService.create({name:this.newItemName.trim(),category:"other",isInCart:!1,isChecked:!1}),this.newItemName="")}async addItemWithCategory(e,t){e.trim()&&await this.groceryService.create({name:e.trim(),category:t,isInCart:!1,isChecked:!1})}deleteItem(e){this.groceryService.delete(e)}startEdit(e){this.editingItem=e,this.editItemName=e.name,this.editItemCategory=e.category,this.editItemImageUrl=e.imageUrl||"",this.showAddModal=!0}openAddModal(e=!1){this.isAddingFromSidebar=e,this.editingItem=null,this.editItemName="",this.editItemCategory="other",this.editItemImageUrl="",this.showAddModal=!0}async saveEdit(){this.editItemName.trim()&&(this.editingItem?await this.groceryService.update(this.editingItem.id,{name:this.editItemName.trim(),category:this.editItemCategory,imageUrl:this.editItemImageUrl.trim()||void 0}):(await this.groceryService.create({name:this.editItemName.trim(),category:this.editItemCategory,imageUrl:this.editItemImageUrl.trim()||void 0,isInCart:this.isAddingFromSidebar,isChecked:!1}),this.isAddingFromSidebar&&this.createOverviewTask(this.editItemName.trim(),this.editItemImageUrl.trim()||void 0)),this.cancelEdit())}cancelEdit(){this.editingItem=null,this.editItemName="",this.editItemCategory="other",this.editItemImageUrl="",this.showAddModal=!1}async addToCart(e){await this.groceryService.addToCart(e);let t=this.groceries().find(r=>r.id===e);t&&this.createOverviewTask(t.name,t.imageUrl)}async removeFromCart(e){let t=this.groceries().find(r=>r.id===e);await this.groceryService.removeFromCart(e),t&&this.removeOverviewTask(t.name)}async toggleChecked(e){await this.groceryService.toggleChecked(e)}async clearCart(){let e=this.cartItems();await this.groceryService.clearCart();for(let t of e)this.removeOverviewTask(t.name)}async checkout(){if(this.cartItems().length!==0&&await this.dialogService.confirm("Complete shopping trip and save to history?","Checkout"))try{await this.groceryService.saveToHistory(),await this.groceryService.clearCart()}catch(e){console.error("Checkout failed",e),await this.dialogService.alert("Failed to save history. Please check your connection.")}}getCategoryLabel(e){return this.groceryService.getCategoryLabel(e)}getCategoryIcon(e){return this.groceryService.getCategoryIcon(e)}getCategoryColor(e){return this.groceryService.getCategoryColor(e)}getItemCount(e){return this.groceriesByCategory()[e]?.length||0}getTotalCartItems(){return this.cartItems().length}getProgress(){let e=this.cartItems().length;return e===0?0:this.checkedItems().length/e*100}isDefaultCategory(e){return this.groceryService.getCategory(e)?.isDefault??!1}handleImageError(e){let t=e.target;t.src="https://placehold.co/200x200/cccccc/ffffff?text=No+Image"}async resetData(){await this.dialogService.confirm("This will reset all grocery data to the default seed data. Continue?","Reset Data")&&await this.groceryService.resetToSeedData()}createOverviewTask(e,t){let r=new Date;r.setDate(r.getDate()+3),this.overviewService.createTask({title:e,category:"groceries",isCompleted:!1,dueDate:r,imageUrl:t})}async removeOverviewTask(e){let r=this.overviewService.tasks().find(i=>i.title===e&&i.category==="groceries");r&&await this.overviewService.deleteTask(r.id)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Bn({type:n,selectors:[["app-groceries"]],hostAttrs:[1,"flex-1","h-screen","flex","flex-col","overflow-hidden"],decls:65,vars:16,consts:[["id","groceries-page",1,"flex","flex-col","h-screen","w-full","overflow-hidden"],["id","groceries-header",1,"flex","items-center","justify-between","whitespace-nowrap","border-b","border-solid","border-[#e5e7eb]","dark:border-border-dark","bg-white","dark:bg-background-dark","px-6","py-3","shrink-0","z-20"],[1,"flex","items-center","gap-4"],[1,"size-8","bg-primary","rounded-lg","flex","items-center","justify-center","text-white"],[1,"material-symbols-outlined","text-[20px]"],[1,"text-slate-900","dark:text-white","text-xl","font-bold","leading-tight","tracking-[-0.015em]"],[1,"flex","flex-1","justify-end","gap-6","items-center"],[1,"flex","gap-2"],[1,"relative"],["id","btn-sort",1,"flex","size-10","cursor-pointer","items-center","justify-center","overflow-hidden","rounded-lg","bg-slate-100","dark:bg-border-dark","text-slate-900","dark:text-white","hover:bg-slate-200","dark:hover:bg-[#3b4754]","transition-colors",3,"click"],[1,"absolute","right-0","top-12","w-40","bg-white","dark:bg-surface-dark","border","border-slate-200","dark:border-border-dark","rounded-lg","shadow-xl","z-50","overflow-hidden"],["id","btn-reset","title","Reset to seed data",1,"flex","size-10","cursor-pointer","items-center","justify-center","overflow-hidden","rounded-lg","bg-slate-100","dark:bg-border-dark","text-slate-900","dark:text-white","hover:bg-red-500","hover:text-white","transition-colors",3,"click"],[1,"flex","flex-1","min-h-0"],["id","groceries-main-content",1,"flex-1","min-w-0","overflow-y-auto","bg-background-light","dark:bg-background-dark","relative"],[1,"w-full","mx-auto","px-6","py-8","flex","flex-col","gap-6"],[1,"bg-red-50","dark:bg-red-900/20","border-l-4","border-red-500","p-4","rounded-r-lg"],[1,"flex","flex-col","md:flex-row","gap-4"],[1,"flex-1","relative","group"],[1,"absolute","left-4","top-1/2","-translate-y-1/2","text-slate-400"],[1,"material-symbols-outlined"],["id","groceries-search-input","placeholder","Search for items (e.g. Avocado, Milk)...","type","text",1,"w-full","h-12","pl-12","pr-4","bg-white","dark:bg-surface-dark","border","border-slate-200","dark:border-border-dark","rounded-xl","text-slate-900","dark:text-white","placeholder:text-slate-400","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all","shadow-sm",3,"input","value"],[1,"md:w-[350px]","relative","flex","gap-2"],[1,"flex-1","relative"],["id","groceries-quick-add-input","placeholder","Quick add item...","type","text",1,"w-full","h-12","pl-4","pr-12","bg-white","dark:bg-surface-dark","border","border-slate-200","dark:border-border-dark","rounded-xl","text-slate-900","dark:text-white","placeholder:text-slate-400","focus:outline-none","focus:ring-2","focus:ring-primary","focus:border-transparent","transition-all","shadow-sm",3,"ngModelChange","keyup.enter","ngModel"],["id","btn-quick-add",1,"absolute","right-2","top-2","size-8","bg-primary/10","hover:bg-primary/20","text-primary","rounded-lg","flex","items-center","justify-center","transition-colors",3,"click"],["id","btn-add-custom",1,"h-12","px-4","bg-primary","text-white","rounded-xl","flex","items-center","justify-center","gap-2","hover:bg-blue-600","transition-colors","shadow-lg","shadow-blue-500/20","whitespace-nowrap",3,"click"],[1,"hidden","sm:inline","font-semibold","text-sm"],["id","groceries-filter-chips",1,"flex","gap-3","overflow-x-auto","pb-2","scrollbar-hide","items-center"],[3,"click"],[1,"material-symbols-outlined","text-[16px]"],[1,"relative","group","shrink-0"],[1,"flex","h-9","shrink-0","items-center","justify-center","gap-x-2","rounded-lg","border-2","border-dashed","border-slate-300","dark:border-slate-600","px-4","hover:border-primary","hover:text-primary","transition-colors","text-slate-400",3,"click"],[1,"material-symbols-outlined","text-[18px]"],[1,"text-sm","font-medium"],[1,"flex","flex-col","items-center","justify-center","py-20","text-center","animate-in","fade-in","duration-300"],[1,"h-12"],["id","btn-mobile-cart",1,"xl:hidden","fixed","bottom-6","right-6","size-14","bg-primary","text-white","rounded-full","shadow-xl","shadow-blue-500/40","flex","items-center","justify-center","z-50",3,"click"],[1,"absolute","top-0","right-0","size-5","bg-red-500","rounded-full","border-2","border-background-light","dark:border-background-dark","text-[10px]","font-bold","flex","items-center","justify-center"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50"],[1,"w-full","px-4","py-2","text-left","text-sm","hover:bg-slate-100","dark:hover:bg-border-dark","transition-colors",3,"bg-primary-10","text-primary","text-slate-700","dark:text-slate-300"],[1,"w-full","px-4","py-2","text-left","text-sm","hover:bg-slate-100","dark:hover:bg-border-dark","transition-colors",3,"click"],[1,"flex"],[1,"flex-shrink-0"],[1,"material-symbols-outlined","text-red-500"],[1,"ml-3"],[1,"text-sm","font-medium","text-red-800","dark:text-red-200"],[1,"mt-2","text-sm","text-red-700","dark:text-red-300"],[1,"mt-1","font-semibold"],[1,"flex","items-center","gap-1","ml-1"],[1,"size-5","flex","items-center","justify-center","rounded","hover:bg-black/10","dark:hover:bg-white/10",3,"click"],[1,"material-symbols-outlined","text-[14px]"],[1,"size-5","flex","items-center","justify-center","rounded","hover:bg-red-500/20","text-red-500",3,"click"],[3,"id"],[1,"flex","items-center","justify-between","mb-4"],[1,"text-lg","font-bold","text-slate-900","dark:text-white","flex","items-center","gap-2"],[1,"text-xs","font-medium","text-slate-500","bg-slate-100","dark:bg-border-dark","px-2","py-1","rounded"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"group","bg-white","dark:bg-surface-dark","p-4","rounded-xl","border","border-slate-200","dark:border-border-dark","hover:border-primary/50","dark:hover:border-primary/50","transition-colors","shadow-sm","flex","items-center","justify-between"],[1,"size-12","rounded-lg","bg-slate-50","dark:bg-black/20","overflow-hidden","flex-shrink-0"],[1,"w-full","h-full","object-cover",3,"alt","src"],[1,"w-full","h-full","flex","items-center","justify-center"],[1,"font-semibold","text-slate-900","dark:text-white"],[1,"flex","items-center","gap-2"],["title","Add to cart",1,"size-9","bg-primary","text-white","rounded-lg","flex","items-center","justify-center","hover:bg-blue-600","transition-colors","shadow-lg","shadow-blue-500/20"],["title","Edit",1,"p-2","text-slate-400","hover:text-primary","rounded-full","hover:bg-slate-100","dark:hover:bg-border-dark","transition-colors",3,"click"],["title","Delete",1,"p-2","text-slate-400","hover:text-red-500","rounded-full","hover:bg-slate-100","dark:hover:bg-border-dark","transition-colors",3,"click"],[1,"w-full","h-full","object-cover",3,"error","alt","src"],[1,"material-symbols-outlined","text-slate-400"],[1,"text-xs","text-green-500","font-medium"],["title","Remove from cart",1,"p-2","text-slate-400","hover:text-red-500","rounded-full","hover:bg-slate-100","dark:hover:bg-border-dark","transition-colors",3,"click"],["title","Add to cart",1,"size-9","bg-primary","text-white","rounded-lg","flex","items-center","justify-center","hover:bg-blue-600","transition-colors","shadow-lg","shadow-blue-500/20",3,"click"],[1,"size-24","rounded-full","bg-slate-100","dark:bg-black/20","flex","items-center","justify-center","mb-4"],[1,"material-symbols-outlined","text-4xl","text-slate-300"],[1,"text-lg","font-bold","text-slate-900","dark:text-white"],[1,"text-slate-500","dark:text-slate-400","mt-2","max-w-xs","mx-auto"],[1,"mt-6","text-primary","font-medium","hover:underline"],[1,"mt-6","text-primary","font-medium","hover:underline",3,"click"],[1,"fixed","inset-0","bg-black/50","flex","items-center","justify-center","z-50",3,"click"],[1,"bg-white","dark:bg-surface-dark","rounded-2xl","p-6","w-full","max-w-md","shadow-2xl",3,"click"],[1,"text-lg","font-bold","text-slate-900","dark:text-white","mb-4"],[1,"space-y-4"],[1,"flex","flex-col","items-center","gap-3"],[1,"size-24","rounded-xl","bg-slate-100","dark:bg-black/20","overflow-hidden","flex","items-center","justify-center"],[1,"flex","flex-col","items-center"],["alt","Preview",1,"w-full","h-full","object-cover",3,"src"],[1,"material-symbols-outlined","text-4xl","text-slate-400"],[1,"absolute","-top-2","-right-2","size-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","hover:bg-red-600","transition-colors","shadow-lg"],[1,"cursor-pointer"],["type","file","accept","image/jpeg,image/png,image/gif,image/webp",1,"hidden",3,"change","disabled"],[1,"flex","items-center","gap-2","px-4","py-2","bg-slate-100","dark:bg-border-dark","text-slate-600","dark:text-slate-300","rounded-lg","hover:bg-slate-200","dark:hover:bg-slate-600","transition-colors","text-sm","font-medium"],[1,"text-xs","text-slate-400"],[1,"block","text-sm","font-medium","text-slate-700","dark:text-slate-300","mb-1"],["type","text","placeholder","Enter item name...",1,"w-full","h-12","px-4","bg-white","dark:bg-background-dark","border","border-slate-200","dark:border-border-dark","rounded-xl","text-slate-900","dark:text-white","focus:outline-none","focus:ring-2","focus:ring-primary",3,"ngModelChange","ngModel"],[1,"w-full","h-12","px-4","bg-white","dark:bg-background-dark","border","border-slate-200","dark:border-border-dark","rounded-xl","text-slate-900","dark:text-white","focus:outline-none","focus:ring-2","focus:ring-primary",3,"ngModelChange","ngModel"],[3,"value"],[1,"flex","gap-3","mt-6"],[1,"flex-1","h-10","rounded-lg","border","border-slate-200","dark:border-border-dark","text-slate-600","dark:text-slate-300","font-semibold","text-sm","hover:bg-slate-50","dark:hover:bg-border-dark","transition-colors",3,"click"],[1,"flex-1","h-10","rounded-lg","bg-primary","text-white","font-semibold","text-sm","hover:bg-blue-600","shadow-lg","shadow-blue-500/20","transition-colors","disabled:opacity-50","disabled:cursor-not-allowed",3,"click","disabled"],[1,"material-symbols-outlined","text-2xl","text-primary","animate-spin"],[1,"text-xs","text-slate-400","mt-1"],["alt","Preview",1,"w-full","h-full","object-cover",3,"error","src"],[1,"absolute","-top-2","-right-2","size-6","bg-red-500","text-white","rounded-full","flex","items-center","justify-center","hover:bg-red-600","transition-colors","shadow-lg",3,"click"],[1,"flex","justify-center"],[1,"flex","items-center","gap-3","px-6","py-3","rounded-xl","bg-slate-100","dark:bg-black/20"],[1,"material-symbols-outlined","text-2xl"],[1,"font-bold","text-slate-900","dark:text-white"],["type","text","placeholder","e.g., Frozen Foods, Beverages...",1,"w-full","h-12","px-4","bg-white","dark:bg-background-dark","border","border-slate-200","dark:border-border-dark","rounded-xl","text-slate-900","dark:text-white","focus:outline-none","focus:ring-2","focus:ring-primary",3,"ngModelChange","ngModel"],[1,"block","text-sm","font-medium","text-slate-700","dark:text-slate-300","mb-2"],[1,"flex","flex-wrap","gap-2","max-h-24","overflow-y-auto","p-2","bg-slate-50","dark:bg-black/20","rounded-xl"],[3,"class"],[1,"flex","flex-wrap","gap-2","p-2","bg-slate-50","dark:bg-black/20","rounded-xl"],[1,"flex-1","h-10","rounded-lg","bg-primary","text-white","font-semibold","text-sm","hover:bg-blue-600","shadow-lg","shadow-blue-500/20","transition-colors",3,"click"]],template:function(t,r){t&1&&(x(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"span",4),N(5,"shopping_basket"),R()(),x(6,"h2",5),N(7,"Groceries"),R()(),x(8,"div",6)(9,"div",7)(10,"div",8)(11,"button",9),Q("click",function(){return r.toggleSortDropdown()}),x(12,"span",4),N(13,"sort"),R()(),ye(14,tZ,3,0,"div",10),R(),x(15,"button",11),Q("click",function(){return r.resetData()}),x(16,"span",4),N(17,"restart_alt"),R()()()()(),x(18,"div",12)(19,"main",13)(20,"div",14),ye(21,nZ,13,1,"div",15),x(22,"div",16)(23,"div",17)(24,"div",18)(25,"span",19),N(26,"search"),R()(),x(27,"input",20),Q("input",function(s){return r.onSearch(s)}),R()(),x(28,"div",21)(29,"div",22)(30,"input",23),on("ngModelChange",function(s){return dn(r.newItemName,s)||(r.newItemName=s),s}),Q("keyup.enter",function(){return r.addItem()}),R(),x(31,"button",24),Q("click",function(){return r.addItem()}),x(32,"span",4),N(33,"add"),R()()(),x(34,"button",25),Q("click",function(){return r.openAddModal()}),x(35,"span",4),N(36,"add_circle"),R(),x(37,"span",26),N(38,"New"),R()()()(),x(39,"div",27)(40,"button",28),Q("click",function(){return r.onCategoryChange("all")}),x(41,"p"),N(42," All Items "),R()(),x(43,"button",28),Q("click",function(){return r.onCategoryChange("cart")}),x(44,"span",29),N(45,"shopping_cart"),R(),x(46,"p"),N(47," Shopping List "),R()(),wt(48,iZ,7,9,"div",30,Y0),x(50,"button",31),Q("click",function(){return r.openAddCategoryModal()}),x(51,"span",32),N(52,"add"),R(),x(53,"span",33),N(54,"Add Category"),R()()(),wt(55,dZ,1,1,null,null,Y0),ye(57,fZ,9,1,"div",34),kt(58,"div",35),R()(),x(59,"button",36),Q("click",function(){return r.toggleMobileCart()}),x(60,"span",19),N(61,"shopping_cart"),R(),ye(62,pZ,2,1,"span",37),R()(),ye(63,wZ,35,8,"div",38),ye(64,bZ,32,6,"div",38),R()),t&2&&(V(14),ve(r.showSortDropdown?14:-1),V(7),ve(r.error()?21:-1),V(6),Ge("value",r.searchQuery()),V(3),sn("ngModel",r.newItemName),V(10),ft(r.selectedCategory()==="all"?"flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-slate-900 dark:bg-white px-4 hover:opacity-90 transition-opacity":"flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-white dark:bg-surface-dark border border-slate-200 dark:border-border-dark px-4 hover:bg-slate-50 dark:hover:bg-border-dark transition-colors"),V(),ft(r.selectedCategory()==="all"?"text-white dark:text-slate-900 text-sm font-bold":"text-slate-600 dark:text-slate-300 text-sm font-medium"),V(2),ft(r.selectedCategory()==="cart"?"flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-slate-900 dark:bg-white px-4 hover:opacity-90 transition-opacity":"flex h-9 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-white dark:bg-surface-dark border border-slate-200 dark:border-border-dark px-4 hover:bg-slate-50 dark:hover:bg-border-dark transition-colors"),V(3),ft(r.selectedCategory()==="cart"?"text-white dark:text-slate-900 text-sm font-bold":"text-slate-600 dark:text-slate-300 text-sm font-medium"),V(2),It(r.categories()),V(7),It(r.categories()),V(2),ve(r.groceries().length===0&&!r.isLoading()?57:-1),V(5),ve(r.getTotalCartItems()>0?62:-1),V(),ve(r.showAddModal?63:-1),V(),ve(r.showCategoryModal?64:-1))},dependencies:[Cr,wa,Vd,Ld,Wi,_a,va,Gs],styles:["#groceries-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;height:100%;overflow:hidden}#groceries-main-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;overflow-x:hidden}#groceries-main-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}#groceries-main-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}#groceries-main-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#9ca3af66;border-radius:4px}#groceries-main-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#9ca3af99}#shopping-list-sidebar[_ngcontent-%COMP%]{max-height:100%;height:100%}#cart-items-container[_ngcontent-%COMP%]{flex:1 1 0%;min-height:0;max-height:calc(100vh - 280px);overflow-y:auto}#cart-items-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}#cart-items-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}#cart-items-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#9ca3af80;border-radius:3px}#cart-items-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background-color:#9ca3afb3}"]})};var u4=[{value:"admin",label:"Admin",colorClass:"bg-primary/10 text-primary border-primary/20"},{value:"member",label:"Member",colorClass:"bg-surface-dark text-slate-300 border-border-dark"},{value:"guest",label:"Guest",colorClass:"bg-surface-dark text-text-muted border-border-dark"}];var d4=(n,e)=>e.value,CZ=(n,e)=>e.id;function TZ(n,e){if(n&1&&(x(0,"option",22),N(1),R()),n&2){let t=e.$implicit;Ge("value",t.value),V(),Re(t.label)}}function SZ(n,e){if(n&1&&(x(0,"div",43),N(1),R()),n&2){let t=B().$implicit;V(),Re(t.name.charAt(0).toUpperCase())}}function DZ(n,e){if(n&1){let t=Oe();x(0,"tr",36)(1,"td",41)(2,"div",5)(3,"div",42),ye(4,SZ,2,1,"div",43),R(),x(5,"div",44)(6,"span",45),N(7),R()()()(),x(8,"td",41)(9,"span",46),N(10),R()(),x(11,"td",41)(12,"div",47),kt(13,"div",48),x(14,"span",49),N(15),R()()(),x(16,"td",41)(17,"span",50),N(18),Zh(19,"date"),R()(),x(20,"td",51)(21,"div",52)(22,"button",53),Q("click",function(){let i=X(t).$implicit,s=B();return Z(s.openLoginModal(i))}),x(23,"span",9),N(24,"login"),R()(),x(25,"button",54),Q("click",function(){let i=X(t).$implicit,s=B();return Z(s.openEditModal(i))}),x(26,"span",9),N(27,"edit"),R()(),x(28,"button",55),Q("click",function(){let i=X(t).$implicit,s=B();return Z(s.deleteUser(i))}),x(29,"span",9),N(30,"delete"),R()()()()()}if(n&2){let t,r,i,s=e.$implicit,o=B();V(3),_y("background-image",s.avatarUrl?"url("+s.avatarUrl+")":""),V(),ve(s.avatarUrl?-1:4),V(3),Re(s.name),V(2),ft(o.getRoleClass(s.role)),V(),lt(" ",o.getRoleLabel(s.role)," "),V(3),ft(o.getStatusColor(s.status)),V(),Rn("text-primary",s.status==="pending")("text-white",s.status!=="pending"),V(),lt(" ",o.getStatusLabel(s.status)," "),V(3),lt(" ",s.lastActive?ef(19,19,s.lastActive,"short"):"Never"," "),V(4),Ge("title",((t=o.currentUser())==null?null:t.id)===s.id?"Currently Logged In":"Switch to User")("disabled",((r=o.currentUser())==null?null:r.id)===s.id),V(),Rn("text-primary",((i=o.currentUser())==null?null:i.id)===s.id)}}function AZ(n,e){n&1&&(x(0,"tr")(1,"td",56)(2,"span",57),N(3,"person_off"),R(),x(4,"p"),N(5,"No users found matching your criteria."),R()()())}function xZ(n,e){if(n&1&&kt(0,"img",65),n&2){let t=B(2);Ge("src",t.formAvatarUrl,Qn)}}function RZ(n,e){n&1&&(x(0,"span",66),N(1,"person"),R())}function kZ(n,e){if(n&1){let t=Oe();x(0,"button",80),Q("click",function(i){X(t);let s=B(2);return Z(s.removeAvatar(i))}),x(1,"span",81),N(2,"close"),R()()}}function NZ(n,e){if(n&1&&(x(0,"option",22),N(1),R()),n&2){let t=e.$implicit;Ge("value",t.value),V(),Re(t.label)}}function MZ(n,e){if(n&1){let t=Oe();x(0,"div")(1,"label",73),N(2,"Status"),R(),x(3,"select",76),on("ngModelChange",function(i){X(t);let s=B(2);return dn(s.formStatus,i)||(s.formStatus=i),Z(i)}),x(4,"option",24),N(5,"Active"),R(),x(6,"option",26),N(7,"Inactive"),R(),x(8,"option",25),N(9,"Pending"),R(),x(10,"option",28),N(11,"Away"),R(),x(12,"option",27),N(13,"Offline"),R()()()}if(n&2){let t=B(2);V(3),sn("ngModel",t.formStatus)}}function PZ(n,e){if(n&1){let t=Oe();x(0,"div",40)(1,"div",58)(2,"div",59)(3,"h3",60),N(4),R(),x(5,"button",61),Q("click",function(){X(t);let i=B();return Z(i.closeModal())}),x(6,"span",7),N(7,"close"),R()()(),x(8,"div",62)(9,"div",63)(10,"div",64),Q("click",function(){X(t);let i=YE(23);return Z(i.click())}),ye(11,xZ,1,1,"img",65)(12,RZ,2,0,"span",66),x(13,"div",67)(14,"span",68),N(15,"upload"),R()(),ye(16,kZ,3,0,"button",69),R(),x(17,"div",44)(18,"span",70),N(19,"Profile Photo"),R(),x(20,"span",71),N(21,"Click to upload"),R()(),x(22,"input",72,0),Q("change",function(i){X(t);let s=B();return Z(s.onAvatarSelected(i))}),R()(),x(24,"div")(25,"label",73),N(26,"Full Name"),R(),x(27,"input",74),on("ngModelChange",function(i){X(t);let s=B();return dn(s.formName,i)||(s.formName=i),Z(i)}),R()(),x(28,"div")(29,"label",73),N(30),R(),x(31,"input",75),on("ngModelChange",function(i){X(t);let s=B();return dn(s.formPassword,i)||(s.formPassword=i),Z(i)}),R()(),x(32,"div")(33,"label",73),N(34,"Role"),R(),x(35,"select",76),on("ngModelChange",function(i){X(t);let s=B();return dn(s.formRole,i)||(s.formRole=i),Z(i)}),wt(36,NZ,2,2,"option",22,d4),R()(),ye(38,MZ,14,1,"div"),R(),x(39,"div",77)(40,"button",78),Q("click",function(){X(t);let i=B();return Z(i.closeModal())}),N(41,"Cancel"),R(),x(42,"button",79),Q("click",function(){X(t);let i=B();return Z(i.saveUser())}),N(43,"Save User"),R()()()()}if(n&2){let t=B();V(4),Re(t.editingUser?"Edit User":"New User"),V(7),ve(t.formAvatarUrl?11:12),V(5),ve(t.formAvatarUrl?16:-1),V(11),sn("ngModel",t.formName),V(3),Re(t.editingUser?"New Password (Optional)":"Password"),V(),sn("ngModel",t.formPassword),Ge("placeholder",t.editingUser?"Leave blank to keep current":"Enter password"),V(4),sn("ngModel",t.formRole),V(),It(t.userRoles),V(2),ve(t.editingUser?38:-1)}}function OZ(n,e){if(n&1&&(x(0,"p",86),N(1),R()),n&2){let t=B(2);V(),Re(t.loginError)}}function FZ(n,e){if(n&1){let t=Oe();x(0,"div",40)(1,"div",82)(2,"div",59)(3,"h3",60),N(4),R(),x(5,"button",61),Q("click",function(){X(t);let i=B();return Z(i.closeLoginModal())}),x(6,"span",7),N(7,"close"),R()()(),x(8,"div",62)(9,"div",83)(10,"div",84),kt(11,"img",65),R()(),x(12,"div")(13,"label",73),N(14,"Password"),R(),x(15,"input",85),on("ngModelChange",function(i){X(t);let s=B();return dn(s.loginPasswordInput,i)||(s.loginPasswordInput=i),Z(i)}),Q("keyup.enter",function(){X(t);let i=B();return Z(i.attemptLogin())}),R(),ye(16,OZ,2,1,"p",86),R()(),x(17,"div",77)(18,"button",78),Q("click",function(){X(t);let i=B();return Z(i.closeLoginModal())}),N(19,"Cancel"),R(),x(20,"button",79),Q("click",function(){X(t);let i=B();return Z(i.attemptLogin())}),N(21,"Login"),R()()()()}if(n&2){let t=B();V(4),lt("Login as ",t.loginTargetUser==null?null:t.loginTargetUser.name),V(7),Ge("src",(t.loginTargetUser==null?null:t.loginTargetUser.avatarUrl)||"https://ui-avatars.com/api/?name="+(t.loginTargetUser==null?null:t.loginTargetUser.name)+"&background=random",Qn),V(4),sn("ngModel",t.loginPasswordInput),V(),ve(t.loginError?16:-1)}}var X0=class n{userService=j(kr);dialogService=j(Nr);imageService=j($d);users=this.userService.users;currentUser=this.userService.currentUser;userRoles=u4;showLoginModal=!1;loginTargetUser=null;loginPasswordInput="";loginError="";openLoginModal(e){this.loginTargetUser=e,this.loginPasswordInput="",this.loginError="",this.showLoginModal=!0}closeLoginModal(){this.showLoginModal=!1}async attemptLogin(){if(!this.loginTargetUser)return;if((this.loginTargetUser.password||"")!==this.loginPasswordInput){this.loginError="Incorrect password";return}try{await this.userService.login(this.loginTargetUser)}finally{this.closeLoginModal()}}searchQuery=Se("");roleFilter=Se("All");statusFilter=Se("All");filteredUsers=nt(()=>{let e=this.users(),t=this.searchQuery().toLowerCase(),r=this.roleFilter(),i=this.statusFilter();return t&&(e=e.filter(s=>s.name.toLowerCase().includes(t))),r!=="All"&&(e=e.filter(s=>s.role===r)),i!=="All"&&(e=e.filter(s=>s.status===i)),e});showModal=!1;editingUser=null;formName="";formPassword="";formRole="member";formStatus="active";formAvatarUrl="";openAddModal(){this.editingUser=null,this.resetForm(),this.showModal=!0}openEditModal(e){this.editingUser=e,this.formName=e.name,this.formRole=e.role,this.formStatus=e.status,this.formAvatarUrl=e.avatarUrl||"",this.showModal=!0}closeModal(){this.showModal=!1}resetForm(){this.formName="",this.formPassword="",this.formRole="member",this.formStatus="active",this.formAvatarUrl=""}removeAvatar(e){e.stopPropagation(),this.formAvatarUrl=""}async saveUser(){if(this.formName.trim())try{if(this.editingUser){let e={name:this.formName,role:this.formRole,status:this.formStatus,avatarUrl:this.formAvatarUrl};this.formPassword&&(e.password=this.formPassword),await this.userService.updateUser(this.editingUser.id,e)}else await this.userService.createUser({name:this.formName,password:this.formPassword,role:this.formRole,status:"pending",avatarUrl:this.formAvatarUrl||`https://ui-avatars.com/api/?name=${this.formName}&background=random`})}finally{this.closeModal()}}async deleteUser(e){await this.dialogService.confirm(`Delete user ${e.name}?`,"Delete User")&&await this.userService.deleteUser(e.id)}getRoleLabel(e){return this.userRoles.find(t=>t.value===e)?.label||e}getRoleClass(e){return this.userRoles.find(t=>t.value===e)?.colorClass||"bg-gray-100 text-gray-800"}getStatusColor(e){switch(e){case"active":return"bg-emerald-500 shadow-[0_0_8px_rgba(16,185,129,0.5)]";case"away":return"bg-amber-500 shadow-[0_0_8px_rgba(245,158,11,0.5)]";case"offline":return"bg-gray-500";case"pending":return"border-2 border-primary/50 border-t-transparent animate-spin";default:return"bg-gray-400"}}getStatusLabel(e){return e==="pending"?"Invited":e.charAt(0).toUpperCase()+e.slice(1)}async onAvatarSelected(e){let t=e.target.files?.[0];t&&(this.formAvatarUrl=await this.imageService.compressImage(t))}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Bn({type:n,selectors:[["app-users"]],decls:78,vars:7,consts:[["fileInput",""],[1,"flex-1","flex","flex-col","h-full","overflow-hidden","bg-background-light","dark:bg-background-dark","relative"],[1,"flex","items-center","justify-between","px-8","py-5","border-b","border-border-dark","bg-background-dark","sticky","top-0","z-10"],[1,"flex","flex-col","gap-1"],[1,"text-white","text-2xl","font-bold","leading-tight","tracking-tight"],[1,"flex","items-center","gap-4"],[1,"size-10","rounded-full","bg-surface-dark","hover:bg-border-dark","flex","items-center","justify-center","text-text-muted","hover:text-white","transition-colors"],[1,"material-symbols-outlined"],[1,"bg-primary","hover:bg-primary-hover","text-white","h-10","px-5","rounded-lg","text-sm","font-bold","flex","items-center","gap-2","transition-all","shadow-lg","shadow-primary/20",3,"click"],[1,"material-symbols-outlined","text-[20px]"],[1,"flex-1","overflow-y-auto","p-8"],[1,"max-w-[1200px]","mx-auto","flex","flex-col","gap-6"],[1,"text-text-muted","text-base","max-w-2xl"],[1,"flex","flex-col","sm:flex-row","gap-4","justify-between","items-start","sm:items-center","bg-surface-dark","p-4","rounded-xl","border","border-border-dark"],[1,"relative","w-full","sm:max-w-md","group"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","pointer-events-none"],[1,"material-symbols-outlined","text-text-muted","group-focus-within:text-primary","transition-colors"],["placeholder","Search users by name...","type","text",1,"block","w-full","pl-10","pr-3","py-2.5","border","border-border-dark","rounded-lg","leading-5","bg-background-dark","text-white","placeholder-text-muted","focus:outline-none","focus:ring-1","focus:ring-primary","focus:border-primary","sm:text-sm","transition-all",3,"ngModelChange","ngModel"],[1,"flex","gap-3","w-full","sm:w-auto"],[1,"relative"],[1,"appearance-none","bg-background-dark","border","border-border-dark","text-white","text-sm","rounded-lg","focus:ring-primary","focus:border-primary","block","w-full","pl-3","pr-10","py-2.5","cursor-pointer","hover:border-slate-600","transition-colors",3,"ngModelChange","ngModel"],["value","All"],[3,"value"],[1,"pointer-events-none","absolute","inset-y-0","right-0","flex","items-center","px-2","text-text-muted"],["value","active"],["value","pending"],["value","inactive"],["value","offline"],["value","away"],[1,"bg-surface-dark","rounded-xl","border","border-border-dark","overflow-hidden","shadow-sm"],[1,"overflow-x-auto"],[1,"w-full","text-left","border-collapse"],[1,"border-b","border-border-dark","bg-surface-dark"],[1,"py-4","px-6","text-xs","font-semibold","uppercase","tracking-wider","text-text-muted"],[1,"py-4","px-6","text-xs","font-semibold","uppercase","tracking-wider","text-text-muted","text-right"],[1,"divide-y","divide-border-dark"],[1,"hover:bg-slate-800","transition-colors","group"],[1,"px-6","py-4","border-t","border-border-dark","bg-surface-dark","flex","items-center","justify-between"],[1,"text-sm","text-text-muted"],[1,"font-medium","text-white"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","p-4","bg-black/50","backdrop-blur-sm","animate-in","fade-in","duration-200"],[1,"py-4","px-6","whitespace-nowrap"],[1,"bg-center","bg-no-repeat","bg-cover","rounded-full","size-10","border","border-border-dark","bg-surface-dark","relative","overflow-hidden"],[1,"absolute","inset-0","flex","items-center","justify-center","text-xs","font-bold","text-text-muted","bg-border-dark"],[1,"flex","flex-col"],[1,"text-white","text-sm","font-semibold"],[1,"inline-flex","items-center","px-2.5","py-0.5","rounded-full","text-xs","font-medium","border"],[1,"flex","items-center","gap-2"],[1,"h-2","w-2","rounded-full"],[1,"text-sm"],[1,"text-text-muted","text-sm"],[1,"py-4","px-6","whitespace-nowrap","text-right"],[1,"flex","items-center","justify-end","gap-2","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"p-2","text-text-muted","hover:text-white","hover:bg-border-dark","rounded-lg","transition-colors",3,"click","title","disabled"],["title","Edit User",1,"p-2","text-text-muted","hover:text-white","hover:bg-border-dark","rounded-lg","transition-colors",3,"click"],["title","Delete User",1,"p-2","text-text-muted","hover:text-red-400","hover:bg-border-dark","rounded-lg","transition-colors",3,"click"],["colspan","5",1,"py-12","text-center","text-text-muted"],[1,"material-symbols-outlined","text-4xl","mb-2","opacity-50"],[1,"bg-surface-dark","border","border-border-dark","w-full","max-w-md","rounded-xl","shadow-2xl","overflow-hidden","animate-in","zoom-in-95","duration-200"],[1,"p-6","border-b","border-border-dark","flex","justify-between","items-center","bg-background-dark"],[1,"font-bold","text-lg","text-white"],[1,"p-1","rounded-full","hover:bg-border-dark","text-text-muted","hover:text-white","transition-colors",3,"click"],[1,"p-6","space-y-4"],[1,"flex","items-center","gap-4","pb-2","border-b","border-border-dark"],[1,"relative","size-14","rounded-full","bg-background-dark","border","border-border-dark","overflow-hidden","flex","items-center","justify-center","group","cursor-pointer",3,"click"],[1,"w-full","h-full","object-cover",3,"src"],[1,"material-symbols-outlined","text-text-muted","text-2xl"],[1,"absolute","inset-0","bg-black/50","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"material-symbols-outlined","text-white","text-sm"],["title","Remove Photo",1,"absolute","top-0","right-0","bg-red-500","rounded-full","p-0.5","text-white","z-20","hover:bg-red-600","transition-colors","shadow-sm","flex","items-center","justify-center","transform","translate-x-1/4","-translate-y-1/4"],[1,"text-xs","font-semibold","uppercase","text-text-muted"],[1,"text-xs","text-text-muted"],["type","file","accept","image/*",1,"hidden",3,"change"],[1,"block","text-xs","font-semibold","uppercase","text-text-muted","mb-1.5"],["type","text","placeholder","e.g. Alex Johnson",1,"w-full","bg-background-dark","border","border-border-dark","rounded-lg","px-4","py-2.5","text-white","focus:outline-none","focus:border-primary","focus:ring-1","focus:ring-primary","transition-all",3,"ngModelChange","ngModel"],["type","password",1,"w-full","bg-background-dark","border","border-border-dark","rounded-lg","px-4","py-2.5","text-white","focus:outline-none","focus:border-primary","focus:ring-1","focus:ring-primary","transition-all",3,"ngModelChange","ngModel","placeholder"],[1,"w-full","bg-background-dark","border","border-border-dark","rounded-lg","px-4","py-2.5","text-white","focus:outline-none","focus:border-primary","focus:ring-1","focus:ring-primary","transition-all","appearance-none",3,"ngModelChange","ngModel"],[1,"p-4","bg-background-dark","border-t","border-border-dark","flex","justify-end","gap-3"],[1,"px-5","py-2.5","rounded-lg","border","border-border-dark","text-text-muted","font-bold","text-sm","hover:text-white","hover:border-white","transition-colors",3,"click"],[1,"px-5","py-2.5","rounded-lg","bg-primary","text-white","font-bold","text-sm","hover:bg-primary-hover","transition-colors","shadow-lg","shadow-primary/20",3,"click"],["title","Remove Photo",1,"absolute","top-0","right-0","bg-red-500","rounded-full","p-0.5","text-white","z-20","hover:bg-red-600","transition-colors","shadow-sm","flex","items-center","justify-center","transform","translate-x-1/4","-translate-y-1/4",3,"click"],[1,"material-symbols-outlined","text-[10px]","font-bold"],[1,"bg-surface-dark","border","border-border-dark","w-full","max-w-sm","rounded-xl","shadow-2xl","overflow-hidden","animate-in","zoom-in-95","duration-200"],[1,"flex","justify-center","mb-4"],[1,"relative","size-20","rounded-full","border-2","border-border-dark","overflow-hidden"],["type","password","placeholder","Enter password","autofocus","",1,"w-full","bg-background-dark","border","border-border-dark","rounded-lg","px-4","py-2.5","text-white","focus:outline-none","focus:border-primary","focus:ring-1","focus:ring-primary","transition-all",3,"ngModelChange","keyup.enter","ngModel"],[1,"text-red-400","text-xs","mt-1"]],template:function(t,r){t&1&&(x(0,"div",1)(1,"header",2)(2,"div",3)(3,"h2",4),N(4,"User Management"),R()(),x(5,"div",5)(6,"button",6)(7,"span",7),N(8,"notifications"),R()(),x(9,"button",8),Q("click",function(){return r.openAddModal()}),x(10,"span",9),N(11,"add"),R(),x(12,"span"),N(13,"Add New User"),R()()()(),x(14,"div",10)(15,"div",11)(16,"p",12),N(17," Manage access and roles for your household members. You can invite new family members, assign tasks, and control permissions. "),R(),x(18,"div",13)(19,"div",14)(20,"div",15)(21,"span",16),N(22,"search"),R()(),x(23,"input",17),Q("ngModelChange",function(s){return r.searchQuery.set(s)}),R()(),x(24,"div",18)(25,"div",19)(26,"select",20),Q("ngModelChange",function(s){return r.roleFilter.set(s)}),x(27,"option",21),N(28,"All Roles"),R(),wt(29,TZ,2,2,"option",22,d4),R(),x(31,"div",23)(32,"span",9),N(33,"expand_more"),R()()(),x(34,"div",19)(35,"select",20),Q("ngModelChange",function(s){return r.statusFilter.set(s)}),x(36,"option",21),N(37,"All Status"),R(),x(38,"option",24),N(39,"Active"),R(),x(40,"option",25),N(41,"Pending"),R(),x(42,"option",26),N(43,"Inactive"),R(),x(44,"option",27),N(45,"Offline"),R(),x(46,"option",28),N(47,"Away"),R()(),x(48,"div",23)(49,"span",9),N(50,"expand_more"),R()()()()(),x(51,"div",29)(52,"div",30)(53,"table",31)(54,"thead")(55,"tr",32)(56,"th",33),N(57,"User"),R(),x(58,"th",33),N(59,"Role"),R(),x(60,"th",33),N(61,"Status"),R(),x(62,"th",33),N(63,"Last Active"),R(),x(64,"th",34),N(65,"Actions"),R()()(),x(66,"tbody",35),wt(67,DZ,31,22,"tr",36,CZ,!1,AZ,6,0,"tr"),R()()(),x(70,"div",37)(71,"p",38),N(72,"Showing "),x(73,"span",39),N(74),R(),N(75," users"),R()()()()(),ye(76,PZ,44,9,"div",40),ye(77,FZ,22,4,"div",40),R()),t&2&&(V(23),Ge("ngModel",r.searchQuery()),V(3),Ge("ngModel",r.roleFilter()),V(3),It(r.userRoles),V(6),Ge("ngModel",r.statusFilter()),V(32),It(r.filteredUsers()),V(7),Re(r.filteredUsers().length),V(2),ve(r.showModal?76:-1),V(),ve(r.showLoginModal?77:-1))},dependencies:[Cr,wa,Vd,Ld,Wi,_a,va,Gs,lf],encapsulation:2})};var h4=[{path:"",redirectTo:"overview",pathMatch:"full"},{path:"overview",component:K0},{path:"groceries",component:J0},{path:"users",component:X0}];var f4={providers:[BI(),Fb(h4),pO(()=>gO(Pd.firebase)),Vj(()=>Lj()),U2(()=>j2())]};function VZ(n,e){if(n&1&&(Di(0,"h3",4),N(1),Mo()),n&2){let t=B();V(),Re(t.title)}}function LZ(n,e){if(n&1){let t=Oe();Di(0,"button",9),lu("click",function(){X(t);let i=B(2);return Z(i.cancel())}),N(1),Mo()}if(n&2){let t=B();V(),lt(" ",t.cancelText||"Cancel"," ")}}function UZ(n,e){if(n&1){let t=Oe();Di(0,"div",0)(1,"div",1),lu("click",function(){let i=X(t),s=B();return Z(i.type==="confirm"?s.cancel():s.confirm())}),Mo(),Di(2,"div",2)(3,"div",3),ye(4,VZ,2,1,"h3",4),Di(5,"p",5),N(6),Mo()(),Di(7,"div",6),ye(8,LZ,2,1,"button",7),Di(9,"button",8),lu("click",function(){X(t);let i=B();return Z(i.confirm())}),N(10),Mo()()()()}if(n&2){let t=e;V(4),ve(t.title?4:-1),V(2),Re(t.message),V(2),ve(t.type==="confirm"?8:-1),V(),Rn("bg-rose-500",t.type==="error")("bg-primary",t.type!=="error"),V(),lt(" ",t.confirmText||"OK"," ")}}var Z0=class n{dialogService=j(Nr);confirm(){this.dialogService.close(!0)}cancel(){this.dialogService.close(!1)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Bn({type:n,selectors:[["app-dialog"]],decls:1,vars:1,consts:[[1,"fixed","inset-0","z-[100]","flex","items-center","justify-center","p-4","bg-black/50","backdrop-blur-sm","animate-in","fade-in","duration-200"],[1,"absolute","inset-0",3,"click"],[1,"relative","bg-white","dark:bg-surface-dark","w-full","max-w-sm","rounded-2xl","shadow-xl","overflow-hidden","animate-in","zoom-in-95","duration-200","border","border-slate-200","dark:border-border-dark"],[1,"p-6"],[1,"text-xl","font-bold","text-slate-900","dark:text-white","mb-2"],[1,"text-slate-600","dark:text-slate-300","leading-relaxed"],[1,"p-4","bg-slate-50","dark:bg-black/20","flex","justify-end","gap-3"],[1,"px-4","py-2","rounded-lg","text-slate-600","dark:text-slate-400","font-bold","hover:bg-slate-200","dark:hover:bg-border-dark","transition-colors"],[1,"px-5","py-2","rounded-lg","text-slate-900","font-bold","hover:brightness-110","transition-all","shadow-lg","active:scale-95",3,"click"],[1,"px-4","py-2","rounded-lg","text-slate-600","dark:text-slate-400","font-bold","hover:bg-slate-200","dark:hover:bg-border-dark","transition-colors",3,"click"]],template:function(t,r){if(t&1&&ye(0,UZ,11,8,"div",0),t&2){let i;ve((i=r.dialogService.dialog())?0:-1,i)}},dependencies:[Cr],encapsulation:2})};var ew=class n{firestore=j(si);COLLECTIONS=["groceries","categories","overview_tasks","assignees","shopping_history"];async migrateAllDataToUser(e){if(!e)return console.error("\u274C userId is required"),[];console.log(`\u{1F504} Starting data migration to userId: ${e}`);let t=[];for(let r of this.COLLECTIONS){let i=await this.migrateCollection(r,e);t.push(i)}return console.log("\u2705 Migration complete!",t),t}async migrateCollection(e,t){console.log(`  \u{1F4C1} Migrating collection: ${e}`);let r=0,i=0;try{let s=ma(this.firestore,e),a=(await Zx(s)).docs.map(async c=>{let d=c.data();if(d.userId===t){console.log(`    \u23ED\uFE0F Skipping ${c.id} (already has userId)`);return}if(d.userId==="system"&&e==="categories"){console.log(`    \u23ED\uFE0F Skipping ${c.id} (system category)`);return}try{await Md(ya(this.firestore,e,c.id),{userId:t}),console.log(`    \u2705 Updated ${c.id}`),r++}catch(h){console.error(`    \u274C Error updating ${c.id}:`,h),i++}});await Promise.all(a)}catch(s){console.error(`  \u274C Error reading collection ${e}:`,s),i++}return console.log(`  \u{1F4CA} ${e}: ${r} updated, ${i} errors`),{collection:e,updated:r,errors:i}}async previewMigration(){console.log("\u{1F4CB} Preview of data to migrate:");for(let e of this.COLLECTIONS)try{let t=ma(this.firestore,e),r=await Zx(t),i=r.docs.filter(s=>{let o=s.data();return!o.userId||o.userId!=="system"&&e!=="categories"});console.log(`  \u{1F4C1} ${e}: ${i.length}/${r.docs.length} documents need migration`)}catch(t){console.error(`  \u274C Error reading ${e}:`,t)}}static \u0275fac=function(t){return new(t||n)};static \u0275prov=se({token:n,factory:n.\u0275fac,providedIn:"root"})};var jZ=(n,e)=>e.id;function BZ(n,e){n&1&&(x(0,"div",42)(1,"span",44),N(2,"lock"),R()())}function $Z(n,e){if(n&1){let t=Oe();x(0,"button",39),Q("click",function(){let i=X(t).$implicit,s=B(3);return Z(s.selectUser(i))}),x(1,"div",40),kt(2,"img",41),ye(3,BZ,3,0,"div",42),R(),x(4,"span",43),N(5),R()()}if(n&2){let t=e.$implicit;V(2),Ge("src",t.avatarUrl||"https://ui-avatars.com/api/?name="+t.name+"&background=random",Qn),V(),ve(t.password?3:-1),V(2),Re(t.name)}}function HZ(n,e){if(n&1&&(x(0,"div",36),wt(1,$Z,6,3,"button",38,jZ),R()),n&2){let t=B(2);V(),It(t.users())}}function qZ(n,e){if(n&1&&(x(0,"p",50),N(1),R()),n&2){let t=B(3);V(),Re(t.loginError())}}function zZ(n,e){if(n&1){let t=Oe();x(0,"div",37)(1,"div",45)(2,"div",46),kt(3,"img",41),R(),x(4,"h3",47),N(5),R()(),x(6,"div",48)(7,"div")(8,"input",49),Q("input",function(i){X(t);let s=B(2);return Z(s.passwordInput.set(i.target.value))})("keyup.enter",function(){X(t);let i=B(2);return Z(i.verifyLogin())}),R(),ye(9,qZ,2,1,"p",50),R(),x(10,"button",51),Q("click",function(){X(t);let i=B(2);return Z(i.verifyLogin())}),N(11,"Login"),R(),x(12,"button",52),Q("click",function(){X(t);let i=B(2);return Z(i.cancelPassword())}),N(13,"Back"),R()()()}if(n&2){let t,r,i=B(2);V(3),Ge("src",((t=i.selectedUser())==null?null:t.avatarUrl)||"https://ui-avatars.com/api/?name="+((t=i.selectedUser())==null?null:t.name)+"&background=random",Qn),V(2),Re((r=i.selectedUser())==null?null:r.name),V(3),Ge("value",i.passwordInput()),V(),ve(i.loginError()?9:-1)}}function GZ(n,e){if(n&1&&(x(0,"div",31)(1,"div",32)(2,"div",33)(3,"h1",34),N(4,"Welcome Back"),R(),x(5,"p",35),N(6,"Who is using HomeNeeds?"),R()(),ye(7,HZ,3,0,"div",36)(8,zZ,14,4,"div",37),R()()),n&2){let t=B();V(7),ve(t.loginStep()==="select"?7:8)}}var tw=class n{title=Se("frontend");overviewService=j(Ki);userService=j(kr);migrationService=j(ew);users=this.userService.users;currentUser=this.userService.currentUser;loading=this.userService.loading;loginStep=Se("select");selectedUser=Se(null);passwordInput=Se("");loginError=Se("");pendingItemsCount=nt(()=>this.overviewService.tasks().filter(e=>!e.isCompleted).length);constructor(){window.userService=this.userService,window.migrationService=this.migrationService,console.log("\u{1F527} Dev Console Tools Available:"),console.log("   \u2192 window.userService.manualMigrateAllUsers()"),console.log('   \u2192 window.migrationService.migrateAllDataToUser("user_xxx")'),console.log("   \u2192 window.migrationService.previewMigration()")}selectUser(e){e.password?(this.selectedUser.set(e),this.loginStep.set("password"),this.passwordInput.set(""),this.loginError.set("")):this.userService.login(e)}cancelPassword(){this.loginStep.set("select"),this.selectedUser.set(null)}async verifyLogin(){let e=this.selectedUser();e&&(e.password===this.passwordInput()?(await this.userService.login(e),this.loginStep.set("select"),this.selectedUser.set(null)):this.loginError.set("Incorrect password"))}logout(){this.userService.logout()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Bn({type:n,selectors:[["app-root"]],hostAttrs:[1,"w-full","h-screen","flex","overflow-hidden"],decls:55,vars:5,consts:[["id","app-sidebar",1,"w-80","h-screen","flex-shrink-0","border-r","border-slate-200","dark:border-border-dark","bg-white","dark:bg-background-dark","flex","flex-col","justify-between","p-6"],[1,"flex","flex-col","mb-8"],[1,"flex","items-center","gap-2","mb-1"],[1,"material-symbols-outlined","text-primary",2,"font-size","32px"],[1,"text-2xl","font-extrabold","tracking-tight"],[1,"text-sm","text-slate-500","dark:text-text-muted"],["id","main-nav",1,"flex","flex-col","gap-2"],["id","nav-overview","routerLink","/overview","routerLinkActive","bg-primary/10 text-primary-hover dark:text-primary",1,"flex","items-center","gap-3","px-4","py-3","rounded-full","hover:bg-slate-100","dark:hover:bg-surface-dark","text-slate-600","dark:text-text-muted","transition-colors","group"],[1,"material-symbols-outlined","filled"],[1,"font-bold","text-sm"],["id","nav-groceries","routerLink","/groceries","routerLinkActive","bg-primary/10 text-primary-hover dark:text-primary",1,"flex","items-center","gap-3","px-4","py-3","rounded-full","hover:bg-slate-100","dark:hover:bg-surface-dark","text-slate-600","dark:text-text-muted","transition-colors","group"],[1,"material-symbols-outlined","group-hover:text-slate-900","dark:group-hover:text-white","transition-colors"],[1,"font-medium","text-sm","group-hover:text-slate-900","dark:group-hover:text-white","transition-colors"],["id","nav-users","routerLink","/users","routerLinkActive","bg-primary/10 text-primary-hover dark:text-primary",1,"flex","items-center","gap-3","px-4","py-3","rounded-full","hover:bg-slate-100","dark:hover:bg-surface-dark","text-slate-600","dark:text-text-muted","transition-colors","group"],["id","nav-logout",1,"flex","w-full","items-center","gap-3","px-4","py-3","rounded-full","hover:bg-slate-100","dark:hover:bg-surface-dark","text-slate-600","dark:text-text-muted","transition-colors","group","text-left","mt-auto",3,"click"],[1,"material-symbols-outlined","group-hover:text-red-500","dark:group-hover:text-red-400","transition-colors"],[1,"font-medium","text-sm","group-hover:text-red-500","dark:group-hover:text-red-400","transition-colors"],[1,"flex","flex-col","gap-4","mt-8"],["id","stats-card",1,"p-5","rounded-2xl","bg-surface-dark/40","border","border-border-dark","backdrop-blur-sm"],[1,"flex","justify-between","items-start","mb-2"],[1,"material-symbols-outlined","text-text-muted"],[1,"text-xs","font-bold","text-primary","bg-primary/10","px-2","py-1","rounded-full"],[1,"text-3xl","font-black","text-white","leading-tight","mb-1"],[1,"text-xs","text-text-muted","font-medium"],["id","user-profile",1,"flex","items-center","gap-3","p-4","rounded-full","bg-surface-dark","cursor-pointer","hover:bg-border-dark","transition-colors"],["alt","User avatar",1,"w-8","h-8","rounded-full","object-cover",3,"src"],[1,"flex","flex-col"],[1,"text-sm","font-bold","text-white","leading-none"],[1,"text-[10px]","text-text-muted","capitalize"],[1,"material-symbols-outlined","text-text-muted","ml-auto","text-sm"],[1,"flex-1","h-screen","flex","flex-col","overflow-hidden"],[1,"fixed","inset-0","z-[100]","bg-[#111317]","flex","items-center","justify-center","p-4"],[1,"max-w-4xl","w-full","flex","flex-col","items-center","gap-12","animate-in","fade-in","zoom-in","duration-300"],[1,"text-center","space-y-2"],[1,"text-4xl","font-bold","text-white","tracking-tight"],[1,"text-[#9ea7b7]","text-lg"],[1,"flex","flex-wrap","justify-center","gap-8"],[1,"bg-[#1a202e]","border","border-[#292e38]","rounded-2xl","p-8","w-full","max-w-sm","shadow-2xl","animate-in","zoom-in-95","duration-200"],[1,"group","flex","flex-col","items-center","gap-4","transition-transform","hover:scale-105","outline-none","focus:scale-105"],[1,"group","flex","flex-col","items-center","gap-4","transition-transform","hover:scale-105","outline-none","focus:scale-105",3,"click"],[1,"size-24","rounded-full","border-2","border-[#292e38]","group-hover:border-[#2060df]","overflow-hidden","transition-colors","relative"],[1,"w-full","h-full","object-cover",3,"src"],[1,"absolute","inset-0","bg-black/40","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],[1,"text-lg","font-medium","text-[#9ea7b7]","group-hover:text-white","transition-colors"],[1,"material-symbols-outlined","text-white"],[1,"flex","flex-col","items-center","gap-4","mb-6"],[1,"size-16","rounded-full","border","border-[#292e38]","overflow-hidden"],[1,"text-white","font-bold","text-xl"],[1,"space-y-4"],["type","password","placeholder","Enter Password","autofocus","",1,"w-full","bg-[#111317]","border","border-[#292e38]","rounded-lg","px-4","py-3","text-white","focus:outline-none","focus:border-[#2060df]","focus:ring-1","focus:ring-[#2060df]","transition-all","text-center","placeholder-[#586173]",3,"input","keyup.enter","value"],[1,"text-red-400","text-xs","mt-2","text-center"],[1,"w-full","py-3","rounded-lg","bg-[#2060df]","text-white","font-bold","hover:bg-[#2060df]/90","transition-colors",3,"click"],[1,"w-full","py-3","rounded-lg","border","border-[#3b4250]","text-[#9ea7b7]","font-bold","hover:text-white","hover:border-white","transition-colors",3,"click"]],template:function(t,r){if(t&1&&(x(0,"aside",0)(1,"div")(2,"div",1)(3,"div",2)(4,"span",3),N(5,"checklist"),R(),x(6,"h1",4),N(7,"HomeNeeds"),R()(),x(8,"p",5),N(9,"Manage your home effortlessly"),R()(),x(10,"nav",6)(11,"a",7)(12,"span",8),N(13,"dashboard"),R(),x(14,"span",9),N(15,"Overview"),R()(),x(16,"a",10)(17,"span",11),N(18,"shopping_cart"),R(),x(19,"span",12),N(20,"Groceries"),R()(),x(21,"a",13)(22,"span",11),N(23,"group"),R(),x(24,"span",12),N(25,"Users"),R()(),x(26,"button",14),Q("click",function(){return r.logout()}),x(27,"span",15),N(28,"logout"),R(),x(29,"span",16),N(30,"Log Out"),R()()()(),x(31,"div",17)(32,"div",18)(33,"div",19)(34,"span",20),N(35,"pending_actions"),R(),x(36,"span",21),N(37,"Today"),R()(),x(38,"p",22),N(39),R(),x(40,"p",23),N(41,"Items Pending"),R()(),x(42,"div",24),kt(43,"img",25),x(44,"div",26)(45,"span",27),N(46),R(),x(47,"span",28),N(48),R()(),x(49,"span",29),N(50,"expand_more"),R()()()(),x(51,"div",30),kt(52,"router-outlet"),R(),kt(53,"app-dialog"),ye(54,GZ,9,1,"div",31)),t&2){let i,s,o;V(39),Re(r.pendingItemsCount()),V(4),Ge("src",((i=r.currentUser())==null?null:i.avatarUrl)||"https://ui-avatars.com/api/?name=Guest&background=random",Qn),V(3),Re(((s=r.currentUser())==null?null:s.name)||"Guest"),V(2),Re(((o=r.currentUser())==null?null:o.role)||"Visitor"),V(6),ve(!r.currentUser()&&!r.loading()?54:-1)}},dependencies:[xf,cv,Z0],encapsulation:2})};fb(tw,f4).catch(n=>console.error(n));
